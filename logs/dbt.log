

============================== 2023-06-27 21:38:43.074960 | 8f62aaae-d9fb-4e11-b593-5f25b45ce69f ==============================
[0m21:38:43.074960 [info ] [MainThread]: Running with dbt=1.4.6
[0m21:38:43.076778 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m21:38:43.077009 [debug] [MainThread]: Tracking: tracking
[0m21:38:43.078507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae459bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae459b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae45efaf0>]}
[0m21:38:43.120097 [debug] [MainThread]: Executing "git --help"
[0m21:38:43.122055 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:38:43.122387 [debug] [MainThread]: STDERR: "b''"
[0m21:38:43.122808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae45ed4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae45ef1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae45edff0>]}
[0m21:38:43.123154 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 21:40:24.116003 | 7703bffc-aad0-4e1d-8567-3aced740b8d8 ==============================
[0m21:40:24.116003 [info ] [MainThread]: Running with dbt=1.4.6
[0m21:40:24.118167 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m21:40:24.118627 [debug] [MainThread]: Tracking: tracking
[0m21:40:24.121075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34379d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34379f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34379e860>]}
[0m21:40:24.121992 [info ] [MainThread]: Setting up your profile.
[0m21:41:55.738957 [info ] [MainThread]: Profile desafioaethaina written to /home/thaina/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m21:41:55.740060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff341ff9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff341c76620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff341c76500>]}
[0m21:41:55.740548 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 21:42:02.989527 | ce2b4029-b72e-41aa-92b6-069770716ca1 ==============================
[0m21:42:02.989527 [info ] [MainThread]: Running with dbt=1.4.6
[0m21:42:02.991298 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m21:42:02.991513 [debug] [MainThread]: Tracking: tracking
[0m21:42:02.992913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a80a3970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a80a1c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a80a3a00>]}
[0m21:42:03.402030 [debug] [MainThread]: Executing "git --help"
[0m21:42:03.403902 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:42:03.404212 [debug] [MainThread]: STDERR: "b''"
[0m21:42:03.406989 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:42:03.407339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:42:03.409350 [debug] [MainThread]: On debug: select 1 as id
[0m21:42:05.693844 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a619633b-e3a3-45a0-9768-d16681a97c1a&page=queryresults
[0m21:42:05.694450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a972dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a6397d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a63976d0>]}
[0m21:42:05.695082 [debug] [MainThread]: Flushing usage events
[0m21:42:06.686550 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-06-27 21:42:52.556666 | ddb831fd-1ba0-448e-9661-ee73978ef77f ==============================
[0m21:42:52.556666 [info ] [MainThread]: Running with dbt=1.4.6
[0m21:42:52.560102 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:42:52.560603 [debug] [MainThread]: Tracking: tracking
[0m21:42:52.562672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8a67a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8a679c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8a67a560>]}
[0m21:42:52.602973 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m21:42:52.603731 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:42:52.604945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8a6780d0>]}
[0m21:42:54.050757 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m21:42:54.081268 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m21:42:54.091044 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m21:42:54.100107 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m21:42:54.110405 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer.sql
[0m21:42:54.119759 [debug] [MainThread]: 1603: static parser failed on gold/dim_dates.sql
[0m21:42:54.172306 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim_dates.sql
[0m21:42:54.174718 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m21:42:54.179563 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_description.sql
[0m21:42:54.184146 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_location.sql
[0m21:42:54.188720 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_inventory.sql
[0m21:42:54.193248 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_subcategory.sql
[0m21:42:54.198498 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_category.sql
[0m21:42:54.203169 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product.sql
[0m21:42:54.207784 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_model.sql
[0m21:42:54.212718 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_detail.sql
[0m21:42:54.217378 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_ship_method.sql
[0m21:42:54.222088 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_product_vendor.sql
[0m21:42:54.226715 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_header.sql
[0m21:42:54.231554 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_vendor.sql
[0m21:42:54.236211 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_detail.sql
[0m21:42:54.240813 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency.sql
[0m21:42:54.245753 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_territory.sql
[0m21:42:54.250397 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency_rate.sql
[0m21:42:54.255246 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_reason.sql
[0m21:42:54.260039 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_customer.sql
[0m21:42:54.264635 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_country_region_currency.sql
[0m21:42:54.269264 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person.sql
[0m21:42:54.273906 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_tax_rate.sql
[0m21:42:54.278833 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person_quota_history.sql
[0m21:42:54.283574 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header_reason.sql
[0m21:42:54.288275 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header.sql
[0m21:42:54.293166 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_address_type.sql
[0m21:42:54.297798 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_state_province.sql
[0m21:42:54.302734 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_person.sql
[0m21:42:54.308715 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_address.sql
[0m21:42:54.313439 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_contact_type.sql
[0m21:42:54.318243 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_business_entity_address.sql
[0m21:42:54.322894 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_country_region.sql
[0m21:42:54.327807 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_business_entity_contact.sql
[0m21:42:54.892465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8979e500>]}
[0m21:42:54.916459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8a678a90>]}
[0m21:42:54.917201 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m21:42:54.918302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8a67a590>]}
[0m21:42:54.925355 [info ] [MainThread]: 
[0m21:42:54.927628 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:42:54.931465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m21:42:54.933004 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m21:42:54.934071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:54.934576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:54.935780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m21:42:54.976528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:56.282011 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_silver'
[0m21:42:56.282705 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_gold'
[0m21:42:56.283578 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_intermediate'
[0m21:42:56.284347 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_silver'
[0m21:42:56.285113 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_gold'
[0m21:42:56.285815 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_intermediate'
[0m21:42:56.286240 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='desafiothaina', schema='dev_thaina_silver', identifier=None)"
[0m21:42:56.286625 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='desafiothaina', schema='dev_thaina_gold', identifier=None)"
[0m21:42:56.286974 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='desafiothaina', schema='dev_thaina_intermediate', identifier=None)"
[0m21:42:56.293357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:56.295795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:56.298192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:56.300433 [debug] [ThreadPool]: On create_desafiothaina_dev_thaina_silver: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "connection_name": "create_desafiothaina_dev_thaina_silver"} */
create schema if not exists `desafiothaina`.`dev_thaina_silver`
  
[0m21:42:56.302178 [debug] [ThreadPool]: On create_desafiothaina_dev_thaina_gold: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "connection_name": "create_desafiothaina_dev_thaina_gold"} */
create schema if not exists `desafiothaina`.`dev_thaina_gold`
  
[0m21:42:56.306149 [debug] [ThreadPool]: On create_desafiothaina_dev_thaina_intermediate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "connection_name": "create_desafiothaina_dev_thaina_intermediate"} */
create schema if not exists `desafiothaina`.`dev_thaina_intermediate`
  
[0m21:42:58.573606 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e3ad3329-cb8e-4a6e-8594-f3c48fb42af4&page=queryresults
[0m21:42:58.589871 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3609cb08-1abe-41fc-b5dc-1de1bd7e233c&page=queryresults
[0m21:42:58.943533 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4f195ec9-38dd-4ea6-a38d-42f30b97c3bd&page=queryresults
[0m21:42:58.951503 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m21:42:58.952080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:58.952783 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m21:42:58.953973 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m21:42:58.954362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:58.957066 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m21:42:58.992358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:59.065499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:00.787322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae896a8e20>]}
[0m21:43:00.788780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:43:00.789634 [info ] [MainThread]: 
[0m21:43:00.797268 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m21:43:00.798285 [info ] [Thread-1 (]: 1 of 39 START sql table model dev_thaina_gold.dim_dates ........................ [RUN]
[0m21:43:00.799987 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m21:43:00.800675 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m21:43:00.810955 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_address
[0m21:43:00.812061 [info ] [Thread-2 (]: 2 of 39 START sql table model dev_thaina_intermediate.int_address .............. [RUN]
[0m21:43:00.814001 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m21:43:00.814662 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_address
[0m21:43:00.821819 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_customer
[0m21:43:00.823159 [info ] [Thread-3 (]: 3 of 39 START sql table model dev_thaina_intermediate.int_customer ............. [RUN]
[0m21:43:00.825253 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer'
[0m21:43:00.827443 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_customer
[0m21:43:00.839875 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_customer_and_sales
[0m21:43:00.840888 [info ] [Thread-4 (]: 4 of 39 START sql table model dev_thaina_intermediate.int_customer_and_sales ... [RUN]
[0m21:43:00.843883 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer_and_sales'
[0m21:43:00.844590 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_customer_and_sales
[0m21:43:00.856019 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m21:43:00.858064 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_customer_and_sales"
[0m21:43:00.876578 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_customer_and_sales (compile): 2023-06-27 21:43:00.845263 => 2023-06-27 21:43:00.876430
[0m21:43:00.877219 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.int_customer_and_sales
[0m21:43:00.878231 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_customer"
[0m21:43:00.878859 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-06-27 21:43:00.815134 => 2023-06-27 21:43:00.878744
[0m21:43:00.886980 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.int_address
[0m21:43:00.893095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:00.894242 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_customer (compile): 2023-06-27 21:43:00.827882 => 2023-06-27 21:43:00.894084
[0m21:43:00.909664 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.int_customer
[0m21:43:00.916486 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m21:43:01.014945 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.int_customer_and_sales"
[0m21:43:01.016325 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m21:43:01.013671 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.int_customer"
[0m21:43:01.019151 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:01.019838 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:01.020122 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:01.021767 [debug] [Thread-4 (]: On model.desafioaethaina.int_customer_and_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
	from `dev_thaina_intermediate.int_sales_customer`	
)

, sales as (
	select * 
	from `dev_thaina_intermediate.int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, business_entity_id
		, person_type
		, name_style
		, courtesy_title
		, first_name
		, middle_name
		, last_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m21:43:01.023263 [debug] [Thread-3 (]: On model.desafioaethaina.int_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `dev_thaina_silver.stg_sales_customer`
)

, sales_territory as (
	select * 
    from `dev_thaina_silver.stg_sales_territory`
)

, person_person as (
	select * 
    from `dev_thaina_silver.stg_person_person`
)

, person_country as (
	select * 
    from `dev_thaina_silver.stg_person_country_region`
)

, state_province as (
	select * 
    from `dev_thaina_silver.stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , group_geo
        , sales_territory_year
        , bussiness_cost_in_territory
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

select * 
from union_customer_country
    );
  
[0m21:43:01.025015 [debug] [Thread-2 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with address as (
	select * 
    from `dev_thaina_silver.stg_person_address`
)

, address_type as (
	select * 
    from `dev_thaina_silver.stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `dev_thaina_silver.stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `dev_thaina_silver.stg_person_business_entity_contact`
)

, union_address_business_address as (
    select
        address.address_id
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
        , business_entity_id
        , address_type_id
    from address 
    left join business_entity_address  
    on address.address_id = business_entity_address.address_id
   
)

, union_address_business_contact as (
    select
        union_address_business_address.*
        , address_type_name
        , contact_type_id
    from business_entity_contact
    left join  union_address_business_address
    on union_address_business_address.business_entity_id = business_entity_contact.business_entity_id
    left join address_type 
    on address_type.address_type_id = union_address_business_address.address_type_id
)

select * 
from union_address_business_contact
    );
  
[0m21:43:02.424028 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with address as (
	select * 
    from `dev_thaina_silver.stg_person_address`
)

, address_type as (
	select * 
    from `dev_thaina_silver.stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `dev_thaina_silver.stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `dev_thaina_silver.stg_person_business_entity_contact`
)

, union_address_business_address as (
    select
        address.address_id
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
        , business_entity_id
        , address_type_id
    from address 
    left join business_entity_address  
    on address.address_id = business_entity_address.address_id
   
)

, union_address_business_contact as (
    select
        union_address_business_address.*
        , address_type_name
        , contact_type_id
    from business_entity_contact
    left join  union_address_business_address
    on union_address_business_address.business_entity_id = business_entity_contact.business_entity_id
    left join address_type 
    on address_type.address_type_id = union_address_business_address.address_type_id
)

select * 
from union_address_business_contact
    );
  
[0m21:43:02.425029 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_address was not found in location US

Location: US
Job ID: 89b949f4-71e4-44d2-b98b-fe1c20eab9e1

[0m21:43:02.425529 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-06-27 21:43:00.887575 => 2023-06-27 21:43:02.425448
[0m21:43:02.428109 [debug] [Thread-2 (]: Runtime Error in model int_address (models/intermediate/int_address.sql)
  404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_address was not found in location US
  
  Location: US
  Job ID: 89b949f4-71e4-44d2-b98b-fe1c20eab9e1
  
[0m21:43:02.428596 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae899df6a0>]}
[0m21:43:02.429145 [error] [Thread-2 (]: 2 of 39 ERROR creating sql table model dev_thaina_intermediate.int_address ..... [[31mERROR[0m in 1.62s]
[0m21:43:02.431771 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_address
[0m21:43:02.432301 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_sales
[0m21:43:02.433378 [info ] [Thread-2 (]: 5 of 39 START sql table model dev_thaina_intermediate.int_sales ................ [RUN]
[0m21:43:02.434656 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m21:43:02.435211 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_sales
[0m21:43:02.439627 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m21:43:02.440672 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-06-27 21:43:02.435554 => 2023-06-27 21:43:02.440514
[0m21:43:02.441409 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.int_sales
[0m21:43:02.448402 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m21:43:02.449136 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:02.452106 [debug] [Thread-2 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with order_header as (
	select * 
	from `dev_thaina_silver.stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `dev_thaina_silver.stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `dev_thaina_silver.stg_sales_order_detail`	
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, sales_order_detail_id
		, carrier_tracking_number
		, order_qty
		, product_id
		, unit_price
		, unit_price_discount
	from order_header
	left join order_header_reason
	on order_header_reason.sales_order_id = order_header.sales_order_id
	left join order_detail 
	on order_detail.sales_order_id =  order_header.sales_order_id
)

select * from union_header_reason
    );
  
[0m21:43:02.496150 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
	from `dev_thaina_intermediate.int_sales_customer`	
)

, sales as (
	select * 
	from `dev_thaina_intermediate.int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, business_entity_id
		, person_type
		, name_style
		, courtesy_title
		, first_name
		, middle_name
		, last_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m21:43:02.496679 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Table desafiothaina:dev_thaina_intermediate.int_sales was not found in location US

Location: US
Job ID: b417ceb1-1518-4be7-a081-c6d968d1583d

[0m21:43:02.497168 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_customer_and_sales (execute): 2023-06-27 21:43:00.879310 => 2023-06-27 21:43:02.497094
[0m21:43:02.497839 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `dev_thaina_silver.stg_sales_customer`
)

, sales_territory as (
	select * 
    from `dev_thaina_silver.stg_sales_territory`
)

, person_person as (
	select * 
    from `dev_thaina_silver.stg_person_person`
)

, person_country as (
	select * 
    from `dev_thaina_silver.stg_person_country_region`
)

, state_province as (
	select * 
    from `dev_thaina_silver.stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , group_geo
        , sales_territory_year
        , bussiness_cost_in_territory
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

select * 
from union_customer_country
    );
  
[0m21:43:02.498956 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_country_region was not found in location US

Location: US
Job ID: 435dc787-617e-4e47-889e-68a72c7b2455

[0m21:43:02.499770 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_customer (execute): 2023-06-27 21:43:00.917253 => 2023-06-27 21:43:02.499637
[0m21:43:02.501624 [debug] [Thread-4 (]: Runtime Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)
  404 Not found: Table desafiothaina:dev_thaina_intermediate.int_sales was not found in location US
  
  Location: US
  Job ID: b417ceb1-1518-4be7-a081-c6d968d1583d
  
[0m21:43:02.502812 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89914520>]}
[0m21:43:02.503821 [error] [Thread-4 (]: 4 of 39 ERROR creating sql table model dev_thaina_intermediate.int_customer_and_sales  [[31mERROR[0m in 1.66s]
[0m21:43:02.504718 [debug] [Thread-3 (]: Runtime Error in model int_customer (models/intermediate/int_customer.sql)
  404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_country_region was not found in location US
  
  Location: US
  Job ID: 435dc787-617e-4e47-889e-68a72c7b2455
  
[0m21:43:02.505498 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_customer_and_sales
[0m21:43:02.506243 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae899985b0>]}
[0m21:43:02.506748 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_address
[0m21:43:02.508190 [error] [Thread-3 (]: 3 of 39 ERROR creating sql table model dev_thaina_intermediate.int_customer .... [[31mERROR[0m in 1.68s]
[0m21:43:02.511556 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_customer
[0m21:43:02.509245 [info ] [Thread-4 (]: 6 of 39 START sql table model dev_thaina_silver.stg_person_address ............. [RUN]
[0m21:43:02.512762 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_address_type
[0m21:43:02.513944 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address'
[0m21:43:02.514613 [info ] [Thread-3 (]: 7 of 39 START sql table model dev_thaina_silver.stg_person_address_type ........ [RUN]
[0m21:43:02.515498 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_address
[0m21:43:02.516872 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address_type'
[0m21:43:02.520978 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address"
[0m21:43:02.521537 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_address_type
[0m21:43:02.526595 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address_type"
[0m21:43:02.527599 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_address (compile): 2023-06-27 21:43:02.517230 => 2023-06-27 21:43:02.527461
[0m21:43:02.527998 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (compile): 2023-06-27 21:43:02.522217 => 2023-06-27 21:43:02.527912
[0m21:43:02.528475 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_address
[0m21:43:02.529054 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_address_type
[0m21:43:02.542931 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address"
[0m21:43:02.548780 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:02.552059 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
    );
  
[0m21:43:02.608630 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address_type"
[0m21:43:02.610974 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:02.614430 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_address_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addresstypeid as address_type_id
    , name as address_type_name 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`addresstype`
)

select *
from source_data
    );
  
[0m21:43:03.189378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:33994d60-aa13-4e1e-9ad9-3441178fd0bb&page=queryresults
[0m21:43:03.191685 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m21:43:03.192294 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-06-27 21:43:00.801170 => 2023-06-27 21:43:03.192215
[0m21:43:03.192638 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m21:43:03.196598 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m21:43:03.197187 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      


/* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m21:43:03.455043 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with order_header as (
	select * 
	from `dev_thaina_silver.stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `dev_thaina_silver.stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `dev_thaina_silver.stg_sales_order_detail`	
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, sales_order_detail_id
		, carrier_tracking_number
		, order_qty
		, product_id
		, unit_price
		, unit_price_discount
	from order_header
	left join order_header_reason
	on order_header_reason.sales_order_id = order_header.sales_order_id
	left join order_detail 
	on order_detail.sales_order_id =  order_header.sales_order_id
)

select * from union_header_reason
    );
  
[0m21:43:03.455531 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Table desafiothaina:dev_thaina_silver.stg_sales_order_detail was not found in location US

Location: US
Job ID: 9ab4744a-14ed-48ef-95a8-33da116bbae9

[0m21:43:03.456004 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-06-27 21:43:02.441999 => 2023-06-27 21:43:03.455938
[0m21:43:03.457004 [debug] [Thread-2 (]: Runtime Error in model int_sales (models/intermediate/int_sales.sql)
  404 Not found: Table desafiothaina:dev_thaina_silver.stg_sales_order_detail was not found in location US
  
  Location: US
  Job ID: 9ab4744a-14ed-48ef-95a8-33da116bbae9
  
[0m21:43:03.457433 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae896aa140>]}
[0m21:43:03.457922 [error] [Thread-2 (]: 5 of 39 ERROR creating sql table model dev_thaina_intermediate.int_sales ....... [[31mERROR[0m in 1.02s]
[0m21:43:03.458592 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_sales
[0m21:43:03.459336 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_business_entity_address
[0m21:43:03.460303 [info ] [Thread-2 (]: 8 of 39 START sql table model dev_thaina_silver.stg_person_business_entity_address  [RUN]
[0m21:43:03.461850 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_address'
[0m21:43:03.462501 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_address
[0m21:43:03.469098 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_address"
[0m21:43:03.469966 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (compile): 2023-06-27 21:43:03.462985 => 2023-06-27 21:43:03.469860
[0m21:43:03.470600 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_business_entity_address
[0m21:43:03.477683 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_address"
[0m21:43:03.478766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:03.481408 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_business_entity_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , addressid as address_id
    , addresstypeid as address_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentityaddress`
)

select *
from source_data
    );
  
[0m21:43:03.574723 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
    );
  
[0m21:43:03.575229 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: a7d9709b-80c3-4da0-a966-6d58c733c085

[0m21:43:03.575856 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_address (execute): 2023-06-27 21:43:02.529584 => 2023-06-27 21:43:03.575763
[0m21:43:03.577453 [debug] [Thread-4 (]: Runtime Error in model stg_person_address (models/silver/person/stg_person_address.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: a7d9709b-80c3-4da0-a966-6d58c733c085
  
[0m21:43:03.578043 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89733400>]}
[0m21:43:03.578742 [error] [Thread-4 (]: 6 of 39 ERROR creating sql table model dev_thaina_silver.stg_person_address .... [[31mERROR[0m in 1.06s]
[0m21:43:03.579501 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_address
[0m21:43:03.580187 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_contact
[0m21:43:03.580864 [info ] [Thread-4 (]: 9 of 39 START sql table model dev_thaina_silver.stg_person_business_entity_contact  [RUN]
[0m21:43:03.582478 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_contact'
[0m21:43:03.583152 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_contact
[0m21:43:03.588906 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m21:43:03.589873 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (compile): 2023-06-27 21:43:03.583646 => 2023-06-27 21:43:03.589738
[0m21:43:03.590566 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_business_entity_contact
[0m21:43:03.600593 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m21:43:03.601522 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:03.604351 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_business_entity_contact: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_contact"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , personid as person_id
    , contacttypeid as contact_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentitycontact`
)

select *
from source_data
    );
  
[0m21:43:03.646118 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addresstypeid as address_type_id
    , name as address_type_name 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`addresstype`
)

select *
from source_data
    );
  
[0m21:43:03.646929 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 1c3be0ee-98fd-4c71-94aa-58dab61127e8

[0m21:43:03.647670 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (execute): 2023-06-27 21:43:02.535752 => 2023-06-27 21:43:03.647565
[0m21:43:03.655584 [debug] [Thread-3 (]: Runtime Error in model stg_person_address_type (models/silver/person/stg_person_address_type.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 1c3be0ee-98fd-4c71-94aa-58dab61127e8
  
[0m21:43:03.656459 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae897478b0>]}
[0m21:43:03.657079 [error] [Thread-3 (]: 7 of 39 ERROR creating sql table model dev_thaina_silver.stg_person_address_type  [[31mERROR[0m in 1.14s]
[0m21:43:03.657651 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_address_type
[0m21:43:03.658427 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_contact_type
[0m21:43:03.659335 [info ] [Thread-3 (]: 10 of 39 START sql table model dev_thaina_silver.stg_person_contact_type ....... [RUN]
[0m21:43:03.661523 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_contact_type'
[0m21:43:03.662331 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_contact_type
[0m21:43:03.669545 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_contact_type"
[0m21:43:03.671344 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_contact_type (compile): 2023-06-27 21:43:03.662847 => 2023-06-27 21:43:03.671122
[0m21:43:03.672406 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_contact_type
[0m21:43:03.681454 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_contact_type"
[0m21:43:03.682342 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:03.684604 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_contact_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_contact_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    contacttypeid as contact_type_id
    , name as contact_type_name 
  from  `desafiothaina`.`dev_thaina`.`contacttype`
)

select *
from source_data
    );
  
[0m21:43:04.439221 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , addressid as address_id
    , addresstypeid as address_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentityaddress`
)

select *
from source_data
    );
  
[0m21:43:04.439582 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: a532f3f0-0f5b-4e76-ae11-5937ad13738d

[0m21:43:04.440089 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (execute): 2023-06-27 21:43:03.471388 => 2023-06-27 21:43:04.440018
[0m21:43:04.441108 [debug] [Thread-2 (]: Runtime Error in model stg_person_business_entity_address (models/silver/person/stg_person_business_entity_address.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: a532f3f0-0f5b-4e76-ae11-5937ad13738d
  
[0m21:43:04.441553 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae896a8e50>]}
[0m21:43:04.442044 [error] [Thread-2 (]: 8 of 39 ERROR creating sql table model dev_thaina_silver.stg_person_business_entity_address  [[31mERROR[0m in 0.98s]
[0m21:43:04.442555 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_business_entity_address
[0m21:43:04.443134 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_country_region
[0m21:43:04.443829 [info ] [Thread-2 (]: 11 of 39 START sql table model dev_thaina_silver.stg_person_country_region ..... [RUN]
[0m21:43:04.444932 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_country_region'
[0m21:43:04.445378 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_country_region
[0m21:43:04.451476 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_country_region"
[0m21:43:04.452964 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_country_region (compile): 2023-06-27 21:43:04.445610 => 2023-06-27 21:43:04.452754
[0m21:43:04.453985 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_country_region
[0m21:43:04.462257 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_country_region"
[0m21:43:04.463091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:04.466423 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_country_region: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_country_region"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
    );
  
[0m21:43:04.631178 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_contact"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , personid as person_id
    , contacttypeid as contact_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentitycontact`
)

select *
from source_data
    );
  
[0m21:43:04.631546 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 8d8f0790-61df-4c45-a1fc-1f2c68a55094

[0m21:43:04.631949 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (execute): 2023-06-27 21:43:03.591099 => 2023-06-27 21:43:04.631883
[0m21:43:04.633162 [debug] [Thread-4 (]: Runtime Error in model stg_person_business_entity_contact (models/silver/person/stg_person_business_entity_contact.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 8d8f0790-61df-4c45-a1fc-1f2c68a55094
  
[0m21:43:04.633654 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae898cc5b0>]}
[0m21:43:04.634184 [error] [Thread-4 (]: 9 of 39 ERROR creating sql table model dev_thaina_silver.stg_person_business_entity_contact  [[31mERROR[0m in 1.05s]
[0m21:43:04.634852 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_contact
[0m21:43:04.635501 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_person
[0m21:43:04.636932 [info ] [Thread-4 (]: 12 of 39 START sql table model dev_thaina_silver.stg_person_person ............. [RUN]
[0m21:43:04.638144 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_person'
[0m21:43:04.638674 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_person
[0m21:43:04.643996 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_person"
[0m21:43:04.644783 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_person (compile): 2023-06-27 21:43:04.638932 => 2023-06-27 21:43:04.644667
[0m21:43:04.645444 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_person
[0m21:43:04.653469 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_person"
[0m21:43:04.654530 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:04.656359 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
    );
  
[0m21:43:04.693424 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_contact_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    contacttypeid as contact_type_id
    , name as contact_type_name 
  from  `desafiothaina`.`dev_thaina`.`contacttype`
)

select *
from source_data
    );
  
[0m21:43:04.694023 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 229929d5-a267-45fc-8797-ddad7d38cc0d

[0m21:43:04.694546 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_contact_type (execute): 2023-06-27 21:43:03.672987 => 2023-06-27 21:43:04.694444
[0m21:43:04.696248 [debug] [Thread-3 (]: Runtime Error in model stg_person_contact_type (models/silver/person/stg_person_contact_type.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 229929d5-a267-45fc-8797-ddad7d38cc0d
  
[0m21:43:04.696916 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89747490>]}
[0m21:43:04.697614 [error] [Thread-3 (]: 10 of 39 ERROR creating sql table model dev_thaina_silver.stg_person_contact_type  [[31mERROR[0m in 1.04s]
[0m21:43:04.698492 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_contact_type
[0m21:43:04.699827 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_state_province
[0m21:43:04.700824 [info ] [Thread-3 (]: 13 of 39 START sql table model dev_thaina_silver.stg_person_state_province ..... [RUN]
[0m21:43:04.702364 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_state_province'
[0m21:43:04.703005 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_state_province
[0m21:43:04.717949 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_state_province"
[0m21:43:04.719012 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_state_province (compile): 2023-06-27 21:43:04.703427 => 2023-06-27 21:43:04.718928
[0m21:43:04.719356 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_state_province
[0m21:43:04.726046 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_state_province"
[0m21:43:04.726879 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:04.730285 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_state_province: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_state_province"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
    );
  
[0m21:43:05.451635 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_country_region"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
    );
  
[0m21:43:05.452100 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 33c75b27-9bbf-441a-aa89-a25390519a75

[0m21:43:05.452814 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_country_region (execute): 2023-06-27 21:43:04.454748 => 2023-06-27 21:43:05.452685
[0m21:43:05.454231 [debug] [Thread-2 (]: Runtime Error in model stg_person_country_region (models/silver/person/stg_person_country_region.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 33c75b27-9bbf-441a-aa89-a25390519a75
  
[0m21:43:05.454712 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89aadae0>]}
[0m21:43:05.455246 [error] [Thread-2 (]: 11 of 39 ERROR creating sql table model dev_thaina_silver.stg_person_country_region  [[31mERROR[0m in 1.01s]
[0m21:43:05.455798 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_country_region
[0m21:43:05.456504 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product
[0m21:43:05.457184 [info ] [Thread-2 (]: 14 of 39 START sql table model dev_thaina_silver.stg_product ................... [RUN]
[0m21:43:05.458347 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product'
[0m21:43:05.458880 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product
[0m21:43:05.464978 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product"
[0m21:43:05.466505 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product (compile): 2023-06-27 21:43:05.459311 => 2023-06-27 21:43:05.466191
[0m21:43:05.467364 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product
[0m21:43:05.475638 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product"
[0m21:43:05.476510 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:05.479256 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , productmodelid as product_model_id
    , productsubcategoryid as product_subcategory_id
    , name as product_name
    , productnumber as product_number
    , makeflag
    , finishedgoodsflag as finished_goods_flag
    , color
    , safetystocklevel as safety_stock_level
    , standardcost as stand_cost
    , listprice as list_price
    , size as size_product
    , style as style_product
    , weight as weight_product 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`product`
)

select * from source_data
    );
  
[0m21:43:05.707502 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
    );
  
[0m21:43:05.707919 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 04c1d532-6590-4b8b-afc2-f6e4d86d3036

[0m21:43:05.708404 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_person (execute): 2023-06-27 21:43:04.646215 => 2023-06-27 21:43:05.708323
[0m21:43:05.709732 [debug] [Thread-4 (]: Runtime Error in model stg_person_person (models/silver/person/stg_person_person.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 04c1d532-6590-4b8b-afc2-f6e4d86d3036
  
[0m21:43:05.710191 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89748a90>]}
[0m21:43:05.710970 [error] [Thread-4 (]: 12 of 39 ERROR creating sql table model dev_thaina_silver.stg_person_person .... [[31mERROR[0m in 1.07s]
[0m21:43:05.712124 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_person
[0m21:43:05.712901 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_category
[0m21:43:05.713537 [info ] [Thread-4 (]: 15 of 39 START sql table model dev_thaina_silver.stg_product_category .......... [RUN]
[0m21:43:05.714757 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_category'
[0m21:43:05.715382 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_category
[0m21:43:05.719894 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_category"
[0m21:43:05.721053 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_category (compile): 2023-06-27 21:43:05.715658 => 2023-06-27 21:43:05.720889
[0m21:43:05.721662 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product_category
[0m21:43:05.726685 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_category"
[0m21:43:05.727276 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:05.730993 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product_category: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_category"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productcategoryid as category_id
    , name as category_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productcategory`
)

select *
from source_data
    );
  
[0m21:43:05.772581 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_state_province"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
    );
  
[0m21:43:05.773315 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: b3d48ab6-57b2-4856-9a1b-8523a2f6bdbc

[0m21:43:05.773779 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_state_province (execute): 2023-06-27 21:43:04.719557 => 2023-06-27 21:43:05.773708
[0m21:43:05.774790 [debug] [Thread-3 (]: Runtime Error in model stg_person_state_province (models/silver/person/stg_person_state_province.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: b3d48ab6-57b2-4856-9a1b-8523a2f6bdbc
  
[0m21:43:05.775310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89aaecb0>]}
[0m21:43:05.776217 [error] [Thread-3 (]: 13 of 39 ERROR creating sql table model dev_thaina_silver.stg_person_state_province  [[31mERROR[0m in 1.07s]
[0m21:43:05.778422 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_state_province
[0m21:43:05.779410 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_description
[0m21:43:05.780063 [info ] [Thread-3 (]: 16 of 39 START sql table model dev_thaina_silver.stg_product_description ....... [RUN]
[0m21:43:05.781363 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_description'
[0m21:43:05.782291 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_description
[0m21:43:05.796715 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_description"
[0m21:43:05.797304 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_description (compile): 2023-06-27 21:43:05.782771 => 2023-06-27 21:43:05.797208
[0m21:43:05.797703 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_description
[0m21:43:05.802427 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_description"
[0m21:43:05.803457 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:05.805280 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_description: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_description"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_description`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productdescriptionid as product_description_id
    , description as product_description
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productdescription`
)

select *
from source_data
    );
  
[0m21:43:06.577596 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , productmodelid as product_model_id
    , productsubcategoryid as product_subcategory_id
    , name as product_name
    , productnumber as product_number
    , makeflag
    , finishedgoodsflag as finished_goods_flag
    , color
    , safetystocklevel as safety_stock_level
    , standardcost as stand_cost
    , listprice as list_price
    , size as size_product
    , style as style_product
    , weight as weight_product 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`product`
)

select * from source_data
    );
  
[0m21:43:06.578116 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: a9fe3047-8447-41ca-8ba9-679dff5b4ce8

[0m21:43:06.578884 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product (execute): 2023-06-27 21:43:05.467832 => 2023-06-27 21:43:06.578777
[0m21:43:06.580266 [debug] [Thread-2 (]: Runtime Error in model stg_product (models/silver/products/stg_product.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: a9fe3047-8447-41ca-8ba9-679dff5b4ce8
  
[0m21:43:06.580761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8976cdc0>]}
[0m21:43:06.581336 [error] [Thread-2 (]: 14 of 39 ERROR creating sql table model dev_thaina_silver.stg_product .......... [[31mERROR[0m in 1.12s]
[0m21:43:06.581909 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product
[0m21:43:06.582624 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_inventory
[0m21:43:06.583310 [info ] [Thread-2 (]: 17 of 39 START sql table model dev_thaina_silver.stg_product_inventory ......... [RUN]
[0m21:43:06.584409 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_inventory'
[0m21:43:06.584767 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_inventory
[0m21:43:06.588308 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_inventory"
[0m21:43:06.589055 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_inventory (compile): 2023-06-27 21:43:06.584984 => 2023-06-27 21:43:06.588935
[0m21:43:06.589462 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product_inventory
[0m21:43:06.593272 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_inventory"
[0m21:43:06.593851 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:06.596300 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product_inventory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_inventory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , locationid as location_id
    , shelf
    , bin
    , quantity as quantity_inventory
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productinventory`
)

select *
from source_data
    );
  
[0m21:43:06.794756 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_category"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productcategoryid as category_id
    , name as category_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productcategory`
)

select *
from source_data
    );
  
[0m21:43:06.795173 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 87fd3ac6-21ea-446b-9419-6da4792b2fb3

[0m21:43:06.795657 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_category (execute): 2023-06-27 21:43:05.721896 => 2023-06-27 21:43:06.795587
[0m21:43:06.796740 [debug] [Thread-4 (]: Runtime Error in model stg_product_category (models/silver/products/stg_product_category.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 87fd3ac6-21ea-446b-9419-6da4792b2fb3
  
[0m21:43:06.797162 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8a426ec0>]}
[0m21:43:06.797686 [error] [Thread-4 (]: 15 of 39 ERROR creating sql table model dev_thaina_silver.stg_product_category . [[31mERROR[0m in 1.08s]
[0m21:43:06.798271 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_category
[0m21:43:06.798801 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_location
[0m21:43:06.799407 [info ] [Thread-4 (]: 18 of 39 START sql table model dev_thaina_silver.stg_product_location .......... [RUN]
[0m21:43:06.800646 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_location'
[0m21:43:06.801035 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_location
[0m21:43:06.804692 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_location"
[0m21:43:06.805389 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_location (compile): 2023-06-27 21:43:06.801274 => 2023-06-27 21:43:06.805223
[0m21:43:06.806134 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product_location
[0m21:43:06.813820 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_location"
[0m21:43:06.814984 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:06.816695 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product_location: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_location"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    locationid as location_id
    , name as location_name
    -- Standard hourly cost of the manufacturing location.
    , costrate as cost_rate
    -- Work capacity (in hours) of the manufacturing location.
    , availability 
  from  `desafiothaina`.`dev_thaina`.`location`
)

select *
from source_data
    );
  
[0m21:43:06.854351 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_description"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_description`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productdescriptionid as product_description_id
    , description as product_description
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productdescription`
)

select *
from source_data
    );
  
[0m21:43:06.855521 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: ebbd9f95-ee97-4d0c-967c-6b5821c272c9

[0m21:43:06.856270 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_description (execute): 2023-06-27 21:43:05.797939 => 2023-06-27 21:43:06.856126
[0m21:43:06.859579 [debug] [Thread-3 (]: Runtime Error in model stg_product_description (models/silver/products/stg_product_description.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: ebbd9f95-ee97-4d0c-967c-6b5821c272c9
  
[0m21:43:06.860656 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89acc640>]}
[0m21:43:06.861645 [error] [Thread-3 (]: 16 of 39 ERROR creating sql table model dev_thaina_silver.stg_product_description  [[31mERROR[0m in 1.08s]
[0m21:43:06.862646 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_description
[0m21:43:06.863337 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_model
[0m21:43:06.863989 [info ] [Thread-3 (]: 19 of 39 START sql table model dev_thaina_silver.stg_product_model ............. [RUN]
[0m21:43:06.865213 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_model'
[0m21:43:06.865691 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_model
[0m21:43:06.875778 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_model"
[0m21:43:06.876827 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_model (compile): 2023-06-27 21:43:06.865938 => 2023-06-27 21:43:06.876678
[0m21:43:06.878186 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_model
[0m21:43:06.885199 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_model"
[0m21:43:06.885873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:06.887730 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_model: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_model"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productmodelid as model_id
    , name as model_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productmodel`
)

select *
from source_data
    );
  
[0m21:43:07.565157 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_inventory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , locationid as location_id
    , shelf
    , bin
    , quantity as quantity_inventory
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productinventory`
)

select *
from source_data
    );
  
[0m21:43:07.565623 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 1cd432f8-5b13-414b-a516-5f3c9bf59d45

[0m21:43:07.566160 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_inventory (execute): 2023-06-27 21:43:06.589686 => 2023-06-27 21:43:07.566080
[0m21:43:07.567313 [debug] [Thread-2 (]: Runtime Error in model stg_product_inventory (models/silver/products/stg_product_inventory.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 1cd432f8-5b13-414b-a516-5f3c9bf59d45
  
[0m21:43:07.567744 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae895aaf50>]}
[0m21:43:07.568262 [error] [Thread-2 (]: 17 of 39 ERROR creating sql table model dev_thaina_silver.stg_product_inventory  [[31mERROR[0m in 0.98s]
[0m21:43:07.568795 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_inventory
[0m21:43:07.569557 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_subcategory
[0m21:43:07.570451 [info ] [Thread-2 (]: 20 of 39 START sql table model dev_thaina_silver.stg_product_subcategory ....... [RUN]
[0m21:43:07.572016 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_subcategory'
[0m21:43:07.572642 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_subcategory
[0m21:43:07.579959 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_subcategory"
[0m21:43:07.581340 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_subcategory (compile): 2023-06-27 21:43:07.573080 => 2023-06-27 21:43:07.581031
[0m21:43:07.582238 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product_subcategory
[0m21:43:07.586988 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_subcategory"
[0m21:43:07.587508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:07.589046 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product_subcategory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_subcategory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productsubcategoryid as subcategory_id
    , productcategoryid as category_id
    , name as subcategory_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productsubcategory`
)

select *
from source_data
    );
  
[0m21:43:07.828686 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_location"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    locationid as location_id
    , name as location_name
    -- Standard hourly cost of the manufacturing location.
    , costrate as cost_rate
    -- Work capacity (in hours) of the manufacturing location.
    , availability 
  from  `desafiothaina`.`dev_thaina`.`location`
)

select *
from source_data
    );
  
[0m21:43:07.829238 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 5d9bf51b-32ef-4012-bd2a-9358a55eacb4

[0m21:43:07.829804 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_location (execute): 2023-06-27 21:43:06.806645 => 2023-06-27 21:43:07.829719
[0m21:43:07.830970 [debug] [Thread-4 (]: Runtime Error in model stg_product_location (models/silver/products/stg_product_location.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 5d9bf51b-32ef-4012-bd2a-9358a55eacb4
  
[0m21:43:07.831403 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8975e020>]}
[0m21:43:07.831901 [error] [Thread-4 (]: 18 of 39 ERROR creating sql table model dev_thaina_silver.stg_product_location . [[31mERROR[0m in 1.03s]
[0m21:43:07.832503 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_location
[0m21:43:07.833018 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m21:43:07.833675 [info ] [Thread-4 (]: 21 of 39 START sql table model dev_thaina_silver.stg_purchase_order_detail ..... [RUN]
[0m21:43:07.834924 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m21:43:07.835321 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m21:43:07.839360 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m21:43:07.840546 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-06-27 21:43:07.835560 => 2023-06-27 21:43:07.840286
[0m21:43:07.841414 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_purchase_order_detail
[0m21:43:07.849321 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_detail"
[0m21:43:07.850261 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:07.852291 [debug] [Thread-4 (]: On model.desafioaethaina.stg_purchase_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , purchaseorderdetailid as purchase_order_detail_id
    , duedate as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m21:43:07.895450 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_model"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productmodelid as model_id
    , name as model_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productmodel`
)

select *
from source_data
    );
  
[0m21:43:07.896017 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 0ce12475-5684-46dd-92a8-6b374197eef4

[0m21:43:07.897193 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_model (execute): 2023-06-27 21:43:06.878721 => 2023-06-27 21:43:07.896749
[0m21:43:07.899225 [debug] [Thread-3 (]: Runtime Error in model stg_product_model (models/silver/products/stg_product_model.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 0ce12475-5684-46dd-92a8-6b374197eef4
  
[0m21:43:07.899772 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8963f250>]}
[0m21:43:07.900441 [error] [Thread-3 (]: 19 of 39 ERROR creating sql table model dev_thaina_silver.stg_product_model .... [[31mERROR[0m in 1.04s]
[0m21:43:07.901090 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_model
[0m21:43:07.902232 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchase_order_header
[0m21:43:07.903269 [info ] [Thread-3 (]: 22 of 39 START sql table model dev_thaina_silver.stg_purchase_order_header ..... [RUN]
[0m21:43:07.904735 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_header'
[0m21:43:07.905224 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchase_order_header
[0m21:43:07.919619 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_header"
[0m21:43:07.922551 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (compile): 2023-06-27 21:43:07.905536 => 2023-06-27 21:43:07.922407
[0m21:43:07.923131 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchase_order_header
[0m21:43:07.930247 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_header"
[0m21:43:07.930905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:07.933028 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchase_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    purchaseorderid as purchase_order_id
    , revisionnumber as revision_number
    , status as status_order
    , employeeid as employee_id
    , vendorid as vendor_id
    , shipmethodid as ship_method_id
    , shipdate as ship_date
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight  
    /* Total due to vendor. Computed as Subtotal + TaxAmt + Freight.
Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0))  */
  from
    `desafiothaina`.`dev_thaina`.`purchaseorderheader`
)

select * 
  from source_data
    );
  
[0m21:43:08.353371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8d7bf307-8651-4fb1-98f2-439172085e23&page=queryresults
[0m21:43:08.653212 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_subcategory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productsubcategoryid as subcategory_id
    , productcategoryid as category_id
    , name as subcategory_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productsubcategory`
)

select *
from source_data
    );
  
[0m21:43:08.653656 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 56b65f85-3d92-4922-b25e-eef80705619f

[0m21:43:08.654098 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_subcategory (execute): 2023-06-27 21:43:07.582600 => 2023-06-27 21:43:08.654012
[0m21:43:08.655323 [debug] [Thread-2 (]: Runtime Error in model stg_product_subcategory (models/silver/products/stg_product_subcategory.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 56b65f85-3d92-4922-b25e-eef80705619f
  
[0m21:43:08.655790 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89665b40>]}
[0m21:43:08.656409 [error] [Thread-2 (]: 20 of 39 ERROR creating sql table model dev_thaina_silver.stg_product_subcategory  [[31mERROR[0m in 1.08s]
[0m21:43:08.657099 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_subcategory
[0m21:43:08.657928 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_purchasing_product_vendor
[0m21:43:08.658853 [info ] [Thread-2 (]: 23 of 39 START sql table model dev_thaina_silver.stg_purchasing_product_vendor . [RUN]
[0m21:43:08.660601 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_product_vendor'
[0m21:43:08.661110 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_purchasing_product_vendor
[0m21:43:08.667053 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m21:43:08.668830 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (compile): 2023-06-27 21:43:08.661431 => 2023-06-27 21:43:08.668679
[0m21:43:08.670138 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_purchasing_product_vendor
[0m21:43:08.675467 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m21:43:08.676102 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:08.678726 [debug] [Thread-2 (]: On model.desafioaethaina.stg_purchasing_product_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_product_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_product_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , productid as product_id
    , standardprice as standard_price
    , minorderqty as min_order_qty
    , maxorderqty as max_order_qty
    , onorderqty as on_order_qty
    , unitmeasurecode as unit_measure_code
  from  `desafiothaina`.`dev_thaina`.`productvendor`
)

select *
from source_data
    );
  
[0m21:43:08.850447 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , purchaseorderdetailid as purchase_order_detail_id
    , duedate as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m21:43:08.850936 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 5469be2c-46e8-4376-a259-7e02707c3fc5

[0m21:43:08.851506 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (execute): 2023-06-27 21:43:07.841917 => 2023-06-27 21:43:08.851414
[0m21:43:08.852901 [debug] [Thread-4 (]: Runtime Error in model stg_purchase_order_detail (models/silver/purchasing/stg_purchase_order_detail.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 5469be2c-46e8-4376-a259-7e02707c3fc5
  
[0m21:43:08.853383 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8a425cf0>]}
[0m21:43:08.853931 [error] [Thread-4 (]: 21 of 39 ERROR creating sql table model dev_thaina_silver.stg_purchase_order_detail  [[31mERROR[0m in 1.02s]
[0m21:43:08.854516 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m21:43:08.855184 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchasing_ship_method
[0m21:43:08.855860 [info ] [Thread-4 (]: 24 of 39 START sql table model dev_thaina_silver.stg_purchasing_ship_method .... [RUN]
[0m21:43:08.856996 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_ship_method'
[0m21:43:08.857488 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchasing_ship_method
[0m21:43:08.862110 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m21:43:08.862936 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (compile): 2023-06-27 21:43:08.857733 => 2023-06-27 21:43:08.862797
[0m21:43:08.863451 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_purchasing_ship_method
[0m21:43:08.869665 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m21:43:08.870263 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:08.871839 [debug] [Thread-4 (]: On model.desafioaethaina.stg_purchasing_ship_method: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_ship_method"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
    );
  
[0m21:43:08.999155 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    purchaseorderid as purchase_order_id
    , revisionnumber as revision_number
    , status as status_order
    , employeeid as employee_id
    , vendorid as vendor_id
    , shipmethodid as ship_method_id
    , shipdate as ship_date
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight  
    /* Total due to vendor. Computed as Subtotal + TaxAmt + Freight.
Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0))  */
  from
    `desafiothaina`.`dev_thaina`.`purchaseorderheader`
)

select * 
  from source_data
    );
  
[0m21:43:08.999532 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: fdc494eb-02ad-4408-93bc-6fe9eff3c90d

[0m21:43:08.999964 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (execute): 2023-06-27 21:43:07.923496 => 2023-06-27 21:43:08.999889
[0m21:43:09.001014 [debug] [Thread-3 (]: Runtime Error in model stg_purchase_order_header (models/silver/purchasing/stg_purchase_order_header.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: fdc494eb-02ad-4408-93bc-6fe9eff3c90d
  
[0m21:43:09.001464 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89664370>]}
[0m21:43:09.001968 [error] [Thread-3 (]: 22 of 39 ERROR creating sql table model dev_thaina_silver.stg_purchase_order_header  [[31mERROR[0m in 1.10s]
[0m21:43:09.002602 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchase_order_header
[0m21:43:09.003414 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchasing_vendor
[0m21:43:09.004311 [info ] [Thread-3 (]: 25 of 39 START sql table model dev_thaina_silver.stg_purchasing_vendor ......... [RUN]
[0m21:43:09.005895 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_vendor'
[0m21:43:09.006541 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchasing_vendor
[0m21:43:09.023121 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_vendor"
[0m21:43:09.028796 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (compile): 2023-06-27 21:43:09.006962 => 2023-06-27 21:43:09.028018
[0m21:43:09.029847 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchasing_vendor
[0m21:43:09.035352 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_vendor"
[0m21:43:09.036263 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:09.038251 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchasing_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , accountnumber as account_number
    , name as company_name
    -- 1 = Superior, 2 = Excellent, 3 = Above average, 4 = Average, 5 = Below
    , creditrating as credit_rate
    , activeflag as active_flag
  from  `desafiothaina`.`dev_thaina`.`vendor`
)

select *
from source_data
    );
  
[0m21:43:09.262024 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-06-27 21:43:03.192844 => 2023-06-27 21:43:09.261955
[0m21:43:09.262846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89686b90>]}
[0m21:43:09.263365 [info ] [Thread-1 (]: 1 of 39 OK created sql table model dev_thaina_gold.dim_dates ................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 8.46s]
[0m21:43:09.264034 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m21:43:09.265099 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_country_region_currency
[0m21:43:09.266154 [info ] [Thread-1 (]: 26 of 39 START sql table model dev_thaina_silver.stg_sales_country_region_currency  [RUN]
[0m21:43:09.267904 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_country_region_currency'
[0m21:43:09.268631 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_country_region_currency
[0m21:43:09.277145 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m21:43:09.278194 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (compile): 2023-06-27 21:43:09.269104 => 2023-06-27 21:43:09.278050
[0m21:43:09.278800 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_country_region_currency
[0m21:43:09.287308 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m21:43:09.288514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:09.296502 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_country_region_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_country_region_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_country_region_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
      countryregioncode as country_region_code
      , currencycode as currency_code
    from `desafiothaina`.`dev_thaina`.`countryregioncurrency`
  )
select  *
from source_data
    );
  
[0m21:43:09.724777 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_product_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_product_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , productid as product_id
    , standardprice as standard_price
    , minorderqty as min_order_qty
    , maxorderqty as max_order_qty
    , onorderqty as on_order_qty
    , unitmeasurecode as unit_measure_code
  from  `desafiothaina`.`dev_thaina`.`productvendor`
)

select *
from source_data
    );
  
[0m21:43:09.725158 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 2e7adc26-3e6f-4d7f-a33a-50b97444b79c

[0m21:43:09.725629 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (execute): 2023-06-27 21:43:08.671069 => 2023-06-27 21:43:09.725555
[0m21:43:09.726864 [debug] [Thread-2 (]: Runtime Error in model stg_purchasing_product_vendor (models/silver/purchasing/stg_purchasing_product_vendor.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 2e7adc26-3e6f-4d7f-a33a-50b97444b79c
  
[0m21:43:09.727333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89665b40>]}
[0m21:43:09.727842 [error] [Thread-2 (]: 23 of 39 ERROR creating sql table model dev_thaina_silver.stg_purchasing_product_vendor  [[31mERROR[0m in 1.07s]
[0m21:43:09.728367 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_purchasing_product_vendor
[0m21:43:09.729072 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_currency
[0m21:43:09.729776 [info ] [Thread-2 (]: 27 of 39 START sql table model dev_thaina_silver.stg_sales_currency ............ [RUN]
[0m21:43:09.731064 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency'
[0m21:43:09.731486 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_currency
[0m21:43:09.735183 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency"
[0m21:43:09.735861 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_currency (compile): 2023-06-27 21:43:09.731716 => 2023-06-27 21:43:09.735763
[0m21:43:09.736498 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_currency
[0m21:43:09.744580 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency"
[0m21:43:09.745725 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:09.749459 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    currencycode as currency_code
    , name as currency_name
  from  `desafiothaina`.`dev_thaina`.`currency`
)

select *
from source_data
    );
  
[0m21:43:09.901505 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_ship_method"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
    );
  
[0m21:43:09.902438 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: bfef9122-1fcd-4cb6-9e0b-75db6b24db13

[0m21:43:09.903101 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (execute): 2023-06-27 21:43:08.863722 => 2023-06-27 21:43:09.902989
[0m21:43:09.904653 [debug] [Thread-4 (]: Runtime Error in model stg_purchasing_ship_method (models/silver/purchasing/stg_purchasing_ship_method.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: bfef9122-1fcd-4cb6-9e0b-75db6b24db13
  
[0m21:43:09.905108 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae897493f0>]}
[0m21:43:10.006993 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , accountnumber as account_number
    , name as company_name
    -- 1 = Superior, 2 = Excellent, 3 = Above average, 4 = Average, 5 = Below
    , creditrating as credit_rate
    , activeflag as active_flag
  from  `desafiothaina`.`dev_thaina`.`vendor`
)

select *
from source_data
    );
  
[0m21:43:10.007403 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 99d579ee-c59a-4664-b0b7-05712f259781

[0m21:43:10.007903 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (execute): 2023-06-27 21:43:09.030270 => 2023-06-27 21:43:10.007823
[0m21:43:10.008947 [debug] [Thread-3 (]: Runtime Error in model stg_purchasing_vendor (models/silver/purchasing/stg_purchasing_vendor.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 99d579ee-c59a-4664-b0b7-05712f259781
  
[0m21:43:10.009369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89694880>]}
[0m21:43:10.300686 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_country_region_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_country_region_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
      countryregioncode as country_region_code
      , currencycode as currency_code
    from `desafiothaina`.`dev_thaina`.`countryregioncurrency`
  )
select  *
from source_data
    );
  
[0m21:43:10.301226 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 86ca5005-abe1-4b35-b66d-70c97a87e96f

[0m21:43:10.301955 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (execute): 2023-06-27 21:43:09.279225 => 2023-06-27 21:43:10.301853
[0m21:43:10.303614 [debug] [Thread-1 (]: Runtime Error in model stg_sales_country_region_currency (models/silver/sales/stg_sales_country_region_currency.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 86ca5005-abe1-4b35-b66d-70c97a87e96f
  
[0m21:43:10.304224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89684040>]}
[0m21:43:10.719194 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    currencycode as currency_code
    , name as currency_name
  from  `desafiothaina`.`dev_thaina`.`currency`
)

select *
from source_data
    );
  
[0m21:43:10.719597 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 76532992-642a-4066-a212-2a1ae7d9ef54

[0m21:43:10.720083 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_currency (execute): 2023-06-27 21:43:09.736978 => 2023-06-27 21:43:10.720003
[0m21:43:10.721212 [debug] [Thread-2 (]: Runtime Error in model stg_sales_currency (models/silver/sales/stg_sales_currency.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 76532992-642a-4066-a212-2a1ae7d9ef54
  
[0m21:43:10.721675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae88510d00>]}
[0m21:43:11.059481 [error] [Thread-4 (]: 24 of 39 ERROR creating sql table model dev_thaina_silver.stg_purchasing_ship_method  [[31mERROR[0m in 1.05s]
[0m21:43:11.060558 [error] [Thread-3 (]: 25 of 39 ERROR creating sql table model dev_thaina_silver.stg_purchasing_vendor  [[31mERROR[0m in 1.00s]
[0m21:43:11.062155 [error] [Thread-1 (]: 26 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_country_region_currency  [[31mERROR[0m in 1.04s]
[0m21:43:11.063244 [error] [Thread-2 (]: 27 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_currency ... [[31mERROR[0m in 0.99s]
[0m21:43:11.064214 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchasing_ship_method
[0m21:43:11.064884 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchasing_vendor
[0m21:43:11.065462 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_country_region_currency
[0m21:43:11.068641 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_order_detail
[0m21:43:11.065908 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_currency
[0m21:43:11.067612 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_customer
[0m21:43:11.066647 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_currency_rate
[0m21:43:11.069623 [info ] [Thread-1 (]: 30 of 39 START sql table model dev_thaina_silver.stg_sales_order_detail ........ [RUN]
[0m21:43:11.071783 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m21:43:11.073536 [info ] [Thread-3 (]: 29 of 39 START sql table model dev_thaina_silver.stg_sales_customer ............ [RUN]
[0m21:43:11.075723 [info ] [Thread-4 (]: 28 of 39 START sql table model dev_thaina_silver.stg_sales_currency_rate ....... [RUN]
[0m21:43:11.077236 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_detail'
[0m21:43:11.081458 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_customer'
[0m21:43:11.084373 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_customer
[0m21:43:11.078195 [info ] [Thread-2 (]: 31 of 39 START sql table model dev_thaina_silver.stg_sales_order_header ........ [RUN]
[0m21:43:11.083934 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_order_detail
[0m21:43:11.083295 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency_rate'
[0m21:43:11.100773 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m21:43:11.102901 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_customer"
[0m21:43:11.107089 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_detail"
[0m21:43:11.107606 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_currency_rate
[0m21:43:11.107962 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m21:43:11.116097 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency_rate"
[0m21:43:11.116537 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_customer (compile): 2023-06-27 21:43:11.084780 => 2023-06-27 21:43:11.116410
[0m21:43:11.116993 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (compile): 2023-06-27 21:43:11.103441 => 2023-06-27 21:43:11.116905
[0m21:43:11.121610 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m21:43:11.122320 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_customer
[0m21:43:11.122757 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_order_detail
[0m21:43:11.123001 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (compile): 2023-06-27 21:43:11.108721 => 2023-06-27 21:43:11.122933
[0m21:43:11.127051 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_customer"
[0m21:43:11.127587 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-06-27 21:43:11.117183 => 2023-06-27 21:43:11.127482
[0m21:43:11.134185 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_detail"
[0m21:43:11.134871 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_currency_rate
[0m21:43:11.135949 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m21:43:11.136535 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:11.140656 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency_rate"
[0m21:43:11.141119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:11.146995 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m21:43:11.149795 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
    );
  
[0m21:43:11.150565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:11.186532 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
    );
  
[0m21:43:11.187242 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:11.189277 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      currencyrateid as currency_rate_id
      , currencyratedate as currency_rate_date
      , fromcurrencycode as from_currency_code
      , tocurrencycode as to_currency_code
      , averagerate as avg_rate
      , endofdayrate as end_of_day_rate
    from `desafiothaina`.`dev_thaina`.`currencyrate`
  )
select  *
from source_data
    );
  
[0m21:43:11.223872 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , orderdate as order_date
    , duedate as due_date
    , shipdate as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m21:43:12.247507 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
    );
  
[0m21:43:12.247947 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 1a575aee-f8e2-4d06-938c-e148cb5f5af3

[0m21:43:12.248598 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_customer (execute): 2023-06-27 21:43:11.123406 => 2023-06-27 21:43:12.248514
[0m21:43:12.249752 [debug] [Thread-3 (]: Runtime Error in model stg_sales_customer (models/silver/sales/stg_sales_customer.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 1a575aee-f8e2-4d06-938c-e148cb5f5af3
  
[0m21:43:12.250185 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89acf1c0>]}
[0m21:43:12.250711 [error] [Thread-3 (]: 29 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_customer ... [[31mERROR[0m in 1.17s]
[0m21:43:12.251382 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_customer
[0m21:43:12.252038 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_order_header_reason
[0m21:43:12.252974 [info ] [Thread-3 (]: 32 of 39 START sql table model dev_thaina_silver.stg_sales_order_header_reason . [RUN]
[0m21:43:12.254767 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header_reason'
[0m21:43:12.255426 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_order_header_reason
[0m21:43:12.262994 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m21:43:12.264358 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (compile): 2023-06-27 21:43:12.255827 => 2023-06-27 21:43:12.264081
[0m21:43:12.265266 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_order_header_reason
[0m21:43:12.270263 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m21:43:12.270811 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:12.273069 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_order_header_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
    );
  
[0m21:43:12.408096 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
    );
  
[0m21:43:12.408472 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: ad60ef2c-88e7-4fb9-a63d-d193ff556694

[0m21:43:12.408917 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (execute): 2023-06-27 21:43:11.127877 => 2023-06-27 21:43:12.408844
[0m21:43:12.410001 [debug] [Thread-1 (]: Runtime Error in model stg_sales_order_detail (models/silver/sales/stg_sales_order_detail.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: ad60ef2c-88e7-4fb9-a63d-d193ff556694
  
[0m21:43:12.410487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae885103d0>]}
[0m21:43:12.411017 [error] [Thread-1 (]: 30 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_order_detail  [[31mERROR[0m in 1.33s]
[0m21:43:12.411586 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_order_detail
[0m21:43:12.412224 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_person
[0m21:43:12.413108 [info ] [Thread-1 (]: 33 of 39 START sql table model dev_thaina_silver.stg_sales_person .............. [RUN]
[0m21:43:12.414802 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person'
[0m21:43:12.415476 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_person
[0m21:43:12.423738 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person"
[0m21:43:12.425339 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_person (compile): 2023-06-27 21:43:12.415924 => 2023-06-27 21:43:12.424995
[0m21:43:12.426336 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_person
[0m21:43:12.431601 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person"
[0m21:43:12.432393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:12.435084 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , territoryid as territory_id
      , salesquota as sales_quota
      , bonus
      , commissionpct as commission_pct
      , salesytd as sales_total
      , saleslastyear as sales_last_year
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salesperson`
  )

select  *
from source_data
    );
  
[0m21:43:12.473760 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      currencyrateid as currency_rate_id
      , currencyratedate as currency_rate_date
      , fromcurrencycode as from_currency_code
      , tocurrencycode as to_currency_code
      , averagerate as avg_rate
      , endofdayrate as end_of_day_rate
    from `desafiothaina`.`dev_thaina`.`currencyrate`
  )
select  *
from source_data
    );
  
[0m21:43:12.474338 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: bda2d588-d5af-45cd-ba47-5a684baeccb5

[0m21:43:12.474781 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (execute): 2023-06-27 21:43:11.136851 => 2023-06-27 21:43:12.474711
[0m21:43:12.475794 [debug] [Thread-4 (]: Runtime Error in model stg_sales_currency_rate (models/silver/sales/stg_sales_currency_rate.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: bda2d588-d5af-45cd-ba47-5a684baeccb5
  
[0m21:43:12.476175 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae88510c40>]}
[0m21:43:12.476640 [error] [Thread-4 (]: 28 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_currency_rate  [[31mERROR[0m in 1.39s]
[0m21:43:12.477127 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_currency_rate
[0m21:43:12.477942 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_person_quota_history
[0m21:43:12.478568 [info ] [Thread-4 (]: 34 of 39 START sql table model dev_thaina_silver.stg_sales_person_quota_history  [RUN]
[0m21:43:12.479656 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person_quota_history'
[0m21:43:12.480042 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_person_quota_history
[0m21:43:12.484390 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m21:43:12.485216 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (compile): 2023-06-27 21:43:12.480252 => 2023-06-27 21:43:12.485100
[0m21:43:12.485869 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_person_quota_history
[0m21:43:12.569563 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , orderdate as order_date
    , duedate as due_date
    , shipdate as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m21:43:12.572397 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 5068fa13-1ec4-4b8e-a2a8-1ec19e2b296d

[0m21:43:12.574740 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-06-27 21:43:11.141401 => 2023-06-27 21:43:12.574640
[0m21:43:12.592116 [debug] [Thread-2 (]: Runtime Error in model stg_sales_order_header (models/silver/sales/stg_sales_order_header.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 5068fa13-1ec4-4b8e-a2a8-1ec19e2b296d
  
[0m21:43:12.595350 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8975c880>]}
[0m21:43:12.597689 [error] [Thread-2 (]: 31 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_order_header  [[31mERROR[0m in 1.49s]
[0m21:43:12.601378 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m21:43:12.605726 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_reason
[0m21:43:12.606852 [info ] [Thread-2 (]: 35 of 39 START sql table model dev_thaina_silver.stg_sales_reason .............. [RUN]
[0m21:43:12.609795 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_reason'
[0m21:43:12.611382 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_reason
[0m21:43:12.648875 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_reason"
[0m21:43:12.664768 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m21:43:12.665812 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_reason (compile): 2023-06-27 21:43:12.625687 => 2023-06-27 21:43:12.665697
[0m21:43:12.666281 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_reason
[0m21:43:12.666676 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:12.673257 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_reason"
[0m21:43:12.676911 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_person_quota_history: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person_quota_history"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person_quota_history`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , quotadate as quota_date
      , salesquota as sales_quota
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salespersonquotahistory`
  )

select  *
from source_data
    );
  
[0m21:43:12.713903 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:12.715947 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salesreasonid as sales_reason_id
      , name as name_reason
      , reasontype as reason_type
    from `desafiothaina`.`dev_thaina`.`salesreason`
  )

select  *
from source_data
    );
  
[0m21:43:13.357527 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
    );
  
[0m21:43:13.357978 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 130a8dbb-3905-4286-bfc4-0cb4b76adb39

[0m21:43:13.358558 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (execute): 2023-06-27 21:43:12.265578 => 2023-06-27 21:43:13.358462
[0m21:43:13.359661 [debug] [Thread-3 (]: Runtime Error in model stg_sales_order_header_reason (models/silver/sales/stg_sales_order_header_reason.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 130a8dbb-3905-4286-bfc4-0cb4b76adb39
  
[0m21:43:13.360079 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae88500460>]}
[0m21:43:13.360582 [error] [Thread-3 (]: 32 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_order_header_reason  [[31mERROR[0m in 1.11s]
[0m21:43:13.361223 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_order_header_reason
[0m21:43:13.361895 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_tax_rate
[0m21:43:13.362603 [info ] [Thread-3 (]: 36 of 39 START sql table model dev_thaina_silver.stg_sales_tax_rate ............ [RUN]
[0m21:43:13.364155 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_tax_rate'
[0m21:43:13.364686 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_tax_rate
[0m21:43:13.369535 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_tax_rate"
[0m21:43:13.370498 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (compile): 2023-06-27 21:43:13.364942 => 2023-06-27 21:43:13.370214
[0m21:43:13.371471 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_tax_rate
[0m21:43:13.377185 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_tax_rate"
[0m21:43:13.377776 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:13.379349 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_tax_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_tax_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_tax_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salestaxrateid as sales_tax_rate_id
      , stateprovinceid as state_province_id
      , taxtype as tax_type
      , taxrate as tax_rate
      , name as name_tax_rate_desciption
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salestaxrate`
  )

select  *
from source_data
    );
  
[0m21:43:13.504854 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , territoryid as territory_id
      , salesquota as sales_quota
      , bonus
      , commissionpct as commission_pct
      , salesytd as sales_total
      , saleslastyear as sales_last_year
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salesperson`
  )

select  *
from source_data
    );
  
[0m21:43:13.505276 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: a9db31e9-7ecb-4b67-8b75-030d4cda2d72

[0m21:43:13.505792 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_person (execute): 2023-06-27 21:43:12.427085 => 2023-06-27 21:43:13.505709
[0m21:43:13.507045 [debug] [Thread-1 (]: Runtime Error in model stg_sales_person (models/silver/sales/stg_sales_person.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: a9db31e9-7ecb-4b67-8b75-030d4cda2d72
  
[0m21:43:13.507515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae885006d0>]}
[0m21:43:13.508060 [error] [Thread-1 (]: 33 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_person ..... [[31mERROR[0m in 1.09s]
[0m21:43:13.508884 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_person
[0m21:43:13.509888 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_territory
[0m21:43:13.510939 [info ] [Thread-1 (]: 37 of 39 START sql table model dev_thaina_silver.stg_sales_territory ........... [RUN]
[0m21:43:13.512466 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_territory'
[0m21:43:13.513474 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_territory
[0m21:43:13.521565 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_territory"
[0m21:43:13.523806 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_territory (compile): 2023-06-27 21:43:13.513981 => 2023-06-27 21:43:13.523584
[0m21:43:13.525291 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_territory
[0m21:43:13.533202 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_territory"
[0m21:43:13.534751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:13.538426 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_territory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_territory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
    );
  
[0m21:43:13.766368 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salesreasonid as sales_reason_id
      , name as name_reason
      , reasontype as reason_type
    from `desafiothaina`.`dev_thaina`.`salesreason`
  )

select  *
from source_data
    );
  
[0m21:43:13.766790 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: e281ef32-4e4e-4159-8ce2-7544663e67e2

[0m21:43:13.767283 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_reason (execute): 2023-06-27 21:43:12.667088 => 2023-06-27 21:43:13.767204
[0m21:43:13.768405 [debug] [Thread-2 (]: Runtime Error in model stg_sales_reason (models/silver/sales/stg_sales_reason.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: e281ef32-4e4e-4159-8ce2-7544663e67e2
  
[0m21:43:13.768850 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae88418d90>]}
[0m21:43:13.769359 [error] [Thread-2 (]: 35 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_reason ..... [[31mERROR[0m in 1.16s]
[0m21:43:13.769885 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_reason
[0m21:43:13.770625 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_customer
[0m21:43:13.771449 [info ] [Thread-2 (]: 38 of 39 SKIP relation dev_thaina_gold.dim_customer ............................ [[33mSKIP[0m]
[0m21:43:13.772536 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_customer
[0m21:43:13.776544 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_product
[0m21:43:13.777331 [info ] [Thread-2 (]: 39 of 39 SKIP relation dev_thaina_intermediate.int_product ..................... [[33mSKIP[0m]
[0m21:43:13.779014 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_product
[0m21:43:13.796158 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person_quota_history"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person_quota_history`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , quotadate as quota_date
      , salesquota as sales_quota
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salespersonquotahistory`
  )

select  *
from source_data
    );
  
[0m21:43:13.796637 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 92cc3107-1fff-4fa7-9619-8ca0c81caf8a

[0m21:43:13.797182 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (execute): 2023-06-27 21:43:12.486609 => 2023-06-27 21:43:13.797091
[0m21:43:13.798603 [debug] [Thread-4 (]: Runtime Error in model stg_sales_person_quota_history (models/silver/sales/stg_sales_person_quota_history.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 92cc3107-1fff-4fa7-9619-8ca0c81caf8a
  
[0m21:43:13.799207 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae88503fa0>]}
[0m21:43:13.799754 [error] [Thread-4 (]: 34 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_person_quota_history  [[31mERROR[0m in 1.32s]
[0m21:43:13.800330 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_person_quota_history
[0m21:43:14.508105 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_tax_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_tax_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salestaxrateid as sales_tax_rate_id
      , stateprovinceid as state_province_id
      , taxtype as tax_type
      , taxrate as tax_rate
      , name as name_tax_rate_desciption
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salestaxrate`
  )

select  *
from source_data
    );
  
[0m21:43:14.510207 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: d409582d-1ef3-49c6-b4e3-39101ddd414c

[0m21:43:14.511745 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_territory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
    );
  
[0m21:43:14.512577 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (execute): 2023-06-27 21:43:13.371877 => 2023-06-27 21:43:14.512433
[0m21:43:14.513182 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset desafiothaina:dev_thaina was not found in location US

Location: US
Job ID: 27747bc4-eaa1-4fe7-adf5-65464db83d49

[0m21:43:14.515266 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_territory (execute): 2023-06-27 21:43:13.526086 => 2023-06-27 21:43:14.515134
[0m21:43:14.516929 [debug] [Thread-3 (]: Runtime Error in model stg_sales_tax_rate (models/silver/sales/stg_sales_tax_rate.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: d409582d-1ef3-49c6-b4e3-39101ddd414c
  
[0m21:43:14.517565 [debug] [Thread-1 (]: Runtime Error in model stg_sales_territory (models/silver/sales/stg_sales_territory.sql)
  404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
  
  Location: US
  Job ID: 27747bc4-eaa1-4fe7-adf5-65464db83d49
  
[0m21:43:14.517903 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8975e0e0>]}
[0m21:43:14.518273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb831fd-1ba0-448e-9661-ee73978ef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8975fc70>]}
[0m21:43:14.518769 [error] [Thread-3 (]: 36 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_tax_rate ... [[31mERROR[0m in 1.15s]
[0m21:43:14.519494 [error] [Thread-1 (]: 37 of 39 ERROR creating sql table model dev_thaina_silver.stg_sales_territory .. [[31mERROR[0m in 1.01s]
[0m21:43:14.520299 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_tax_rate
[0m21:43:14.520765 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_territory
[0m21:43:14.522769 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:43:14.523650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:14.523972 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_territory' was properly closed.
[0m21:43:14.524245 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_tax_rate' was properly closed.
[0m21:43:14.524555 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_person_quota_history' was properly closed.
[0m21:43:14.524821 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_reason' was properly closed.
[0m21:43:14.525271 [info ] [MainThread]: 
[0m21:43:14.525774 [info ] [MainThread]: Finished running 39 table models in 0 hours 0 minutes and 19.60 seconds (19.60s).
[0m21:43:14.528288 [debug] [MainThread]: Command end result
[0m21:43:14.552332 [info ] [MainThread]: 
[0m21:43:14.553202 [info ] [MainThread]: [31mCompleted with 36 errors and 0 warnings:[0m
[0m21:43:14.554128 [info ] [MainThread]: 
[0m21:43:14.555064 [error] [MainThread]: [33mRuntime Error in model int_address (models/intermediate/int_address.sql)[0m
[0m21:43:14.556320 [error] [MainThread]:   404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_address was not found in location US
[0m21:43:14.557645 [error] [MainThread]:   
[0m21:43:14.558507 [error] [MainThread]:   Location: US
[0m21:43:14.559346 [error] [MainThread]:   Job ID: 89b949f4-71e4-44d2-b98b-fe1c20eab9e1
[0m21:43:14.560169 [error] [MainThread]:   
[0m21:43:14.560943 [info ] [MainThread]: 
[0m21:43:14.561717 [error] [MainThread]: [33mRuntime Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)[0m
[0m21:43:14.562543 [error] [MainThread]:   404 Not found: Table desafiothaina:dev_thaina_intermediate.int_sales was not found in location US
[0m21:43:14.563331 [error] [MainThread]:   
[0m21:43:14.564374 [error] [MainThread]:   Location: US
[0m21:43:14.565330 [error] [MainThread]:   Job ID: b417ceb1-1518-4be7-a081-c6d968d1583d
[0m21:43:14.566451 [error] [MainThread]:   
[0m21:43:14.567507 [info ] [MainThread]: 
[0m21:43:14.568846 [error] [MainThread]: [33mRuntime Error in model int_customer (models/intermediate/int_customer.sql)[0m
[0m21:43:14.569696 [error] [MainThread]:   404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_country_region was not found in location US
[0m21:43:14.570457 [error] [MainThread]:   
[0m21:43:14.571204 [error] [MainThread]:   Location: US
[0m21:43:14.571968 [error] [MainThread]:   Job ID: 435dc787-617e-4e47-889e-68a72c7b2455
[0m21:43:14.572736 [error] [MainThread]:   
[0m21:43:14.573544 [info ] [MainThread]: 
[0m21:43:14.574404 [error] [MainThread]: [33mRuntime Error in model int_sales (models/intermediate/int_sales.sql)[0m
[0m21:43:14.575190 [error] [MainThread]:   404 Not found: Table desafiothaina:dev_thaina_silver.stg_sales_order_detail was not found in location US
[0m21:43:14.575966 [error] [MainThread]:   
[0m21:43:14.576716 [error] [MainThread]:   Location: US
[0m21:43:14.577492 [error] [MainThread]:   Job ID: 9ab4744a-14ed-48ef-95a8-33da116bbae9
[0m21:43:14.578305 [error] [MainThread]:   
[0m21:43:14.579126 [info ] [MainThread]: 
[0m21:43:14.579965 [error] [MainThread]: [33mRuntime Error in model stg_person_address (models/silver/person/stg_person_address.sql)[0m
[0m21:43:14.580818 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.582207 [error] [MainThread]:   
[0m21:43:14.583171 [error] [MainThread]:   Location: US
[0m21:43:14.583978 [error] [MainThread]:   Job ID: a7d9709b-80c3-4da0-a966-6d58c733c085
[0m21:43:14.584769 [error] [MainThread]:   
[0m21:43:14.585551 [info ] [MainThread]: 
[0m21:43:14.586368 [error] [MainThread]: [33mRuntime Error in model stg_person_address_type (models/silver/person/stg_person_address_type.sql)[0m
[0m21:43:14.587167 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.587982 [error] [MainThread]:   
[0m21:43:14.588716 [error] [MainThread]:   Location: US
[0m21:43:14.589432 [error] [MainThread]:   Job ID: 1c3be0ee-98fd-4c71-94aa-58dab61127e8
[0m21:43:14.590155 [error] [MainThread]:   
[0m21:43:14.591291 [info ] [MainThread]: 
[0m21:43:14.592106 [error] [MainThread]: [33mRuntime Error in model stg_person_business_entity_address (models/silver/person/stg_person_business_entity_address.sql)[0m
[0m21:43:14.592917 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.593752 [error] [MainThread]:   
[0m21:43:14.594535 [error] [MainThread]:   Location: US
[0m21:43:14.595425 [error] [MainThread]:   Job ID: a532f3f0-0f5b-4e76-ae11-5937ad13738d
[0m21:43:14.596389 [error] [MainThread]:   
[0m21:43:14.597156 [info ] [MainThread]: 
[0m21:43:14.598179 [error] [MainThread]: [33mRuntime Error in model stg_person_business_entity_contact (models/silver/person/stg_person_business_entity_contact.sql)[0m
[0m21:43:14.599468 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.600387 [error] [MainThread]:   
[0m21:43:14.601621 [error] [MainThread]:   Location: US
[0m21:43:14.602809 [error] [MainThread]:   Job ID: 8d8f0790-61df-4c45-a1fc-1f2c68a55094
[0m21:43:14.603784 [error] [MainThread]:   
[0m21:43:14.604536 [info ] [MainThread]: 
[0m21:43:14.605280 [error] [MainThread]: [33mRuntime Error in model stg_person_contact_type (models/silver/person/stg_person_contact_type.sql)[0m
[0m21:43:14.606022 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.606740 [error] [MainThread]:   
[0m21:43:14.607549 [error] [MainThread]:   Location: US
[0m21:43:14.608314 [error] [MainThread]:   Job ID: 229929d5-a267-45fc-8797-ddad7d38cc0d
[0m21:43:14.609081 [error] [MainThread]:   
[0m21:43:14.610062 [info ] [MainThread]: 
[0m21:43:14.610921 [error] [MainThread]: [33mRuntime Error in model stg_person_country_region (models/silver/person/stg_person_country_region.sql)[0m
[0m21:43:14.611723 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.612472 [error] [MainThread]:   
[0m21:43:14.613375 [error] [MainThread]:   Location: US
[0m21:43:14.614513 [error] [MainThread]:   Job ID: 33c75b27-9bbf-441a-aa89-a25390519a75
[0m21:43:14.615454 [error] [MainThread]:   
[0m21:43:14.616401 [info ] [MainThread]: 
[0m21:43:14.617364 [error] [MainThread]: [33mRuntime Error in model stg_person_person (models/silver/person/stg_person_person.sql)[0m
[0m21:43:14.618747 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.620084 [error] [MainThread]:   
[0m21:43:14.621293 [error] [MainThread]:   Location: US
[0m21:43:14.622663 [error] [MainThread]:   Job ID: 04c1d532-6590-4b8b-afc2-f6e4d86d3036
[0m21:43:14.623628 [error] [MainThread]:   
[0m21:43:14.624467 [info ] [MainThread]: 
[0m21:43:14.625574 [error] [MainThread]: [33mRuntime Error in model stg_person_state_province (models/silver/person/stg_person_state_province.sql)[0m
[0m21:43:14.626791 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.627571 [error] [MainThread]:   
[0m21:43:14.628454 [error] [MainThread]:   Location: US
[0m21:43:14.629193 [error] [MainThread]:   Job ID: b3d48ab6-57b2-4856-9a1b-8523a2f6bdbc
[0m21:43:14.630013 [error] [MainThread]:   
[0m21:43:14.631123 [info ] [MainThread]: 
[0m21:43:14.632585 [error] [MainThread]: [33mRuntime Error in model stg_product (models/silver/products/stg_product.sql)[0m
[0m21:43:14.633847 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.635181 [error] [MainThread]:   
[0m21:43:14.636039 [error] [MainThread]:   Location: US
[0m21:43:14.637060 [error] [MainThread]:   Job ID: a9fe3047-8447-41ca-8ba9-679dff5b4ce8
[0m21:43:14.638080 [error] [MainThread]:   
[0m21:43:14.639224 [info ] [MainThread]: 
[0m21:43:14.640482 [error] [MainThread]: [33mRuntime Error in model stg_product_category (models/silver/products/stg_product_category.sql)[0m
[0m21:43:14.641635 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.642584 [error] [MainThread]:   
[0m21:43:14.643343 [error] [MainThread]:   Location: US
[0m21:43:14.644086 [error] [MainThread]:   Job ID: 87fd3ac6-21ea-446b-9419-6da4792b2fb3
[0m21:43:14.644830 [error] [MainThread]:   
[0m21:43:14.645678 [info ] [MainThread]: 
[0m21:43:14.646671 [error] [MainThread]: [33mRuntime Error in model stg_product_description (models/silver/products/stg_product_description.sql)[0m
[0m21:43:14.647845 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.649152 [error] [MainThread]:   
[0m21:43:14.650570 [error] [MainThread]:   Location: US
[0m21:43:14.651766 [error] [MainThread]:   Job ID: ebbd9f95-ee97-4d0c-967c-6b5821c272c9
[0m21:43:14.652588 [error] [MainThread]:   
[0m21:43:14.653425 [info ] [MainThread]: 
[0m21:43:14.654330 [error] [MainThread]: [33mRuntime Error in model stg_product_inventory (models/silver/products/stg_product_inventory.sql)[0m
[0m21:43:14.655403 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.656772 [error] [MainThread]:   
[0m21:43:14.657752 [error] [MainThread]:   Location: US
[0m21:43:14.658510 [error] [MainThread]:   Job ID: 1cd432f8-5b13-414b-a516-5f3c9bf59d45
[0m21:43:14.659267 [error] [MainThread]:   
[0m21:43:14.660011 [info ] [MainThread]: 
[0m21:43:14.660782 [error] [MainThread]: [33mRuntime Error in model stg_product_location (models/silver/products/stg_product_location.sql)[0m
[0m21:43:14.661514 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.662163 [error] [MainThread]:   
[0m21:43:14.662984 [error] [MainThread]:   Location: US
[0m21:43:14.664101 [error] [MainThread]:   Job ID: 5d9bf51b-32ef-4012-bd2a-9358a55eacb4
[0m21:43:14.665560 [error] [MainThread]:   
[0m21:43:14.666898 [info ] [MainThread]: 
[0m21:43:14.668322 [error] [MainThread]: [33mRuntime Error in model stg_product_model (models/silver/products/stg_product_model.sql)[0m
[0m21:43:14.669240 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.670252 [error] [MainThread]:   
[0m21:43:14.671528 [error] [MainThread]:   Location: US
[0m21:43:14.672376 [error] [MainThread]:   Job ID: 0ce12475-5684-46dd-92a8-6b374197eef4
[0m21:43:14.673122 [error] [MainThread]:   
[0m21:43:14.673940 [info ] [MainThread]: 
[0m21:43:14.674716 [error] [MainThread]: [33mRuntime Error in model stg_product_subcategory (models/silver/products/stg_product_subcategory.sql)[0m
[0m21:43:14.675709 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.676439 [error] [MainThread]:   
[0m21:43:14.677153 [error] [MainThread]:   Location: US
[0m21:43:14.677910 [error] [MainThread]:   Job ID: 56b65f85-3d92-4922-b25e-eef80705619f
[0m21:43:14.678742 [error] [MainThread]:   
[0m21:43:14.679628 [info ] [MainThread]: 
[0m21:43:14.680554 [error] [MainThread]: [33mRuntime Error in model stg_purchase_order_detail (models/silver/purchasing/stg_purchase_order_detail.sql)[0m
[0m21:43:14.681584 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.682793 [error] [MainThread]:   
[0m21:43:14.683828 [error] [MainThread]:   Location: US
[0m21:43:14.685080 [error] [MainThread]:   Job ID: 5469be2c-46e8-4376-a259-7e02707c3fc5
[0m21:43:14.685996 [error] [MainThread]:   
[0m21:43:14.687367 [info ] [MainThread]: 
[0m21:43:14.688340 [error] [MainThread]: [33mRuntime Error in model stg_purchase_order_header (models/silver/purchasing/stg_purchase_order_header.sql)[0m
[0m21:43:14.689163 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.690195 [error] [MainThread]:   
[0m21:43:14.690900 [error] [MainThread]:   Location: US
[0m21:43:14.691565 [error] [MainThread]:   Job ID: fdc494eb-02ad-4408-93bc-6fe9eff3c90d
[0m21:43:14.692237 [error] [MainThread]:   
[0m21:43:14.692894 [info ] [MainThread]: 
[0m21:43:14.693587 [error] [MainThread]: [33mRuntime Error in model stg_purchasing_product_vendor (models/silver/purchasing/stg_purchasing_product_vendor.sql)[0m
[0m21:43:14.694302 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.695011 [error] [MainThread]:   
[0m21:43:14.695705 [error] [MainThread]:   Location: US
[0m21:43:14.696416 [error] [MainThread]:   Job ID: 2e7adc26-3e6f-4d7f-a33a-50b97444b79c
[0m21:43:14.697546 [error] [MainThread]:   
[0m21:43:14.698815 [info ] [MainThread]: 
[0m21:43:14.699844 [error] [MainThread]: [33mRuntime Error in model stg_purchasing_ship_method (models/silver/purchasing/stg_purchasing_ship_method.sql)[0m
[0m21:43:14.700921 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.701683 [error] [MainThread]:   
[0m21:43:14.702331 [error] [MainThread]:   Location: US
[0m21:43:14.703025 [error] [MainThread]:   Job ID: bfef9122-1fcd-4cb6-9e0b-75db6b24db13
[0m21:43:14.703699 [error] [MainThread]:   
[0m21:43:14.704398 [info ] [MainThread]: 
[0m21:43:14.705156 [error] [MainThread]: [33mRuntime Error in model stg_purchasing_vendor (models/silver/purchasing/stg_purchasing_vendor.sql)[0m
[0m21:43:14.706081 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.706866 [error] [MainThread]:   
[0m21:43:14.707648 [error] [MainThread]:   Location: US
[0m21:43:14.708780 [error] [MainThread]:   Job ID: 99d579ee-c59a-4664-b0b7-05712f259781
[0m21:43:14.709735 [error] [MainThread]:   
[0m21:43:14.710461 [info ] [MainThread]: 
[0m21:43:14.711130 [error] [MainThread]: [33mRuntime Error in model stg_sales_country_region_currency (models/silver/sales/stg_sales_country_region_currency.sql)[0m
[0m21:43:14.711763 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.712486 [error] [MainThread]:   
[0m21:43:14.713243 [error] [MainThread]:   Location: US
[0m21:43:14.714371 [error] [MainThread]:   Job ID: 86ca5005-abe1-4b35-b66d-70c97a87e96f
[0m21:43:14.715510 [error] [MainThread]:   
[0m21:43:14.716499 [info ] [MainThread]: 
[0m21:43:14.717725 [error] [MainThread]: [33mRuntime Error in model stg_sales_currency (models/silver/sales/stg_sales_currency.sql)[0m
[0m21:43:14.718442 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.719093 [error] [MainThread]:   
[0m21:43:14.719731 [error] [MainThread]:   Location: US
[0m21:43:14.720352 [error] [MainThread]:   Job ID: 76532992-642a-4066-a212-2a1ae7d9ef54
[0m21:43:14.720944 [error] [MainThread]:   
[0m21:43:14.721580 [info ] [MainThread]: 
[0m21:43:14.721981 [error] [MainThread]: [33mRuntime Error in model stg_sales_customer (models/silver/sales/stg_sales_customer.sql)[0m
[0m21:43:14.722661 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.723369 [error] [MainThread]:   
[0m21:43:14.724097 [error] [MainThread]:   Location: US
[0m21:43:14.724813 [error] [MainThread]:   Job ID: 1a575aee-f8e2-4d06-938c-e148cb5f5af3
[0m21:43:14.725690 [error] [MainThread]:   
[0m21:43:14.726430 [info ] [MainThread]: 
[0m21:43:14.727161 [error] [MainThread]: [33mRuntime Error in model stg_sales_order_detail (models/silver/sales/stg_sales_order_detail.sql)[0m
[0m21:43:14.727895 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.728586 [error] [MainThread]:   
[0m21:43:14.729277 [error] [MainThread]:   Location: US
[0m21:43:14.730018 [error] [MainThread]:   Job ID: ad60ef2c-88e7-4fb9-a63d-d193ff556694
[0m21:43:14.730963 [error] [MainThread]:   
[0m21:43:14.731934 [info ] [MainThread]: 
[0m21:43:14.732776 [error] [MainThread]: [33mRuntime Error in model stg_sales_currency_rate (models/silver/sales/stg_sales_currency_rate.sql)[0m
[0m21:43:14.733691 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.734638 [error] [MainThread]:   
[0m21:43:14.735610 [error] [MainThread]:   Location: US
[0m21:43:14.736587 [error] [MainThread]:   Job ID: bda2d588-d5af-45cd-ba47-5a684baeccb5
[0m21:43:14.737960 [error] [MainThread]:   
[0m21:43:14.739044 [info ] [MainThread]: 
[0m21:43:14.740406 [error] [MainThread]: [33mRuntime Error in model stg_sales_order_header (models/silver/sales/stg_sales_order_header.sql)[0m
[0m21:43:14.741945 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.742702 [error] [MainThread]:   
[0m21:43:14.743433 [error] [MainThread]:   Location: US
[0m21:43:14.744149 [error] [MainThread]:   Job ID: 5068fa13-1ec4-4b8e-a2a8-1ec19e2b296d
[0m21:43:14.744848 [error] [MainThread]:   
[0m21:43:14.745517 [info ] [MainThread]: 
[0m21:43:14.746205 [error] [MainThread]: [33mRuntime Error in model stg_sales_order_header_reason (models/silver/sales/stg_sales_order_header_reason.sql)[0m
[0m21:43:14.747329 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.748528 [error] [MainThread]:   
[0m21:43:14.749375 [error] [MainThread]:   Location: US
[0m21:43:14.750089 [error] [MainThread]:   Job ID: 130a8dbb-3905-4286-bfc4-0cb4b76adb39
[0m21:43:14.750942 [error] [MainThread]:   
[0m21:43:14.751606 [info ] [MainThread]: 
[0m21:43:14.752307 [error] [MainThread]: [33mRuntime Error in model stg_sales_person (models/silver/sales/stg_sales_person.sql)[0m
[0m21:43:14.753194 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.753898 [error] [MainThread]:   
[0m21:43:14.754732 [error] [MainThread]:   Location: US
[0m21:43:14.755375 [error] [MainThread]:   Job ID: a9db31e9-7ecb-4b67-8b75-030d4cda2d72
[0m21:43:14.755999 [error] [MainThread]:   
[0m21:43:14.756826 [info ] [MainThread]: 
[0m21:43:14.757544 [error] [MainThread]: [33mRuntime Error in model stg_sales_reason (models/silver/sales/stg_sales_reason.sql)[0m
[0m21:43:14.758254 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.759282 [error] [MainThread]:   
[0m21:43:14.760137 [error] [MainThread]:   Location: US
[0m21:43:14.761148 [error] [MainThread]:   Job ID: e281ef32-4e4e-4159-8ce2-7544663e67e2
[0m21:43:14.761895 [error] [MainThread]:   
[0m21:43:14.763233 [info ] [MainThread]: 
[0m21:43:14.764511 [error] [MainThread]: [33mRuntime Error in model stg_sales_person_quota_history (models/silver/sales/stg_sales_person_quota_history.sql)[0m
[0m21:43:14.766342 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.768760 [error] [MainThread]:   
[0m21:43:14.769555 [error] [MainThread]:   Location: US
[0m21:43:14.770283 [error] [MainThread]:   Job ID: 92cc3107-1fff-4fa7-9619-8ca0c81caf8a
[0m21:43:14.771370 [error] [MainThread]:   
[0m21:43:14.772158 [info ] [MainThread]: 
[0m21:43:14.773264 [error] [MainThread]: [33mRuntime Error in model stg_sales_tax_rate (models/silver/sales/stg_sales_tax_rate.sql)[0m
[0m21:43:14.774203 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.775180 [error] [MainThread]:   
[0m21:43:14.775922 [error] [MainThread]:   Location: US
[0m21:43:14.776866 [error] [MainThread]:   Job ID: d409582d-1ef3-49c6-b4e3-39101ddd414c
[0m21:43:14.777639 [error] [MainThread]:   
[0m21:43:14.778570 [info ] [MainThread]: 
[0m21:43:14.779348 [error] [MainThread]: [33mRuntime Error in model stg_sales_territory (models/silver/sales/stg_sales_territory.sql)[0m
[0m21:43:14.780063 [error] [MainThread]:   404 Not found: Dataset desafiothaina:dev_thaina was not found in location US
[0m21:43:14.780989 [error] [MainThread]:   
[0m21:43:14.781727 [error] [MainThread]:   Location: US
[0m21:43:14.782601 [error] [MainThread]:   Job ID: 27747bc4-eaa1-4fe7-adf5-65464db83d49
[0m21:43:14.783394 [error] [MainThread]:   
[0m21:43:14.784124 [info ] [MainThread]: 
[0m21:43:14.785002 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=36 SKIP=2 TOTAL=39
[0m21:43:14.785901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae8e749450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae89900b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae899006d0>]}
[0m21:43:14.786732 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 21:44:01.533640 | 61143302-3a2a-476d-88de-bb50a6bd9da4 ==============================
[0m21:44:01.533640 [info ] [MainThread]: Running with dbt=1.4.6
[0m21:44:01.535613 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m21:44:01.536058 [debug] [MainThread]: Tracking: tracking
[0m21:44:01.538407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed118765f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed11875030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed118765c0>]}
[0m21:44:01.582507 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m21:44:01.730474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:44:01.730879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:44:01.744900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed113f61d0>]}
[0m21:44:01.769848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed11653730>]}
[0m21:44:01.770618 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m21:44:01.771542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed116537f0>]}
[0m21:44:01.783914 [info ] [MainThread]: 
[0m21:44:01.787992 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:44:01.797605 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m21:44:01.798625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:02.654117 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina'
[0m21:44:02.655758 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina'
[0m21:44:02.656571 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='desafiothaina', schema='dev_thaina', identifier=None)"
[0m21:44:02.674476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:02.677255 [debug] [ThreadPool]: On create_desafiothaina_dev_thaina: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "connection_name": "create_desafiothaina_dev_thaina"} */
create schema if not exists `desafiothaina`.`dev_thaina`
  
[0m21:44:04.684051 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:83d61b5f-228b-4f88-8235-94b697802105&page=queryresults
[0m21:44:04.693287 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m21:44:04.694340 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m21:44:04.694961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:04.695911 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m21:44:04.697151 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m21:44:04.697496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:04.698179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:04.732941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:06.285931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed11650bb0>]}
[0m21:44:06.287418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:44:06.288433 [info ] [MainThread]: 
[0m21:44:06.294473 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.address
[0m21:44:06.295809 [info ] [Thread-1 (]: 1 of 64 START seed file dev_thaina.address ..................................... [RUN]
[0m21:44:06.295008 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.addresstype
[0m21:44:06.299894 [info ] [Thread-2 (]: 2 of 64 START seed file dev_thaina.addresstype ................................. [RUN]
[0m21:44:06.301567 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.addresstype'
[0m21:44:06.302661 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.addresstype
[0m21:44:06.298256 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.billofmaterials
[0m21:44:06.304466 [info ] [Thread-3 (]: 3 of 64 START seed file dev_thaina.billofmaterials ............................. [RUN]
[0m21:44:06.306140 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.billofmaterials'
[0m21:44:06.306983 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.billofmaterials
[0m21:44:06.307764 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.billofmaterials (compile): 2023-06-27 21:44:06.307620 => 2023-06-27 21:44:06.307629
[0m21:44:06.299163 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.businessentity
[0m21:44:06.309483 [info ] [Thread-4 (]: 4 of 64 START seed file dev_thaina.businessentity .............................. [RUN]
[0m21:44:06.311333 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.businessentity'
[0m21:44:06.312130 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.businessentity
[0m21:44:06.312906 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.businessentity (compile): 2023-06-27 21:44:06.312741 => 2023-06-27 21:44:06.312748
[0m21:44:06.308547 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.billofmaterials
[0m21:44:06.313820 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.businessentity
[0m21:44:06.297402 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.address'
[0m21:44:06.303591 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.addresstype (compile): 2023-06-27 21:44:06.303451 => 2023-06-27 21:44:06.303468
[0m21:44:06.362009 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.address
[0m21:44:06.386318 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.addresstype
[0m21:44:06.391756 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.address (compile): 2023-06-27 21:44:06.391567 => 2023-06-27 21:44:06.391584
[0m21:44:06.431367 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.address
[0m21:44:06.692547 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:06.901992 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:07.566659 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:08.072621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:14.069405 [debug] [Thread-2 (]: On seed.desafioaethaina.addresstype: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.addresstype"} */

    alter table `desafiothaina`.`dev_thaina`.`addresstype` set OPTIONS()
  
[0m21:44:14.521235 [debug] [Thread-3 (]: On seed.desafioaethaina.billofmaterials: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.billofmaterials"} */

    alter table `desafiothaina`.`dev_thaina`.`billofmaterials` set OPTIONS()
  
[0m21:44:15.160385 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7c477f33-7600-4697-9e22-86306b1cfe43&page=queryresults
[0m21:44:15.172221 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.addresstype"
[0m21:44:15.199448 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.addresstype (execute): 2023-06-27 21:44:06.414045 => 2023-06-27 21:44:15.199351
[0m21:44:15.200662 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1129dd50>]}
[0m21:44:15.201329 [info ] [Thread-2 (]: 2 of 64 OK loaded seed file dev_thaina.addresstype ............................. [[32mINSERT 6[0m in 8.90s]
[0m21:44:15.205833 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.addresstype
[0m21:44:15.206901 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.businessentityaddress
[0m21:44:15.209373 [info ] [Thread-2 (]: 5 of 64 START seed file dev_thaina.businessentityaddress ....................... [RUN]
[0m21:44:15.211031 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.businessentityaddress'
[0m21:44:15.211668 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.businessentityaddress
[0m21:44:15.212244 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.businessentityaddress (compile): 2023-06-27 21:44:15.212106 => 2023-06-27 21:44:15.212116
[0m21:44:15.212914 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.businessentityaddress
[0m21:44:15.418676 [debug] [Thread-1 (]: On seed.desafioaethaina.address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.address"} */

    alter table `desafiothaina`.`dev_thaina`.`address` set OPTIONS()
  
[0m21:44:15.420402 [debug] [Thread-4 (]: On seed.desafioaethaina.businessentity: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.businessentity"} */

    alter table `desafiothaina`.`dev_thaina`.`businessentity` set OPTIONS()
  
[0m21:44:15.626716 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:15ae759f-b8e3-4ea0-8ed1-d4ac7581c4ae&page=queryresults
[0m21:44:15.629115 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.billofmaterials"
[0m21:44:15.676340 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.billofmaterials (execute): 2023-06-27 21:44:06.314533 => 2023-06-27 21:44:15.676269
[0m21:44:15.697926 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1129e3b0>]}
[0m21:44:15.713940 [info ] [Thread-3 (]: 3 of 64 OK loaded seed file dev_thaina.billofmaterials ......................... [[32mINSERT 2679[0m in 9.39s]
[0m21:44:15.721189 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.billofmaterials
[0m21:44:15.722065 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.businessentitycontact
[0m21:44:15.739960 [info ] [Thread-3 (]: 6 of 64 START seed file dev_thaina.businessentitycontact ....................... [RUN]
[0m21:44:15.745192 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.businessentitycontact'
[0m21:44:15.765589 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.businessentitycontact
[0m21:44:15.767672 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.businessentitycontact (compile): 2023-06-27 21:44:15.767299 => 2023-06-27 21:44:15.767324
[0m21:44:15.769653 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.businessentitycontact
[0m21:44:15.908737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:16.245168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:16.554181 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e3c5604c-f2e9-45c9-a2b7-55047869c1ec&page=queryresults
[0m21:44:16.555410 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.address"
[0m21:44:16.561081 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.address (execute): 2023-06-27 21:44:06.444357 => 2023-06-27 21:44:16.561013
[0m21:44:16.563016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed112f20b0>]}
[0m21:44:16.564480 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3dae0697-8fd1-4d7d-ae59-cd51bdbf9a6e&page=queryresults
[0m21:44:16.565041 [info ] [Thread-1 (]: 1 of 64 OK loaded seed file dev_thaina.address ................................. [[32mINSERT 19614[0m in 10.27s]
[0m21:44:16.567796 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.address
[0m21:44:16.568581 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.contacttype
[0m21:44:16.569494 [info ] [Thread-1 (]: 7 of 64 START seed file dev_thaina.contacttype ................................. [RUN]
[0m21:44:16.567231 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.businessentity"
[0m21:44:16.571725 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.contacttype'
[0m21:44:16.572460 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.contacttype
[0m21:44:16.573154 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.contacttype (compile): 2023-06-27 21:44:16.573016 => 2023-06-27 21:44:16.573024
[0m21:44:16.573885 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.contacttype
[0m21:44:16.595114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:16.597125 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.businessentity (execute): 2023-06-27 21:44:06.322700 => 2023-06-27 21:44:16.597007
[0m21:44:16.608325 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1129e7a0>]}
[0m21:44:16.647469 [info ] [Thread-4 (]: 4 of 64 OK loaded seed file dev_thaina.businessentity .......................... [[32mINSERT 20777[0m in 10.30s]
[0m21:44:16.650802 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.businessentity
[0m21:44:16.652093 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.countryregion
[0m21:44:16.652751 [info ] [Thread-4 (]: 8 of 64 START seed file dev_thaina.countryregion ............................... [RUN]
[0m21:44:16.654049 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.countryregion'
[0m21:44:16.654809 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.countryregion
[0m21:44:16.655619 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.countryregion (compile): 2023-06-27 21:44:16.655419 => 2023-06-27 21:44:16.655431
[0m21:44:16.656520 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.countryregion
[0m21:44:16.667024 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:22.811278 [debug] [Thread-3 (]: On seed.desafioaethaina.businessentitycontact: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.businessentitycontact"} */

    alter table `desafiothaina`.`dev_thaina`.`businessentitycontact` set OPTIONS()
  
[0m21:44:22.812202 [debug] [Thread-1 (]: On seed.desafioaethaina.contacttype: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.contacttype"} */

    alter table `desafiothaina`.`dev_thaina`.`contacttype` set OPTIONS()
  
[0m21:44:23.385234 [debug] [Thread-4 (]: On seed.desafioaethaina.countryregion: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.countryregion"} */

    alter table `desafiothaina`.`dev_thaina`.`countryregion` set OPTIONS()
  
[0m21:44:23.398998 [debug] [Thread-2 (]: On seed.desafioaethaina.businessentityaddress: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.businessentityaddress"} */

    alter table `desafiothaina`.`dev_thaina`.`businessentityaddress` set OPTIONS()
  
[0m21:44:23.764373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:fce07ce6-202a-4ada-9037-dae8a18141c6&page=queryresults
[0m21:44:23.765612 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.contacttype"
[0m21:44:23.770398 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.contacttype (execute): 2023-06-27 21:44:16.574422 => 2023-06-27 21:44:23.770276
[0m21:44:23.771629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed112f2980>]}
[0m21:44:23.772183 [info ] [Thread-1 (]: 7 of 64 OK loaded seed file dev_thaina.contacttype ............................. [[32mINSERT 20[0m in 7.20s]
[0m21:44:23.773004 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.contacttype
[0m21:44:23.773732 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.countryregioncurrency
[0m21:44:23.774514 [info ] [Thread-1 (]: 9 of 64 START seed file dev_thaina.countryregioncurrency ....................... [RUN]
[0m21:44:23.775679 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.countryregioncurrency'
[0m21:44:23.776167 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.countryregioncurrency
[0m21:44:23.776557 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.countryregioncurrency (compile): 2023-06-27 21:44:23.776455 => 2023-06-27 21:44:23.776461
[0m21:44:23.776982 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.countryregioncurrency
[0m21:44:23.784770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:23.980122 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:dac8c1e7-730b-4367-925a-317d3d8251ac&page=queryresults
[0m21:44:23.981351 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.businessentitycontact"
[0m21:44:23.986161 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.businessentitycontact (execute): 2023-06-27 21:44:15.771221 => 2023-06-27 21:44:23.986087
[0m21:44:23.987043 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed113d74f0>]}
[0m21:44:23.987533 [info ] [Thread-3 (]: 6 of 64 OK loaded seed file dev_thaina.businessentitycontact ................... [[32mINSERT 909[0m in 8.24s]
[0m21:44:23.988192 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.businessentitycontact
[0m21:44:23.988875 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.creditcard
[0m21:44:23.989602 [info ] [Thread-3 (]: 10 of 64 START seed file dev_thaina.creditcard ................................. [RUN]
[0m21:44:23.991181 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.creditcard'
[0m21:44:23.991752 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.creditcard
[0m21:44:23.992411 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.creditcard (compile): 2023-06-27 21:44:23.992268 => 2023-06-27 21:44:23.992276
[0m21:44:23.993097 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.creditcard
[0m21:44:24.541480 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:40c32cb4-3ecb-4706-8cdf-c5fa76eaad53&page=queryresults
[0m21:44:24.558487 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.businessentityaddress"
[0m21:44:24.591879 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:57d5a197-1997-4556-910e-86d519c5c7a3&page=queryresults
[0m21:44:24.595573 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.businessentityaddress (execute): 2023-06-27 21:44:15.213224 => 2023-06-27 21:44:24.595497
[0m21:44:24.603278 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.countryregion"
[0m21:44:24.623576 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed113d6950>]}
[0m21:44:24.659303 [info ] [Thread-2 (]: 5 of 64 OK loaded seed file dev_thaina.businessentityaddress ................... [[32mINSERT 19614[0m in 9.41s]
[0m21:44:24.660362 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.businessentityaddress
[0m21:44:24.661236 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.culture
[0m21:44:24.666706 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.countryregion (execute): 2023-06-27 21:44:16.656978 => 2023-06-27 21:44:24.666637
[0m21:44:24.681811 [info ] [Thread-2 (]: 11 of 64 START seed file dev_thaina.culture .................................... [RUN]
[0m21:44:24.702837 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecefd05990>]}
[0m21:44:24.723505 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.culture'
[0m21:44:24.749859 [info ] [Thread-4 (]: 8 of 64 OK loaded seed file dev_thaina.countryregion ........................... [[32mINSERT 238[0m in 8.05s]
[0m21:44:24.799092 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.countryregion
[0m21:44:24.771286 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.culture
[0m21:44:24.817777 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.culture (compile): 2023-06-27 21:44:24.817479 => 2023-06-27 21:44:24.817493
[0m21:44:24.806229 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.currency
[0m21:44:24.834302 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.culture
[0m21:44:24.853509 [info ] [Thread-4 (]: 12 of 64 START seed file dev_thaina.currency ................................... [RUN]
[0m21:44:24.871160 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.currency'
[0m21:44:24.872222 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.currency
[0m21:44:24.873264 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.currency (compile): 2023-06-27 21:44:24.872980 => 2023-06-27 21:44:24.873002
[0m21:44:24.895815 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.currency
[0m21:44:24.896756 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:24.957984 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:25.195987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:30.608707 [debug] [Thread-1 (]: On seed.desafioaethaina.countryregioncurrency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.countryregioncurrency"} */

    alter table `desafiothaina`.`dev_thaina`.`countryregioncurrency` set OPTIONS()
  
[0m21:44:31.631901 [debug] [Thread-2 (]: On seed.desafioaethaina.culture: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.culture"} */

    alter table `desafiothaina`.`dev_thaina`.`culture` set OPTIONS()
  
[0m21:44:31.644613 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:847e33b3-f880-4a35-b17a-7c95ce374ed9&page=queryresults
[0m21:44:31.645929 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.countryregioncurrency"
[0m21:44:31.651252 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.countryregioncurrency (execute): 2023-06-27 21:44:23.777391 => 2023-06-27 21:44:31.651139
[0m21:44:31.653007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed088888b0>]}
[0m21:44:31.654730 [info ] [Thread-1 (]: 9 of 64 OK loaded seed file dev_thaina.countryregioncurrency ................... [[32mINSERT 109[0m in 7.88s]
[0m21:44:31.655883 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.countryregioncurrency
[0m21:44:31.656811 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.currencyrate
[0m21:44:31.657939 [info ] [Thread-1 (]: 13 of 64 START seed file dev_thaina.currencyrate ............................... [RUN]
[0m21:44:31.659486 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.currencyrate'
[0m21:44:31.660118 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.currencyrate
[0m21:44:31.660660 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.currencyrate (compile): 2023-06-27 21:44:31.660538 => 2023-06-27 21:44:31.660545
[0m21:44:31.661253 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.currencyrate
[0m21:44:31.839469 [debug] [Thread-3 (]: On seed.desafioaethaina.creditcard: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.creditcard"} */

    alter table `desafiothaina`.`dev_thaina`.`creditcard` set OPTIONS()
  
[0m21:44:32.298004 [debug] [Thread-4 (]: On seed.desafioaethaina.currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.currency"} */

    alter table `desafiothaina`.`dev_thaina`.`currency` set OPTIONS()
  
[0m21:44:32.343245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:32.837833 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:42816a73-5b99-4398-b164-7c622d2a148f&page=queryresults
[0m21:44:32.840360 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.culture"
[0m21:44:32.845548 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.culture (execute): 2023-06-27 21:44:24.854504 => 2023-06-27 21:44:32.845448
[0m21:44:32.846671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceea57f70>]}
[0m21:44:32.847244 [info ] [Thread-2 (]: 11 of 64 OK loaded seed file dev_thaina.culture ................................ [[32mINSERT 8[0m in 8.12s]
[0m21:44:32.848054 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.culture
[0m21:44:32.849096 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.customer
[0m21:44:32.850250 [info ] [Thread-2 (]: 14 of 64 START seed file dev_thaina.customer ................................... [RUN]
[0m21:44:32.852201 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.customer'
[0m21:44:32.852879 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.customer
[0m21:44:32.853523 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.customer (compile): 2023-06-27 21:44:32.853388 => 2023-06-27 21:44:32.853396
[0m21:44:32.854143 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.customer
[0m21:44:33.000657 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7a6e4f47-10d6-45a9-9152-84a2db6dd827&page=queryresults
[0m21:44:33.018193 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.creditcard"
[0m21:44:33.058294 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.creditcard (execute): 2023-06-27 21:44:23.993639 => 2023-06-27 21:44:33.058217
[0m21:44:33.066174 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed113edc00>]}
[0m21:44:33.068867 [info ] [Thread-3 (]: 10 of 64 OK loaded seed file dev_thaina.creditcard ............................. [[32mINSERT 19118[0m in 9.08s]
[0m21:44:33.069966 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.creditcard
[0m21:44:33.078794 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.department
[0m21:44:33.079676 [info ] [Thread-3 (]: 15 of 64 START seed file dev_thaina.department ................................. [RUN]
[0m21:44:33.081735 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.department'
[0m21:44:33.098725 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.department
[0m21:44:33.100183 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.department (compile): 2023-06-27 21:44:33.099795 => 2023-06-27 21:44:33.099819
[0m21:44:33.108179 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.department
[0m21:44:33.157728 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:33.559934 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6adc3256-fe79-47ad-a567-9a7ee7152d3d&page=queryresults
[0m21:44:33.577394 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.currency"
[0m21:44:33.607412 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.currency (execute): 2023-06-27 21:44:24.916848 => 2023-06-27 21:44:33.607335
[0m21:44:33.618682 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed112fc280>]}
[0m21:44:33.714721 [info ] [Thread-4 (]: 12 of 64 OK loaded seed file dev_thaina.currency ............................... [[32mINSERT 105[0m in 8.75s]
[0m21:44:33.739670 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.currency
[0m21:44:33.749956 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.emailaddress
[0m21:44:33.751415 [info ] [Thread-4 (]: 16 of 64 START seed file dev_thaina.emailaddress ............................... [RUN]
[0m21:44:33.765843 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.emailaddress'
[0m21:44:33.773172 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.emailaddress
[0m21:44:33.774097 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.emailaddress (compile): 2023-06-27 21:44:33.773962 => 2023-06-27 21:44:33.773970
[0m21:44:33.774735 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.emailaddress
[0m21:44:34.243350 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:34.654765 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:38.998220 [debug] [Thread-1 (]: On seed.desafioaethaina.currencyrate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.currencyrate"} */

    alter table `desafiothaina`.`dev_thaina`.`currencyrate` set OPTIONS()
  
[0m21:44:39.899952 [debug] [Thread-3 (]: On seed.desafioaethaina.department: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.department"} */

    alter table `desafiothaina`.`dev_thaina`.`department` set OPTIONS()
  
[0m21:44:40.077219 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1ffc334f-c228-4bab-9ea2-dd070a0b1a39&page=queryresults
[0m21:44:40.078798 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.currencyrate"
[0m21:44:40.084384 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.currencyrate (execute): 2023-06-27 21:44:31.661732 => 2023-06-27 21:44:40.084280
[0m21:44:40.085829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed11451690>]}
[0m21:44:40.086839 [info ] [Thread-1 (]: 13 of 64 OK loaded seed file dev_thaina.currencyrate ........................... [[32mINSERT 13532[0m in 8.43s]
[0m21:44:40.088118 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.currencyrate
[0m21:44:40.088911 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.employee
[0m21:44:40.089686 [info ] [Thread-1 (]: 17 of 64 START seed file dev_thaina.employee ................................... [RUN]
[0m21:44:40.090990 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.employee'
[0m21:44:40.091471 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.employee
[0m21:44:40.091851 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.employee (compile): 2023-06-27 21:44:40.091756 => 2023-06-27 21:44:40.091761
[0m21:44:40.092297 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.employee
[0m21:44:40.165580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:41.174483 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ca8c2354-ca28-44a1-bfea-7a57b3fa7797&page=queryresults
[0m21:44:41.176844 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.department"
[0m21:44:41.183394 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.department (execute): 2023-06-27 21:44:33.113912 => 2023-06-27 21:44:41.183270
[0m21:44:41.185004 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed113ed690>]}
[0m21:44:41.186299 [info ] [Thread-3 (]: 15 of 64 OK loaded seed file dev_thaina.department ............................. [[32mINSERT 16[0m in 8.10s]
[0m21:44:41.187201 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.department
[0m21:44:41.187954 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.employeedepartmenthistory
[0m21:44:41.189221 [info ] [Thread-3 (]: 18 of 64 START seed file dev_thaina.employeedepartmenthistory .................. [RUN]
[0m21:44:41.190735 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.employeedepartmenthistory'
[0m21:44:41.191361 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.employeedepartmenthistory
[0m21:44:41.191886 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.employeedepartmenthistory (compile): 2023-06-27 21:44:41.191769 => 2023-06-27 21:44:41.191775
[0m21:44:41.192431 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.employeedepartmenthistory
[0m21:44:41.252754 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:41.855169 [debug] [Thread-4 (]: On seed.desafioaethaina.emailaddress: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.emailaddress"} */

    alter table `desafiothaina`.`dev_thaina`.`emailaddress` set OPTIONS()
  
[0m21:44:42.384493 [debug] [Thread-2 (]: On seed.desafioaethaina.customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.customer"} */

    alter table `desafiothaina`.`dev_thaina`.`customer` set OPTIONS()
  
[0m21:44:43.021952 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d8243246-c541-42db-9dc2-cc774ee516e3&page=queryresults
[0m21:44:43.023588 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.emailaddress"
[0m21:44:43.028814 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.emailaddress (execute): 2023-06-27 21:44:33.775208 => 2023-06-27 21:44:43.028685
[0m21:44:43.030515 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed11451960>]}
[0m21:44:43.031201 [info ] [Thread-4 (]: 16 of 64 OK loaded seed file dev_thaina.emailaddress ........................... [[32mINSERT 19972[0m in 9.27s]
[0m21:44:43.032141 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.emailaddress
[0m21:44:43.033721 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.employeepayhistory
[0m21:44:43.035656 [info ] [Thread-4 (]: 19 of 64 START seed file dev_thaina.employeepayhistory ......................... [RUN]
[0m21:44:43.037466 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.employeepayhistory'
[0m21:44:43.038179 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.employeepayhistory
[0m21:44:43.038803 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.employeepayhistory (compile): 2023-06-27 21:44:43.038656 => 2023-06-27 21:44:43.038664
[0m21:44:43.039500 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.employeepayhistory
[0m21:44:43.085697 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:43.369781 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4052d5ff-f805-459f-aaf3-8b21f32c9e29&page=queryresults
[0m21:44:43.372336 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.customer"
[0m21:44:43.377346 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.customer (execute): 2023-06-27 21:44:32.854597 => 2023-06-27 21:44:43.377205
[0m21:44:43.378788 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecefa8f070>]}
[0m21:44:43.379631 [info ] [Thread-2 (]: 14 of 64 OK loaded seed file dev_thaina.customer ............................... [[32mINSERT 19820[0m in 10.53s]
[0m21:44:43.380620 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.customer
[0m21:44:43.381485 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.illustration
[0m21:44:43.387895 [info ] [Thread-2 (]: 20 of 64 START seed file dev_thaina.illustration ............................... [RUN]
[0m21:44:43.390123 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.illustration'
[0m21:44:43.390800 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.illustration
[0m21:44:43.391396 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.illustration (compile): 2023-06-27 21:44:43.391274 => 2023-06-27 21:44:43.391282
[0m21:44:43.391997 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.illustration
[0m21:44:43.407513 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:46.975631 [debug] [Thread-1 (]: On seed.desafioaethaina.employee: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.employee"} */

    alter table `desafiothaina`.`dev_thaina`.`employee` set OPTIONS()
  
[0m21:44:47.891024 [debug] [Thread-3 (]: On seed.desafioaethaina.employeedepartmenthistory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.employeedepartmenthistory"} */

    alter table `desafiothaina`.`dev_thaina`.`employeedepartmenthistory` set OPTIONS()
  
[0m21:44:48.104525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6f688232-bc8c-448d-bfb4-7238910a54e9&page=queryresults
[0m21:44:48.105895 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.employee"
[0m21:44:48.110365 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.employee (execute): 2023-06-27 21:44:40.092611 => 2023-06-27 21:44:48.110256
[0m21:44:48.111720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed112b6c50>]}
[0m21:44:48.112445 [info ] [Thread-1 (]: 17 of 64 OK loaded seed file dev_thaina.employee ............................... [[32mINSERT 290[0m in 8.02s]
[0m21:44:48.113392 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.employee
[0m21:44:48.114320 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.jobcandidate
[0m21:44:48.116288 [info ] [Thread-1 (]: 21 of 64 START seed file dev_thaina.jobcandidate ............................... [RUN]
[0m21:44:48.117829 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.jobcandidate'
[0m21:44:48.118522 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.jobcandidate
[0m21:44:48.119131 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.jobcandidate (compile): 2023-06-27 21:44:48.119015 => 2023-06-27 21:44:48.119021
[0m21:44:48.120666 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.jobcandidate
[0m21:44:48.142746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:48.858899 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:050a9b35-ef32-46c7-be9e-6675f6a155d0&page=queryresults
[0m21:44:48.860352 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.employeedepartmenthistory"
[0m21:44:48.864914 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.employeedepartmenthistory (execute): 2023-06-27 21:44:41.192826 => 2023-06-27 21:44:48.864716
[0m21:44:48.865920 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecefd04bb0>]}
[0m21:44:48.866522 [info ] [Thread-3 (]: 18 of 64 OK loaded seed file dev_thaina.employeedepartmenthistory .............. [[32mINSERT 296[0m in 7.68s]
[0m21:44:48.867245 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.employeedepartmenthistory
[0m21:44:48.868056 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.location
[0m21:44:48.868955 [info ] [Thread-3 (]: 22 of 64 START seed file dev_thaina.location ................................... [RUN]
[0m21:44:48.870486 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.location'
[0m21:44:48.871157 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.location
[0m21:44:48.871753 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.location (compile): 2023-06-27 21:44:48.871625 => 2023-06-27 21:44:48.871632
[0m21:44:48.872544 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.location
[0m21:44:48.887323 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:49.740328 [debug] [Thread-2 (]: On seed.desafioaethaina.illustration: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.illustration"} */

    alter table `desafiothaina`.`dev_thaina`.`illustration` set OPTIONS()
  
[0m21:44:49.811839 [debug] [Thread-4 (]: On seed.desafioaethaina.employeepayhistory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.employeepayhistory"} */

    alter table `desafiothaina`.`dev_thaina`.`employeepayhistory` set OPTIONS()
  
[0m21:44:50.949139 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6b551b4e-3439-471e-a618-50357cab4400&page=queryresults
[0m21:44:50.951004 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.illustration"
[0m21:44:50.957064 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.illustration (execute): 2023-06-27 21:44:43.392471 => 2023-06-27 21:44:50.956990
[0m21:44:50.957956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed11450f10>]}
[0m21:44:50.958477 [info ] [Thread-2 (]: 20 of 64 OK loaded seed file dev_thaina.illustration ........................... [[32mINSERT 5[0m in 7.57s]
[0m21:44:50.959245 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.illustration
[0m21:44:50.960199 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.person
[0m21:44:50.961185 [info ] [Thread-2 (]: 23 of 64 START seed file dev_thaina.person ..................................... [RUN]
[0m21:44:50.962667 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.person'
[0m21:44:50.963733 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.person
[0m21:44:50.964450 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.person (compile): 2023-06-27 21:44:50.964292 => 2023-06-27 21:44:50.964300
[0m21:44:50.965178 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.person
[0m21:44:50.969602 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:67899e89-eced-401b-968b-60af3e02719c&page=queryresults
[0m21:44:50.980159 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.employeepayhistory"
[0m21:44:50.994911 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.employeepayhistory (execute): 2023-06-27 21:44:43.040008 => 2023-06-27 21:44:50.994738
[0m21:44:50.996949 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecefa8f340>]}
[0m21:44:51.014921 [info ] [Thread-4 (]: 19 of 64 OK loaded seed file dev_thaina.employeepayhistory ..................... [[32mINSERT 316[0m in 7.96s]
[0m21:44:51.103672 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.employeepayhistory
[0m21:44:51.119878 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.personcreditcard
[0m21:44:51.137034 [info ] [Thread-4 (]: 24 of 64 START seed file dev_thaina.personcreditcard ........................... [RUN]
[0m21:44:51.154128 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.personcreditcard'
[0m21:44:51.166796 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.personcreditcard
[0m21:44:51.168154 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.personcreditcard (compile): 2023-06-27 21:44:51.167682 => 2023-06-27 21:44:51.167696
[0m21:44:51.170827 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.personcreditcard
[0m21:44:52.349119 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:52.557130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:54.548128 [debug] [Thread-1 (]: On seed.desafioaethaina.jobcandidate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.jobcandidate"} */

    alter table `desafiothaina`.`dev_thaina`.`jobcandidate` set OPTIONS()
  
[0m21:44:54.966766 [debug] [Thread-3 (]: On seed.desafioaethaina.location: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.location"} */

    alter table `desafiothaina`.`dev_thaina`.`location` set OPTIONS()
  
[0m21:44:55.639580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1d20941d-ca74-40b7-8296-92690f23e797&page=queryresults
[0m21:44:55.641388 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.jobcandidate"
[0m21:44:55.649891 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.jobcandidate (execute): 2023-06-27 21:44:48.121144 => 2023-06-27 21:44:55.649385
[0m21:44:55.651517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebfd8130>]}
[0m21:44:55.652245 [info ] [Thread-1 (]: 21 of 64 OK loaded seed file dev_thaina.jobcandidate ........................... [[32mINSERT 13[0m in 7.53s]
[0m21:44:55.653193 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.jobcandidate
[0m21:44:55.654083 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.personphone
[0m21:44:55.655108 [info ] [Thread-1 (]: 25 of 64 START seed file dev_thaina.personphone ................................ [RUN]
[0m21:44:55.656612 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.personphone'
[0m21:44:55.657223 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.personphone
[0m21:44:55.657772 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.personphone (compile): 2023-06-27 21:44:55.657647 => 2023-06-27 21:44:55.657655
[0m21:44:55.658359 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.personphone
[0m21:44:55.995645 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a1e7ad2c-aaf5-4d53-aa3a-57a6c2c5ef37&page=queryresults
[0m21:44:56.132662 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.location"
[0m21:44:56.164885 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.location (execute): 2023-06-27 21:44:48.873144 => 2023-06-27 21:44:56.164745
[0m21:44:56.186529 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecec53f5b0>]}
[0m21:44:56.204039 [info ] [Thread-3 (]: 22 of 64 OK loaded seed file dev_thaina.location ............................... [[32mINSERT 14[0m in 7.32s]
[0m21:44:56.218132 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.location
[0m21:44:56.219142 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.phonenumbertype
[0m21:44:56.220416 [info ] [Thread-3 (]: 26 of 64 START seed file dev_thaina.phonenumbertype ............................ [RUN]
[0m21:44:56.222068 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.phonenumbertype'
[0m21:44:56.230647 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.phonenumbertype
[0m21:44:56.231474 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.phonenumbertype (compile): 2023-06-27 21:44:56.231314 => 2023-06-27 21:44:56.231324
[0m21:44:56.232434 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.phonenumbertype
[0m21:44:56.288325 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:56.590338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:59.142894 [debug] [Thread-4 (]: On seed.desafioaethaina.personcreditcard: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.personcreditcard"} */

    alter table `desafiothaina`.`dev_thaina`.`personcreditcard` set OPTIONS()
  
[0m21:45:00.368117 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9ea382d5-7aef-47ba-82bf-1383e4041a2e&page=queryresults
[0m21:45:00.370372 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.personcreditcard"
[0m21:45:00.377140 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.personcreditcard (execute): 2023-06-27 21:44:51.177492 => 2023-06-27 21:45:00.377028
[0m21:45:00.378723 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed11692a70>]}
[0m21:45:00.379571 [info ] [Thread-4 (]: 24 of 64 OK loaded seed file dev_thaina.personcreditcard ....................... [[32mINSERT 19118[0m in 9.23s]
[0m21:45:00.380620 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.personcreditcard
[0m21:45:00.381453 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.product
[0m21:45:00.382581 [info ] [Thread-4 (]: 27 of 64 START seed file dev_thaina.product .................................... [RUN]
[0m21:45:00.384589 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.product'
[0m21:45:00.385458 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.product
[0m21:45:00.386221 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.product (compile): 2023-06-27 21:45:00.386066 => 2023-06-27 21:45:00.386076
[0m21:45:00.387005 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.product
[0m21:45:00.534490 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:45:03.057468 [debug] [Thread-3 (]: On seed.desafioaethaina.phonenumbertype: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.phonenumbertype"} */

    alter table `desafiothaina`.`dev_thaina`.`phonenumbertype` set OPTIONS()
  
[0m21:45:04.181372 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:433eb9bc-2864-4ea2-b663-bcd1ccb0a13a&page=queryresults
[0m21:45:04.183101 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.phonenumbertype"
[0m21:45:04.190083 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.phonenumbertype (execute): 2023-06-27 21:44:56.234170 => 2023-06-27 21:45:04.189970
[0m21:45:04.192056 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebf9ba60>]}
[0m21:45:04.192945 [info ] [Thread-3 (]: 26 of 64 OK loaded seed file dev_thaina.phonenumbertype ........................ [[32mINSERT 3[0m in 7.97s]
[0m21:45:04.196264 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.phonenumbertype
[0m21:45:04.197095 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.productcategory
[0m21:45:04.198298 [info ] [Thread-3 (]: 28 of 64 START seed file dev_thaina.productcategory ............................ [RUN]
[0m21:45:04.200185 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productcategory'
[0m21:45:04.200837 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.productcategory
[0m21:45:04.201618 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.productcategory (compile): 2023-06-27 21:45:04.201270 => 2023-06-27 21:45:04.201277
[0m21:45:04.202572 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.productcategory
[0m21:45:04.219508 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:04.756497 [debug] [Thread-2 (]: On seed.desafioaethaina.person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.person"} */

    alter table `desafiothaina`.`dev_thaina`.`person` set OPTIONS()
  
[0m21:45:05.124902 [debug] [Thread-1 (]: On seed.desafioaethaina.personphone: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.personphone"} */

    alter table `desafiothaina`.`dev_thaina`.`personphone` set OPTIONS()
  
[0m21:45:05.923271 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ae34bf77-8628-48f9-a2f5-12cc657de800&page=queryresults
[0m21:45:05.926683 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.person"
[0m21:45:05.930815 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.person (execute): 2023-06-27 21:44:50.970245 => 2023-06-27 21:45:05.930683
[0m21:45:05.932516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1134e0b0>]}
[0m21:45:06.338236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b99ccfaa-0857-4864-951c-06b357c62d71&page=queryresults
[0m21:45:06.342560 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.personphone"
[0m21:45:06.347461 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.personphone (execute): 2023-06-27 21:44:55.658791 => 2023-06-27 21:45:06.347361
[0m21:45:06.348921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebf7e1a0>]}
[0m21:45:07.744806 [info ] [Thread-2 (]: 23 of 64 OK loaded seed file dev_thaina.person ................................. [[32mINSERT 19972[0m in 14.97s]
[0m21:45:07.746815 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.person
[0m21:45:07.748002 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.productcosthistory
[0m21:45:07.745618 [info ] [Thread-1 (]: 25 of 64 OK loaded seed file dev_thaina.personphone ............................ [[32mINSERT 19972[0m in 10.69s]
[0m21:45:07.749845 [info ] [Thread-2 (]: 29 of 64 START seed file dev_thaina.productcosthistory ......................... [RUN]
[0m21:45:07.751012 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.personphone
[0m21:45:07.753464 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.productdescription
[0m21:45:07.752563 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productcosthistory'
[0m21:45:07.755047 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.productcosthistory
[0m21:45:07.755718 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.productcosthistory (compile): 2023-06-27 21:45:07.755572 => 2023-06-27 21:45:07.755579
[0m21:45:07.756501 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.productcosthistory
[0m21:45:07.754381 [info ] [Thread-1 (]: 30 of 64 START seed file dev_thaina.productdescription ......................... [RUN]
[0m21:45:07.764704 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productdescription'
[0m21:45:07.771247 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.productdescription
[0m21:45:07.772370 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.productdescription (compile): 2023-06-27 21:45:07.772228 => 2023-06-27 21:45:07.772237
[0m21:45:07.773022 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.productdescription
[0m21:45:07.828416 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:07.840078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:08.388580 [debug] [Thread-4 (]: On seed.desafioaethaina.product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.product"} */

    alter table `desafiothaina`.`dev_thaina`.`product` set OPTIONS()
  
[0m21:45:09.425238 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1bc8698e-7a85-44dc-8149-75dfdde89709&page=queryresults
[0m21:45:09.427001 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.product"
[0m21:45:09.432400 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.product (execute): 2023-06-27 21:45:00.387574 => 2023-06-27 21:45:09.432296
[0m21:45:09.433654 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed116927d0>]}
[0m21:45:09.434487 [info ] [Thread-4 (]: 27 of 64 OK loaded seed file dev_thaina.product ................................ [[32mINSERT 504[0m in 9.05s]
[0m21:45:09.436096 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.product
[0m21:45:09.437201 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.productdocument
[0m21:45:09.438440 [info ] [Thread-4 (]: 31 of 64 START seed file dev_thaina.productdocument ............................ [RUN]
[0m21:45:09.440393 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productdocument'
[0m21:45:09.441114 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.productdocument
[0m21:45:09.441808 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.productdocument (compile): 2023-06-27 21:45:09.441665 => 2023-06-27 21:45:09.441673
[0m21:45:09.442461 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.productdocument
[0m21:45:09.455978 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:45:10.449080 [debug] [Thread-3 (]: On seed.desafioaethaina.productcategory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productcategory"} */

    alter table `desafiothaina`.`dev_thaina`.`productcategory` set OPTIONS()
  
[0m21:45:11.459756 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:eccb0a5d-787b-461c-ae3c-02dd06445bc9&page=queryresults
[0m21:45:11.461441 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.productcategory"
[0m21:45:11.468189 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.productcategory (execute): 2023-06-27 21:45:04.203391 => 2023-06-27 21:45:11.467979
[0m21:45:11.470047 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebf9b070>]}
[0m21:45:11.470833 [info ] [Thread-3 (]: 28 of 64 OK loaded seed file dev_thaina.productcategory ........................ [[32mINSERT 4[0m in 7.27s]
[0m21:45:11.471782 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.productcategory
[0m21:45:11.472587 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.productinventory
[0m21:45:11.474024 [info ] [Thread-3 (]: 32 of 64 START seed file dev_thaina.productinventory ........................... [RUN]
[0m21:45:11.477382 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productinventory'
[0m21:45:11.478449 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.productinventory
[0m21:45:11.479070 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.productinventory (compile): 2023-06-27 21:45:11.478942 => 2023-06-27 21:45:11.478950
[0m21:45:11.479684 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.productinventory
[0m21:45:11.581240 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:13.984555 [debug] [Thread-2 (]: On seed.desafioaethaina.productcosthistory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productcosthistory"} */

    alter table `desafiothaina`.`dev_thaina`.`productcosthistory` set OPTIONS()
  
[0m21:45:14.550039 [debug] [Thread-1 (]: On seed.desafioaethaina.productdescription: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productdescription"} */

    alter table `desafiothaina`.`dev_thaina`.`productdescription` set OPTIONS()
  
[0m21:45:15.184996 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:54b72697-4cfb-4eec-b46d-d411ff7f6d28&page=queryresults
[0m21:45:15.186296 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.productcosthistory"
[0m21:45:15.190199 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.productcosthistory (execute): 2023-06-27 21:45:07.757128 => 2023-06-27 21:45:15.190130
[0m21:45:15.191126 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1134d870>]}
[0m21:45:15.191649 [info ] [Thread-2 (]: 29 of 64 OK loaded seed file dev_thaina.productcosthistory ..................... [[32mINSERT 395[0m in 7.44s]
[0m21:45:15.192317 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.productcosthistory
[0m21:45:15.193061 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.productlistpricehistory
[0m21:45:15.194088 [info ] [Thread-2 (]: 33 of 64 START seed file dev_thaina.productlistpricehistory .................... [RUN]
[0m21:45:15.195837 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productlistpricehistory'
[0m21:45:15.196628 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.productlistpricehistory
[0m21:45:15.197234 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.productlistpricehistory (compile): 2023-06-27 21:45:15.197107 => 2023-06-27 21:45:15.197115
[0m21:45:15.197901 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.productlistpricehistory
[0m21:45:15.243241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:15.680592 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:31506c87-8429-47e1-a758-25b11e50be42&page=queryresults
[0m21:45:15.683673 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.productdescription"
[0m21:45:15.688828 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.productdescription (execute): 2023-06-27 21:45:07.773532 => 2023-06-27 21:45:15.688725
[0m21:45:15.690086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebf7d570>]}
[0m21:45:15.690834 [info ] [Thread-1 (]: 30 of 64 OK loaded seed file dev_thaina.productdescription ..................... [[32mINSERT 762[0m in 7.93s]
[0m21:45:15.691700 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.productdescription
[0m21:45:15.692414 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.productmodel
[0m21:45:15.693113 [info ] [Thread-1 (]: 34 of 64 START seed file dev_thaina.productmodel ............................... [RUN]
[0m21:45:15.696382 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productmodel'
[0m21:45:15.696974 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.productmodel
[0m21:45:15.698602 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.productmodel (compile): 2023-06-27 21:45:15.698470 => 2023-06-27 21:45:15.698480
[0m21:45:15.699177 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.productmodel
[0m21:45:15.720739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:15.867465 [debug] [Thread-4 (]: On seed.desafioaethaina.productdocument: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productdocument"} */

    alter table `desafiothaina`.`dev_thaina`.`productdocument` set OPTIONS()
  
[0m21:45:16.881994 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2058dae2-6e36-4f42-a9d3-e60ce0c41eeb&page=queryresults
[0m21:45:16.883541 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.productdocument"
[0m21:45:16.887652 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.productdocument (execute): 2023-06-27 21:45:09.443041 => 2023-06-27 21:45:16.887576
[0m21:45:16.888505 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed11693bb0>]}
[0m21:45:16.889001 [info ] [Thread-4 (]: 31 of 64 OK loaded seed file dev_thaina.productdocument ........................ [[32mINSERT 32[0m in 7.45s]
[0m21:45:16.889761 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.productdocument
[0m21:45:16.890606 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.productmodelillustration
[0m21:45:16.891661 [info ] [Thread-4 (]: 35 of 64 START seed file dev_thaina.productmodelillustration ................... [RUN]
[0m21:45:16.893404 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productmodelillustration'
[0m21:45:16.894079 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.productmodelillustration
[0m21:45:16.894694 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.productmodelillustration (compile): 2023-06-27 21:45:16.894562 => 2023-06-27 21:45:16.894570
[0m21:45:16.895382 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.productmodelillustration
[0m21:45:16.909231 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:45:17.852740 [debug] [Thread-3 (]: On seed.desafioaethaina.productinventory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productinventory"} */

    alter table `desafiothaina`.`dev_thaina`.`productinventory` set OPTIONS()
  
[0m21:45:19.028719 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7495afbc-a65c-4656-a994-809be9272a7a&page=queryresults
[0m21:45:19.031029 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.productinventory"
[0m21:45:19.035253 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.productinventory (execute): 2023-06-27 21:45:11.480141 => 2023-06-27 21:45:19.035169
[0m21:45:19.036170 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebf9ba60>]}
[0m21:45:19.036803 [info ] [Thread-3 (]: 32 of 64 OK loaded seed file dev_thaina.productinventory ....................... [[32mINSERT 1069[0m in 7.56s]
[0m21:45:19.037747 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.productinventory
[0m21:45:19.038690 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.productmodelproductdescriptionculture
[0m21:45:19.039728 [info ] [Thread-3 (]: 36 of 64 START seed file dev_thaina.productmodelproductdescriptionculture ...... [RUN]
[0m21:45:19.041478 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productmodelproductdescriptionculture'
[0m21:45:19.042192 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.productmodelproductdescriptionculture
[0m21:45:19.042895 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.productmodelproductdescriptionculture (compile): 2023-06-27 21:45:19.042749 => 2023-06-27 21:45:19.042759
[0m21:45:19.043678 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.productmodelproductdescriptionculture
[0m21:45:19.075160 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:21.768173 [debug] [Thread-2 (]: On seed.desafioaethaina.productlistpricehistory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productlistpricehistory"} */

    alter table `desafiothaina`.`dev_thaina`.`productlistpricehistory` set OPTIONS()
  
[0m21:45:22.101938 [debug] [Thread-1 (]: On seed.desafioaethaina.productmodel: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productmodel"} */

    alter table `desafiothaina`.`dev_thaina`.`productmodel` set OPTIONS()
  
[0m21:45:22.749513 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4cea7b38-7b1a-458b-8b79-9894a0d29f43&page=queryresults
[0m21:45:22.751225 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.productlistpricehistory"
[0m21:45:22.756707 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.productlistpricehistory (execute): 2023-06-27 21:45:15.198361 => 2023-06-27 21:45:22.756626
[0m21:45:22.757690 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1134cd30>]}
[0m21:45:22.758165 [info ] [Thread-2 (]: 33 of 64 OK loaded seed file dev_thaina.productlistpricehistory ................ [[32mINSERT 395[0m in 7.56s]
[0m21:45:22.758892 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.productlistpricehistory
[0m21:45:22.759741 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.productproductphoto
[0m21:45:22.760434 [info ] [Thread-2 (]: 37 of 64 START seed file dev_thaina.productproductphoto ........................ [RUN]
[0m21:45:22.761792 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productproductphoto'
[0m21:45:22.762377 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.productproductphoto
[0m21:45:22.762923 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.productproductphoto (compile): 2023-06-27 21:45:22.762804 => 2023-06-27 21:45:22.762811
[0m21:45:22.763540 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.productproductphoto
[0m21:45:22.792500 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:23.070307 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f164a372-1def-4fd3-933d-82f70fc0005a&page=queryresults
[0m21:45:23.071488 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.productmodel"
[0m21:45:23.076286 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.productmodel (execute): 2023-06-27 21:45:15.699559 => 2023-06-27 21:45:23.076206
[0m21:45:23.077327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceac4bca0>]}
[0m21:45:23.077890 [info ] [Thread-1 (]: 34 of 64 OK loaded seed file dev_thaina.productmodel ........................... [[32mINSERT 128[0m in 7.38s]
[0m21:45:23.078606 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.productmodel
[0m21:45:23.079362 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.productsubcategory
[0m21:45:23.080280 [info ] [Thread-1 (]: 38 of 64 START seed file dev_thaina.productsubcategory ......................... [RUN]
[0m21:45:23.081465 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productsubcategory'
[0m21:45:23.081936 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.productsubcategory
[0m21:45:23.082360 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.productsubcategory (compile): 2023-06-27 21:45:23.082223 => 2023-06-27 21:45:23.082229
[0m21:45:23.082849 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.productsubcategory
[0m21:45:23.092185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:23.097539 [debug] [Thread-4 (]: On seed.desafioaethaina.productmodelillustration: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productmodelillustration"} */

    alter table `desafiothaina`.`dev_thaina`.`productmodelillustration` set OPTIONS()
  
[0m21:45:24.151042 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d65fb6c8-91b0-472d-b775-28d76465d8ef&page=queryresults
[0m21:45:24.152630 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.productmodelillustration"
[0m21:45:24.156817 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.productmodelillustration (execute): 2023-06-27 21:45:16.895871 => 2023-06-27 21:45:24.156727
[0m21:45:24.157795 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed116921a0>]}
[0m21:45:24.158482 [info ] [Thread-4 (]: 35 of 64 OK loaded seed file dev_thaina.productmodelillustration ............... [[32mINSERT 7[0m in 7.27s]
[0m21:45:24.159311 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.productmodelillustration
[0m21:45:24.160062 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.productvendor
[0m21:45:24.161058 [info ] [Thread-4 (]: 39 of 64 START seed file dev_thaina.productvendor .............................. [RUN]
[0m21:45:24.162861 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.productvendor'
[0m21:45:24.163589 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.productvendor
[0m21:45:24.164162 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.productvendor (compile): 2023-06-27 21:45:24.164036 => 2023-06-27 21:45:24.164043
[0m21:45:24.164776 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.productvendor
[0m21:45:24.220346 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:45:26.247369 [debug] [Thread-3 (]: On seed.desafioaethaina.productmodelproductdescriptionculture: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productmodelproductdescriptionculture"} */

    alter table `desafiothaina`.`dev_thaina`.`productmodelproductdescriptionculture` set OPTIONS()
  
[0m21:45:27.444572 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e0f70269-de43-415c-9a22-c86b59afa779&page=queryresults
[0m21:45:27.446043 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.productmodelproductdescriptionculture"
[0m21:45:27.449575 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.productmodelproductdescriptionculture (execute): 2023-06-27 21:45:19.044194 => 2023-06-27 21:45:27.449495
[0m21:45:27.450773 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceaa85ae0>]}
[0m21:45:27.451345 [info ] [Thread-3 (]: 36 of 64 OK loaded seed file dev_thaina.productmodelproductdescriptionculture .. [[32mINSERT 762[0m in 8.41s]
[0m21:45:27.452076 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.productmodelproductdescriptionculture
[0m21:45:27.452734 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.purchaseorderdetail
[0m21:45:27.453668 [info ] [Thread-3 (]: 40 of 64 START seed file dev_thaina.purchaseorderdetail ........................ [RUN]
[0m21:45:27.455082 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.purchaseorderdetail'
[0m21:45:27.455570 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.purchaseorderdetail
[0m21:45:27.456132 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.purchaseorderdetail (compile): 2023-06-27 21:45:27.456010 => 2023-06-27 21:45:27.456017
[0m21:45:27.456694 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.purchaseorderdetail
[0m21:45:28.001707 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:28.879973 [debug] [Thread-2 (]: On seed.desafioaethaina.productproductphoto: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productproductphoto"} */

    alter table `desafiothaina`.`dev_thaina`.`productproductphoto` set OPTIONS()
  
[0m21:45:29.010692 [debug] [Thread-1 (]: On seed.desafioaethaina.productsubcategory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productsubcategory"} */

    alter table `desafiothaina`.`dev_thaina`.`productsubcategory` set OPTIONS()
  
[0m21:45:29.765982 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:61a0853f-e408-4e08-96ea-ee4570f644e5&page=queryresults
[0m21:45:29.767750 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.productproductphoto"
[0m21:45:29.773337 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.productproductphoto (execute): 2023-06-27 21:45:22.763983 => 2023-06-27 21:45:29.773199
[0m21:45:29.774730 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebfd7880>]}
[0m21:45:29.775409 [info ] [Thread-2 (]: 37 of 64 OK loaded seed file dev_thaina.productproductphoto .................... [[32mINSERT 504[0m in 7.01s]
[0m21:45:29.776201 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.productproductphoto
[0m21:45:29.777021 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.purchaseorderheader
[0m21:45:29.777958 [info ] [Thread-2 (]: 41 of 64 START seed file dev_thaina.purchaseorderheader ........................ [RUN]
[0m21:45:29.779353 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.purchaseorderheader'
[0m21:45:29.779832 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.purchaseorderheader
[0m21:45:29.780356 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.purchaseorderheader (compile): 2023-06-27 21:45:29.780233 => 2023-06-27 21:45:29.780241
[0m21:45:29.780946 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.purchaseorderheader
[0m21:45:29.916027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:90ce075d-9956-465f-88a2-5d256ca4ce4a&page=queryresults
[0m21:45:29.932538 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.productsubcategory"
[0m21:45:29.967363 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.productsubcategory (execute): 2023-06-27 21:45:23.083223 => 2023-06-27 21:45:29.967289
[0m21:45:29.983632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1134fdf0>]}
[0m21:45:29.999588 [info ] [Thread-1 (]: 38 of 64 OK loaded seed file dev_thaina.productsubcategory ..................... [[32mINSERT 37[0m in 6.90s]
[0m21:45:30.024999 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.productsubcategory
[0m21:45:30.036783 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.salesorderdetail
[0m21:45:30.058077 [info ] [Thread-1 (]: 42 of 64 START seed file dev_thaina.salesorderdetail ........................... [RUN]
[0m21:45:30.069921 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.salesorderdetail'
[0m21:45:30.086521 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.salesorderdetail
[0m21:45:30.097756 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.salesorderdetail (compile): 2023-06-27 21:45:30.097406 => 2023-06-27 21:45:30.097436
[0m21:45:30.109058 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.salesorderdetail
[0m21:45:30.389281 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:30.658220 [debug] [Thread-4 (]: On seed.desafioaethaina.productvendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.productvendor"} */

    alter table `desafiothaina`.`dev_thaina`.`productvendor` set OPTIONS()
  
[0m21:45:31.955306 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0c68bead-a656-416a-854a-213d8c6e019a&page=queryresults
[0m21:45:31.971988 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.productvendor"
[0m21:45:32.015951 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.productvendor (execute): 2023-06-27 21:45:24.165222 => 2023-06-27 21:45:32.015867
[0m21:45:32.017085 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceab1dc90>]}
[0m21:45:32.023076 [info ] [Thread-4 (]: 39 of 64 OK loaded seed file dev_thaina.productvendor .......................... [[32mINSERT 460[0m in 7.85s]
[0m21:45:32.050065 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.productvendor
[0m21:45:32.066873 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.salesorderheader
[0m21:45:32.073264 [info ] [Thread-4 (]: 43 of 64 START seed file dev_thaina.salesorderheader ........................... [RUN]
[0m21:45:32.106069 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.salesorderheader'
[0m21:45:32.122160 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.salesorderheader
[0m21:45:32.132967 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.salesorderheader (compile): 2023-06-27 21:45:32.132847 => 2023-06-27 21:45:32.132855
[0m21:45:32.143682 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.salesorderheader
[0m21:45:34.268069 [debug] [Thread-3 (]: On seed.desafioaethaina.purchaseorderdetail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.purchaseorderdetail"} */

    alter table `desafiothaina`.`dev_thaina`.`purchaseorderdetail` set OPTIONS()
  
[0m21:45:35.650782 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:41bedacb-00dc-4281-8159-fd05794fc0a2&page=queryresults
[0m21:45:35.682707 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.purchaseorderdetail"
[0m21:45:35.780801 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.purchaseorderdetail (execute): 2023-06-27 21:45:27.457116 => 2023-06-27 21:45:35.780728
[0m21:45:35.792953 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceac48fa0>]}
[0m21:45:35.808952 [info ] [Thread-3 (]: 40 of 64 OK loaded seed file dev_thaina.purchaseorderdetail .................... [[32mINSERT 8845[0m in 8.34s]
[0m21:45:35.814962 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.purchaseorderdetail
[0m21:45:35.821373 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.salesorderheadersalesreason
[0m21:45:35.844757 [info ] [Thread-3 (]: 44 of 64 START seed file dev_thaina.salesorderheadersalesreason ................ [RUN]
[0m21:45:35.896264 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.salesorderheadersalesreason'
[0m21:45:35.908055 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.salesorderheadersalesreason
[0m21:45:35.975196 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.salesorderheadersalesreason (compile): 2023-06-27 21:45:35.975080 => 2023-06-27 21:45:35.975087
[0m21:45:36.001260 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.salesorderheadersalesreason
[0m21:45:37.702385 [debug] [Thread-2 (]: On seed.desafioaethaina.purchaseorderheader: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.purchaseorderheader"} */

    alter table `desafiothaina`.`dev_thaina`.`purchaseorderheader` set OPTIONS()
  
[0m21:45:38.604616 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:38.876444 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7bdb5aac-3c74-4cd8-9ba6-2a8b94e69555&page=queryresults
[0m21:45:38.903030 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.purchaseorderheader"
[0m21:45:38.954129 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.purchaseorderheader (execute): 2023-06-27 21:45:29.781368 => 2023-06-27 21:45:38.954025
[0m21:45:38.967349 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceab1c3a0>]}
[0m21:45:38.968269 [info ] [Thread-2 (]: 41 of 64 OK loaded seed file dev_thaina.purchaseorderheader .................... [[32mINSERT 4012[0m in 9.19s]
[0m21:45:38.969564 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.purchaseorderheader
[0m21:45:38.970780 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.salesperson
[0m21:45:39.013197 [info ] [Thread-2 (]: 45 of 64 START seed file dev_thaina.salesperson ................................ [RUN]
[0m21:45:39.058037 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.salesperson'
[0m21:45:39.069014 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.salesperson
[0m21:45:39.084867 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.salesperson (compile): 2023-06-27 21:45:39.084761 => 2023-06-27 21:45:39.084769
[0m21:45:39.090477 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.salesperson
[0m21:45:39.461857 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:43.411567 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:45:45.508585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:46.284224 [debug] [Thread-3 (]: On seed.desafioaethaina.salesorderheadersalesreason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.salesorderheadersalesreason"} */

    alter table `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason` set OPTIONS()
  
[0m21:45:46.677191 [debug] [Thread-2 (]: On seed.desafioaethaina.salesperson: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.salesperson"} */

    alter table `desafiothaina`.`dev_thaina`.`salesperson` set OPTIONS()
  
[0m21:45:47.166480 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:47e950ea-70fa-4223-8241-bd876891310e&page=queryresults
[0m21:45:47.168007 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.salesorderheadersalesreason"
[0m21:45:47.173181 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.salesorderheadersalesreason (execute): 2023-06-27 21:45:36.011961 => 2023-06-27 21:45:47.173081
[0m21:45:47.174538 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceac48f40>]}
[0m21:45:47.175318 [info ] [Thread-3 (]: 44 of 64 OK loaded seed file dev_thaina.salesorderheadersalesreason ............ [[32mINSERT 27647[0m in 11.28s]
[0m21:45:47.176134 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.salesorderheadersalesreason
[0m21:45:47.176967 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.salespersonquotahistory
[0m21:45:47.178900 [info ] [Thread-3 (]: 46 of 64 START seed file dev_thaina.salespersonquotahistory .................... [RUN]
[0m21:45:47.180580 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.salespersonquotahistory'
[0m21:45:47.181359 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.salespersonquotahistory
[0m21:45:47.181961 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.salespersonquotahistory (compile): 2023-06-27 21:45:47.181838 => 2023-06-27 21:45:47.181845
[0m21:45:47.182621 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.salespersonquotahistory
[0m21:45:47.202196 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:47.564126 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:97792397-5dfa-4a83-ac45-5ccbc6044b94&page=queryresults
[0m21:45:47.565431 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.salesperson"
[0m21:45:47.569381 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.salesperson (execute): 2023-06-27 21:45:39.096120 => 2023-06-27 21:45:47.569293
[0m21:45:47.570313 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed08a71600>]}
[0m21:45:47.571500 [info ] [Thread-2 (]: 45 of 64 OK loaded seed file dev_thaina.salesperson ............................ [[32mINSERT 17[0m in 8.51s]
[0m21:45:47.572573 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.salesperson
[0m21:45:47.573451 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.salesreason
[0m21:45:47.574387 [info ] [Thread-2 (]: 47 of 64 START seed file dev_thaina.salesreason ................................ [RUN]
[0m21:45:47.575820 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.salesreason'
[0m21:45:47.576501 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.salesreason
[0m21:45:47.577125 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.salesreason (compile): 2023-06-27 21:45:47.577007 => 2023-06-27 21:45:47.577013
[0m21:45:47.577827 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.salesreason
[0m21:45:47.596686 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:52.910645 [debug] [Thread-3 (]: On seed.desafioaethaina.salespersonquotahistory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.salespersonquotahistory"} */

    alter table `desafiothaina`.`dev_thaina`.`salespersonquotahistory` set OPTIONS()
  
[0m21:45:53.678283 [debug] [Thread-4 (]: On seed.desafioaethaina.salesorderheader: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.salesorderheader"} */

    alter table `desafiothaina`.`dev_thaina`.`salesorderheader` set OPTIONS()
  
[0m21:45:53.817946 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:35243892-2fd3-4e35-b847-a210c3f1408f&page=queryresults
[0m21:45:53.821182 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.salespersonquotahistory"
[0m21:45:53.828020 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.salespersonquotahistory (execute): 2023-06-27 21:45:47.183095 => 2023-06-27 21:45:53.827914
[0m21:45:53.829242 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1133a530>]}
[0m21:45:53.829914 [info ] [Thread-3 (]: 46 of 64 OK loaded seed file dev_thaina.salespersonquotahistory ................ [[32mINSERT 163[0m in 6.65s]
[0m21:45:53.830675 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.salespersonquotahistory
[0m21:45:53.831411 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.salestaxrate
[0m21:45:53.832325 [info ] [Thread-3 (]: 48 of 64 START seed file dev_thaina.salestaxrate ............................... [RUN]
[0m21:45:53.833632 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.salestaxrate'
[0m21:45:53.834085 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.salestaxrate
[0m21:45:53.834622 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.salestaxrate (compile): 2023-06-27 21:45:53.834503 => 2023-06-27 21:45:53.834509
[0m21:45:53.835187 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.salestaxrate
[0m21:45:53.845199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:54.256805 [debug] [Thread-2 (]: On seed.desafioaethaina.salesreason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.salesreason"} */

    alter table `desafiothaina`.`dev_thaina`.`salesreason` set OPTIONS()
  
[0m21:45:54.587871 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:43d512f3-552d-4f6f-96ef-af1da882f992&page=queryresults
[0m21:45:54.589652 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.salesorderheader"
[0m21:45:54.595712 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.salesorderheader (execute): 2023-06-27 21:45:32.154285 => 2023-06-27 21:45:54.595609
[0m21:45:54.596985 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceab1ea40>]}
[0m21:45:54.597771 [info ] [Thread-4 (]: 43 of 64 OK loaded seed file dev_thaina.salesorderheader ....................... [[32mINSERT 31465[0m in 22.49s]
[0m21:45:54.598651 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.salesorderheader
[0m21:45:54.599433 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.salesterritory
[0m21:45:54.600163 [info ] [Thread-4 (]: 49 of 64 START seed file dev_thaina.salesterritory ............................. [RUN]
[0m21:45:54.602645 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.salesterritory'
[0m21:45:54.603260 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.salesterritory
[0m21:45:54.604052 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.salesterritory (compile): 2023-06-27 21:45:54.603934 => 2023-06-27 21:45:54.603941
[0m21:45:54.604635 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.salesterritory
[0m21:45:54.616464 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:45:55.111712 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:84c45f5f-6f91-41b3-bc5f-3fb44267c13c&page=queryresults
[0m21:45:55.113182 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.salesreason"
[0m21:45:55.117259 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.salesreason (execute): 2023-06-27 21:45:47.578387 => 2023-06-27 21:45:55.117190
[0m21:45:55.118343 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceea48dc0>]}
[0m21:45:55.119077 [info ] [Thread-2 (]: 47 of 64 OK loaded seed file dev_thaina.salesreason ............................ [[32mINSERT 10[0m in 7.54s]
[0m21:45:55.119835 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.salesreason
[0m21:45:55.120474 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.salesterritoryhistory
[0m21:45:55.121387 [info ] [Thread-2 (]: 50 of 64 START seed file dev_thaina.salesterritoryhistory ...................... [RUN]
[0m21:45:55.123028 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.salesterritoryhistory'
[0m21:45:55.123674 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.salesterritoryhistory
[0m21:45:55.124246 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.salesterritoryhistory (compile): 2023-06-27 21:45:55.124129 => 2023-06-27 21:45:55.124135
[0m21:45:55.124847 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.salesterritoryhistory
[0m21:45:55.136695 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:57.250768 [debug] [Thread-1 (]: On seed.desafioaethaina.salesorderdetail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.salesorderdetail"} */

    alter table `desafiothaina`.`dev_thaina`.`salesorderdetail` set OPTIONS()
  
[0m21:45:58.354005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:40c5d675-24d2-4536-b8c6-9606a3b5f635&page=queryresults
[0m21:45:58.355619 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.salesorderdetail"
[0m21:45:58.361050 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.salesorderdetail (execute): 2023-06-27 21:45:30.114847 => 2023-06-27 21:45:58.360947
[0m21:45:58.362370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebfb3160>]}
[0m21:45:58.363062 [info ] [Thread-1 (]: 42 of 64 OK loaded seed file dev_thaina.salesorderdetail ....................... [[32mINSERT 121317[0m in 28.29s]
[0m21:45:58.363839 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.salesorderdetail
[0m21:45:58.364567 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.scrapreason
[0m21:45:58.365445 [info ] [Thread-1 (]: 51 of 64 START seed file dev_thaina.scrapreason ................................ [RUN]
[0m21:45:58.366783 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.scrapreason'
[0m21:45:58.367378 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.scrapreason
[0m21:45:58.367893 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.scrapreason (compile): 2023-06-27 21:45:58.367777 => 2023-06-27 21:45:58.367783
[0m21:45:58.368454 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.scrapreason
[0m21:45:58.380491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:00.427730 [debug] [Thread-3 (]: On seed.desafioaethaina.salestaxrate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.salestaxrate"} */

    alter table `desafiothaina`.`dev_thaina`.`salestaxrate` set OPTIONS()
  
[0m21:46:00.910777 [debug] [Thread-4 (]: On seed.desafioaethaina.salesterritory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.salesterritory"} */

    alter table `desafiothaina`.`dev_thaina`.`salesterritory` set OPTIONS()
  
[0m21:46:01.215725 [debug] [Thread-2 (]: On seed.desafioaethaina.salesterritoryhistory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.salesterritoryhistory"} */

    alter table `desafiothaina`.`dev_thaina`.`salesterritoryhistory` set OPTIONS()
  
[0m21:46:01.340452 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8e5adf2d-eaf1-45e0-8849-0783e249ad46&page=queryresults
[0m21:46:01.341720 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.salestaxrate"
[0m21:46:01.345312 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.salestaxrate (execute): 2023-06-27 21:45:53.835579 => 2023-06-27 21:46:01.345226
[0m21:46:01.346159 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecea51aef0>]}
[0m21:46:01.347000 [info ] [Thread-3 (]: 48 of 64 OK loaded seed file dev_thaina.salestaxrate ........................... [[32mINSERT 29[0m in 7.51s]
[0m21:46:01.347845 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.salestaxrate
[0m21:46:01.348645 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.shift
[0m21:46:01.349350 [info ] [Thread-3 (]: 52 of 64 START seed file dev_thaina.shift ...................................... [RUN]
[0m21:46:01.350550 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.shift'
[0m21:46:01.350984 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.shift
[0m21:46:01.351453 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.shift (compile): 2023-06-27 21:46:01.351336 => 2023-06-27 21:46:01.351345
[0m21:46:01.351882 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.shift
[0m21:46:01.360603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:46:01.765532 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2de2377e-dc07-4254-9371-e27d66586b30&page=queryresults
[0m21:46:01.767565 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.salesterritory"
[0m21:46:01.772019 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.salesterritory (execute): 2023-06-27 21:45:54.605326 => 2023-06-27 21:46:01.771912
[0m21:46:01.773992 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceab1dc30>]}
[0m21:46:01.775746 [info ] [Thread-4 (]: 49 of 64 OK loaded seed file dev_thaina.salesterritory ......................... [[32mINSERT 10[0m in 7.17s]
[0m21:46:01.777367 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.salesterritory
[0m21:46:01.778229 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.shipmethod
[0m21:46:01.779103 [info ] [Thread-4 (]: 53 of 64 START seed file dev_thaina.shipmethod ................................. [RUN]
[0m21:46:01.780446 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.shipmethod'
[0m21:46:01.781031 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.shipmethod
[0m21:46:01.781566 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.shipmethod (compile): 2023-06-27 21:46:01.781459 => 2023-06-27 21:46:01.781466
[0m21:46:01.782116 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.shipmethod
[0m21:46:01.793093 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:46:02.153015 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e7c19fba-6c99-419c-b65e-684a42a9f0b8&page=queryresults
[0m21:46:02.157364 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.salesterritoryhistory"
[0m21:46:02.164208 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.salesterritoryhistory (execute): 2023-06-27 21:45:55.125342 => 2023-06-27 21:46:02.164101
[0m21:46:02.165619 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceea49900>]}
[0m21:46:02.166341 [info ] [Thread-2 (]: 50 of 64 OK loaded seed file dev_thaina.salesterritoryhistory .................. [[32mINSERT 17[0m in 7.04s]
[0m21:46:02.167184 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.salesterritoryhistory
[0m21:46:02.167960 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.shoppingcartitem
[0m21:46:02.168810 [info ] [Thread-2 (]: 54 of 64 START seed file dev_thaina.shoppingcartitem ........................... [RUN]
[0m21:46:02.170238 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.shoppingcartitem'
[0m21:46:02.170829 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.shoppingcartitem
[0m21:46:02.171405 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.shoppingcartitem (compile): 2023-06-27 21:46:02.171274 => 2023-06-27 21:46:02.171283
[0m21:46:02.171993 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.shoppingcartitem
[0m21:46:02.182619 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:04.203612 [debug] [Thread-1 (]: On seed.desafioaethaina.scrapreason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.scrapreason"} */

    alter table `desafiothaina`.`dev_thaina`.`scrapreason` set OPTIONS()
  
[0m21:46:05.519547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d882dbda-bcdb-4e98-9353-52c79904cd5f&page=queryresults
[0m21:46:05.521161 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.scrapreason"
[0m21:46:05.525173 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.scrapreason (execute): 2023-06-27 21:45:58.368877 => 2023-06-27 21:46:05.525057
[0m21:46:05.526466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebfb31c0>]}
[0m21:46:05.527022 [info ] [Thread-1 (]: 51 of 64 OK loaded seed file dev_thaina.scrapreason ............................ [[32mINSERT 16[0m in 7.16s]
[0m21:46:05.528002 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.scrapreason
[0m21:46:05.528897 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.specialoffer
[0m21:46:05.529955 [info ] [Thread-1 (]: 55 of 64 START seed file dev_thaina.specialoffer ............................... [RUN]
[0m21:46:05.531336 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.specialoffer'
[0m21:46:05.532002 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.specialoffer
[0m21:46:05.532538 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.specialoffer (compile): 2023-06-27 21:46:05.532429 => 2023-06-27 21:46:05.532437
[0m21:46:05.533126 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.specialoffer
[0m21:46:05.547889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:07.589627 [debug] [Thread-4 (]: On seed.desafioaethaina.shipmethod: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.shipmethod"} */

    alter table `desafiothaina`.`dev_thaina`.`shipmethod` set OPTIONS()
  
[0m21:46:07.601845 [debug] [Thread-3 (]: On seed.desafioaethaina.shift: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.shift"} */

    alter table `desafiothaina`.`dev_thaina`.`shift` set OPTIONS()
  
[0m21:46:08.558953 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4718b580-f9e4-4654-994f-8ac1daf6a566&page=queryresults
[0m21:46:08.560615 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.shipmethod"
[0m21:46:08.564193 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.shipmethod (execute): 2023-06-27 21:46:01.782506 => 2023-06-27 21:46:08.564079
[0m21:46:08.565837 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceaad50c0>]}
[0m21:46:08.566817 [info ] [Thread-4 (]: 53 of 64 OK loaded seed file dev_thaina.shipmethod ............................. [[32mINSERT 5[0m in 6.79s]
[0m21:46:08.567994 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.shipmethod
[0m21:46:08.568960 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.specialofferproduct
[0m21:46:08.570096 [info ] [Thread-4 (]: 56 of 64 START seed file dev_thaina.specialofferproduct ........................ [RUN]
[0m21:46:08.571830 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.specialofferproduct'
[0m21:46:08.572621 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.specialofferproduct
[0m21:46:08.573371 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.specialofferproduct (compile): 2023-06-27 21:46:08.573175 => 2023-06-27 21:46:08.573183
[0m21:46:08.574105 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.specialofferproduct
[0m21:46:08.611122 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:46:08.612370 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:43cf0c05-51ee-4aad-bf42-7af121de1c76&page=queryresults
[0m21:46:08.614220 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.shift"
[0m21:46:08.656648 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.shift (execute): 2023-06-27 21:46:01.352270 => 2023-06-27 21:46:08.656550
[0m21:46:08.657913 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed112aa170>]}
[0m21:46:08.658872 [info ] [Thread-3 (]: 52 of 64 OK loaded seed file dev_thaina.shift .................................. [[32mINSERT 3[0m in 7.31s]
[0m21:46:08.659989 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.shift
[0m21:46:08.663041 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.stateprovince
[0m21:46:08.664960 [info ] [Thread-3 (]: 57 of 64 START seed file dev_thaina.stateprovince .............................. [RUN]
[0m21:46:08.666449 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.stateprovince'
[0m21:46:08.667138 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.stateprovince
[0m21:46:08.667717 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.stateprovince (compile): 2023-06-27 21:46:08.667595 => 2023-06-27 21:46:08.667602
[0m21:46:08.668311 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.stateprovince
[0m21:46:08.701760 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:46:08.896094 [debug] [Thread-2 (]: On seed.desafioaethaina.shoppingcartitem: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.shoppingcartitem"} */

    alter table `desafiothaina`.`dev_thaina`.`shoppingcartitem` set OPTIONS()
  
[0m21:46:09.825034 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9de768a7-509d-4c60-a1f7-2acc68d2a06b&page=queryresults
[0m21:46:09.826600 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.shoppingcartitem"
[0m21:46:09.830320 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.shoppingcartitem (execute): 2023-06-27 21:46:02.172406 => 2023-06-27 21:46:09.830252
[0m21:46:09.831426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1129c160>]}
[0m21:46:09.832137 [info ] [Thread-2 (]: 54 of 64 OK loaded seed file dev_thaina.shoppingcartitem ....................... [[32mINSERT 3[0m in 7.66s]
[0m21:46:09.832821 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.shoppingcartitem
[0m21:46:09.833696 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.store
[0m21:46:09.834603 [info ] [Thread-2 (]: 58 of 64 START seed file dev_thaina.store ...................................... [RUN]
[0m21:46:09.836062 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.store'
[0m21:46:09.836708 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.store
[0m21:46:09.837269 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.store (compile): 2023-06-27 21:46:09.837154 => 2023-06-27 21:46:09.837160
[0m21:46:09.837910 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.store
[0m21:46:09.888329 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:10.842695 [debug] [Thread-1 (]: On seed.desafioaethaina.specialoffer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.specialoffer"} */

    alter table `desafiothaina`.`dev_thaina`.`specialoffer` set OPTIONS()
  
[0m21:46:11.932672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:37fae820-026e-497d-8936-0a57947656ba&page=queryresults
[0m21:46:11.934963 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.specialoffer"
[0m21:46:11.940966 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.specialoffer (execute): 2023-06-27 21:46:05.533579 => 2023-06-27 21:46:11.940868
[0m21:46:11.942284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebfb1b70>]}
[0m21:46:13.144585 [info ] [Thread-1 (]: 55 of 64 OK loaded seed file dev_thaina.specialoffer ........................... [[32mINSERT 16[0m in 6.41s]
[0m21:46:13.145596 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.specialoffer
[0m21:46:13.146409 [debug] [Thread-1 (]: Began running node seed.desafioaethaina.transactionhistory
[0m21:46:13.147336 [info ] [Thread-1 (]: 59 of 64 START seed file dev_thaina.transactionhistory ......................... [RUN]
[0m21:46:13.148721 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.desafioaethaina.transactionhistory'
[0m21:46:13.149185 [debug] [Thread-1 (]: Began compiling node seed.desafioaethaina.transactionhistory
[0m21:46:13.149770 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.transactionhistory (compile): 2023-06-27 21:46:13.149647 => 2023-06-27 21:46:13.149653
[0m21:46:13.150502 [debug] [Thread-1 (]: Began executing node seed.desafioaethaina.transactionhistory
[0m21:46:14.669401 [debug] [Thread-3 (]: On seed.desafioaethaina.stateprovince: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.stateprovince"} */

    alter table `desafiothaina`.`dev_thaina`.`stateprovince` set OPTIONS()
  
[0m21:46:15.679705 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:08198dc3-b822-40a8-b27f-4f999f70d091&page=queryresults
[0m21:46:15.691298 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.stateprovince"
[0m21:46:15.718311 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.stateprovince (execute): 2023-06-27 21:46:08.668748 => 2023-06-27 21:46:15.718215
[0m21:46:15.739848 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceac0b7c0>]}
[0m21:46:15.750560 [info ] [Thread-3 (]: 57 of 64 OK loaded seed file dev_thaina.stateprovince .......................... [[32mINSERT 181[0m in 7.07s]
[0m21:46:15.772324 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.stateprovince
[0m21:46:15.789622 [debug] [Thread-3 (]: Began running node seed.desafioaethaina.transactionhistoryarchive
[0m21:46:15.810780 [info ] [Thread-3 (]: 60 of 64 START seed file dev_thaina.transactionhistoryarchive .................. [RUN]
[0m21:46:15.828221 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.desafioaethaina.transactionhistoryarchive'
[0m21:46:15.829258 [debug] [Thread-3 (]: Began compiling node seed.desafioaethaina.transactionhistoryarchive
[0m21:46:15.835265 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.transactionhistoryarchive (compile): 2023-06-27 21:46:15.835045 => 2023-06-27 21:46:15.835063
[0m21:46:15.846197 [debug] [Thread-3 (]: Began executing node seed.desafioaethaina.transactionhistoryarchive
[0m21:46:16.052835 [debug] [Thread-2 (]: On seed.desafioaethaina.store: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.store"} */

    alter table `desafiothaina`.`dev_thaina`.`store` set OPTIONS()
  
[0m21:46:16.275383 [debug] [Thread-4 (]: On seed.desafioaethaina.specialofferproduct: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.specialofferproduct"} */

    alter table `desafiothaina`.`dev_thaina`.`specialofferproduct` set OPTIONS()
  
[0m21:46:17.566638 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6ca58baf-d50f-4ecd-82eb-0d05ede58eb2&page=queryresults
[0m21:46:17.573645 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8bf8ca59-8939-4987-af1b-e530593994c1&page=queryresults
[0m21:46:17.594428 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.specialofferproduct"
[0m21:46:17.614252 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.store"
[0m21:46:17.825461 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.specialofferproduct (execute): 2023-06-27 21:46:08.574641 => 2023-06-27 21:46:17.825390
[0m21:46:17.837078 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecec53fd60>]}
[0m21:46:17.840704 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.store (execute): 2023-06-27 21:46:09.838404 => 2023-06-27 21:46:17.840642
[0m21:46:17.848131 [info ] [Thread-4 (]: 56 of 64 OK loaded seed file dev_thaina.specialofferproduct .................... [[32mINSERT 538[0m in 9.27s]
[0m21:46:17.970997 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecead2c820>]}
[0m21:46:17.996078 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.specialofferproduct
[0m21:46:18.082917 [info ] [Thread-2 (]: 58 of 64 OK loaded seed file dev_thaina.store .................................. [[32mINSERT 701[0m in 8.14s]
[0m21:46:18.102039 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.unitmeasure
[0m21:46:18.111766 [info ] [Thread-4 (]: 61 of 64 START seed file dev_thaina.unitmeasure ................................ [RUN]
[0m21:46:18.119440 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.unitmeasure'
[0m21:46:18.120644 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.unitmeasure
[0m21:46:18.110966 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.store
[0m21:46:18.132055 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.unitmeasure (compile): 2023-06-27 21:46:18.131895 => 2023-06-27 21:46:18.131905
[0m21:46:18.163210 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.vendor
[0m21:46:18.191605 [info ] [Thread-2 (]: 62 of 64 START seed file dev_thaina.vendor ..................................... [RUN]
[0m21:46:18.178204 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.unitmeasure
[0m21:46:18.193500 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.vendor'
[0m21:46:18.214032 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.vendor
[0m21:46:18.215151 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.vendor (compile): 2023-06-27 21:46:18.214686 => 2023-06-27 21:46:18.214697
[0m21:46:18.221001 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.vendor
[0m21:46:18.269129 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:46:18.321573 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:25.452936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:26.579460 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:46:26.621320 [debug] [Thread-2 (]: On seed.desafioaethaina.vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.vendor"} */

    alter table `desafiothaina`.`dev_thaina`.`vendor` set OPTIONS()
  
[0m21:46:26.622228 [debug] [Thread-4 (]: On seed.desafioaethaina.unitmeasure: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.unitmeasure"} */

    alter table `desafiothaina`.`dev_thaina`.`unitmeasure` set OPTIONS()
  
[0m21:46:27.521258 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e5e891c2-44d7-46be-89fd-eccab6b0e496&page=queryresults
[0m21:46:27.522994 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.vendor"
[0m21:46:27.527411 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.vendor (execute): 2023-06-27 21:46:18.221483 => 2023-06-27 21:46:27.527288
[0m21:46:27.528487 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1134f7f0>]}
[0m21:46:27.528953 [info ] [Thread-2 (]: 62 of 64 OK loaded seed file dev_thaina.vendor ................................. [[32mINSERT 104[0m in 9.34s]
[0m21:46:27.529631 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.vendor
[0m21:46:27.530318 [debug] [Thread-2 (]: Began running node seed.desafioaethaina.workorder
[0m21:46:27.531132 [info ] [Thread-2 (]: 63 of 64 START seed file dev_thaina.workorder .................................. [RUN]
[0m21:46:27.532777 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.desafioaethaina.workorder'
[0m21:46:27.533389 [debug] [Thread-2 (]: Began compiling node seed.desafioaethaina.workorder
[0m21:46:27.533945 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.workorder (compile): 2023-06-27 21:46:27.533808 => 2023-06-27 21:46:27.533815
[0m21:46:27.534556 [debug] [Thread-2 (]: Began executing node seed.desafioaethaina.workorder
[0m21:46:27.543406 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:767ce36c-cd0d-4e5c-aa54-1abdc63dba63&page=queryresults
[0m21:46:27.553512 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.unitmeasure"
[0m21:46:27.625642 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.unitmeasure (execute): 2023-06-27 21:46:18.199185 => 2023-06-27 21:46:27.625528
[0m21:46:27.638251 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceac09720>]}
[0m21:46:27.650390 [info ] [Thread-4 (]: 61 of 64 OK loaded seed file dev_thaina.unitmeasure ............................ [[32mINSERT 38[0m in 9.52s]
[0m21:46:27.673093 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.unitmeasure
[0m21:46:27.696231 [debug] [Thread-4 (]: Began running node seed.desafioaethaina.workorderrouting
[0m21:46:27.724855 [info ] [Thread-4 (]: 64 of 64 START seed file dev_thaina.workorderrouting ........................... [RUN]
[0m21:46:27.731250 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.desafioaethaina.workorderrouting'
[0m21:46:27.747192 [debug] [Thread-4 (]: Began compiling node seed.desafioaethaina.workorderrouting
[0m21:46:27.766555 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.workorderrouting (compile): 2023-06-27 21:46:27.766221 => 2023-06-27 21:46:27.766237
[0m21:46:27.786548 [debug] [Thread-4 (]: Began executing node seed.desafioaethaina.workorderrouting
[0m21:46:34.314688 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:35.918396 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:46:36.980211 [debug] [Thread-1 (]: On seed.desafioaethaina.transactionhistory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.transactionhistory"} */

    alter table `desafiothaina`.`dev_thaina`.`transactionhistory` set OPTIONS()
  
[0m21:46:37.893914 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:910b7899-d29c-41d8-916a-85058dd29b4e&page=queryresults
[0m21:46:37.895858 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.desafioaethaina.transactionhistory"
[0m21:46:37.901114 [debug] [Thread-1 (]: Timing info for seed.desafioaethaina.transactionhistory (execute): 2023-06-27 21:46:13.151055 => 2023-06-27 21:46:37.901008
[0m21:46:37.902461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed113a1210>]}
[0m21:46:37.903282 [info ] [Thread-1 (]: 59 of 64 OK loaded seed file dev_thaina.transactionhistory ..................... [[32mINSERT 113443[0m in 24.75s]
[0m21:46:37.904169 [debug] [Thread-1 (]: Finished running node seed.desafioaethaina.transactionhistory
[0m21:46:38.594526 [debug] [Thread-3 (]: On seed.desafioaethaina.transactionhistoryarchive: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.transactionhistoryarchive"} */

    alter table `desafiothaina`.`dev_thaina`.`transactionhistoryarchive` set OPTIONS()
  
[0m21:46:39.455181 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4bea418e-f6a9-468c-b897-452fb58189cd&page=queryresults
[0m21:46:39.456616 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.desafioaethaina.transactionhistoryarchive"
[0m21:46:39.462519 [debug] [Thread-3 (]: Timing info for seed.desafioaethaina.transactionhistoryarchive (execute): 2023-06-27 21:46:15.862533 => 2023-06-27 21:46:39.462405
[0m21:46:39.464032 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feceac0bbe0>]}
[0m21:46:39.464721 [info ] [Thread-3 (]: 60 of 64 OK loaded seed file dev_thaina.transactionhistoryarchive .............. [[32mINSERT 89253[0m in 23.64s]
[0m21:46:39.465550 [debug] [Thread-3 (]: Finished running node seed.desafioaethaina.transactionhistoryarchive
[0m21:46:45.028559 [debug] [Thread-2 (]: On seed.desafioaethaina.workorder: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.workorder"} */

    alter table `desafiothaina`.`dev_thaina`.`workorder` set OPTIONS()
  
[0m21:46:46.305271 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:919d0757-1104-4d9c-beca-6be41409d95c&page=queryresults
[0m21:46:46.306814 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.desafioaethaina.workorder"
[0m21:46:46.310389 [debug] [Thread-2 (]: Timing info for seed.desafioaethaina.workorder (execute): 2023-06-27 21:46:27.534966 => 2023-06-27 21:46:46.310322
[0m21:46:46.311242 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecebf99a80>]}
[0m21:46:46.311770 [info ] [Thread-2 (]: 63 of 64 OK loaded seed file dev_thaina.workorder .............................. [[32mINSERT 72591[0m in 18.78s]
[0m21:46:46.312746 [debug] [Thread-2 (]: Finished running node seed.desafioaethaina.workorder
[0m21:46:47.804783 [debug] [Thread-4 (]: On seed.desafioaethaina.workorderrouting: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "seed.desafioaethaina.workorderrouting"} */

    alter table `desafiothaina`.`dev_thaina`.`workorderrouting` set OPTIONS()
  
[0m21:46:48.928704 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cdb9e338-99b0-4945-8a3f-f39cf1ac824b&page=queryresults
[0m21:46:48.930335 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.desafioaethaina.workorderrouting"
[0m21:46:48.936520 [debug] [Thread-4 (]: Timing info for seed.desafioaethaina.workorderrouting (execute): 2023-06-27 21:46:27.802264 => 2023-06-27 21:46:48.936413
[0m21:46:48.937883 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61143302-3a2a-476d-88de-bb50a6bd9da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed113a1a20>]}
[0m21:46:48.938618 [info ] [Thread-4 (]: 64 of 64 OK loaded seed file dev_thaina.workorderrouting ....................... [[32mINSERT 67131[0m in 21.21s]
[0m21:46:48.939464 [debug] [Thread-4 (]: Finished running node seed.desafioaethaina.workorderrouting
[0m21:46:48.942995 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:46:48.944181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:48.944687 [debug] [MainThread]: Connection 'seed.desafioaethaina.workorderrouting' was properly closed.
[0m21:46:48.945149 [debug] [MainThread]: Connection 'seed.desafioaethaina.transactionhistoryarchive' was properly closed.
[0m21:46:48.945630 [debug] [MainThread]: Connection 'seed.desafioaethaina.transactionhistory' was properly closed.
[0m21:46:48.946076 [debug] [MainThread]: Connection 'seed.desafioaethaina.workorder' was properly closed.
[0m21:46:48.946715 [info ] [MainThread]: 
[0m21:46:48.947497 [info ] [MainThread]: Finished running 64 seeds in 0 hours 2 minutes and 47.16 seconds (167.16s).
[0m21:46:48.953037 [debug] [MainThread]: Command end result
[0m21:46:48.998689 [info ] [MainThread]: 
[0m21:46:49.001164 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:46:49.003250 [info ] [MainThread]: 
[0m21:46:49.004926 [info ] [MainThread]: Done. PASS=64 WARN=0 ERROR=0 SKIP=0 TOTAL=64
[0m21:46:49.006333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed113ed7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed113ed9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed113ed840>]}
[0m21:46:49.007045 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 22:44:02.086669 | dcfebfe9-e825-4885-89dc-48d1aeaff4dd ==============================
[0m22:44:02.086669 [info ] [MainThread]: Running with dbt=1.4.6
[0m22:44:02.088572 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:44:02.089322 [debug] [MainThread]: Tracking: tracking
[0m22:44:02.091783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954cd62ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954cd608e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954cd62d10>]}
[0m22:44:02.131041 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m22:44:02.261476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:44:02.261827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:44:02.275287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c8ddf90>]}
[0m22:44:02.301913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954cb4f4f0>]}
[0m22:44:02.302605 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m22:44:02.303349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954cb4f5b0>]}
[0m22:44:02.312497 [info ] [MainThread]: 
[0m22:44:02.316942 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:44:02.323488 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m22:44:02.325987 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m22:44:02.328677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:02.331381 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m22:44:02.332113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:02.334493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:04.269659 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m22:44:04.270322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:44:04.271444 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m22:44:04.272733 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m22:44:04.273056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:44:04.306560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m22:44:04.308962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:44:04.311730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:05.699733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954cd62d70>]}
[0m22:44:05.700811 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:44:05.701575 [info ] [MainThread]: 
[0m22:44:05.708182 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m22:44:05.709137 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_address
[0m22:44:05.709824 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_customer
[0m22:44:05.710898 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_customer_and_sales
[0m22:44:05.710462 [info ] [Thread-1 (]: 1 of 39 START sql table model dev_thaina_gold.dim_dates ........................ [RUN]
[0m22:44:05.711926 [info ] [Thread-2 (]: 2 of 39 START sql table model dev_thaina_intermediate.int_address .............. [RUN]
[0m22:44:05.715689 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m22:44:05.718253 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m22:44:05.717253 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m22:44:05.712777 [info ] [Thread-3 (]: 3 of 39 START sql table model dev_thaina_intermediate.int_customer ............. [RUN]
[0m22:44:05.713946 [info ] [Thread-4 (]: 4 of 39 START sql table model dev_thaina_intermediate.int_customer_and_sales ... [RUN]
[0m22:44:05.742159 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_address
[0m22:44:05.753611 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer'
[0m22:44:05.756324 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer_and_sales'
[0m22:44:05.778721 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m22:44:05.781651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:05.782387 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_customer
[0m22:44:05.783364 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_customer_and_sales
[0m22:44:05.788915 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m22:44:05.789978 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-06-27 22:44:05.772144 => 2023-06-27 22:44:05.789752
[0m22:44:05.794322 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_customer"
[0m22:44:05.800088 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_customer_and_sales"
[0m22:44:05.833950 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.int_address
[0m22:44:05.836184 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_customer (compile): 2023-06-27 22:44:05.790372 => 2023-06-27 22:44:05.836051
[0m22:44:05.842268 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_customer_and_sales (compile): 2023-06-27 22:44:05.794701 => 2023-06-27 22:44:05.842158
[0m22:44:05.862743 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.int_customer
[0m22:44:05.878706 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m22:44:05.879359 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.int_customer_and_sales
[0m22:44:05.884120 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.int_customer"
[0m22:44:05.891199 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.int_customer_and_sales"
[0m22:44:05.893817 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:44:05.892666 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:44:05.891860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:05.896635 [debug] [Thread-4 (]: On model.desafioaethaina.int_customer_and_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
	from `dev_thaina_intermediate.int_sales_customer`	
)

, sales as (
	select * 
	from `dev_thaina_intermediate.int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, business_entity_id
		, person_type
		, name_style
		, courtesy_title
		, first_name
		, middle_name
		, last_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m22:44:05.899377 [debug] [Thread-3 (]: On model.desafioaethaina.int_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `dev_thaina_silver.stg_sales_customer`
)

, sales_territory as (
	select * 
    from `dev_thaina_silver.stg_sales_territory`
)

, person_person as (
	select * 
    from `dev_thaina_silver.stg_person_person`
)

, person_country as (
	select * 
    from `dev_thaina_silver.stg_person_country_region`
)

, state_province as (
	select * 
    from `dev_thaina_silver.stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , group_geo
        , sales_territory_year
        , bussiness_cost_in_territory
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

select * 
from union_customer_country
    );
  
[0m22:44:05.901139 [debug] [Thread-2 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with address as (
	select * 
    from `dev_thaina_silver.stg_person_address`
)

, address_type as (
	select * 
    from `dev_thaina_silver.stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `dev_thaina_silver.stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `dev_thaina_silver.stg_person_business_entity_contact`
)

, union_address_business_address as (
    select
        address.address_id
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
        , business_entity_id
        , address_type_id
    from address 
    left join business_entity_address  
    on address.address_id = business_entity_address.address_id
   
)

, union_address_business_contact as (
    select
        union_address_business_address.*
        , address_type_name
        , contact_type_id
    from business_entity_contact
    left join  union_address_business_address
    on union_address_business_address.business_entity_id = business_entity_contact.business_entity_id
    left join address_type 
    on address_type.address_type_id = union_address_business_address.address_type_id
)

select * 
from union_address_business_contact
    );
  
[0m22:44:07.137582 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with address as (
	select * 
    from `dev_thaina_silver.stg_person_address`
)

, address_type as (
	select * 
    from `dev_thaina_silver.stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `dev_thaina_silver.stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `dev_thaina_silver.stg_person_business_entity_contact`
)

, union_address_business_address as (
    select
        address.address_id
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
        , business_entity_id
        , address_type_id
    from address 
    left join business_entity_address  
    on address.address_id = business_entity_address.address_id
   
)

, union_address_business_contact as (
    select
        union_address_business_address.*
        , address_type_name
        , contact_type_id
    from business_entity_contact
    left join  union_address_business_address
    on union_address_business_address.business_entity_id = business_entity_contact.business_entity_id
    left join address_type 
    on address_type.address_type_id = union_address_business_address.address_type_id
)

select * 
from union_address_business_contact
    );
  
[0m22:44:07.138204 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `dev_thaina_silver.stg_sales_customer`
)

, sales_territory as (
	select * 
    from `dev_thaina_silver.stg_sales_territory`
)

, person_person as (
	select * 
    from `dev_thaina_silver.stg_person_person`
)

, person_country as (
	select * 
    from `dev_thaina_silver.stg_person_country_region`
)

, state_province as (
	select * 
    from `dev_thaina_silver.stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , group_geo
        , sales_territory_year
        , bussiness_cost_in_territory
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

select * 
from union_customer_country
    );
  
[0m22:44:07.139406 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_address was not found in location US

Location: US
Job ID: b7e2f18a-76ee-41c5-a082-d54dc60a78b7

[0m22:44:07.140124 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_country_region was not found in location US

Location: US
Job ID: a0fe8c98-f099-4449-aa64-78e55ec44aee

[0m22:44:07.140726 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-06-27 22:44:05.837001 => 2023-06-27 22:44:07.140621
[0m22:44:07.141207 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_customer (execute): 2023-06-27 22:44:05.879787 => 2023-06-27 22:44:07.141141
[0m22:44:07.147102 [debug] [Thread-2 (]: Runtime Error in model int_address (models/intermediate/int_address.sql)
  404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_address was not found in location US
  
  Location: US
  Job ID: b7e2f18a-76ee-41c5-a082-d54dc60a78b7
  
[0m22:44:07.147635 [debug] [Thread-3 (]: Runtime Error in model int_customer (models/intermediate/int_customer.sql)
  404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_country_region was not found in location US
  
  Location: US
  Job ID: a0fe8c98-f099-4449-aa64-78e55ec44aee
  
[0m22:44:07.148217 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c96df60>]}
[0m22:44:07.148848 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c955750>]}
[0m22:44:07.149675 [error] [Thread-2 (]: 2 of 39 ERROR creating sql table model dev_thaina_intermediate.int_address ..... [[31mERROR[0m in 1.43s]
[0m22:44:07.154417 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_address
[0m22:44:07.150926 [error] [Thread-3 (]: 3 of 39 ERROR creating sql table model dev_thaina_intermediate.int_customer .... [[31mERROR[0m in 1.40s]
[0m22:44:07.155341 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_sales
[0m22:44:07.155985 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_customer
[0m22:44:07.156521 [info ] [Thread-2 (]: 5 of 39 START sql table model dev_thaina_intermediate.int_sales ................ [RUN]
[0m22:44:07.157540 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_address
[0m22:44:07.158723 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m22:44:07.159641 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_sales
[0m22:44:07.159221 [info ] [Thread-3 (]: 6 of 39 START sql table model dev_thaina_silver.stg_person_address ............. [RUN]
[0m22:44:07.165534 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m22:44:07.167697 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address'
[0m22:44:07.169801 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-06-27 22:44:07.160052 => 2023-06-27 22:44:07.169616
[0m22:44:07.172532 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.int_sales
[0m22:44:07.170876 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_address
[0m22:44:07.186010 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m22:44:07.198789 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
	from `dev_thaina_intermediate.int_sales_customer`	
)

, sales as (
	select * 
	from `dev_thaina_intermediate.int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, business_entity_id
		, person_type
		, name_style
		, courtesy_title
		, first_name
		, middle_name
		, last_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m22:44:07.201012 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Table desafiothaina:dev_thaina_intermediate.int_sales was not found in location US

Location: US
Job ID: 4ea7c008-25f7-4160-9da3-9eb74ec7b6f1

[0m22:44:07.203251 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_customer_and_sales (execute): 2023-06-27 22:44:05.885070 => 2023-06-27 22:44:07.203054
[0m22:44:07.213966 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:07.217363 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address"
[0m22:44:07.221769 [debug] [Thread-2 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with order_header as (
	select * 
	from `dev_thaina_silver.stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `dev_thaina_silver.stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `dev_thaina_silver.stg_sales_order_detail`	
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, sales_order_detail_id
		, carrier_tracking_number
		, order_qty
		, product_id
		, unit_price
		, unit_price_discount
	from order_header
	left join order_header_reason
	on order_header_reason.sales_order_id = order_header.sales_order_id
	left join order_detail 
	on order_detail.sales_order_id =  order_header.sales_order_id
)

select * from union_header_reason
    );
  
[0m22:44:07.222787 [debug] [Thread-4 (]: Runtime Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)
  404 Not found: Table desafiothaina:dev_thaina_intermediate.int_sales was not found in location US
  
  Location: US
  Job ID: 4ea7c008-25f7-4160-9da3-9eb74ec7b6f1
  
[0m22:44:07.258417 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address (compile): 2023-06-27 22:44:07.190236 => 2023-06-27 22:44:07.258263
[0m22:44:07.259933 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_address
[0m22:44:07.258958 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c955b10>]}
[0m22:44:07.263990 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address"
[0m22:44:07.264866 [error] [Thread-4 (]: 4 of 39 ERROR creating sql table model dev_thaina_intermediate.int_customer_and_sales  [[31mERROR[0m in 1.50s]
[0m22:44:07.266132 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_customer_and_sales
[0m22:44:07.266898 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_address_type
[0m22:44:07.267887 [info ] [Thread-4 (]: 7 of 39 START sql table model dev_thaina_silver.stg_person_address_type ........ [RUN]
[0m22:44:07.269383 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address_type'
[0m22:44:07.270353 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_address_type
[0m22:44:07.271023 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:44:07.278188 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address_type"
[0m22:44:07.281678 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
    );
  
[0m22:44:07.321017 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_address_type (compile): 2023-06-27 22:44:07.271436 => 2023-06-27 22:44:07.320669
[0m22:44:07.322410 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_address_type
[0m22:44:07.331072 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address_type"
[0m22:44:07.331952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:44:07.335245 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_address_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addresstypeid as address_type_id
    , name as address_type_name 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`addresstype`
)

select *
from source_data
    );
  
[0m22:44:08.196593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ebc1b7e5-a747-4a66-bb8f-339f1b40bbde&page=queryresults
[0m22:44:08.228805 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m22:44:08.233916 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-06-27 22:44:05.719106 => 2023-06-27 22:44:08.233712
[0m22:44:08.234810 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m22:44:08.273918 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with order_header as (
	select * 
	from `dev_thaina_silver.stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `dev_thaina_silver.stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `dev_thaina_silver.stg_sales_order_detail`	
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, sales_order_detail_id
		, carrier_tracking_number
		, order_qty
		, product_id
		, unit_price
		, unit_price_discount
	from order_header
	left join order_header_reason
	on order_header_reason.sales_order_id = order_header.sales_order_id
	left join order_detail 
	on order_detail.sales_order_id =  order_header.sales_order_id
)

select * from union_header_reason
    );
  
[0m22:44:08.274518 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Table desafiothaina:dev_thaina_silver.stg_sales_order_detail was not found in location US

Location: US
Job ID: 38663f4b-922f-4316-a3d9-778888004e10

[0m22:44:08.275244 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-06-27 22:44:07.173545 => 2023-06-27 22:44:08.275140
[0m22:44:08.276926 [debug] [Thread-2 (]: Runtime Error in model int_sales (models/intermediate/int_sales.sql)
  404 Not found: Table desafiothaina:dev_thaina_silver.stg_sales_order_detail was not found in location US
  
  Location: US
  Job ID: 38663f4b-922f-4316-a3d9-778888004e10
  
[0m22:44:08.277876 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c847ee0>]}
[0m22:44:08.279091 [error] [Thread-2 (]: 5 of 39 ERROR creating sql table model dev_thaina_intermediate.int_sales ....... [[31mERROR[0m in 1.12s]
[0m22:44:08.281036 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_sales
[0m22:44:08.282238 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_business_entity_address
[0m22:44:08.283200 [info ] [Thread-2 (]: 8 of 39 START sql table model dev_thaina_silver.stg_person_business_entity_address  [RUN]
[0m22:44:08.284623 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_address'
[0m22:44:08.285252 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_address
[0m22:44:08.294276 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_address"
[0m22:44:08.295192 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (compile): 2023-06-27 22:44:08.285691 => 2023-06-27 22:44:08.295033
[0m22:44:08.295875 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_business_entity_address
[0m22:44:08.325988 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_address"
[0m22:44:08.328329 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:08.334278 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_business_entity_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , addressid as address_id
    , addresstypeid as address_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentityaddress`
)

select *
from source_data
    );
  
[0m22:44:08.531538 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m22:44:08.532174 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      


/* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m22:44:11.019306 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7734f70f-22c0-4fc7-be66-6e6ba58dd248&page=queryresults
[0m22:44:11.041743 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_address_type (execute): 2023-06-27 22:44:07.323400 => 2023-06-27 22:44:11.041665
[0m22:44:11.042796 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c8ba620>]}
[0m22:44:11.043483 [info ] [Thread-4 (]: 7 of 39 OK created sql table model dev_thaina_silver.stg_person_address_type ... [[32mCREATE TABLE (6.0 rows, 332.0 Bytes processed)[0m in 3.77s]
[0m22:44:11.044259 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_address_type
[0m22:44:11.044966 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_contact
[0m22:44:11.045856 [info ] [Thread-4 (]: 9 of 39 START sql table model dev_thaina_silver.stg_person_business_entity_contact  [RUN]
[0m22:44:11.047212 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_contact'
[0m22:44:11.047843 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_contact
[0m22:44:11.052891 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m22:44:11.053801 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (compile): 2023-06-27 22:44:11.048267 => 2023-06-27 22:44:11.053673
[0m22:44:11.054276 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_business_entity_contact
[0m22:44:11.061602 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m22:44:11.062514 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:44:11.065498 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_business_entity_contact: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_contact"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , personid as person_id
    , contacttypeid as contact_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentitycontact`
)

select *
from source_data
    );
  
[0m22:44:11.560120 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b9d12e80-8683-49a9-b770-c8d95d4374b4&page=queryresults
[0m22:44:11.562624 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address (execute): 2023-06-27 22:44:07.260345 => 2023-06-27 22:44:11.562558
[0m22:44:11.563666 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c8bb670>]}
[0m22:44:11.564380 [info ] [Thread-3 (]: 6 of 39 OK created sql table model dev_thaina_silver.stg_person_address ........ [[32mCREATE TABLE (19.6k rows, 1.7 MB processed)[0m in 4.40s]
[0m22:44:11.565134 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_address
[0m22:44:11.565967 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_contact_type
[0m22:44:11.566757 [info ] [Thread-3 (]: 10 of 39 START sql table model dev_thaina_silver.stg_person_contact_type ....... [RUN]
[0m22:44:11.568018 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_contact_type'
[0m22:44:11.568479 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_contact_type
[0m22:44:11.573778 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_contact_type"
[0m22:44:11.574902 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_contact_type (compile): 2023-06-27 22:44:11.568886 => 2023-06-27 22:44:11.574684
[0m22:44:11.575970 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_contact_type
[0m22:44:11.583141 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_contact_type"
[0m22:44:11.584494 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:44:11.587703 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_contact_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_contact_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    contacttypeid as contact_type_id
    , name as contact_type_name 
  from  `desafiothaina`.`dev_thaina`.`contacttype`
)

select *
from source_data
    );
  
[0m22:44:12.863907 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:86029686-4782-4e72-a78f-796de8e4c178&page=queryresults
[0m22:44:12.870382 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (execute): 2023-06-27 22:44:08.296306 => 2023-06-27 22:44:12.870313
[0m22:44:12.871607 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c78fac0>]}
[0m22:44:12.872234 [info ] [Thread-2 (]: 8 of 39 OK created sql table model dev_thaina_silver.stg_person_business_entity_address  [[32mCREATE TABLE (19.6k rows, 1.2 MB processed)[0m in 4.59s]
[0m22:44:12.873030 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_business_entity_address
[0m22:44:12.873870 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_country_region
[0m22:44:12.874700 [info ] [Thread-2 (]: 11 of 39 START sql table model dev_thaina_silver.stg_person_country_region ..... [RUN]
[0m22:44:12.875899 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_country_region'
[0m22:44:12.876355 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_country_region
[0m22:44:12.891892 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_country_region"
[0m22:44:12.893020 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_country_region (compile): 2023-06-27 22:44:12.876632 => 2023-06-27 22:44:12.892809
[0m22:44:12.894023 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_country_region
[0m22:44:12.906318 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_country_region"
[0m22:44:12.908589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:12.913053 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_country_region: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_country_region"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
    );
  
[0m22:44:13.433098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:daeff7f4-bd5d-41c3-bf27-0b340dc73ec7&page=queryresults
[0m22:44:14.296343 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-06-27 22:44:08.235389 => 2023-06-27 22:44:14.296253
[0m22:44:14.297595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c955d50>]}
[0m22:44:14.298467 [info ] [Thread-1 (]: 1 of 39 OK created sql table model dev_thaina_gold.dim_dates ................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 8.58s]
[0m22:44:14.299356 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m22:44:14.300042 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_person_person
[0m22:44:14.300871 [info ] [Thread-1 (]: 12 of 39 START sql table model dev_thaina_silver.stg_person_person ............. [RUN]
[0m22:44:14.302327 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_person'
[0m22:44:14.302882 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_person_person
[0m22:44:14.308541 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_person"
[0m22:44:14.309507 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_person_person (compile): 2023-06-27 22:44:14.303227 => 2023-06-27 22:44:14.309367
[0m22:44:14.310294 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_person_person
[0m22:44:14.319089 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_person"
[0m22:44:14.320554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:14.324243 [debug] [Thread-1 (]: On model.desafioaethaina.stg_person_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
    );
  
[0m22:44:14.952934 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6ccadb51-942f-4668-abe5-2d3c59a1d00f&page=queryresults
[0m22:44:14.957047 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (execute): 2023-06-27 22:44:11.054712 => 2023-06-27 22:44:14.956971
[0m22:44:14.959105 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548dfc220>]}
[0m22:44:14.960492 [info ] [Thread-4 (]: 9 of 39 OK created sql table model dev_thaina_silver.stg_person_business_entity_contact  [[32mCREATE TABLE (909.0 rows, 55.0 KB processed)[0m in 3.91s]
[0m22:44:14.961650 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_contact
[0m22:44:14.962552 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_state_province
[0m22:44:14.963445 [info ] [Thread-4 (]: 13 of 39 START sql table model dev_thaina_silver.stg_person_state_province ..... [RUN]
[0m22:44:14.964975 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_state_province'
[0m22:44:14.965693 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_state_province
[0m22:44:14.972176 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_state_province"
[0m22:44:14.973352 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_state_province (compile): 2023-06-27 22:44:14.966184 => 2023-06-27 22:44:14.973168
[0m22:44:14.974290 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_state_province
[0m22:44:14.984251 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_state_province"
[0m22:44:14.986589 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:44:15.000318 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_state_province: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_state_province"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
    );
  
[0m22:44:15.330929 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:069b4385-829f-46aa-8d89-a34a73cc74b5&page=queryresults
[0m22:44:15.334885 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_contact_type (execute): 2023-06-27 22:44:11.576749 => 2023-06-27 22:44:15.334817
[0m22:44:15.336239 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c9559c0>]}
[0m22:44:15.336876 [info ] [Thread-3 (]: 10 of 39 OK created sql table model dev_thaina_silver.stg_person_contact_type .. [[32mCREATE TABLE (20.0 rows, 595.0 Bytes processed)[0m in 3.77s]
[0m22:44:15.337668 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_contact_type
[0m22:44:15.338536 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product
[0m22:44:15.339321 [info ] [Thread-3 (]: 14 of 39 START sql table model dev_thaina_silver.stg_product ................... [RUN]
[0m22:44:15.341316 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product'
[0m22:44:15.342315 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product
[0m22:44:15.348818 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product"
[0m22:44:15.350015 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product (compile): 2023-06-27 22:44:15.342660 => 2023-06-27 22:44:15.349761
[0m22:44:15.351132 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product
[0m22:44:15.362692 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product"
[0m22:44:15.363545 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:44:15.365966 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , productmodelid as product_model_id
    , productsubcategoryid as product_subcategory_id
    , name as product_name
    , productnumber as product_number
    , makeflag
    , finishedgoodsflag as finished_goods_flag
    , color
    , safetystocklevel as safety_stock_level
    , standardcost as stand_cost
    , listprice as list_price
    , size as size_product
    , style as style_product
    , weight as weight_product 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`product`
)

select * from source_data
    );
  
[0m22:44:16.549446 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bc752bb3-9f01-4f4a-a175-c5bbef1003c8&page=queryresults
[0m22:44:16.553187 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_country_region (execute): 2023-06-27 22:44:12.894602 => 2023-06-27 22:44:16.553105
[0m22:44:16.556112 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d8fbb0>]}
[0m22:44:16.557000 [info ] [Thread-2 (]: 11 of 39 OK created sql table model dev_thaina_silver.stg_person_country_region  [[32mCREATE TABLE (238.0 rows, 3.7 KB processed)[0m in 3.68s]
[0m22:44:16.557820 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_country_region
[0m22:44:16.558593 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_category
[0m22:44:16.559458 [info ] [Thread-2 (]: 15 of 39 START sql table model dev_thaina_silver.stg_product_category .......... [RUN]
[0m22:44:16.560809 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_category'
[0m22:44:16.561254 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_category
[0m22:44:16.567057 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_category"
[0m22:44:16.569952 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_category (compile): 2023-06-27 22:44:16.561679 => 2023-06-27 22:44:16.569706
[0m22:44:16.572062 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product_category
[0m22:44:16.579414 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_category"
[0m22:44:16.581567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:16.588052 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product_category: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_category"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productcategoryid as category_id
    , name as category_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productcategory`
)

select *
from source_data
    );
  
[0m22:44:18.445707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:74ac12e8-3a3b-44d7-9a1c-bc819313efb2&page=queryresults
[0m22:44:18.448213 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_person_person (execute): 2023-06-27 22:44:14.310776 => 2023-06-27 22:44:18.448143
[0m22:44:18.449346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c954df0>]}
[0m22:44:18.450571 [info ] [Thread-1 (]: 12 of 39 OK created sql table model dev_thaina_silver.stg_person_person ........ [[32mCREATE TABLE (20.0k rows, 1.5 MB processed)[0m in 4.15s]
[0m22:44:18.451684 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_person_person
[0m22:44:18.452584 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_description
[0m22:44:18.454810 [info ] [Thread-1 (]: 16 of 39 START sql table model dev_thaina_silver.stg_product_description ....... [RUN]
[0m22:44:18.464429 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_description'
[0m22:44:18.465578 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_description
[0m22:44:18.474264 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_description"
[0m22:44:18.475429 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_description (compile): 2023-06-27 22:44:18.467536 => 2023-06-27 22:44:18.475204
[0m22:44:18.476461 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_description
[0m22:44:18.496817 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_description"
[0m22:44:18.500172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:18.505287 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_description: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_description"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_description`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productdescriptionid as product_description_id
    , description as product_description
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productdescription`
)

select *
from source_data
    );
  
[0m22:44:18.783976 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cd86c74d-4360-4987-8397-58c1159f0747&page=queryresults
[0m22:44:18.789088 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_state_province (execute): 2023-06-27 22:44:14.975040 => 2023-06-27 22:44:18.788974
[0m22:44:18.794877 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c955a80>]}
[0m22:44:18.796300 [info ] [Thread-4 (]: 13 of 39 OK created sql table model dev_thaina_silver.stg_person_state_province  [[32mCREATE TABLE (181.0 rows, 13.4 KB processed)[0m in 3.83s]
[0m22:44:18.798166 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_state_province
[0m22:44:18.801384 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_inventory
[0m22:44:18.805089 [info ] [Thread-4 (]: 17 of 39 START sql table model dev_thaina_silver.stg_product_inventory ......... [RUN]
[0m22:44:18.807041 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_inventory'
[0m22:44:18.807897 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_inventory
[0m22:44:18.818831 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_inventory"
[0m22:44:18.820356 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_inventory (compile): 2023-06-27 22:44:18.808568 => 2023-06-27 22:44:18.820160
[0m22:44:18.821457 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product_inventory
[0m22:44:18.839762 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_inventory"
[0m22:44:18.841255 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:44:18.846577 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product_inventory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_inventory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , locationid as location_id
    , shelf
    , bin
    , quantity as quantity_inventory
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productinventory`
)

select *
from source_data
    );
  
[0m22:44:18.999392 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ad8ecc8b-b66e-4823-bc35-f290706f0a5f&page=queryresults
[0m22:44:19.002802 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product (execute): 2023-06-27 22:44:15.351910 => 2023-06-27 22:44:19.002732
[0m22:44:19.004112 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c88e0e0>]}
[0m22:44:19.005165 [info ] [Thread-3 (]: 14 of 39 OK created sql table model dev_thaina_silver.stg_product .............. [[32mCREATE TABLE (504.0 rows, 60.1 KB processed)[0m in 3.66s]
[0m22:44:19.006330 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product
[0m22:44:19.007353 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_location
[0m22:44:19.008429 [info ] [Thread-3 (]: 18 of 39 START sql table model dev_thaina_silver.stg_product_location .......... [RUN]
[0m22:44:19.010498 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_location'
[0m22:44:19.011110 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_location
[0m22:44:19.018042 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_location"
[0m22:44:19.021933 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_location (compile): 2023-06-27 22:44:19.011684 => 2023-06-27 22:44:19.021661
[0m22:44:19.023059 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_location
[0m22:44:19.034016 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_location"
[0m22:44:19.035584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:44:19.043293 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_location: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_location"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    locationid as location_id
    , name as location_name
    -- Standard hourly cost of the manufacturing location.
    , costrate as cost_rate
    -- Work capacity (in hours) of the manufacturing location.
    , availability 
  from  `desafiothaina`.`dev_thaina`.`location`
)

select *
from source_data
    );
  
[0m22:44:20.503884 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ddba280b-6411-4bea-82a5-c845a931b7f4&page=queryresults
[0m22:44:20.507357 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_category (execute): 2023-06-27 22:44:16.572901 => 2023-06-27 22:44:20.507252
[0m22:44:20.510213 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c9555d0>]}
[0m22:44:20.512083 [info ] [Thread-2 (]: 15 of 39 OK created sql table model dev_thaina_silver.stg_product_category ..... [[32mCREATE TABLE (4.0 rows, 226.0 Bytes processed)[0m in 3.95s]
[0m22:44:20.513783 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_category
[0m22:44:20.514631 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_model
[0m22:44:20.515665 [info ] [Thread-2 (]: 19 of 39 START sql table model dev_thaina_silver.stg_product_model ............. [RUN]
[0m22:44:20.517446 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_model'
[0m22:44:20.519148 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_model
[0m22:44:20.526884 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_model"
[0m22:44:20.530545 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_model (compile): 2023-06-27 22:44:20.520366 => 2023-06-27 22:44:20.530214
[0m22:44:20.532561 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product_model
[0m22:44:20.544672 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_model"
[0m22:44:20.546265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:20.550583 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product_model: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_model"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productmodelid as model_id
    , name as model_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productmodel`
)

select *
from source_data
    );
  
[0m22:44:22.693292 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9aca9f99-5b3f-4227-a737-cd3530a71f6f&page=queryresults
[0m22:44:22.697228 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_inventory (execute): 2023-06-27 22:44:18.822621 => 2023-06-27 22:44:22.697156
[0m22:44:22.698466 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548cefd60>]}
[0m22:44:22.699080 [info ] [Thread-4 (]: 17 of 39 OK created sql table model dev_thaina_silver.stg_product_inventory .... [[32mCREATE TABLE (1.1k rows, 76.8 KB processed)[0m in 3.89s]
[0m22:44:22.700040 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_inventory
[0m22:44:22.702494 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_subcategory
[0m22:44:22.703421 [info ] [Thread-4 (]: 20 of 39 START sql table model dev_thaina_silver.stg_product_subcategory ....... [RUN]
[0m22:44:22.704933 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_subcategory'
[0m22:44:22.705623 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_subcategory
[0m22:44:22.719704 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c29ceed9-cdb7-4c19-a22a-ae78e7b753b8&page=queryresults
[0m22:44:22.730219 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_subcategory"
[0m22:44:22.732097 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_subcategory (compile): 2023-06-27 22:44:22.706131 => 2023-06-27 22:44:22.731726
[0m22:44:22.733513 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product_subcategory
[0m22:44:22.747793 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_location (execute): 2023-06-27 22:44:19.023684 => 2023-06-27 22:44:22.747548
[0m22:44:22.750198 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c955690>]}
[0m22:44:22.752183 [info ] [Thread-3 (]: 18 of 39 OK created sql table model dev_thaina_silver.stg_product_location ..... [[32mCREATE TABLE (14.0 rows, 670.0 Bytes processed)[0m in 3.74s]
[0m22:44:22.754094 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_location
[0m22:44:22.755238 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m22:44:22.758630 [info ] [Thread-3 (]: 21 of 39 START sql table model dev_thaina_silver.stg_purchase_order_detail ..... [RUN]
[0m22:44:22.760303 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m22:44:22.761436 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m22:44:22.757752 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_subcategory"
[0m22:44:22.775408 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:44:22.778416 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product_subcategory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_subcategory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productsubcategoryid as subcategory_id
    , productcategoryid as category_id
    , name as subcategory_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productsubcategory`
)

select *
from source_data
    );
  
[0m22:44:22.780346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4752b2f0-8d5b-4d5e-945a-dfcffabf4131&page=queryresults
[0m22:44:22.787641 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_description (execute): 2023-06-27 22:44:18.477203 => 2023-06-27 22:44:22.787491
[0m22:44:22.791037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c954ee0>]}
[0m22:44:22.782004 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m22:44:22.794437 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-06-27 22:44:22.761952 => 2023-06-27 22:44:22.794177
[0m22:44:22.795328 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchase_order_detail
[0m22:44:22.792461 [info ] [Thread-1 (]: 16 of 39 OK created sql table model dev_thaina_silver.stg_product_description .. [[32mCREATE TABLE (762.0 rows, 125.4 KB processed)[0m in 4.33s]
[0m22:44:22.855059 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_description
[0m22:44:22.856381 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchase_order_header
[0m22:44:22.857208 [info ] [Thread-1 (]: 22 of 39 START sql table model dev_thaina_silver.stg_purchase_order_header ..... [RUN]
[0m22:44:22.859106 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_header'
[0m22:44:22.859937 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchase_order_header
[0m22:44:22.874484 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_detail"
[0m22:44:22.879069 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:44:22.886177 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchase_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , purchaseorderdetailid as purchase_order_detail_id
    , duedate as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m22:44:22.889874 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_header"
[0m22:44:22.935694 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (compile): 2023-06-27 22:44:22.860638 => 2023-06-27 22:44:22.935540
[0m22:44:22.936689 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchase_order_header
[0m22:44:22.949617 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_header"
[0m22:44:22.951649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.954697 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchase_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    purchaseorderid as purchase_order_id
    , revisionnumber as revision_number
    , status as status_order
    , employeeid as employee_id
    , vendorid as vendor_id
    , shipmethodid as ship_method_id
    , shipdate as ship_date
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight  
    /* Total due to vendor. Computed as Subtotal + TaxAmt + Freight.
Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0))  */
  from
    `desafiothaina`.`dev_thaina`.`purchaseorderheader`
)

select * 
  from source_data
    );
  
[0m22:44:24.433641 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:99c9158a-3424-450c-9045-95f452b9d5d7&page=queryresults
[0m22:44:24.436181 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_model (execute): 2023-06-27 22:44:20.533537 => 2023-06-27 22:44:24.436112
[0m22:44:24.437060 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c88e110>]}
[0m22:44:24.437914 [info ] [Thread-2 (]: 19 of 39 OK created sql table model dev_thaina_silver.stg_product_model ........ [[32mCREATE TABLE (128.0 rows, 8.0 KB processed)[0m in 3.92s]
[0m22:44:24.439070 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_model
[0m22:44:24.440152 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_purchasing_product_vendor
[0m22:44:24.441090 [info ] [Thread-2 (]: 23 of 39 START sql table model dev_thaina_silver.stg_purchasing_product_vendor . [RUN]
[0m22:44:24.442982 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_product_vendor'
[0m22:44:24.443647 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_purchasing_product_vendor
[0m22:44:24.453604 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m22:44:24.455217 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (compile): 2023-06-27 22:44:24.444085 => 2023-06-27 22:44:24.454996
[0m22:44:24.457358 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_purchasing_product_vendor
[0m22:44:24.634548 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m22:44:24.635536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:24.638935 [debug] [Thread-2 (]: On model.desafioaethaina.stg_purchasing_product_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_product_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_product_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , productid as product_id
    , standardprice as standard_price
    , minorderqty as min_order_qty
    , maxorderqty as max_order_qty
    , onorderqty as on_order_qty
    , unitmeasurecode as unit_measure_code
  from  `desafiothaina`.`dev_thaina`.`productvendor`
)

select *
from source_data
    );
  
[0m22:44:27.202523 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:325715c7-7286-4974-b455-e0645c0e0e5c&page=queryresults
[0m22:44:27.203112 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9e84914d-f336-43ab-a821-07d678883595&page=queryresults
[0m22:44:27.206164 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (execute): 2023-06-27 22:44:22.795836 => 2023-06-27 22:44:27.206018
[0m22:44:27.209340 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (execute): 2023-06-27 22:44:22.937285 => 2023-06-27 22:44:27.209204
[0m22:44:27.211230 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d71fc0>]}
[0m22:44:27.212704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d720e0>]}
[0m22:44:27.213504 [info ] [Thread-3 (]: 21 of 39 OK created sql table model dev_thaina_silver.stg_purchase_order_detail  [[32mCREATE TABLE (8.8k rows, 837.9 KB processed)[0m in 4.45s]
[0m22:44:27.216475 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m22:44:27.215067 [info ] [Thread-1 (]: 22 of 39 OK created sql table model dev_thaina_silver.stg_purchase_order_header  [[32mCREATE TABLE (4.0k rows, 380.0 KB processed)[0m in 4.35s]
[0m22:44:27.218170 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchase_order_header
[0m22:44:27.219008 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchasing_vendor
[0m22:44:27.217291 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchasing_ship_method
[0m22:44:27.219886 [info ] [Thread-1 (]: 25 of 39 START sql table model dev_thaina_silver.stg_purchasing_vendor ......... [RUN]
[0m22:44:27.222266 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_vendor'
[0m22:44:27.220934 [info ] [Thread-3 (]: 24 of 39 START sql table model dev_thaina_silver.stg_purchasing_ship_method .... [RUN]
[0m22:44:27.223047 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchasing_vendor
[0m22:44:27.224282 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_ship_method'
[0m22:44:27.235057 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchasing_ship_method
[0m22:44:27.233319 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_vendor"
[0m22:44:27.244822 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (compile): 2023-06-27 22:44:27.225066 => 2023-06-27 22:44:27.244674
[0m22:44:27.245798 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchasing_vendor
[0m22:44:27.243730 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m22:44:27.258073 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (compile): 2023-06-27 22:44:27.235560 => 2023-06-27 22:44:27.257914
[0m22:44:27.259242 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchasing_ship_method
[0m22:44:27.256712 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_vendor"
[0m22:44:27.267041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:27.271861 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchasing_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , accountnumber as account_number
    , name as company_name
    -- 1 = Superior, 2 = Excellent, 3 = Above average, 4 = Average, 5 = Below
    , creditrating as credit_rate
    , activeflag as active_flag
  from  `desafiothaina`.`dev_thaina`.`vendor`
)

select *
from source_data
    );
  
[0m22:44:27.278722 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m22:44:27.324324 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:44:27.329961 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5066e33f-3ea9-4010-9867-8887228336b8&page=queryresults
[0m22:44:27.334404 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchasing_ship_method: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_ship_method"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
    );
  
[0m22:44:27.340789 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_subcategory (execute): 2023-06-27 22:44:22.734146 => 2023-06-27 22:44:27.340681
[0m22:44:27.381424 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548de4400>]}
[0m22:44:27.382359 [info ] [Thread-4 (]: 20 of 39 OK created sql table model dev_thaina_silver.stg_product_subcategory .. [[32mCREATE TABLE (37.0 rows, 2.3 KB processed)[0m in 4.68s]
[0m22:44:27.383428 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_subcategory
[0m22:44:27.384429 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_country_region_currency
[0m22:44:27.385360 [info ] [Thread-4 (]: 26 of 39 START sql table model dev_thaina_silver.stg_sales_country_region_currency  [RUN]
[0m22:44:27.387062 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_country_region_currency'
[0m22:44:27.388054 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_country_region_currency
[0m22:44:27.395068 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m22:44:27.396534 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (compile): 2023-06-27 22:44:27.388521 => 2023-06-27 22:44:27.396260
[0m22:44:27.397471 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_country_region_currency
[0m22:44:27.415598 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m22:44:27.417644 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:44:27.421153 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_country_region_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_country_region_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_country_region_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
      countryregioncode as country_region_code
      , currencycode as currency_code
    from `desafiothaina`.`dev_thaina`.`countryregioncurrency`
  )
select  *
from source_data
    );
  
[0m22:44:28.528581 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a1e40fdb-b784-4cd4-9d87-d8722944f618&page=queryresults
[0m22:44:28.531207 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (execute): 2023-06-27 22:44:24.458052 => 2023-06-27 22:44:28.531135
[0m22:44:28.532691 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548defa60>]}
[0m22:44:28.533486 [info ] [Thread-2 (]: 23 of 39 OK created sql table model dev_thaina_silver.stg_purchasing_product_vendor  [[32mCREATE TABLE (460.0 rows, 21.4 KB processed)[0m in 4.09s]
[0m22:44:28.534339 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_purchasing_product_vendor
[0m22:44:28.535059 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_currency
[0m22:44:28.535937 [info ] [Thread-2 (]: 27 of 39 START sql table model dev_thaina_silver.stg_sales_currency ............ [RUN]
[0m22:44:28.537412 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency'
[0m22:44:28.538041 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_currency
[0m22:44:28.546770 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency"
[0m22:44:28.548237 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_currency (compile): 2023-06-27 22:44:28.538640 => 2023-06-27 22:44:28.547974
[0m22:44:28.549258 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_currency
[0m22:44:28.562787 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency"
[0m22:44:28.564292 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:28.567493 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    currencycode as currency_code
    , name as currency_name
  from  `desafiothaina`.`dev_thaina`.`currency`
)

select *
from source_data
    );
  
[0m22:44:31.316353 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2a8cc1d1-0d82-4e24-a7f8-6081578e51ee&page=queryresults
[0m22:44:31.320184 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (execute): 2023-06-27 22:44:27.260261 => 2023-06-27 22:44:31.320110
[0m22:44:31.321480 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d72410>]}
[0m22:44:31.322521 [info ] [Thread-3 (]: 24 of 39 OK created sql table model dev_thaina_silver.stg_purchasing_ship_method  [[32mCREATE TABLE (5.0 rows, 400.0 Bytes processed)[0m in 4.10s]
[0m22:44:31.323857 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchasing_ship_method
[0m22:44:31.324999 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_currency_rate
[0m22:44:31.326174 [info ] [Thread-3 (]: 28 of 39 START sql table model dev_thaina_silver.stg_sales_currency_rate ....... [RUN]
[0m22:44:31.327720 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency_rate'
[0m22:44:31.328694 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_currency_rate
[0m22:44:31.334053 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency_rate"
[0m22:44:31.335058 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (compile): 2023-06-27 22:44:31.329555 => 2023-06-27 22:44:31.334917
[0m22:44:31.335750 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_currency_rate
[0m22:44:31.343179 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency_rate"
[0m22:44:31.344007 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:44:31.347324 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      currencyrateid as currency_rate_id
      , currencyratedate as currency_rate_date
      , fromcurrencycode as from_currency_code
      , tocurrencycode as to_currency_code
      , averagerate as avg_rate
      , endofdayrate as end_of_day_rate
    from `desafiothaina`.`dev_thaina`.`currencyrate`
  )
select  *
from source_data
    );
  
[0m22:44:31.574017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3235aab8-1d33-4907-ad36-4a81bccae323&page=queryresults
[0m22:44:31.576852 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (execute): 2023-06-27 22:44:27.246419 => 2023-06-27 22:44:31.576780
[0m22:44:31.577800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d73c40>]}
[0m22:44:31.628135 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:924f0d2d-d7a0-4578-ac78-68bb4df0d7d8&page=queryresults
[0m22:44:31.631507 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (execute): 2023-06-27 22:44:27.398143 => 2023-06-27 22:44:31.631402
[0m22:44:31.634816 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548de6560>]}
[0m22:44:32.203288 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1bb8afd1-1e63-4194-8583-1fd318a3927b&page=queryresults
[0m22:44:32.205882 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_currency (execute): 2023-06-27 22:44:28.550054 => 2023-06-27 22:44:32.205785
[0m22:44:32.207267 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548cb08e0>]}
[0m22:44:33.547617 [info ] [Thread-1 (]: 25 of 39 OK created sql table model dev_thaina_silver.stg_purchasing_vendor .... [[32mCREATE TABLE (104.0 rows, 5.1 KB processed)[0m in 4.36s]
[0m22:44:33.548302 [info ] [Thread-4 (]: 26 of 39 OK created sql table model dev_thaina_silver.stg_sales_country_region_currency  [[32mCREATE TABLE (109.0 rows, 981.0 Bytes processed)[0m in 4.25s]
[0m22:44:33.549092 [info ] [Thread-2 (]: 27 of 39 OK created sql table model dev_thaina_silver.stg_sales_currency ....... [[32mCREATE TABLE (105.0 rows, 2.0 KB processed)[0m in 3.67s]
[0m22:44:33.550650 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchasing_vendor
[0m22:44:33.551401 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_country_region_currency
[0m22:44:33.552064 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_currency
[0m22:44:33.552813 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_customer
[0m22:44:33.553560 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_order_detail
[0m22:44:33.554557 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m22:44:33.556232 [info ] [Thread-4 (]: 30 of 39 START sql table model dev_thaina_silver.stg_sales_order_detail ........ [RUN]
[0m22:44:33.555473 [info ] [Thread-1 (]: 29 of 39 START sql table model dev_thaina_silver.stg_sales_customer ............ [RUN]
[0m22:44:33.560330 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_detail'
[0m22:44:33.563870 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_order_detail
[0m22:44:33.558378 [info ] [Thread-2 (]: 31 of 39 START sql table model dev_thaina_silver.stg_sales_order_header ........ [RUN]
[0m22:44:33.561614 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_customer'
[0m22:44:33.574979 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_customer
[0m22:44:33.573746 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m22:44:33.571708 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_detail"
[0m22:44:33.581830 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m22:44:33.584616 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (compile): 2023-06-27 22:44:33.564362 => 2023-06-27 22:44:33.584242
[0m22:44:33.598733 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m22:44:33.610980 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_order_detail
[0m22:44:33.612019 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_customer"
[0m22:44:33.618982 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-06-27 22:44:33.588394 => 2023-06-27 22:44:33.618663
[0m22:44:33.622921 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_detail"
[0m22:44:33.623514 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m22:44:33.623842 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_customer (compile): 2023-06-27 22:44:33.575992 => 2023-06-27 22:44:33.623757
[0m22:44:33.629870 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_customer
[0m22:44:33.632729 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m22:44:33.640741 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_customer"
[0m22:44:33.641129 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:44:33.642017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:33.642484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:33.645506 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
    );
  
[0m22:44:33.648058 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
    );
  
[0m22:44:33.684225 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , orderdate as order_date
    , duedate as due_date
    , shipdate as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m22:44:35.169065 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d6482a91-447c-4e63-ae9a-5188ebf5f2fb&page=queryresults
[0m22:44:35.171659 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (execute): 2023-06-27 22:44:31.336241 => 2023-06-27 22:44:35.171592
[0m22:44:35.172987 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d72770>]}
[0m22:44:35.173952 [info ] [Thread-3 (]: 28 of 39 OK created sql table model dev_thaina_silver.stg_sales_currency_rate .. [[32mCREATE TABLE (13.5k rows, 779.7 KB processed)[0m in 3.85s]
[0m22:44:35.175020 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_currency_rate
[0m22:44:35.175937 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_order_header_reason
[0m22:44:35.176929 [info ] [Thread-3 (]: 32 of 39 START sql table model dev_thaina_silver.stg_sales_order_header_reason . [RUN]
[0m22:44:35.179288 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header_reason'
[0m22:44:35.179975 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_order_header_reason
[0m22:44:35.187474 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m22:44:35.188707 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (compile): 2023-06-27 22:44:35.180476 => 2023-06-27 22:44:35.188538
[0m22:44:35.189762 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_order_header_reason
[0m22:44:35.202174 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m22:44:35.203996 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:44:35.208765 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_order_header_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
    );
  
[0m22:44:38.059198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1f6e3afc-d4a6-46f4-823a-03ccc3218ac9&page=queryresults
[0m22:44:38.063743 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_customer (execute): 2023-06-27 22:44:33.633148 => 2023-06-27 22:44:38.063679
[0m22:44:38.065250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d730d0>]}
[0m22:44:38.066011 [info ] [Thread-1 (]: 29 of 39 OK created sql table model dev_thaina_silver.stg_sales_customer ....... [[32mCREATE TABLE (19.8k rows, 1.2 MB processed)[0m in 4.50s]
[0m22:44:38.066809 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_customer
[0m22:44:38.067862 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_person
[0m22:44:38.068675 [info ] [Thread-1 (]: 33 of 39 START sql table model dev_thaina_silver.stg_sales_person .............. [RUN]
[0m22:44:38.069900 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person'
[0m22:44:38.070391 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_person
[0m22:44:38.075838 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person"
[0m22:44:38.076774 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_person (compile): 2023-06-27 22:44:38.070809 => 2023-06-27 22:44:38.076620
[0m22:44:38.077728 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_person
[0m22:44:38.091464 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person"
[0m22:44:38.092829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:38.097233 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , territoryid as territory_id
      , salesquota as sales_quota
      , bonus
      , commissionpct as commission_pct
      , salesytd as sales_total
      , saleslastyear as sales_last_year
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salesperson`
  )

select  *
from source_data
    );
  
[0m22:44:38.347900 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a2004c57-d842-4443-bc04-5c1a422c70c5&page=queryresults
[0m22:44:38.350501 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-06-27 22:44:33.624306 => 2023-06-27 22:44:38.350432
[0m22:44:38.351577 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548c10d90>]}
[0m22:44:38.352351 [info ] [Thread-2 (]: 31 of 39 OK created sql table model dev_thaina_silver.stg_sales_order_header ... [[32mCREATE TABLE (31.5k rows, 7.4 MB processed)[0m in 4.78s]
[0m22:44:38.353217 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m22:44:38.353923 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_person_quota_history
[0m22:44:38.354766 [info ] [Thread-2 (]: 34 of 39 START sql table model dev_thaina_silver.stg_sales_person_quota_history  [RUN]
[0m22:44:38.356031 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person_quota_history'
[0m22:44:38.357395 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_person_quota_history
[0m22:44:38.364367 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m22:44:38.365228 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (compile): 2023-06-27 22:44:38.357924 => 2023-06-27 22:44:38.365092
[0m22:44:38.365860 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_person_quota_history
[0m22:44:38.376381 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m22:44:38.377323 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:38.380603 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_person_quota_history: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person_quota_history"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person_quota_history`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , quotadate as quota_date
      , salesquota as sales_quota
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salespersonquotahistory`
  )

select  *
from source_data
    );
  
[0m22:44:38.826967 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9ce14324-5b2c-41ec-a541-13f050e48cc5&page=queryresults
[0m22:44:38.829267 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (execute): 2023-06-27 22:44:35.190645 => 2023-06-27 22:44:38.829198
[0m22:44:38.830200 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d72800>]}
[0m22:44:38.830783 [info ] [Thread-3 (]: 32 of 39 OK created sql table model dev_thaina_silver.stg_sales_order_header_reason  [[32mCREATE TABLE (27.6k rows, 432.0 KB processed)[0m in 3.65s]
[0m22:44:38.831416 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_order_header_reason
[0m22:44:38.832222 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_reason
[0m22:44:38.833125 [info ] [Thread-3 (]: 35 of 39 START sql table model dev_thaina_silver.stg_sales_reason .............. [RUN]
[0m22:44:38.834493 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_reason'
[0m22:44:38.834987 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_reason
[0m22:44:38.840695 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_reason"
[0m22:44:38.842687 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_reason (compile): 2023-06-27 22:44:38.835389 => 2023-06-27 22:44:38.842330
[0m22:44:38.843644 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_reason
[0m22:44:38.869200 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_reason"
[0m22:44:38.870294 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:44:38.874190 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salesreasonid as sales_reason_id
      , name as name_reason
      , reasontype as reason_type
    from `desafiothaina`.`dev_thaina`.`salesreason`
  )

select  *
from source_data
    );
  
[0m22:44:38.929477 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:75689f31-5028-44cb-a78f-216d015bc986&page=queryresults
[0m22:44:38.933996 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (execute): 2023-06-27 22:44:33.613268 => 2023-06-27 22:44:38.933928
[0m22:44:38.935441 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d6fee0>]}
[0m22:44:38.936348 [info ] [Thread-4 (]: 30 of 39 OK created sql table model dev_thaina_silver.stg_sales_order_detail ... [[32mCREATE TABLE (121.3k rows, 10.8 MB processed)[0m in 5.38s]
[0m22:44:38.937543 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_order_detail
[0m22:44:38.938278 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_tax_rate
[0m22:44:38.940108 [info ] [Thread-4 (]: 36 of 39 START sql table model dev_thaina_silver.stg_sales_tax_rate ............ [RUN]
[0m22:44:38.942881 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_tax_rate'
[0m22:44:38.943482 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_tax_rate
[0m22:44:38.948896 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_tax_rate"
[0m22:44:38.950243 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (compile): 2023-06-27 22:44:38.943893 => 2023-06-27 22:44:38.950088
[0m22:44:38.951026 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_tax_rate
[0m22:44:38.963296 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_tax_rate"
[0m22:44:38.964352 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:44:38.969571 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_tax_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_tax_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_tax_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salestaxrateid as sales_tax_rate_id
      , stateprovinceid as state_province_id
      , taxtype as tax_type
      , taxrate as tax_rate
      , name as name_tax_rate_desciption
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salestaxrate`
  )

select  *
from source_data
    );
  
[0m22:44:41.901049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:da517b0a-b7c9-46e4-9148-5a7bfb850752&page=queryresults
[0m22:44:41.903519 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_person (execute): 2023-06-27 22:44:38.078753 => 2023-06-27 22:44:41.903449
[0m22:44:41.904598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d73790>]}
[0m22:44:41.905311 [info ] [Thread-1 (]: 33 of 39 OK created sql table model dev_thaina_silver.stg_sales_person ......... [[32mCREATE TABLE (17.0 rows, 1.5 KB processed)[0m in 3.84s]
[0m22:44:41.906185 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_person
[0m22:44:41.907550 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_territory
[0m22:44:41.908622 [info ] [Thread-1 (]: 37 of 39 START sql table model dev_thaina_silver.stg_sales_territory ........... [RUN]
[0m22:44:41.910168 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_territory'
[0m22:44:41.910840 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_territory
[0m22:44:41.917741 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_territory"
[0m22:44:41.918870 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_territory (compile): 2023-06-27 22:44:41.911283 => 2023-06-27 22:44:41.918705
[0m22:44:41.919629 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_territory
[0m22:44:41.934867 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_territory"
[0m22:44:41.937201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:41.940910 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_territory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_territory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
    );
  
[0m22:44:42.046353 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3824c341-32c3-4c9e-b9b1-90746807190d&page=queryresults
[0m22:44:42.048744 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (execute): 2023-06-27 22:44:38.366283 => 2023-06-27 22:44:42.048676
[0m22:44:42.049820 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548cb3340>]}
[0m22:44:42.050555 [info ] [Thread-2 (]: 34 of 39 OK created sql table model dev_thaina_silver.stg_sales_person_quota_history  [[32mCREATE TABLE (163.0 rows, 12.6 KB processed)[0m in 3.69s]
[0m22:44:42.051547 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_person_quota_history
[0m22:44:42.052756 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_customer
[0m22:44:42.053733 [info ] [Thread-2 (]: 38 of 39 SKIP relation dev_thaina_gold.dim_customer ............................ [[33mSKIP[0m]
[0m22:44:42.054817 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_customer
[0m22:44:42.055755 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_product
[0m22:44:42.056704 [info ] [Thread-2 (]: 39 of 39 START sql table model dev_thaina_intermediate.int_product ............. [RUN]
[0m22:44:42.061200 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m22:44:42.061957 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_product
[0m22:44:42.074223 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m22:44:42.075694 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-06-27 22:44:42.062392 => 2023-06-27 22:44:42.075468
[0m22:44:42.076489 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.int_product
[0m22:44:42.101193 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m22:44:42.102237 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:44:42.113446 [debug] [Thread-2 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_all as (
    select 
        product.product_id
        , product_model_id
        , subcategory_id
        , category.category_id
        , location.location_id
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , list_price
        , size_product
        , style_product
        , weight_product
        , location_name
        , cost_rate
        , availability
        , shelf
        , bin
        , quantity_inventory
        , model_name
    from product
    left join subcategory
    on product.product_subcategory_id = subcategory.subcategory_id
    left join category
    on subcategory.category_id = category.category_id
    left join inventory 
    on inventory.product_id = product.product_id
  	left join location
  	on location.location_id = inventory.location_id
    left join model
    on product.product_model_id = model.model_id
)

select * 
from union_all
    );
  
[0m22:44:42.520728 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:352610ea-8fa2-45c0-ad15-3d9df95a7fdf&page=queryresults
[0m22:44:42.524694 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (execute): 2023-06-27 22:44:38.954943 => 2023-06-27 22:44:42.524491
[0m22:44:42.526743 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c773160>]}
[0m22:44:42.527493 [info ] [Thread-4 (]: 36 of 39 OK created sql table model dev_thaina_silver.stg_sales_tax_rate ....... [[32mCREATE TABLE (29.0 rows, 2.6 KB processed)[0m in 3.59s]
[0m22:44:42.528391 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_tax_rate
[0m22:44:42.764436 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f6602630-2657-4a8d-b8ff-2bf7d506ca08&page=queryresults
[0m22:44:42.767527 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_reason (execute): 2023-06-27 22:44:38.845489 => 2023-06-27 22:44:42.767448
[0m22:44:42.769534 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d73d00>]}
[0m22:44:42.770476 [info ] [Thread-3 (]: 35 of 39 OK created sql table model dev_thaina_silver.stg_sales_reason ......... [[32mCREATE TABLE (10.0 rows, 305.0 Bytes processed)[0m in 3.94s]
[0m22:44:42.771209 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_reason
[0m22:44:45.447721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:82286c4f-a171-48a4-9b5f-1a4e8ec9370d&page=queryresults
[0m22:44:45.450213 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_territory (execute): 2023-06-27 22:44:41.920081 => 2023-06-27 22:44:45.450148
[0m22:44:45.451311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548d73a00>]}
[0m22:44:45.453572 [info ] [Thread-1 (]: 37 of 39 OK created sql table model dev_thaina_silver.stg_sales_territory ...... [[32mCREATE TABLE (10.0 rows, 925.0 Bytes processed)[0m in 3.54s]
[0m22:44:45.454527 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_territory
[0m22:44:46.045805 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4d4fde14-c0ac-40c4-91a7-87158d8ffcd3&page=queryresults
[0m22:44:46.049476 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-06-27 22:44:42.080264 => 2023-06-27 22:44:46.049354
[0m22:44:46.050771 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfebfe9-e825-4885-89dc-48d1aeaff4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548cb08e0>]}
[0m22:44:46.051485 [info ] [Thread-2 (]: 39 of 39 OK created sql table model dev_thaina_intermediate.int_product ........ [[32mCREATE TABLE (1.1k rows, 83.4 KB processed)[0m in 3.99s]
[0m22:44:46.052363 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_product
[0m22:44:46.054887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:44:46.056140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:44:46.057725 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_reason' was properly closed.
[0m22:44:46.058357 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_territory' was properly closed.
[0m22:44:46.059084 [debug] [MainThread]: Connection 'model.desafioaethaina.int_product' was properly closed.
[0m22:44:46.059613 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_tax_rate' was properly closed.
[0m22:44:46.060857 [info ] [MainThread]: 
[0m22:44:46.062583 [info ] [MainThread]: Finished running 39 table models in 0 hours 0 minutes and 43.75 seconds (43.75s).
[0m22:44:46.067685 [debug] [MainThread]: Command end result
[0m22:44:46.127007 [info ] [MainThread]: 
[0m22:44:46.128502 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:44:46.130123 [info ] [MainThread]: 
[0m22:44:46.131952 [error] [MainThread]: [33mRuntime Error in model int_address (models/intermediate/int_address.sql)[0m
[0m22:44:46.132887 [error] [MainThread]:   404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_address was not found in location US
[0m22:44:46.133729 [error] [MainThread]:   
[0m22:44:46.134376 [error] [MainThread]:   Location: US
[0m22:44:46.135561 [error] [MainThread]:   Job ID: b7e2f18a-76ee-41c5-a082-d54dc60a78b7
[0m22:44:46.137725 [error] [MainThread]:   
[0m22:44:46.139094 [info ] [MainThread]: 
[0m22:44:46.140988 [error] [MainThread]: [33mRuntime Error in model int_customer (models/intermediate/int_customer.sql)[0m
[0m22:44:46.141797 [error] [MainThread]:   404 Not found: Table desafiothaina:dev_thaina_silver.stg_person_country_region was not found in location US
[0m22:44:46.142831 [error] [MainThread]:   
[0m22:44:46.143898 [error] [MainThread]:   Location: US
[0m22:44:46.145132 [error] [MainThread]:   Job ID: a0fe8c98-f099-4449-aa64-78e55ec44aee
[0m22:44:46.146150 [error] [MainThread]:   
[0m22:44:46.146935 [info ] [MainThread]: 
[0m22:44:46.147740 [error] [MainThread]: [33mRuntime Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)[0m
[0m22:44:46.148669 [error] [MainThread]:   404 Not found: Table desafiothaina:dev_thaina_intermediate.int_sales was not found in location US
[0m22:44:46.149855 [error] [MainThread]:   
[0m22:44:46.151064 [error] [MainThread]:   Location: US
[0m22:44:46.152305 [error] [MainThread]:   Job ID: 4ea7c008-25f7-4160-9da3-9eb74ec7b6f1
[0m22:44:46.153496 [error] [MainThread]:   
[0m22:44:46.154204 [info ] [MainThread]: 
[0m22:44:46.155077 [error] [MainThread]: [33mRuntime Error in model int_sales (models/intermediate/int_sales.sql)[0m
[0m22:44:46.155883 [error] [MainThread]:   404 Not found: Table desafiothaina:dev_thaina_silver.stg_sales_order_detail was not found in location US
[0m22:44:46.156763 [error] [MainThread]:   
[0m22:44:46.157551 [error] [MainThread]:   Location: US
[0m22:44:46.158305 [error] [MainThread]:   Job ID: 38663f4b-922f-4316-a3d9-778888004e10
[0m22:44:46.159101 [error] [MainThread]:   
[0m22:44:46.159941 [info ] [MainThread]: 
[0m22:44:46.160991 [info ] [MainThread]: Done. PASS=34 WARN=0 ERROR=4 SKIP=1 TOTAL=39
[0m22:44:46.162142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c8ba740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c8bba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548bff010>]}
[0m22:44:46.162827 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 22:50:49.878554 | c4d8455b-9aa9-49ed-b776-cd234305d4b6 ==============================
[0m22:50:49.878554 [info ] [MainThread]: Running with dbt=1.4.6
[0m22:50:49.880557 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_person_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:50:49.880996 [debug] [MainThread]: Tracking: tracking
[0m22:50:49.883524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e3e63340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e3e62710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e3e62ec0>]}
[0m22:50:49.933243 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m22:50:50.068616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:50:50.069101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:50:50.082795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4d8455b-9aa9-49ed-b776-cd234305d4b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e39dded0>]}
[0m22:50:50.107227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4d8455b-9aa9-49ed-b776-cd234305d4b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e3c3f430>]}
[0m22:50:50.107958 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m22:50:50.108505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d8455b-9aa9-49ed-b776-cd234305d4b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e3c3f4f0>]}
[0m22:50:50.112062 [info ] [MainThread]: 
[0m22:50:50.114929 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:50:50.116396 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m22:50:50.117024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:51.211913 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m22:50:51.213007 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m22:50:51.213493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:51.214387 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m22:50:51.215728 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m22:50:51.216194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:51.251769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:51.253691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:52.588237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d8455b-9aa9-49ed-b776-cd234305d4b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e3c3c880>]}
[0m22:50:52.589426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:50:52.590166 [info ] [MainThread]: 
[0m22:50:52.599217 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_person_address
[0m22:50:52.600090 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_silver.stg_person_address .............. [RUN]
[0m22:50:52.601864 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address'
[0m22:50:52.602537 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_person_address
[0m22:50:52.609572 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address"
[0m22:50:52.610660 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_person_address (compile): 2023-06-27 22:50:52.603063 => 2023-06-27 22:50:52.610415
[0m22:50:52.611377 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_person_address
[0m22:50:52.645123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:53.692031 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address"
[0m22:50:53.693498 [debug] [Thread-1 (]: On model.desafioaethaina.stg_person_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
    );
  
[0m22:50:57.138207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6e74f3e4-8cb7-469c-8349-7ad44b7020e3&page=queryresults
[0m22:50:57.179250 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_person_address (execute): 2023-06-27 22:50:52.611929 => 2023-06-27 22:50:57.179135
[0m22:50:57.180478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d8455b-9aa9-49ed-b776-cd234305d4b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e3a4dfc0>]}
[0m22:50:57.181067 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_silver.stg_person_address ......... [[32mCREATE TABLE (19.6k rows, 1.7 MB processed)[0m in 4.58s]
[0m22:50:57.184362 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_person_address
[0m22:50:57.186692 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:50:57.188001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:57.188533 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m22:50:57.188973 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m22:50:57.189445 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_person_address' was properly closed.
[0m22:50:57.189916 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m22:50:57.190462 [info ] [MainThread]: 
[0m22:50:57.191269 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.08 seconds (7.08s).
[0m22:50:57.192479 [debug] [MainThread]: Command end result
[0m22:50:57.234193 [info ] [MainThread]: 
[0m22:50:57.234997 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:50:57.235756 [info ] [MainThread]: 
[0m22:50:57.236476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:50:57.237456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e7fa9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e398ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e3886530>]}
[0m22:50:57.238090 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 22:54:18.675775 | 6458d08e-93a9-4a98-bf84-17229dc2bf7d ==============================
[0m22:54:18.675775 [info ] [MainThread]: Running with dbt=1.4.6
[0m22:54:18.677923 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:54:18.678661 [debug] [MainThread]: Tracking: tracking
[0m22:54:18.681086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9378b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9378ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9378b3a0>]}
[0m22:54:18.729572 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m22:54:18.872961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:54:18.874320 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m22:54:18.875082 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_customer_and_sales.sql
[0m22:54:18.875871 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_customer.sql
[0m22:54:18.876491 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m22:54:18.900362 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m22:54:18.916227 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m22:54:18.921707 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer.sql
[0m22:54:18.927034 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m22:54:18.931032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c934f5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c936abf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c936abf40>]}
[0m22:54:18.931494 [debug] [MainThread]: Flushing usage events
[0m22:54:20.004132 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.desafioaethaina.int_customer_and_sales' (models/intermediate/int_customer_and_sales.sql) depends on a node named 'int_sales_customer' which was not found


============================== 2023-06-27 22:54:31.750528 | b188c24e-afb5-4f43-be0f-308869f04854 ==============================
[0m22:54:31.750528 [info ] [MainThread]: Running with dbt=1.4.6
[0m22:54:31.752555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:54:31.753053 [debug] [MainThread]: Tracking: tracking
[0m22:54:31.755498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed9863b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed986380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed986da0>]}
[0m22:54:31.809946 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m22:54:31.949385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:54:31.950594 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_customer.sql
[0m22:54:31.951398 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_customer_and_sales.sql
[0m22:54:31.952053 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m22:54:31.952669 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m22:54:31.976205 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer.sql
[0m22:54:31.992195 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m22:54:31.997961 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m22:54:32.003298 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m22:54:32.007258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed6ed5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed6b81c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed6b8160>]}
[0m22:54:32.007733 [debug] [MainThread]: Flushing usage events
[0m22:54:33.108736 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.desafioaethaina.int_customer_and_sales' (models/intermediate/int_customer_and_sales.sql) depends on a node named 'int_sales_customer' which was not found


============================== 2023-06-27 22:55:00.794029 | d3800846-04af-486f-914f-7ab7cd8996b3 ==============================
[0m22:55:00.794029 [info ] [MainThread]: Running with dbt=1.4.6
[0m22:55:00.797067 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:55:00.798817 [debug] [MainThread]: Tracking: tracking
[0m22:55:00.804238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07c76620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07c75060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07c765f0>]}
[0m22:55:00.862094 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m22:55:01.066935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:55:01.068034 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m22:55:01.068720 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_customer.sql
[0m22:55:01.069386 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m22:55:01.069920 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_customer_and_sales.sql
[0m22:55:01.096362 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m22:55:01.112297 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer.sql
[0m22:55:01.117975 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m22:55:01.123253 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m22:55:01.149467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07859ae0>]}
[0m22:55:01.171909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07a81570>]}
[0m22:55:01.172486 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m22:55:01.173143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07a812d0>]}
[0m22:55:01.179277 [info ] [MainThread]: 
[0m22:55:01.181996 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:55:01.188810 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m22:55:01.190232 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m22:55:01.191070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:01.192356 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m22:55:01.193059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:01.194822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:02.824457 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m22:55:02.826329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:02.828705 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m22:55:02.877602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m22:55:02.879748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m22:55:02.884702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:02.886056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:02.887232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:04.405972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07a92530>]}
[0m22:55:04.407371 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:04.408708 [info ] [MainThread]: 
[0m22:55:04.415891 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m22:55:04.416392 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_address
[0m22:55:04.416918 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_address_type
[0m22:55:04.417542 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_address
[0m22:55:04.418042 [info ] [Thread-1 (]: 1 of 39 START sql table model dev_thaina_gold.dim_dates ........................ [RUN]
[0m22:55:04.419674 [info ] [Thread-2 (]: 2 of 39 START sql table model dev_thaina_silver.stg_person_address ............. [RUN]
[0m22:55:04.421589 [info ] [Thread-3 (]: 3 of 39 START sql table model dev_thaina_silver.stg_person_address_type ........ [RUN]
[0m22:55:04.422654 [info ] [Thread-4 (]: 4 of 39 START sql table model dev_thaina_silver.stg_person_business_entity_address  [RUN]
[0m22:55:04.425114 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m22:55:04.427552 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address'
[0m22:55:04.429112 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address_type'
[0m22:55:04.430130 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_address'
[0m22:55:04.430858 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m22:55:04.431658 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_address
[0m22:55:04.432201 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_address_type
[0m22:55:04.432920 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_address
[0m22:55:04.450070 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address"
[0m22:55:04.490538 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_address"
[0m22:55:04.515078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:04.522982 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (compile): 2023-06-27 22:55:04.469074 => 2023-06-27 22:55:04.522783
[0m22:55:04.527519 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address_type"
[0m22:55:04.527893 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (compile): 2023-06-27 22:55:04.438989 => 2023-06-27 22:55:04.527801
[0m22:55:04.530507 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_business_entity_address
[0m22:55:04.535022 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m22:55:04.535670 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_address
[0m22:55:04.541918 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (compile): 2023-06-27 22:55:04.451337 => 2023-06-27 22:55:04.541331
[0m22:55:04.573944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:04.621742 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_address_type
[0m22:55:04.677177 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:04.689622 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:06.417174 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address"
[0m22:55:06.419386 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address_type"
[0m22:55:06.421536 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_address"
[0m22:55:06.422479 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
    );
  
[0m22:55:06.426028 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_address_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addresstypeid as address_type_id
    , name as address_type_name 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`addresstype`
)

select *
from source_data
    );
  
[0m22:55:06.426748 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_business_entity_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , addressid as address_id
    , addresstypeid as address_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentityaddress`
)

select *
from source_data
    );
  
[0m22:55:07.617221 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1c9f6ed8-b9c6-4ed2-9386-a94df2fc8feb&page=queryresults
[0m22:55:07.644161 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m22:55:07.645560 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-06-27 22:55:04.433438 => 2023-06-27 22:55:07.645231
[0m22:55:07.646633 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m22:55:07.948176 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m22:55:07.948914 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      


/* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m22:55:09.368978 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:18a86024-ac36-43c5-8d23-a1fb362328ca&page=queryresults
[0m22:55:09.394747 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (execute): 2023-06-27 22:55:04.681958 => 2023-06-27 22:55:09.394658
[0m22:55:09.395876 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff070f9780>]}
[0m22:55:09.396497 [info ] [Thread-3 (]: 3 of 39 OK created sql table model dev_thaina_silver.stg_person_address_type ... [[32mCREATE TABLE (6.0 rows, 332.0 Bytes processed)[0m in 4.97s]
[0m22:55:09.398817 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_address_type
[0m22:55:09.399460 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_business_entity_contact
[0m22:55:09.400205 [info ] [Thread-3 (]: 5 of 39 START sql table model dev_thaina_silver.stg_person_business_entity_contact  [RUN]
[0m22:55:09.401465 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_contact'
[0m22:55:09.401932 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_contact
[0m22:55:09.405719 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m22:55:09.406467 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (compile): 2023-06-27 22:55:09.402305 => 2023-06-27 22:55:09.406327
[0m22:55:09.407086 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_business_entity_contact
[0m22:55:09.411955 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:09.503735 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a12dbbae-fe2c-41b8-ac96-a893a85992da&page=queryresults
[0m22:55:09.509709 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (execute): 2023-06-27 22:55:04.564774 => 2023-06-27 22:55:09.509505
[0m22:55:09.511079 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07157d00>]}
[0m22:55:09.511905 [info ] [Thread-2 (]: 2 of 39 OK created sql table model dev_thaina_silver.stg_person_address ........ [[32mCREATE TABLE (19.6k rows, 1.7 MB processed)[0m in 5.09s]
[0m22:55:09.514772 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_address
[0m22:55:09.515576 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_contact_type
[0m22:55:09.516649 [info ] [Thread-2 (]: 6 of 39 START sql table model dev_thaina_silver.stg_person_contact_type ........ [RUN]
[0m22:55:09.518130 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_contact_type'
[0m22:55:09.518777 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_contact_type
[0m22:55:09.525953 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_contact_type"
[0m22:55:09.526739 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_contact_type (compile): 2023-06-27 22:55:09.519213 => 2023-06-27 22:55:09.526603
[0m22:55:09.527524 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_contact_type
[0m22:55:09.535831 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:09.906108 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3825ba01-14f2-49d1-80da-79f4269eb7c2&page=queryresults
[0m22:55:09.909752 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (execute): 2023-06-27 22:55:04.536123 => 2023-06-27 22:55:09.909646
[0m22:55:09.911034 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff070f9a20>]}
[0m22:55:09.912033 [info ] [Thread-4 (]: 4 of 39 OK created sql table model dev_thaina_silver.stg_person_business_entity_address  [[32mCREATE TABLE (19.6k rows, 1.2 MB processed)[0m in 5.48s]
[0m22:55:09.914808 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_address
[0m22:55:09.915643 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_country_region
[0m22:55:09.916540 [info ] [Thread-4 (]: 7 of 39 START sql table model dev_thaina_silver.stg_person_country_region ...... [RUN]
[0m22:55:09.917969 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_country_region'
[0m22:55:09.918791 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_country_region
[0m22:55:09.926459 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_country_region"
[0m22:55:09.930285 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_country_region (compile): 2023-06-27 22:55:09.920044 => 2023-06-27 22:55:09.930090
[0m22:55:09.932014 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_country_region
[0m22:55:09.938776 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:10.375882 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m22:55:10.376675 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_business_entity_contact: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_contact"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , personid as person_id
    , contacttypeid as contact_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentitycontact`
)

select *
from source_data
    );
  
[0m22:55:10.459130 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_contact_type"
[0m22:55:10.459985 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_contact_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_contact_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    contacttypeid as contact_type_id
    , name as contact_type_name 
  from  `desafiothaina`.`dev_thaina`.`contacttype`
)

select *
from source_data
    );
  
[0m22:55:11.001180 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_country_region"
[0m22:55:11.007060 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_country_region: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_country_region"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
    );
  
[0m22:55:12.640417 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6fe4e987-79f3-4b8a-ae1a-8c4a844c3559&page=queryresults
[0m22:55:13.362153 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:80e074ab-0736-4ec7-938b-7676c7981b82&page=queryresults
[0m22:55:13.364864 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (execute): 2023-06-27 22:55:09.407482 => 2023-06-27 22:55:13.364756
[0m22:55:13.366266 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0468d030>]}
[0m22:55:13.367261 [info ] [Thread-3 (]: 5 of 39 OK created sql table model dev_thaina_silver.stg_person_business_entity_contact  [[32mCREATE TABLE (909.0 rows, 55.0 KB processed)[0m in 3.97s]
[0m22:55:13.368196 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_business_entity_contact
[0m22:55:13.369006 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_person
[0m22:55:13.369700 [info ] [Thread-3 (]: 8 of 39 START sql table model dev_thaina_silver.stg_person_person .............. [RUN]
[0m22:55:13.371655 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_person'
[0m22:55:13.372256 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_person
[0m22:55:13.377619 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_person"
[0m22:55:13.378325 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_person (compile): 2023-06-27 22:55:13.372640 => 2023-06-27 22:55:13.378231
[0m22:55:13.378754 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_person
[0m22:55:13.383293 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:13.497199 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-06-27 22:55:07.647066 => 2023-06-27 22:55:13.497098
[0m22:55:13.498639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff070f9270>]}
[0m22:55:13.499541 [info ] [Thread-1 (]: 1 of 39 OK created sql table model dev_thaina_gold.dim_dates ................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 9.07s]
[0m22:55:13.500494 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m22:55:13.501196 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_person_state_province
[0m22:55:13.503991 [info ] [Thread-1 (]: 9 of 39 START sql table model dev_thaina_silver.stg_person_state_province ...... [RUN]
[0m22:55:13.506537 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_state_province'
[0m22:55:13.507444 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_person_state_province
[0m22:55:13.516514 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_state_province"
[0m22:55:13.517913 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_person_state_province (compile): 2023-06-27 22:55:13.508212 => 2023-06-27 22:55:13.517783
[0m22:55:13.518500 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_person_state_province
[0m22:55:13.526070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:13.676495 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:57ff7b19-25b4-4377-a0c2-1d082e7587ea&page=queryresults
[0m22:55:13.682009 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_contact_type (execute): 2023-06-27 22:55:09.528470 => 2023-06-27 22:55:13.681884
[0m22:55:13.684775 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff070f88b0>]}
[0m22:55:13.686811 [info ] [Thread-2 (]: 6 of 39 OK created sql table model dev_thaina_silver.stg_person_contact_type ... [[32mCREATE TABLE (20.0 rows, 595.0 Bytes processed)[0m in 4.17s]
[0m22:55:13.694662 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_contact_type
[0m22:55:13.700684 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product
[0m22:55:13.701597 [info ] [Thread-2 (]: 10 of 39 START sql table model dev_thaina_silver.stg_product ................... [RUN]
[0m22:55:13.703688 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product'
[0m22:55:13.704285 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product
[0m22:55:13.716421 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product"
[0m22:55:13.717517 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product (compile): 2023-06-27 22:55:13.704658 => 2023-06-27 22:55:13.717346
[0m22:55:13.718633 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product
[0m22:55:13.737135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:14.093149 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:67637499-da6e-42ae-8034-06a048a17b18&page=queryresults
[0m22:55:14.098065 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_country_region (execute): 2023-06-27 22:55:09.934037 => 2023-06-27 22:55:14.097906
[0m22:55:14.102709 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0712c280>]}
[0m22:55:14.103911 [info ] [Thread-4 (]: 7 of 39 OK created sql table model dev_thaina_silver.stg_person_country_region . [[32mCREATE TABLE (238.0 rows, 3.7 KB processed)[0m in 4.19s]
[0m22:55:14.107197 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_country_region
[0m22:55:14.107996 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_category
[0m22:55:14.109715 [info ] [Thread-4 (]: 11 of 39 START sql table model dev_thaina_silver.stg_product_category .......... [RUN]
[0m22:55:14.111154 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_category'
[0m22:55:14.111796 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_category
[0m22:55:14.120247 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_category"
[0m22:55:14.123950 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_category (compile): 2023-06-27 22:55:14.112189 => 2023-06-27 22:55:14.123729
[0m22:55:14.125923 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product_category
[0m22:55:14.135281 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:14.649674 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_person"
[0m22:55:14.650512 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
    );
  
[0m22:55:14.736084 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_state_province"
[0m22:55:14.736852 [debug] [Thread-1 (]: On model.desafioaethaina.stg_person_state_province: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_state_province"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
    );
  
[0m22:55:14.963564 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product"
[0m22:55:14.964496 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , productmodelid as product_model_id
    , productsubcategoryid as product_subcategory_id
    , name as product_name
    , productnumber as product_number
    , makeflag
    , finishedgoodsflag as finished_goods_flag
    , color
    , safetystocklevel as safety_stock_level
    , standardcost as stand_cost
    , listprice as list_price
    , size as size_product
    , style as style_product
    , weight as weight_product 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`product`
)

select * from source_data
    );
  
[0m22:55:15.093822 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_category"
[0m22:55:15.094462 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product_category: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_category"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productcategoryid as category_id
    , name as category_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productcategory`
)

select *
from source_data
    );
  
[0m22:55:17.713025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:38a40a0f-6e19-4b73-8575-398aee32422b&page=queryresults
[0m22:55:17.715893 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_person_state_province (execute): 2023-06-27 22:55:13.518897 => 2023-06-27 22:55:17.715823
[0m22:55:17.716839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0703b100>]}
[0m22:55:17.717462 [info ] [Thread-1 (]: 9 of 39 OK created sql table model dev_thaina_silver.stg_person_state_province . [[32mCREATE TABLE (181.0 rows, 13.4 KB processed)[0m in 4.21s]
[0m22:55:17.718141 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_person_state_province
[0m22:55:17.718799 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_description
[0m22:55:17.719638 [info ] [Thread-1 (]: 12 of 39 START sql table model dev_thaina_silver.stg_product_description ....... [RUN]
[0m22:55:17.720863 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_description'
[0m22:55:17.721450 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_description
[0m22:55:17.726201 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_description"
[0m22:55:17.726824 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_description (compile): 2023-06-27 22:55:17.721798 => 2023-06-27 22:55:17.726712
[0m22:55:17.727254 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_description
[0m22:55:17.732494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:17.860428 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6981218d-9b2d-49a1-aabb-8e3069050a02&page=queryresults
[0m22:55:17.863257 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_person (execute): 2023-06-27 22:55:13.379040 => 2023-06-27 22:55:17.863188
[0m22:55:17.864244 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff046c2da0>]}
[0m22:55:17.864959 [info ] [Thread-3 (]: 8 of 39 OK created sql table model dev_thaina_silver.stg_person_person ......... [[32mCREATE TABLE (20.0k rows, 1.5 MB processed)[0m in 4.49s]
[0m22:55:17.865847 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_person
[0m22:55:17.866633 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_inventory
[0m22:55:17.867375 [info ] [Thread-3 (]: 13 of 39 START sql table model dev_thaina_silver.stg_product_inventory ......... [RUN]
[0m22:55:17.869724 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_inventory'
[0m22:55:17.870378 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_inventory
[0m22:55:17.874737 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_inventory"
[0m22:55:17.875378 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_inventory (compile): 2023-06-27 22:55:17.870940 => 2023-06-27 22:55:17.875261
[0m22:55:17.875962 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_inventory
[0m22:55:17.886360 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:18.223144 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c3122384-a087-430b-b319-28f80b5add44&page=queryresults
[0m22:55:18.228789 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product (execute): 2023-06-27 22:55:13.719699 => 2023-06-27 22:55:18.228702
[0m22:55:18.230728 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff04598b50>]}
[0m22:55:18.232260 [info ] [Thread-2 (]: 10 of 39 OK created sql table model dev_thaina_silver.stg_product .............. [[32mCREATE TABLE (504.0 rows, 60.1 KB processed)[0m in 4.53s]
[0m22:55:18.233388 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product
[0m22:55:18.234892 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_location
[0m22:55:18.235954 [info ] [Thread-2 (]: 14 of 39 START sql table model dev_thaina_silver.stg_product_location .......... [RUN]
[0m22:55:18.238024 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_location'
[0m22:55:18.238813 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_location
[0m22:55:18.244715 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_location"
[0m22:55:18.245351 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_location (compile): 2023-06-27 22:55:18.239330 => 2023-06-27 22:55:18.245231
[0m22:55:18.245837 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product_location
[0m22:55:18.252281 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:18.321954 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b225d91a-aacb-449f-b99a-d0b0b3d5dddf&page=queryresults
[0m22:55:18.327256 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_category (execute): 2023-06-27 22:55:14.126664 => 2023-06-27 22:55:18.327158
[0m22:55:18.328646 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff04750070>]}
[0m22:55:18.334404 [info ] [Thread-4 (]: 11 of 39 OK created sql table model dev_thaina_silver.stg_product_category ..... [[32mCREATE TABLE (4.0 rows, 226.0 Bytes processed)[0m in 4.22s]
[0m22:55:18.336260 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_category
[0m22:55:18.337460 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_model
[0m22:55:18.338567 [info ] [Thread-4 (]: 15 of 39 START sql table model dev_thaina_silver.stg_product_model ............. [RUN]
[0m22:55:18.341068 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_model'
[0m22:55:18.342009 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_model
[0m22:55:18.349888 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_model"
[0m22:55:18.350795 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_model (compile): 2023-06-27 22:55:18.343054 => 2023-06-27 22:55:18.350647
[0m22:55:18.351445 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product_model
[0m22:55:18.364957 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:18.971135 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_description"
[0m22:55:18.972283 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_description: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_description"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_description`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productdescriptionid as product_description_id
    , description as product_description
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productdescription`
)

select *
from source_data
    );
  
[0m22:55:19.127926 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_inventory"
[0m22:55:19.130496 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_inventory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_inventory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , locationid as location_id
    , shelf
    , bin
    , quantity as quantity_inventory
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productinventory`
)

select *
from source_data
    );
  
[0m22:55:19.601979 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_location"
[0m22:55:19.604399 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_model"
[0m22:55:19.611646 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product_location: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_location"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    locationid as location_id
    , name as location_name
    -- Standard hourly cost of the manufacturing location.
    , costrate as cost_rate
    -- Work capacity (in hours) of the manufacturing location.
    , availability 
  from  `desafiothaina`.`dev_thaina`.`location`
)

select *
from source_data
    );
  
[0m22:55:19.613760 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product_model: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_model"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productmodelid as model_id
    , name as model_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productmodel`
)

select *
from source_data
    );
  
[0m22:55:22.174438 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:19d55c8b-bf67-4b31-b564-bab913f00d96&page=queryresults
[0m22:55:22.177820 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_description (execute): 2023-06-27 22:55:17.727570 => 2023-06-27 22:55:22.177752
[0m22:55:22.178792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff047382e0>]}
[0m22:55:22.179410 [info ] [Thread-1 (]: 12 of 39 OK created sql table model dev_thaina_silver.stg_product_description .. [[32mCREATE TABLE (762.0 rows, 125.4 KB processed)[0m in 4.46s]
[0m22:55:22.180049 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_description
[0m22:55:22.180724 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_subcategory
[0m22:55:22.181360 [info ] [Thread-1 (]: 16 of 39 START sql table model dev_thaina_silver.stg_product_subcategory ....... [RUN]
[0m22:55:22.182399 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_subcategory'
[0m22:55:22.182834 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_subcategory
[0m22:55:22.186684 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_subcategory"
[0m22:55:22.187296 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_subcategory (compile): 2023-06-27 22:55:22.183110 => 2023-06-27 22:55:22.187202
[0m22:55:22.187712 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_subcategory
[0m22:55:22.192230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:22.300619 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e7d23c50-a645-4bd5-b3fc-5954646dfa3e&page=queryresults
[0m22:55:22.303518 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_inventory (execute): 2023-06-27 22:55:17.876385 => 2023-06-27 22:55:22.303451
[0m22:55:22.304585 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0705bbb0>]}
[0m22:55:22.305323 [info ] [Thread-3 (]: 13 of 39 OK created sql table model dev_thaina_silver.stg_product_inventory .... [[32mCREATE TABLE (1.1k rows, 76.8 KB processed)[0m in 4.44s]
[0m22:55:22.306226 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_inventory
[0m22:55:22.307113 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m22:55:22.308192 [info ] [Thread-3 (]: 17 of 39 START sql table model dev_thaina_silver.stg_purchase_order_detail ..... [RUN]
[0m22:55:22.309650 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m22:55:22.310260 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m22:55:22.316115 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m22:55:22.317024 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-06-27 22:55:22.310623 => 2023-06-27 22:55:22.316899
[0m22:55:22.317705 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchase_order_detail
[0m22:55:22.324345 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:22.336825 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5728d73d-fca7-4116-969e-01645534ac81&page=queryresults
[0m22:55:22.343862 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_location (execute): 2023-06-27 22:55:18.246115 => 2023-06-27 22:55:22.343736
[0m22:55:22.348665 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff045983d0>]}
[0m22:55:22.390135 [info ] [Thread-2 (]: 14 of 39 OK created sql table model dev_thaina_silver.stg_product_location ..... [[32mCREATE TABLE (14.0 rows, 670.0 Bytes processed)[0m in 4.11s]
[0m22:55:22.394177 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_location
[0m22:55:22.395763 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_purchase_order_header
[0m22:55:22.396541 [info ] [Thread-2 (]: 18 of 39 START sql table model dev_thaina_silver.stg_purchase_order_header ..... [RUN]
[0m22:55:22.398421 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_header'
[0m22:55:22.398894 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_purchase_order_header
[0m22:55:22.403530 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_header"
[0m22:55:22.404175 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (compile): 2023-06-27 22:55:22.399179 => 2023-06-27 22:55:22.404072
[0m22:55:22.404724 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_purchase_order_header
[0m22:55:22.409990 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:22.631225 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6d324228-7c19-408f-a080-4ffbbb8f3e76&page=queryresults
[0m22:55:22.634560 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_model (execute): 2023-06-27 22:55:18.351913 => 2023-06-27 22:55:22.634441
[0m22:55:22.636082 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff04750130>]}
[0m22:55:22.636716 [info ] [Thread-4 (]: 15 of 39 OK created sql table model dev_thaina_silver.stg_product_model ........ [[32mCREATE TABLE (128.0 rows, 8.0 KB processed)[0m in 4.30s]
[0m22:55:22.637619 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_model
[0m22:55:22.638560 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchasing_product_vendor
[0m22:55:22.640496 [info ] [Thread-4 (]: 19 of 39 START sql table model dev_thaina_silver.stg_purchasing_product_vendor . [RUN]
[0m22:55:22.642604 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_product_vendor'
[0m22:55:22.643606 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchasing_product_vendor
[0m22:55:22.649742 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m22:55:22.650557 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (compile): 2023-06-27 22:55:22.644241 => 2023-06-27 22:55:22.650429
[0m22:55:22.651113 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_purchasing_product_vendor
[0m22:55:22.657861 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:23.150629 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_subcategory"
[0m22:55:23.151266 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_subcategory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_subcategory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productsubcategoryid as subcategory_id
    , productcategoryid as category_id
    , name as subcategory_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productsubcategory`
)

select *
from source_data
    );
  
[0m22:55:23.339934 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_detail"
[0m22:55:23.340764 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchase_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , purchaseorderdetailid as purchase_order_detail_id
    , duedate as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m22:55:23.382981 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_header"
[0m22:55:23.383773 [debug] [Thread-2 (]: On model.desafioaethaina.stg_purchase_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    purchaseorderid as purchase_order_id
    , revisionnumber as revision_number
    , status as status_order
    , employeeid as employee_id
    , vendorid as vendor_id
    , shipmethodid as ship_method_id
    , shipdate as ship_date
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight  
    /* Total due to vendor. Computed as Subtotal + TaxAmt + Freight.
Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0))  */
  from
    `desafiothaina`.`dev_thaina`.`purchaseorderheader`
)

select * 
  from source_data
    );
  
[0m22:55:23.494653 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m22:55:23.495360 [debug] [Thread-4 (]: On model.desafioaethaina.stg_purchasing_product_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_product_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_product_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , productid as product_id
    , standardprice as standard_price
    , minorderqty as min_order_qty
    , maxorderqty as max_order_qty
    , onorderqty as on_order_qty
    , unitmeasurecode as unit_measure_code
  from  `desafiothaina`.`dev_thaina`.`productvendor`
)

select *
from source_data
    );
  
[0m22:55:26.423977 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c138c8e9-dbd6-4df3-a59c-54462f9e166d&page=queryresults
[0m22:55:26.427667 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_subcategory (execute): 2023-06-27 22:55:22.188036 => 2023-06-27 22:55:26.427549
[0m22:55:26.430247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff04682e60>]}
[0m22:55:26.433130 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:593a7d50-27ca-4ff9-b74b-f9fb54593902&page=queryresults
[0m22:55:26.431605 [info ] [Thread-1 (]: 16 of 39 OK created sql table model dev_thaina_silver.stg_product_subcategory .. [[32mCREATE TABLE (37.0 rows, 2.3 KB processed)[0m in 4.25s]
[0m22:55:26.438474 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (execute): 2023-06-27 22:55:22.318197 => 2023-06-27 22:55:26.438379
[0m22:55:26.439157 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_subcategory
[0m22:55:26.440425 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff046803d0>]}
[0m22:55:26.441211 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchasing_ship_method
[0m22:55:26.442394 [info ] [Thread-3 (]: 17 of 39 OK created sql table model dev_thaina_silver.stg_purchase_order_detail  [[32mCREATE TABLE (8.8k rows, 837.9 KB processed)[0m in 4.13s]
[0m22:55:26.443142 [info ] [Thread-1 (]: 20 of 39 START sql table model dev_thaina_silver.stg_purchasing_ship_method .... [RUN]
[0m22:55:26.445027 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m22:55:26.446065 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_ship_method'
[0m22:55:26.446706 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchasing_vendor
[0m22:55:26.447406 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchasing_ship_method
[0m22:55:26.448241 [info ] [Thread-3 (]: 21 of 39 START sql table model dev_thaina_silver.stg_purchasing_vendor ......... [RUN]
[0m22:55:26.457203 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m22:55:26.459077 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_vendor'
[0m22:55:26.459862 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (compile): 2023-06-27 22:55:26.449292 => 2023-06-27 22:55:26.459720
[0m22:55:26.460483 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchasing_vendor
[0m22:55:26.461141 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchasing_ship_method
[0m22:55:26.470821 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_vendor"
[0m22:55:26.474420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:26.475973 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (compile): 2023-06-27 22:55:26.461640 => 2023-06-27 22:55:26.475693
[0m22:55:26.477632 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchasing_vendor
[0m22:55:26.482703 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:26.650768 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e3a24f9f-e02c-497f-9603-23195560ae4f&page=queryresults
[0m22:55:26.656916 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (execute): 2023-06-27 22:55:22.651711 => 2023-06-27 22:55:26.656712
[0m22:55:26.661411 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff04495b70>]}
[0m22:55:26.662264 [info ] [Thread-4 (]: 19 of 39 OK created sql table model dev_thaina_silver.stg_purchasing_product_vendor  [[32mCREATE TABLE (460.0 rows, 21.4 KB processed)[0m in 4.02s]
[0m22:55:26.663289 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchasing_product_vendor
[0m22:55:26.664113 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_country_region_currency
[0m22:55:26.664898 [info ] [Thread-4 (]: 22 of 39 START sql table model dev_thaina_silver.stg_sales_country_region_currency  [RUN]
[0m22:55:26.666685 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_country_region_currency'
[0m22:55:26.667396 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_country_region_currency
[0m22:55:26.677596 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m22:55:26.678473 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (compile): 2023-06-27 22:55:26.668806 => 2023-06-27 22:55:26.678335
[0m22:55:26.679123 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_country_region_currency
[0m22:55:26.685154 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:26.813467 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:610bdaed-8567-4130-a09e-543482394480&page=queryresults
[0m22:55:26.817503 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (execute): 2023-06-27 22:55:22.405206 => 2023-06-27 22:55:26.817402
[0m22:55:26.818890 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0447e920>]}
[0m22:55:26.821026 [info ] [Thread-2 (]: 18 of 39 OK created sql table model dev_thaina_silver.stg_purchase_order_header  [[32mCREATE TABLE (4.0k rows, 380.0 KB processed)[0m in 4.42s]
[0m22:55:26.824907 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_purchase_order_header
[0m22:55:26.826943 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_currency
[0m22:55:26.827987 [info ] [Thread-2 (]: 23 of 39 START sql table model dev_thaina_silver.stg_sales_currency ............ [RUN]
[0m22:55:26.829839 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency'
[0m22:55:26.830465 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_currency
[0m22:55:26.840026 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency"
[0m22:55:26.841586 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_currency (compile): 2023-06-27 22:55:26.830915 => 2023-06-27 22:55:26.841323
[0m22:55:26.843126 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_currency
[0m22:55:26.850550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:27.902232 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m22:55:27.904041 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchasing_ship_method: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_ship_method"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
    );
  
[0m22:55:27.957932 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_vendor"
[0m22:55:27.958662 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchasing_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , accountnumber as account_number
    , name as company_name
    -- 1 = Superior, 2 = Excellent, 3 = Above average, 4 = Average, 5 = Below
    , creditrating as credit_rate
    , activeflag as active_flag
  from  `desafiothaina`.`dev_thaina`.`vendor`
)

select *
from source_data
    );
  
[0m22:55:28.049031 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m22:55:28.054259 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency"
[0m22:55:28.058693 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    currencycode as currency_code
    , name as currency_name
  from  `desafiothaina`.`dev_thaina`.`currency`
)

select *
from source_data
    );
  
[0m22:55:28.059186 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_country_region_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_country_region_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_country_region_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
      countryregioncode as country_region_code
      , currencycode as currency_code
    from `desafiothaina`.`dev_thaina`.`countryregioncurrency`
  )
select  *
from source_data
    );
  
[0m22:55:31.010299 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2de69372-7180-4507-af51-3a36e3cc60d0&page=queryresults
[0m22:55:31.011555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:18c94f4d-174c-4324-8bc5-43bca46bd0a5&page=queryresults
[0m22:55:31.012328 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8255dc37-3105-43ca-8216-a065ec794942&page=queryresults
[0m22:55:31.014894 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_currency (execute): 2023-06-27 22:55:26.843969 => 2023-06-27 22:55:31.014827
[0m22:55:31.015666 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0357e3bd-c022-4aa1-9caa-979110860309&page=queryresults
[0m22:55:31.018215 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (execute): 2023-06-27 22:55:26.471114 => 2023-06-27 22:55:31.018152
[0m22:55:31.020931 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (execute): 2023-06-27 22:55:26.478643 => 2023-06-27 22:55:31.020858
[0m22:55:31.022196 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff077d86d0>]}
[0m22:55:31.025142 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (execute): 2023-06-27 22:55:26.679557 => 2023-06-27 22:55:31.025046
[0m22:55:31.026698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07176320>]}
[0m22:55:31.027847 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0712f370>]}
[0m22:55:31.028689 [info ] [Thread-2 (]: 23 of 39 OK created sql table model dev_thaina_silver.stg_sales_currency ....... [[32mCREATE TABLE (105.0 rows, 2.0 KB processed)[0m in 4.19s]
[0m22:55:31.030209 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0713a5c0>]}
[0m22:55:31.031073 [info ] [Thread-1 (]: 20 of 39 OK created sql table model dev_thaina_silver.stg_purchasing_ship_method  [[32mCREATE TABLE (5.0 rows, 400.0 Bytes processed)[0m in 4.58s]
[0m22:55:31.032211 [info ] [Thread-3 (]: 21 of 39 OK created sql table model dev_thaina_silver.stg_purchasing_vendor .... [[32mCREATE TABLE (104.0 rows, 5.1 KB processed)[0m in 4.57s]
[0m22:55:31.033024 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_currency
[0m22:55:31.034000 [info ] [Thread-4 (]: 22 of 39 OK created sql table model dev_thaina_silver.stg_sales_country_region_currency  [[32mCREATE TABLE (109.0 rows, 981.0 Bytes processed)[0m in 4.36s]
[0m22:55:31.034852 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchasing_ship_method
[0m22:55:31.035507 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchasing_vendor
[0m22:55:31.036277 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_currency_rate
[0m22:55:31.037004 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_country_region_currency
[0m22:55:31.037714 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_customer
[0m22:55:31.038505 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_order_detail
[0m22:55:31.039212 [info ] [Thread-2 (]: 24 of 39 START sql table model dev_thaina_silver.stg_sales_currency_rate ....... [RUN]
[0m22:55:31.040359 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m22:55:31.041063 [info ] [Thread-1 (]: 25 of 39 START sql table model dev_thaina_silver.stg_sales_customer ............ [RUN]
[0m22:55:31.042034 [info ] [Thread-3 (]: 26 of 39 START sql table model dev_thaina_silver.stg_sales_order_detail ........ [RUN]
[0m22:55:31.043503 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency_rate'
[0m22:55:31.044430 [info ] [Thread-4 (]: 27 of 39 START sql table model dev_thaina_silver.stg_sales_order_header ........ [RUN]
[0m22:55:31.045906 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_customer'
[0m22:55:31.049275 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_customer
[0m22:55:31.047598 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_currency_rate
[0m22:55:31.048727 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m22:55:31.047077 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_detail'
[0m22:55:31.065600 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_order_detail
[0m22:55:31.055529 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_customer"
[0m22:55:31.064871 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m22:55:31.064292 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency_rate"
[0m22:55:31.081920 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (compile): 2023-06-27 22:55:31.056028 => 2023-06-27 22:55:31.081643
[0m22:55:31.082970 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_customer (compile): 2023-06-27 22:55:31.049742 => 2023-06-27 22:55:31.082689
[0m22:55:31.087127 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_customer
[0m22:55:31.073440 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_detail"
[0m22:55:31.084676 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_currency_rate
[0m22:55:31.096550 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m22:55:31.111257 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-06-27 22:55:31.074886 => 2023-06-27 22:55:31.111050
[0m22:55:31.106897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:31.110047 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (compile): 2023-06-27 22:55:31.066284 => 2023-06-27 22:55:31.109894
[0m22:55:31.116352 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_order_detail
[0m22:55:31.109323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:31.111892 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m22:55:31.172114 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:31.214343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:32.923067 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_detail"
[0m22:55:32.927135 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m22:55:32.930248 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_customer"
[0m22:55:32.932730 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency_rate"
[0m22:55:32.934008 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
    );
  
[0m22:55:32.934701 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , orderdate as order_date
    , duedate as due_date
    , shipdate as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m22:55:32.936032 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
    );
  
[0m22:55:32.947959 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      currencyrateid as currency_rate_id
      , currencyratedate as currency_rate_date
      , fromcurrencycode as from_currency_code
      , tocurrencycode as to_currency_code
      , averagerate as avg_rate
      , endofdayrate as end_of_day_rate
    from `desafiothaina`.`dev_thaina`.`currencyrate`
  )
select  *
from source_data
    );
  
[0m22:55:36.483893 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0775b852-c291-4dde-b713-87050a0bc4f4&page=queryresults
[0m22:55:36.494150 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (execute): 2023-06-27 22:55:31.103611 => 2023-06-27 22:55:36.493950
[0m22:55:36.497257 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff06f7e410>]}
[0m22:55:36.498430 [info ] [Thread-2 (]: 24 of 39 OK created sql table model dev_thaina_silver.stg_sales_currency_rate .. [[32mCREATE TABLE (13.5k rows, 779.7 KB processed)[0m in 5.45s]
[0m22:55:36.499562 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_currency_rate
[0m22:55:36.500293 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_order_header_reason
[0m22:55:36.501009 [info ] [Thread-2 (]: 28 of 39 START sql table model dev_thaina_silver.stg_sales_order_header_reason . [RUN]
[0m22:55:36.502326 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header_reason'
[0m22:55:36.502906 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_order_header_reason
[0m22:55:36.511712 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m22:55:36.512649 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (compile): 2023-06-27 22:55:36.503481 => 2023-06-27 22:55:36.512515
[0m22:55:36.513288 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_order_header_reason
[0m22:55:36.527458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:36.761715 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:eec687eb-f46c-479e-8bdb-d13454a66789&page=queryresults
[0m22:55:36.764671 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-06-27 22:55:31.210537 => 2023-06-27 22:55:36.764606
[0m22:55:36.765697 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0713b430>]}
[0m22:55:36.766194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0e31607a-af8c-45d4-a600-e6c0ea796e19&page=queryresults
[0m22:55:36.770505 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_customer (execute): 2023-06-27 22:55:31.087660 => 2023-06-27 22:55:36.770439
[0m22:55:36.771407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0448a380>]}
[0m22:55:37.072712 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:eb20972f-26b6-4ab7-a366-62cdf8740ad7&page=queryresults
[0m22:55:37.080477 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (execute): 2023-06-27 22:55:31.117091 => 2023-06-27 22:55:37.080374
[0m22:55:37.081818 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07078d00>]}
[0m22:55:37.474453 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m22:55:37.475190 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_order_header_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
    );
  
[0m22:55:38.034244 [info ] [Thread-4 (]: 27 of 39 OK created sql table model dev_thaina_silver.stg_sales_order_header ... [[32mCREATE TABLE (31.5k rows, 7.4 MB processed)[0m in 5.72s]
[0m22:55:38.035381 [info ] [Thread-1 (]: 25 of 39 OK created sql table model dev_thaina_silver.stg_sales_customer ....... [[32mCREATE TABLE (19.8k rows, 1.2 MB processed)[0m in 5.73s]
[0m22:55:38.036584 [info ] [Thread-3 (]: 26 of 39 OK created sql table model dev_thaina_silver.stg_sales_order_detail ... [[32mCREATE TABLE (121.3k rows, 10.8 MB processed)[0m in 6.04s]
[0m22:55:38.038062 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m22:55:38.041119 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_customer
[0m22:55:38.041831 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_order_detail
[0m22:55:38.042560 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_person
[0m22:55:38.043347 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_person_quota_history
[0m22:55:38.044052 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_reason
[0m22:55:38.044657 [info ] [Thread-4 (]: 29 of 39 START sql table model dev_thaina_silver.stg_sales_person .............. [RUN]
[0m22:55:38.045533 [info ] [Thread-1 (]: 30 of 39 START sql table model dev_thaina_silver.stg_sales_person_quota_history  [RUN]
[0m22:55:38.046611 [info ] [Thread-3 (]: 31 of 39 START sql table model dev_thaina_silver.stg_sales_reason .............. [RUN]
[0m22:55:38.048997 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person'
[0m22:55:38.052145 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person_quota_history'
[0m22:55:38.055449 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_reason'
[0m22:55:38.056270 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_person
[0m22:55:38.057091 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_person_quota_history
[0m22:55:38.057871 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_reason
[0m22:55:38.067464 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person"
[0m22:55:38.080055 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m22:55:38.089467 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_reason"
[0m22:55:38.092004 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person (compile): 2023-06-27 22:55:38.058383 => 2023-06-27 22:55:38.091533
[0m22:55:38.093458 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_person
[0m22:55:38.100231 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (compile): 2023-06-27 22:55:38.069374 => 2023-06-27 22:55:38.099705
[0m22:55:38.102931 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:38.103480 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_person_quota_history
[0m22:55:38.103997 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_reason (compile): 2023-06-27 22:55:38.081202 => 2023-06-27 22:55:38.103894
[0m22:55:38.141719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:38.142465 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_reason
[0m22:55:38.180065 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:39.267977 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_reason"
[0m22:55:39.270476 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person"
[0m22:55:39.272063 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m22:55:39.272837 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salesreasonid as sales_reason_id
      , name as name_reason
      , reasontype as reason_type
    from `desafiothaina`.`dev_thaina`.`salesreason`
  )

select  *
from source_data
    );
  
[0m22:55:39.273424 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , territoryid as territory_id
      , salesquota as sales_quota
      , bonus
      , commissionpct as commission_pct
      , salesytd as sales_total
      , saleslastyear as sales_last_year
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salesperson`
  )

select  *
from source_data
    );
  
[0m22:55:39.277927 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_person_quota_history: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person_quota_history"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person_quota_history`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , quotadate as quota_date
      , salesquota as sales_quota
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salespersonquotahistory`
  )

select  *
from source_data
    );
  
[0m22:55:40.897077 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:12952b7f-5a91-430a-9c95-7a438aecaeef&page=queryresults
[0m22:55:40.899899 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (execute): 2023-06-27 22:55:36.513733 => 2023-06-27 22:55:40.899832
[0m22:55:40.900991 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0447e770>]}
[0m22:55:40.901713 [info ] [Thread-2 (]: 28 of 39 OK created sql table model dev_thaina_silver.stg_sales_order_header_reason  [[32mCREATE TABLE (27.6k rows, 432.0 KB processed)[0m in 4.40s]
[0m22:55:40.902427 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_order_header_reason
[0m22:55:40.903175 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_tax_rate
[0m22:55:40.904190 [info ] [Thread-2 (]: 32 of 39 START sql table model dev_thaina_silver.stg_sales_tax_rate ............ [RUN]
[0m22:55:40.905591 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_tax_rate'
[0m22:55:40.906191 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_tax_rate
[0m22:55:40.912528 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_tax_rate"
[0m22:55:40.913403 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (compile): 2023-06-27 22:55:40.906574 => 2023-06-27 22:55:40.913240
[0m22:55:40.914092 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_tax_rate
[0m22:55:40.921698 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:41.753012 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_tax_rate"
[0m22:55:41.753804 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_tax_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_tax_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_tax_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salestaxrateid as sales_tax_rate_id
      , stateprovinceid as state_province_id
      , taxtype as tax_type
      , taxrate as tax_rate
      , name as name_tax_rate_desciption
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salestaxrate`
  )

select  *
from source_data
    );
  
[0m22:55:42.131352 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b12a9203-cedf-4d59-9166-52d1fd008059&page=queryresults
[0m22:55:42.134129 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_reason (execute): 2023-06-27 22:55:38.177057 => 2023-06-27 22:55:42.134064
[0m22:55:42.135008 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07078d00>]}
[0m22:55:42.135593 [info ] [Thread-3 (]: 31 of 39 OK created sql table model dev_thaina_silver.stg_sales_reason ......... [[32mCREATE TABLE (10.0 rows, 305.0 Bytes processed)[0m in 4.08s]
[0m22:55:42.136281 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_reason
[0m22:55:42.136990 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_territory
[0m22:55:42.137919 [info ] [Thread-3 (]: 33 of 39 START sql table model dev_thaina_silver.stg_sales_territory ........... [RUN]
[0m22:55:42.139380 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_territory'
[0m22:55:42.139904 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_territory
[0m22:55:42.144115 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_territory"
[0m22:55:42.144900 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_territory (compile): 2023-06-27 22:55:42.140281 => 2023-06-27 22:55:42.144748
[0m22:55:42.145582 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_territory
[0m22:55:42.151960 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:42.213072 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9dbf8e6f-d2cc-4247-b584-e4dc44f31a34&page=queryresults
[0m22:55:42.217197 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person (execute): 2023-06-27 22:55:38.094013 => 2023-06-27 22:55:42.217121
[0m22:55:42.218643 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0713a5c0>]}
[0m22:55:42.219413 [info ] [Thread-4 (]: 29 of 39 OK created sql table model dev_thaina_silver.stg_sales_person ......... [[32mCREATE TABLE (17.0 rows, 1.5 KB processed)[0m in 4.17s]
[0m22:55:42.220151 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_person
[0m22:55:42.221260 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_address
[0m22:55:42.222291 [info ] [Thread-4 (]: 34 of 39 START sql table model dev_thaina_intermediate.int_address ............. [RUN]
[0m22:55:42.224225 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m22:55:42.224880 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_address
[0m22:55:42.235112 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m22:55:42.241012 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-06-27 22:55:42.225353 => 2023-06-27 22:55:42.240709
[0m22:55:42.241989 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.int_address
[0m22:55:42.253887 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m22:55:42.255360 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:42.260065 [debug] [Thread-4 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, union_address_business_address as (
    select
        address.address_id
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
        , business_entity_id
        , address_type_id
    from address 
    left join business_entity_address  
    on address.address_id = business_entity_address.address_id
   
)

, union_address_business_contact as (
    select
        union_address_business_address.*
        , address_type_name
        , contact_type_id
    from business_entity_contact
    left join  union_address_business_address
    on union_address_business_address.business_entity_id = business_entity_contact.business_entity_id
    left join address_type 
    on address_type.address_type_id = union_address_business_address.address_type_id
)

select * 
from union_address_business_contact
    );
  
[0m22:55:42.417927 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e1ec1d60-a521-4b10-9e62-399eed971e0a&page=queryresults
[0m22:55:42.421050 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (execute): 2023-06-27 22:55:38.138957 => 2023-06-27 22:55:42.420981
[0m22:55:42.422031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff04489420>]}
[0m22:55:42.422673 [info ] [Thread-1 (]: 30 of 39 OK created sql table model dev_thaina_silver.stg_sales_person_quota_history  [[32mCREATE TABLE (163.0 rows, 12.6 KB processed)[0m in 4.37s]
[0m22:55:42.423783 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_person_quota_history
[0m22:55:42.424727 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_product
[0m22:55:42.425665 [info ] [Thread-1 (]: 35 of 39 START sql table model dev_thaina_intermediate.int_product ............. [RUN]
[0m22:55:42.427645 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m22:55:42.428295 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_product
[0m22:55:42.440260 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m22:55:42.441665 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-06-27 22:55:42.428938 => 2023-06-27 22:55:42.441491
[0m22:55:42.442798 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_product
[0m22:55:42.449973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:43.134084 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_territory"
[0m22:55:43.134776 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_territory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_territory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
    );
  
[0m22:55:43.343051 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m22:55:43.343763 [debug] [Thread-1 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_all as (
    select 
        product.product_id
        , product_model_id
        , subcategory_id
        , category.category_id
        , location.location_id
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , list_price
        , size_product
        , style_product
        , weight_product
        , location_name
        , cost_rate
        , availability
        , shelf
        , bin
        , quantity_inventory
        , model_name
    from product
    left join subcategory
    on product.product_subcategory_id = subcategory.subcategory_id
    left join category
    on subcategory.category_id = category.category_id
    left join inventory 
    on inventory.product_id = product.product_id
  	left join location
  	on location.location_id = inventory.location_id
    left join model
    on product.product_model_id = model.model_id
)

select * 
from union_all
    );
  
[0m22:55:44.878304 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8be4aedf-996a-4322-bb56-4da1a0498767&page=queryresults
[0m22:55:44.881006 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (execute): 2023-06-27 22:55:40.914690 => 2023-06-27 22:55:44.880938
[0m22:55:44.881876 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff06f7c7f0>]}
[0m22:55:44.882455 [info ] [Thread-2 (]: 32 of 39 OK created sql table model dev_thaina_silver.stg_sales_tax_rate ....... [[32mCREATE TABLE (29.0 rows, 2.6 KB processed)[0m in 3.98s]
[0m22:55:44.883200 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_tax_rate
[0m22:55:44.884004 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_sales
[0m22:55:44.884843 [info ] [Thread-2 (]: 36 of 39 START sql table model dev_thaina_intermediate.int_sales ............... [RUN]
[0m22:55:44.886256 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m22:55:44.886706 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_sales
[0m22:55:44.892713 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m22:55:44.893693 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-06-27 22:55:44.887093 => 2023-06-27 22:55:44.893528
[0m22:55:44.894692 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.int_sales
[0m22:55:44.903044 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m22:55:44.905227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:55:44.910718 [debug] [Thread-2 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, sales_order_detail_id
		, carrier_tracking_number
		, order_qty
		, product_id
		, unit_price
		, unit_price_discount
	from order_header
	left join order_header_reason
	on order_header_reason.sales_order_id = order_header.sales_order_id
	left join order_detail 
	on order_detail.sales_order_id =  order_header.sales_order_id
)

select * from union_header_reason
    );
  
[0m22:55:46.023150 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b9567e0f-f6fd-49ae-8eb2-bc73ddca2955&page=queryresults
[0m22:55:46.030002 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_territory (execute): 2023-06-27 22:55:42.146215 => 2023-06-27 22:55:46.029904
[0m22:55:46.031344 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0707bcd0>]}
[0m22:55:46.032179 [info ] [Thread-3 (]: 33 of 39 OK created sql table model dev_thaina_silver.stg_sales_territory ...... [[32mCREATE TABLE (10.0 rows, 925.0 Bytes processed)[0m in 3.89s]
[0m22:55:46.033037 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_territory
[0m22:55:46.035158 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_customer
[0m22:55:46.035945 [info ] [Thread-3 (]: 37 of 39 START sql table model dev_thaina_intermediate.int_customer ............ [RUN]
[0m22:55:46.037429 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer'
[0m22:55:46.038019 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_customer
[0m22:55:46.049016 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_customer"
[0m22:55:46.050016 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_customer (compile): 2023-06-27 22:55:46.038414 => 2023-06-27 22:55:46.049868
[0m22:55:46.050799 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.int_customer
[0m22:55:46.066649 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.int_customer"
[0m22:55:46.067797 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:46.070839 [debug] [Thread-3 (]: On model.desafioaethaina.int_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , group_geo
        , sales_territory_year
        , bussiness_cost_in_territory
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

select * 
from union_customer_country
    );
  
[0m22:55:46.592442 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:491d6287-53ca-4905-a913-8c188be8a427&page=queryresults
[0m22:55:46.595844 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-06-27 22:55:42.242537 => 2023-06-27 22:55:46.595748
[0m22:55:46.597085 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0713b3d0>]}
[0m22:55:46.602567 [info ] [Thread-4 (]: 34 of 39 OK created sql table model dev_thaina_intermediate.int_address ........ [[32mCREATE TABLE (921.0 rows, 1.5 MB processed)[0m in 4.37s]
[0m22:55:46.603391 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_address
[0m22:55:46.848908 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ed402f2a-b85f-4f8e-9101-1fd0a77de5fe&page=queryresults
[0m22:55:46.854001 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-06-27 22:55:42.443637 => 2023-06-27 22:55:46.853888
[0m22:55:46.856669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff04488160>]}
[0m22:55:46.862595 [info ] [Thread-1 (]: 35 of 39 OK created sql table model dev_thaina_intermediate.int_product ........ [[32mCREATE TABLE (1.1k rows, 83.4 KB processed)[0m in 4.43s]
[0m22:55:46.864934 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_product
[0m22:55:50.386506 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:499b29f6-db78-4132-aef4-4bf7bc4505ea&page=queryresults
[0m22:55:50.389703 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_customer (execute): 2023-06-27 22:55:46.051658 => 2023-06-27 22:55:50.389599
[0m22:55:50.391123 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff070f82e0>]}
[0m22:55:50.392836 [info ] [Thread-3 (]: 37 of 39 OK created sql table model dev_thaina_intermediate.int_customer ....... [[32mCREATE TABLE (10.3k rows, 1.2 MB processed)[0m in 4.35s]
[0m22:55:50.394560 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_customer
[0m22:55:50.396146 [debug] [Thread-4 (]: Began running node model.desafioaethaina.dim_customer
[0m22:55:50.396972 [info ] [Thread-4 (]: 38 of 39 START sql table model dev_thaina_gold.dim_customer .................... [RUN]
[0m22:55:50.398666 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customer'
[0m22:55:50.399195 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.dim_customer
[0m22:55:50.403401 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.dim_customer"
[0m22:55:50.404143 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_customer (compile): 2023-06-27 22:55:50.399527 => 2023-06-27 22:55:50.404023
[0m22:55:50.404623 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.dim_customer
[0m22:55:50.410188 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.dim_customer"
[0m22:55:50.410827 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:50.413425 [debug] [Thread-4 (]: On model.desafioaethaina.dim_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customer`
    
    
    OPTIONS(
      description="""This table contains information about customers of Adventure Works"""
    )
    as (
      with int_customer as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by customer_id order by customer_id) as dedup_index
    from int_customer
)

, customer_with_sk  as (
    select
        xxhash64(customer_id) as customer_sk
        , full_name
		, suffix
		, store_id
		, territory_id 
        , person_type
		, name_style
		, courtesy_title
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m22:55:50.855522 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bd622c0a-4a27-4e1b-92c1-6a51d40e058d&page=queryresults
[0m22:55:50.860255 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-06-27 22:55:44.895135 => 2023-06-27 22:55:50.860128
[0m22:55:50.862673 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07a932b0>]}
[0m22:55:50.864164 [info ] [Thread-2 (]: 36 of 39 OK created sql table model dev_thaina_intermediate.int_sales .......... [[32mCREATE TABLE (131.9k rows, 14.2 MB processed)[0m in 5.98s]
[0m22:55:50.865787 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_sales
[0m22:55:50.867628 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_customer_and_sales
[0m22:55:50.868639 [info ] [Thread-3 (]: 39 of 39 START sql table model dev_thaina_intermediate.int_customer_and_sales .. [RUN]
[0m22:55:50.870304 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer_and_sales'
[0m22:55:50.870881 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_customer_and_sales
[0m22:55:50.878022 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_customer_and_sales"
[0m22:55:50.879566 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_customer_and_sales (compile): 2023-06-27 22:55:50.871277 => 2023-06-27 22:55:50.879321
[0m22:55:50.880558 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.int_customer_and_sales
[0m22:55:50.889531 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.int_customer_and_sales"
[0m22:55:50.890830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:50.894506 [debug] [Thread-3 (]: On model.desafioaethaina.int_customer_and_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`	
)

, sales as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, business_entity_id
		, person_type
		, name_style
		, courtesy_title
		, first_name
		, middle_name
		, last_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m22:55:52.168148 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: xxhash64 at [27:9]')
[0m22:55:52.636365 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: business_entity_id at [31:19]')
[0m22:55:53.474151 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:82bb5e2a-1195-44c0-a3e9-f2001aa936dc&page=queryresults
[0m22:55:53.475943 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_customer (execute): 2023-06-27 22:55:50.404925 => 2023-06-27 22:55:53.475667
[0m22:55:53.479730 [debug] [Thread-4 (]: Database Error in model dim_customer (models/gold/dim_customer.sql)
  Function not found: xxhash64 at [27:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customer.sql
[0m22:55:53.480301 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff045ddc90>]}
[0m22:55:53.481211 [error] [Thread-4 (]: 38 of 39 ERROR creating sql table model dev_thaina_gold.dim_customer ........... [[31mERROR[0m in 3.08s]
[0m22:55:53.482166 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.dim_customer
[0m22:55:54.517130 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:515d69c6-3cc3-4336-901b-c5bb0b9280d8&page=queryresults
[0m22:55:54.518047 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_customer_and_sales (execute): 2023-06-27 22:55:50.881117 => 2023-06-27 22:55:54.517898
[0m22:55:54.519915 [debug] [Thread-3 (]: Database Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)
  Unrecognized name: business_entity_id at [31:19]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_customer_and_sales.sql
[0m22:55:54.520619 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3800846-04af-486f-914f-7ab7cd8996b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff06f7c7f0>]}
[0m22:55:54.521491 [error] [Thread-3 (]: 39 of 39 ERROR creating sql table model dev_thaina_intermediate.int_customer_and_sales  [[31mERROR[0m in 3.65s]
[0m22:55:54.522388 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_customer_and_sales
[0m22:55:54.524394 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:55:54.525741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:54.526288 [debug] [MainThread]: Connection 'model.desafioaethaina.int_product' was properly closed.
[0m22:55:54.526793 [debug] [MainThread]: Connection 'model.desafioaethaina.int_customer_and_sales' was properly closed.
[0m22:55:54.527255 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customer' was properly closed.
[0m22:55:54.527744 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m22:55:54.528521 [info ] [MainThread]: 
[0m22:55:54.529655 [info ] [MainThread]: Finished running 39 table models in 0 hours 0 minutes and 53.35 seconds (53.35s).
[0m22:55:54.534621 [debug] [MainThread]: Command end result
[0m22:55:54.590948 [info ] [MainThread]: 
[0m22:55:54.592074 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:55:54.593093 [info ] [MainThread]: 
[0m22:55:54.595566 [error] [MainThread]: [33mDatabase Error in model dim_customer (models/gold/dim_customer.sql)[0m
[0m22:55:54.597918 [error] [MainThread]:   Function not found: xxhash64 at [27:9]
[0m22:55:54.600686 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customer.sql
[0m22:55:54.601671 [info ] [MainThread]: 
[0m22:55:54.602615 [error] [MainThread]: [33mDatabase Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)[0m
[0m22:55:54.604242 [error] [MainThread]:   Unrecognized name: business_entity_id at [31:19]
[0m22:55:54.605102 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_customer_and_sales.sql
[0m22:55:54.606023 [info ] [MainThread]: 
[0m22:55:54.606874 [info ] [MainThread]: Done. PASS=37 WARN=0 ERROR=2 SKIP=0 TOTAL=39
[0m22:55:54.608055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0447e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07114640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff07a80460>]}
[0m22:55:54.608772 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 22:56:51.407209 | f421fdd9-d6e2-4e65-8133-d3307e2360c0 ==============================
[0m22:56:51.407209 [info ] [MainThread]: Running with dbt=1.4.6
[0m22:56:51.409837 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_customer_and_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:56:51.410479 [debug] [MainThread]: Tracking: tracking
[0m22:56:51.413062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116228f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116228e740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116228f340>]}
[0m22:56:51.458866 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m22:56:51.609114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:56:51.610067 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_customer_and_sales.sql
[0m22:56:51.633793 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m22:56:51.670757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f421fdd9-d6e2-4e65-8133-d3307e2360c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11620680d0>]}
[0m22:56:51.692440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f421fdd9-d6e2-4e65-8133-d3307e2360c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116211fbb0>]}
[0m22:56:51.692962 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m22:56:51.693576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f421fdd9-d6e2-4e65-8133-d3307e2360c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1162297820>]}
[0m22:56:51.697245 [info ] [MainThread]: 
[0m22:56:51.699763 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:56:51.701361 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m22:56:51.702011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:52.597723 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m22:56:52.598695 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m22:56:52.600132 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m22:56:52.600835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:56:52.602050 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m22:56:52.603039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:52.603494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:52.638393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:54.039562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f421fdd9-d6e2-4e65-8133-d3307e2360c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116218f430>]}
[0m22:56:54.040920 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:56:54.041779 [info ] [MainThread]: 
[0m22:56:54.046963 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_customer_and_sales
[0m22:56:54.047715 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_customer_and_sales .... [RUN]
[0m22:56:54.049157 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer_and_sales'
[0m22:56:54.049850 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_customer_and_sales
[0m22:56:54.058647 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_customer_and_sales"
[0m22:56:54.060128 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (compile): 2023-06-27 22:56:54.050258 => 2023-06-27 22:56:54.059816
[0m22:56:54.060973 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_customer_and_sales
[0m22:56:54.171512 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_customer_and_sales"
[0m22:56:54.172806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:54.176495 [debug] [Thread-1 (]: On model.desafioaethaina.int_customer_and_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`	
)

, sales as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, person_type
		, name_style
		, courtesy_title
		, first_name
		, middle_name
		, last_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m22:56:56.062847 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: first_name; Did you mean full_name? at [34:19]')
[0m22:56:57.514756 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cf1514ca-09c3-4bcd-8cbd-fc816e929b2e&page=queryresults
[0m22:56:57.515532 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (execute): 2023-06-27 22:56:54.061689 => 2023-06-27 22:56:57.515401
[0m22:56:57.519720 [debug] [Thread-1 (]: Database Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)
  Unrecognized name: first_name; Did you mean full_name? at [34:19]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_customer_and_sales.sql
[0m22:56:57.520482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f421fdd9-d6e2-4e65-8133-d3307e2360c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11618df4c0>]}
[0m22:56:57.521341 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_customer_and_sales  [[31mERROR[0m in 3.47s]
[0m22:56:57.524890 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_customer_and_sales
[0m22:56:57.527008 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:56:57.528493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:57.529412 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m22:56:57.530128 [debug] [MainThread]: Connection 'model.desafioaethaina.int_customer_and_sales' was properly closed.
[0m22:56:57.530795 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m22:56:57.531731 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m22:56:57.532365 [info ] [MainThread]: 
[0m22:56:57.533272 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m22:56:57.534240 [debug] [MainThread]: Command end result
[0m22:56:57.586779 [info ] [MainThread]: 
[0m22:56:57.588559 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:56:57.590022 [info ] [MainThread]: 
[0m22:56:57.591607 [error] [MainThread]: [33mDatabase Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)[0m
[0m22:56:57.593167 [error] [MainThread]:   Unrecognized name: first_name; Did you mean full_name? at [34:19]
[0m22:56:57.594946 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_customer_and_sales.sql
[0m22:56:57.596009 [info ] [MainThread]: 
[0m22:56:57.596847 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:56:57.597856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116228e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1162296800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1161fb7760>]}
[0m22:56:57.598532 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 22:57:21.565961 | eedc854d-0d17-48ab-a5d8-24324b5b77af ==============================
[0m22:57:21.565961 [info ] [MainThread]: Running with dbt=1.4.6
[0m22:57:21.569268 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_customer_and_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:57:21.569767 [debug] [MainThread]: Tracking: tracking
[0m22:57:21.573426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520a2566b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520a255030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520a2548e0>]}
[0m22:57:21.627549 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m22:57:21.880779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:57:21.881972 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_customer_and_sales.sql
[0m22:57:21.923940 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m22:57:22.021732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eedc854d-0d17-48ab-a5d8-24324b5b77af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5209e60250>]}
[0m22:57:22.068294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eedc854d-0d17-48ab-a5d8-24324b5b77af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5209eebf10>]}
[0m22:57:22.069533 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m22:57:22.070942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eedc854d-0d17-48ab-a5d8-24324b5b77af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520a22a110>]}
[0m22:57:22.078977 [info ] [MainThread]: 
[0m22:57:22.082667 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:57:22.083993 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m22:57:22.084502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:23.104086 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m22:57:23.104686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:23.105974 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m22:57:23.108283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m22:57:23.108594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:23.142918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:23.144146 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m22:57:23.243327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:24.649595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eedc854d-0d17-48ab-a5d8-24324b5b77af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520a0352d0>]}
[0m22:57:24.650849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:57:24.651576 [info ] [MainThread]: 
[0m22:57:24.656444 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_customer_and_sales
[0m22:57:24.657272 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_customer_and_sales .... [RUN]
[0m22:57:24.658666 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer_and_sales'
[0m22:57:24.659103 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_customer_and_sales
[0m22:57:24.664144 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_customer_and_sales"
[0m22:57:24.665130 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (compile): 2023-06-27 22:57:24.659487 => 2023-06-27 22:57:24.664980
[0m22:57:24.666200 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_customer_and_sales
[0m22:57:24.756042 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_customer_and_sales"
[0m22:57:24.756761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:24.760085 [debug] [Thread-1 (]: On model.desafioaethaina.int_customer_and_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`	
)

, sales as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, person_type
		, name_style
		, courtesy_title
		, full_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m22:57:30.881583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a190c330-d3bd-4750-bd46-f331b702cdb9&page=queryresults
[0m22:57:30.898840 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (execute): 2023-06-27 22:57:24.666924 => 2023-06-27 22:57:30.898771
[0m22:57:30.900116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eedc854d-0d17-48ab-a5d8-24324b5b77af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52094af7f0>]}
[0m22:57:30.900713 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_customer_and_sales  [[32mCREATE TABLE (44.6k rows, 39.4 MB processed)[0m in 6.24s]
[0m22:57:30.903238 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_customer_and_sales
[0m22:57:30.905283 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:57:30.906499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:30.907030 [debug] [MainThread]: Connection 'model.desafioaethaina.int_customer_and_sales' was properly closed.
[0m22:57:30.907500 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m22:57:30.907976 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m22:57:30.908431 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m22:57:30.908963 [info ] [MainThread]: 
[0m22:57:30.909828 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.83 seconds (8.83s).
[0m22:57:30.910837 [debug] [MainThread]: Command end result
[0m22:57:30.962028 [info ] [MainThread]: 
[0m22:57:30.963865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:57:30.965257 [info ] [MainThread]: 
[0m22:57:30.966962 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:57:30.969018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520a229ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520e4014b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52094cf400>]}
[0m22:57:30.970514 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 23:00:18.039856 | eb0199ec-e354-4d1e-9088-edc159088520 ==============================
[0m23:00:18.039856 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:00:18.044833 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:00:18.046414 [debug] [MainThread]: Tracking: tracking
[0m23:00:18.049885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede0256c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede0256260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede0256770>]}
[0m23:00:18.116918 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:00:18.293567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:18.293988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:18.311473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb0199ec-e354-4d1e-9088-edc159088520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feddfdde0b0>]}
[0m23:00:18.338310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb0199ec-e354-4d1e-9088-edc159088520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede002b640>]}
[0m23:00:18.339323 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m23:00:18.340149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb0199ec-e354-4d1e-9088-edc159088520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede002b730>]}
[0m23:00:18.346242 [info ] [MainThread]: 
[0m23:00:18.349365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:00:18.351227 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m23:00:18.352181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:19.440446 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m23:00:19.441391 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m23:00:19.442059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:19.443205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m23:00:19.444543 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m23:00:19.445198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:19.485129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:19.487138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:21.293514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb0199ec-e354-4d1e-9088-edc159088520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feddfd837c0>]}
[0m23:00:21.296508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:21.298089 [info ] [MainThread]: 
[0m23:00:21.306155 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customer
[0m23:00:21.307201 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customer ...................... [RUN]
[0m23:00:21.311736 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customer'
[0m23:00:21.313529 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customer
[0m23:00:21.322997 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customer"
[0m23:00:21.324554 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (compile): 2023-06-27 23:00:21.314051 => 2023-06-27 23:00:21.324383
[0m23:00:21.325290 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customer
[0m23:00:21.408528 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customer"
[0m23:00:21.409200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:21.413544 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customer`
    
    
    OPTIONS(
      description="""This table contains information about customers of Adventure Works"""
    )
    as (
      with int_customer as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by customer_id order by customer_id) as dedup_index
    from int_customer
)

, customer_with_sk  as (
    select
        xxhash64(customer_id) as customer_sk
        , full_name
		, suffix
		, store_id
		, territory_id 
        , person_type
		, name_style
		, courtesy_title
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m23:00:23.013322 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: xxhash64 at [27:9]')
[0m23:00:24.961047 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b687d803-ce35-4616-888d-61055a92a014&page=queryresults
[0m23:00:24.962759 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (execute): 2023-06-27 23:00:21.325726 => 2023-06-27 23:00:24.962593
[0m23:00:24.970405 [debug] [Thread-1 (]: Database Error in model dim_customer (models/gold/dim_customer.sql)
  Function not found: xxhash64 at [27:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customer.sql
[0m23:00:24.971232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb0199ec-e354-4d1e-9088-edc159088520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feddfe4a950>]}
[0m23:00:24.972105 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_customer ............. [[31mERROR[0m in 3.66s]
[0m23:00:24.976212 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customer
[0m23:00:24.980693 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:00:24.982675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:24.984020 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m23:00:24.984559 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customer' was properly closed.
[0m23:00:24.984989 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m23:00:24.985730 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m23:00:24.986664 [info ] [MainThread]: 
[0m23:00:24.991282 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.64 seconds (6.64s).
[0m23:00:24.994484 [debug] [MainThread]: Command end result
[0m23:00:25.053932 [info ] [MainThread]: 
[0m23:00:25.057885 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:00:25.059583 [info ] [MainThread]: 
[0m23:00:25.060952 [error] [MainThread]: [33mDatabase Error in model dim_customer (models/gold/dim_customer.sql)[0m
[0m23:00:25.062484 [error] [MainThread]:   Function not found: xxhash64 at [27:9]
[0m23:00:25.065041 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customer.sql
[0m23:00:25.067361 [info ] [MainThread]: 
[0m23:00:25.069238 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:00:25.071806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede00298d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede002b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede0029810>]}
[0m23:00:25.073672 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 23:07:22.202788 | 0d6e10ed-f5bd-4817-8393-972fd4b64f1a ==============================
[0m23:07:22.202788 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:07:22.205176 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_customer_and_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:07:22.205757 [debug] [MainThread]: Tracking: tracking
[0m23:07:22.207982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c8862620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c8860fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c88607c0>]}
[0m23:07:22.256695 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:07:22.380422 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:07:22.381105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d6e10ed-f5bd-4817-8393-972fd4b64f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c8879bd0>]}
[0m23:07:24.384272 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m23:07:24.406696 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m23:07:24.413951 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m23:07:24.421405 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m23:07:24.426848 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer.sql
[0m23:07:24.434196 [debug] [MainThread]: 1603: static parser failed on gold/dim_dates.sql
[0m23:07:24.485288 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim_dates.sql
[0m23:07:24.491068 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m23:07:24.502454 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_description.sql
[0m23:07:24.509243 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_location.sql
[0m23:07:24.517087 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_inventory.sql
[0m23:07:24.522507 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_subcategory.sql
[0m23:07:24.528180 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_category.sql
[0m23:07:24.536073 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product.sql
[0m23:07:24.541490 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_model.sql
[0m23:07:24.547598 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_detail.sql
[0m23:07:24.553591 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_ship_method.sql
[0m23:07:24.559152 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_product_vendor.sql
[0m23:07:24.567775 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_header.sql
[0m23:07:24.572992 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_vendor.sql
[0m23:07:24.579133 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_detail.sql
[0m23:07:24.585886 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency.sql
[0m23:07:24.591778 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_territory.sql
[0m23:07:24.598566 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency_rate.sql
[0m23:07:24.604059 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_reason.sql
[0m23:07:24.609904 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_customer.sql
[0m23:07:24.617384 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_country_region_currency.sql
[0m23:07:24.623261 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person.sql
[0m23:07:24.628380 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_tax_rate.sql
[0m23:07:24.636083 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person_quota_history.sql
[0m23:07:24.641714 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header_reason.sql
[0m23:07:24.646978 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header.sql
[0m23:07:24.654819 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_address_type.sql
[0m23:07:24.659896 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_state_province.sql
[0m23:07:24.666426 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_person.sql
[0m23:07:24.671902 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_address.sql
[0m23:07:24.676450 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_contact_type.sql
[0m23:07:24.682737 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_business_entity_address.sql
[0m23:07:24.688244 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_country_region.sql
[0m23:07:24.693927 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_business_entity_contact.sql
[0m23:07:25.281454 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.desafiothaina
- models.desafiothaina.gold
- models.desafiothaina.intermediate
- models.desafiothaina.silver
[0m23:07:25.298640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d6e10ed-f5bd-4817-8393-972fd4b64f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c7a000d0>]}
[0m23:07:25.356027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d6e10ed-f5bd-4817-8393-972fd4b64f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c838cfd0>]}
[0m23:07:25.356765 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m23:07:25.357325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d6e10ed-f5bd-4817-8393-972fd4b64f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c88795a0>]}
[0m23:07:25.364541 [info ] [MainThread]: 
[0m23:07:25.369327 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:07:25.371816 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m23:07:25.372708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:26.487130 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m23:07:26.487911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:27.412331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d6e10ed-f5bd-4817-8393-972fd4b64f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c7a02920>]}
[0m23:07:27.413770 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:27.414603 [info ] [MainThread]: 
[0m23:07:27.421206 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_customer_and_sales
[0m23:07:27.422153 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_thaina.int_customer_and_sales .................. [RUN]
[0m23:07:27.424027 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer_and_sales'
[0m23:07:27.424680 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_customer_and_sales
[0m23:07:27.439985 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_customer_and_sales"
[0m23:07:27.441997 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (compile): 2023-06-27 23:07:27.425149 => 2023-06-27 23:07:27.441828
[0m23:07:27.443252 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_customer_and_sales
[0m23:07:27.619964 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_customer_and_sales"
[0m23:07:27.621019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:27.624741 [debug] [Thread-1 (]: On model.desafioaethaina.int_customer_and_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */


  create or replace view `desafiothaina`.`dev_thaina`.`int_customer_and_sales`
  OPTIONS()
  as with customer as (
	select * 
	from `desafiothaina`.`dev_thaina`.`int_customer`	
)

, sales as (
	select * 
	from `desafiothaina`.`dev_thaina`.`int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, person_type
		, name_style
		, courtesy_title
		, full_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason;


[0m23:07:28.731883 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */


  create or replace view `desafiothaina`.`dev_thaina`.`int_customer_and_sales`
  OPTIONS()
  as with customer as (
	select * 
	from `desafiothaina`.`dev_thaina`.`int_customer`	
)

, sales as (
	select * 
	from `desafiothaina`.`dev_thaina`.`int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, person_type
		, name_style
		, courtesy_title
		, full_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason;


[0m23:07:28.733605 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table desafiothaina:dev_thaina.int_customer was not found in location US

Location: US
Job ID: 4d7f29e5-04ec-47f3-9e94-1b6ec4296ad9

[0m23:07:28.734372 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (execute): 2023-06-27 23:07:27.444097 => 2023-06-27 23:07:28.734262
[0m23:07:28.737768 [debug] [Thread-1 (]: Runtime Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)
  404 Not found: Table desafiothaina:dev_thaina.int_customer was not found in location US
  
  Location: US
  Job ID: 4d7f29e5-04ec-47f3-9e94-1b6ec4296ad9
  
[0m23:07:28.738279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6e10ed-f5bd-4817-8393-972fd4b64f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c7b14940>]}
[0m23:07:28.738888 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev_thaina.int_customer_and_sales ......... [[31mERROR[0m in 1.32s]
[0m23:07:28.741602 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_customer_and_sales
[0m23:07:28.744779 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:07:28.747354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:28.749106 [debug] [MainThread]: Connection 'model.desafioaethaina.int_customer_and_sales' was properly closed.
[0m23:07:28.749841 [info ] [MainThread]: 
[0m23:07:28.750736 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m23:07:28.751737 [debug] [MainThread]: Command end result
[0m23:07:28.807322 [info ] [MainThread]: 
[0m23:07:28.808305 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:07:28.811864 [info ] [MainThread]: 
[0m23:07:28.814278 [error] [MainThread]: [33mRuntime Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)[0m
[0m23:07:28.818920 [error] [MainThread]:   404 Not found: Table desafiothaina:dev_thaina.int_customer was not found in location US
[0m23:07:28.820064 [error] [MainThread]:   
[0m23:07:28.822457 [error] [MainThread]:   Location: US
[0m23:07:28.824642 [error] [MainThread]:   Job ID: 4d7f29e5-04ec-47f3-9e94-1b6ec4296ad9
[0m23:07:28.826605 [error] [MainThread]:   
[0m23:07:28.827442 [info ] [MainThread]: 
[0m23:07:28.828269 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:07:28.831017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c7a6c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c79ab970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c79abf40>]}
[0m23:07:28.834043 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 23:08:50.236400 | 3a61d6b4-3f54-421f-a846-190d4653c893 ==============================
[0m23:08:50.236400 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:08:50.238398 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_customer_and_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:08:50.238849 [debug] [MainThread]: Tracking: tracking
[0m23:08:50.241239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8089a8a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8089a893c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8089a8a3e0>]}
[0m23:08:50.310653 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:08:50.389600 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:08:50.390355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a61d6b4-3f54-421f-a846-190d4653c893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8089a9d180>]}
[0m23:08:51.832743 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m23:08:51.848986 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m23:08:51.854357 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m23:08:51.859803 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m23:08:51.865246 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer.sql
[0m23:08:51.870304 [debug] [MainThread]: 1603: static parser failed on gold/dim_dates.sql
[0m23:08:51.906555 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim_dates.sql
[0m23:08:51.910283 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m23:08:51.915444 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_description.sql
[0m23:08:51.920237 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_location.sql
[0m23:08:51.924999 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_inventory.sql
[0m23:08:51.929719 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_subcategory.sql
[0m23:08:51.934703 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_category.sql
[0m23:08:51.939416 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product.sql
[0m23:08:51.944113 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_model.sql
[0m23:08:51.949130 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_detail.sql
[0m23:08:51.953963 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_ship_method.sql
[0m23:08:51.962191 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_product_vendor.sql
[0m23:08:51.969244 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_header.sql
[0m23:08:51.974396 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_vendor.sql
[0m23:08:51.979486 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_detail.sql
[0m23:08:51.984564 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency.sql
[0m23:08:51.989818 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_territory.sql
[0m23:08:51.994906 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency_rate.sql
[0m23:08:51.999909 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_reason.sql
[0m23:08:52.005282 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_customer.sql
[0m23:08:52.010447 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_country_region_currency.sql
[0m23:08:52.015603 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person.sql
[0m23:08:52.021164 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_tax_rate.sql
[0m23:08:52.025940 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person_quota_history.sql
[0m23:08:52.030842 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header_reason.sql
[0m23:08:52.035588 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header.sql
[0m23:08:52.041406 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_address_type.sql
[0m23:08:52.046222 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_state_province.sql
[0m23:08:52.050976 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_person.sql
[0m23:08:52.056050 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_address.sql
[0m23:08:52.061100 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_contact_type.sql
[0m23:08:52.065922 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_business_entity_address.sql
[0m23:08:52.070648 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_country_region.sql
[0m23:08:52.076369 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_business_entity_contact.sql
[0m23:08:52.561834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a61d6b4-3f54-421f-a846-190d4653c893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8089781990>]}
[0m23:08:52.583704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a61d6b4-3f54-421f-a846-190d4653c893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80891065f0>]}
[0m23:08:52.584237 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m23:08:52.584817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a61d6b4-3f54-421f-a846-190d4653c893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808996bc10>]}
[0m23:08:52.588660 [info ] [MainThread]: 
[0m23:08:52.591194 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:08:52.593172 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m23:08:52.594175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:53.517478 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m23:08:53.518880 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m23:08:53.519561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:53.520648 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m23:08:53.520974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:53.521887 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m23:08:53.557078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:53.593338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:55.068453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a61d6b4-3f54-421f-a846-190d4653c893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8089781990>]}
[0m23:08:55.070794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:08:55.072640 [info ] [MainThread]: 
[0m23:08:55.078302 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_customer_and_sales
[0m23:08:55.078863 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_customer_and_sales .... [RUN]
[0m23:08:55.080145 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer_and_sales'
[0m23:08:55.080567 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_customer_and_sales
[0m23:08:55.094541 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_customer_and_sales"
[0m23:08:55.095518 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (compile): 2023-06-27 23:08:55.080843 => 2023-06-27 23:08:55.095336
[0m23:08:55.096066 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_customer_and_sales
[0m23:08:55.205201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:56.091656 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_customer_and_sales"
[0m23:08:56.092893 [debug] [Thread-1 (]: On model.desafioaethaina.int_customer_and_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with customer as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`	
)

, sales as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, person_type
		, name_style
		, courtesy_title
		, full_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m23:09:01.806179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:47d7a5f8-2257-4511-8bfa-519b20afc444&page=queryresults
[0m23:09:01.849998 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (execute): 2023-06-27 23:08:55.096653 => 2023-06-27 23:09:01.849869
[0m23:09:01.851625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a61d6b4-3f54-421f-a846-190d4653c893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8088e8b0a0>]}
[0m23:09:01.852520 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_customer_and_sales  [[32mCREATE TABLE (44.6k rows, 39.4 MB processed)[0m in 6.77s]
[0m23:09:01.856057 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_customer_and_sales
[0m23:09:01.859424 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:09:01.860726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:01.861119 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m23:09:01.861623 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m23:09:01.862127 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m23:09:01.862716 [debug] [MainThread]: Connection 'model.desafioaethaina.int_customer_and_sales' was properly closed.
[0m23:09:01.863475 [info ] [MainThread]: 
[0m23:09:01.866299 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m23:09:01.867893 [debug] [MainThread]: Command end result
[0m23:09:01.919110 [info ] [MainThread]: 
[0m23:09:01.919980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:09:01.920769 [info ] [MainThread]: 
[0m23:09:01.921613 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:09:01.922706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80890d0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8088e8a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8088e8a890>]}
[0m23:09:01.923503 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 23:09:46.718388 | 6929366c-1f24-47fe-9edf-d7189bcdbeb6 ==============================
[0m23:09:46.718388 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:09:46.720279 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m23:09:46.720754 [debug] [MainThread]: Tracking: tracking
[0m23:09:46.722809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0206aa2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0206af7c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0206af7af0>]}
[0m23:09:46.794192 [debug] [MainThread]: Executing "git --help"
[0m23:09:46.797642 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:09:46.798228 [debug] [MainThread]: STDERR: "b''"
[0m23:09:46.799542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0206af5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0206af79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0206af5300>]}
[0m23:09:46.802076 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 23:09:57.023459 | ee7bf7cc-d1f3-4bfb-a252-24c59b962f98 ==============================
[0m23:09:57.023459 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:09:57.025660 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m23:09:57.026128 [debug] [MainThread]: Tracking: tracking
[0m23:09:57.028202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3fa9ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3faf3c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3faf3ac0>]}
[0m23:09:57.469651 [debug] [MainThread]: Executing "git --help"
[0m23:09:57.471971 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:09:57.472363 [debug] [MainThread]: STDERR: "b''"
[0m23:09:57.476665 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m23:09:57.477332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:57.481736 [debug] [MainThread]: On debug: select 1 as id
[0m23:09:59.352267 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1cb30f4c-78d0-4998-bb90-1abe5c851a72&page=queryresults
[0m23:09:59.352876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3dd93d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3dd92740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3dd92ef0>]}
[0m23:09:59.353571 [debug] [MainThread]: Flushing usage events
[0m23:10:00.576282 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-06-27 23:11:00.670928 | d413aaf4-3caf-4559-98cf-ebb0dd8fbf52 ==============================
[0m23:11:00.670928 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:11:00.673903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:11:00.674425 [debug] [MainThread]: Tracking: tracking
[0m23:11:00.676726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ed282530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ed281cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ed282500>]}
[0m23:11:00.739333 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:11:00.944237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:11:00.945348 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_product.sql
[0m23:11:00.946303 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m23:11:00.947033 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m23:11:00.979177 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m23:11:01.000259 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m23:11:01.010861 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m23:11:01.059112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd413aaf4-3caf-4559-98cf-ebb0dd8fbf52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ecfe4d90>]}
[0m23:11:01.091635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd413aaf4-3caf-4559-98cf-ebb0dd8fbf52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ed285c00>]}
[0m23:11:01.092523 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m23:11:01.093482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd413aaf4-3caf-4559-98cf-ebb0dd8fbf52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ed286860>]}
[0m23:11:01.101494 [info ] [MainThread]: 
[0m23:11:01.106075 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:11:01.109164 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m23:11:01.110225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:02.058892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m23:11:02.059810 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m23:11:02.061104 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m23:11:02.061893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:02.062981 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m23:11:02.068545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:02.069159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:02.113941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:03.568615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd413aaf4-3caf-4559-98cf-ebb0dd8fbf52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ecfe9450>]}
[0m23:11:03.570032 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:11:03.570905 [info ] [MainThread]: 
[0m23:11:03.578098 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m23:11:03.578938 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_address ............... [RUN]
[0m23:11:03.580500 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m23:11:03.581155 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m23:11:03.594221 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m23:11:03.595388 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-06-27 23:11:03.581646 => 2023-06-27 23:11:03.595236
[0m23:11:03.596046 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m23:11:03.649948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:04.574572 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m23:11:04.576266 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, union_address_business_address as (
    select
        address.address_id
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
        , business_entity_id
        , address_type_id
    from address 
    left join business_entity_address  
    on address.address_id = business_entity_address.address_id
   
)

, union_address_business_contact as (
    select
        union_address_business_address.*
        , address_type_name
        , contact_type_id
    from business_entity_contact
    left join  union_address_business_address
    on union_address_business_address.business_entity_id = business_entity_contact.business_entity_id
    left join address_type 
    on address_type.address_type_id = union_address_business_address.address_type_id
)

select * 
from union_address_business_contact
    );
  
[0m23:11:07.838911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a0a31211-6d49-41b3-94f7-b54cd12b8fce&page=queryresults
[0m23:11:07.864784 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-06-27 23:11:03.596472 => 2023-06-27 23:11:07.864715
[0m23:11:07.865678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd413aaf4-3caf-4559-98cf-ebb0dd8fbf52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ec6d7c70>]}
[0m23:11:07.866533 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_address .......... [[32mCREATE TABLE (921.0 rows, 1.5 MB processed)[0m in 4.29s]
[0m23:11:07.869996 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m23:11:07.872290 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:11:07.873458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:07.873867 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m23:11:07.874254 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m23:11:07.874603 [debug] [MainThread]: Connection 'model.desafioaethaina.int_address' was properly closed.
[0m23:11:07.874931 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m23:11:07.875314 [info ] [MainThread]: 
[0m23:11:07.875960 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m23:11:07.876845 [debug] [MainThread]: Command end result
[0m23:11:07.927882 [info ] [MainThread]: 
[0m23:11:07.929463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:07.930631 [info ] [MainThread]: 
[0m23:11:07.932011 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:11:07.934301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f1551450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ed285c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ed2857e0>]}
[0m23:11:07.935968 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 23:12:18.848362 | 89e71dc6-a7ed-44d5-92c7-7fe34416d8d1 ==============================
[0m23:12:18.848362 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:12:18.850400 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:12:18.850890 [debug] [MainThread]: Tracking: tracking
[0m23:12:18.853757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2db28ed70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2db28e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2db28e740>]}
[0m23:12:18.902160 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:12:19.045910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:12:19.046248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:12:19.059640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89e71dc6-a7ed-44d5-92c7-7fe34416d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2db006080>]}
[0m23:12:19.081934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89e71dc6-a7ed-44d5-92c7-7fe34416d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2db22b610>]}
[0m23:12:19.082490 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m23:12:19.083142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89e71dc6-a7ed-44d5-92c7-7fe34416d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2db22b700>]}
[0m23:12:19.084946 [warn ] [MainThread]: The selection criterion 'dim' does not match any nodes
[0m23:12:19.088062 [info ] [MainThread]: 
[0m23:12:19.088798 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:12:19.089608 [debug] [MainThread]: Command end result
[0m23:12:19.116122 [debug] [MainThread]: Flushing usage events
[0m23:12:20.240211 [info ] [MainThread]: ctrl-c


============================== 2023-06-27 23:12:26.773098 | a9c4b7f5-4aec-4842-bb0d-8e3aef4b6cd8 ==============================
[0m23:12:26.773098 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:12:26.775023 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_dates'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:12:26.775454 [debug] [MainThread]: Tracking: tracking
[0m23:12:26.778237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cb7664d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cb7653f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cb7664a0>]}
[0m23:12:26.817391 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:12:27.062514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:12:27.063242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:12:27.081961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9c4b7f5-4aec-4842-bb0d-8e3aef4b6cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cb2d9c90>]}
[0m23:12:27.128483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9c4b7f5-4aec-4842-bb0d-8e3aef4b6cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cb53b1f0>]}
[0m23:12:27.129279 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m23:12:27.130145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c4b7f5-4aec-4842-bb0d-8e3aef4b6cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cb53b370>]}
[0m23:12:27.137968 [info ] [MainThread]: 
[0m23:12:27.143335 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:12:27.146635 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m23:12:27.147653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:28.244085 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m23:12:28.245624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:28.294215 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m23:12:28.296357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:28.349278 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m23:12:28.353884 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m23:12:28.355257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:28.356878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:29.881620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c4b7f5-4aec-4842-bb0d-8e3aef4b6cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cb290bb0>]}
[0m23:12:29.882718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:29.883771 [info ] [MainThread]: 
[0m23:12:29.892411 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m23:12:29.893280 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_dates ......................... [RUN]
[0m23:12:29.894849 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m23:12:29.895524 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m23:12:29.994216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:29.997920 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m23:12:32.228109 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a0d5f5e1-22ff-410c-a069-9abf295c602d&page=queryresults
[0m23:12:32.244912 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m23:12:32.245854 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-06-27 23:12:29.895986 => 2023-06-27 23:12:32.245618
[0m23:12:32.247022 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m23:12:32.763588 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m23:12:32.764642 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      


/* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m23:12:37.553439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a0a08e8a-dee1-41b8-8fb0-e251eaca850b&page=queryresults
[0m23:12:38.465805 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-06-27 23:12:32.247878 => 2023-06-27 23:12:38.465735
[0m23:12:38.467752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c4b7f5-4aec-4842-bb0d-8e3aef4b6cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cb34a2c0>]}
[0m23:12:38.469248 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_dates .................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 8.57s]
[0m23:12:38.473376 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m23:12:38.475333 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:12:38.476359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:38.476815 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m23:12:38.477189 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_dates' was properly closed.
[0m23:12:38.477572 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m23:12:38.477943 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m23:12:38.478398 [info ] [MainThread]: 
[0m23:12:38.479127 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.34 seconds (11.34s).
[0m23:12:38.480089 [debug] [MainThread]: Command end result
[0m23:12:38.515785 [info ] [MainThread]: 
[0m23:12:38.517951 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:12:38.519111 [info ] [MainThread]: 
[0m23:12:38.520002 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:12:38.521109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cebfa260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cb290b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cb290af0>]}
[0m23:12:38.522575 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 23:13:16.894623 | 8fbbd761-e8d3-4458-a94e-017e6671e379 ==============================
[0m23:13:16.894623 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:13:16.899540 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_dates'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:13:16.900248 [debug] [MainThread]: Tracking: tracking
[0m23:13:16.909083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8422372620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8422371060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84223725f0>]}
[0m23:13:17.001557 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:13:17.193512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:13:17.195089 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_dates.sql
[0m23:13:17.250453 [debug] [MainThread]: 1603: static parser failed on gold/dim_dates.sql
[0m23:13:17.336838 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim_dates.sql
[0m23:13:17.411907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fbbd761-e8d3-4458-a94e-017e6671e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8421e0db10>]}
[0m23:13:17.439311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fbbd761-e8d3-4458-a94e-017e6671e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8422003940>]}
[0m23:13:17.439923 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m23:13:17.440616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fbbd761-e8d3-4458-a94e-017e6671e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84223768c0>]}
[0m23:13:17.447262 [info ] [MainThread]: 
[0m23:13:17.451291 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:13:17.454396 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m23:13:17.455603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:18.407670 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m23:13:18.408390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:18.409440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m23:13:18.410708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m23:13:18.411504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:18.412353 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m23:13:18.446852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:18.482096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:20.035040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fbbd761-e8d3-4458-a94e-017e6671e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84220039d0>]}
[0m23:13:20.037045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:13:20.037563 [info ] [MainThread]: 
[0m23:13:20.041865 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m23:13:20.042561 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_dates ......................... [RUN]
[0m23:13:20.044204 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m23:13:20.044687 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m23:13:20.066708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:20.072428 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m23:13:22.290010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cb0cd6bc-ab36-4bdd-a1a8-98740f74a725&page=queryresults
[0m23:13:22.293096 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m23:13:22.293828 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-06-27 23:13:20.045131 => 2023-06-27 23:13:22.293707
[0m23:13:22.294301 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m23:13:22.630952 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m23:13:22.631678 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      /* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m23:13:27.288821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4e4027dd-578f-4299-8ec7-a8664996d477&page=queryresults
[0m23:13:28.236936 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-06-27 23:13:22.294710 => 2023-06-27 23:13:28.236853
[0m23:13:28.238584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbbd761-e8d3-4458-a94e-017e6671e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8421e54be0>]}
[0m23:13:28.239935 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_dates .................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 8.19s]
[0m23:13:28.243657 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m23:13:28.246546 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:13:28.249256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:28.250992 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m23:13:28.251612 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m23:13:28.252151 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m23:13:28.252686 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_dates' was properly closed.
[0m23:13:28.253339 [info ] [MainThread]: 
[0m23:13:28.254315 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.81 seconds (10.81s).
[0m23:13:28.255489 [debug] [MainThread]: Command end result
[0m23:13:28.300881 [info ] [MainThread]: 
[0m23:13:28.301880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:13:28.302643 [info ] [MainThread]: 
[0m23:13:28.303352 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:13:28.304260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8421f0a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8422375840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8421c8bd90>]}
[0m23:13:28.304919 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 23:27:21.013185 | 25f298b4-e494-4863-8989-77720d781178 ==============================
[0m23:27:21.013185 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:27:21.016887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:27:21.017713 [debug] [MainThread]: Tracking: tracking
[0m23:27:21.020309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc117733d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc11772c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc117733a0>]}
[0m23:27:21.082089 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:27:21.223020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1158e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc113ae5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc113ae650>]}
[0m23:27:21.223559 [debug] [MainThread]: Flushing usage events
[0m23:27:22.146028 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading desafioaethaina: gold/dim_products.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |     - name: dim_products
    5  |         description: This table contains information about customer of Adventure Works
    6  |         columns:
    7  |         - name: product_sk
    8  |             description: Single promo record.
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 20


============================== 2023-06-27 23:27:56.176951 | 1f4633b2-d2da-45e2-bf14-9503485a784d ==============================
[0m23:27:56.176951 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:27:56.179213 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:27:56.179652 [debug] [MainThread]: Tracking: tracking
[0m23:27:56.181780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daf17a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daf179060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daf17a5f0>]}
[0m23:27:56.208700 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:27:56.338737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daef963e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daed8e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daed8e9b0>]}
[0m23:27:56.339194 [debug] [MainThread]: Flushing usage events
[0m23:27:57.369527 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading desafioaethaina: gold/dim_products.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |     - name: dim_products
    5  |         description: This table contains information about customer of Adventure Works
    6  |         columns:
    7  |             - name: product_sk
    8  |                 description: Single promo record.
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 20


============================== 2023-06-27 23:28:31.296598 | d6c24e1f-e34e-4357-827e-158f163a59ca ==============================
[0m23:28:31.296598 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:28:31.299572 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:28:31.300346 [debug] [MainThread]: Tracking: tracking
[0m23:28:31.302564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0836e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0836dcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0836e410>]}
[0m23:28:31.349199 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:28:31.536747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:28:31.537699 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.sql
[0m23:28:31.560866 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m23:28:31.633553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6c24e1f-e34e-4357-827e-158f163a59ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a07f3beb0>]}
[0m23:28:31.655875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6c24e1f-e34e-4357-827e-158f163a59ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a07ffee00>]}
[0m23:28:31.656470 [info ] [MainThread]: Found 39 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m23:28:31.657117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c24e1f-e34e-4357-827e-158f163a59ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a08345de0>]}
[0m23:28:31.663556 [info ] [MainThread]: 
[0m23:28:31.667393 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:28:31.669868 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m23:28:31.670922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:32.809707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m23:28:32.810903 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m23:28:32.811292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:32.812273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m23:28:32.813313 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m23:28:32.813848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:32.814538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:32.849832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:34.142367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c24e1f-e34e-4357-827e-158f163a59ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0836c970>]}
[0m23:28:34.145152 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:28:34.146744 [info ] [MainThread]: 
[0m23:28:34.158690 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customer
[0m23:28:34.159425 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customer ...................... [RUN]
[0m23:28:34.160883 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customer'
[0m23:28:34.161261 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customer
[0m23:28:34.178420 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customer"
[0m23:28:34.179111 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (compile): 2023-06-27 23:28:34.161655 => 2023-06-27 23:28:34.178983
[0m23:28:34.179664 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customer
[0m23:28:34.260884 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customer"
[0m23:28:34.261544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:34.264097 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customer`
    
    
    OPTIONS(
      description="""This table contains information about customers of Adventure Works"""
    )
    as (
      with int_customer as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by customer_id order by customer_id) as dedup_index
    from int_customer
)

, customer_with_sk  as (
    select
        row_number() over (order by customer_id) as customer_sk
        , full_name
		, suffix
		, store_id
		, territory_id 
        , person_type
		, name_style
		, courtesy_title
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m23:28:37.997589 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3055ffac-d468-44b9-bda4-d931f3556870&page=queryresults
[0m23:28:38.796642 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (execute): 2023-06-27 23:28:34.180046 => 2023-06-27 23:28:38.796562
[0m23:28:38.797819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6c24e1f-e34e-4357-827e-158f163a59ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0813cbb0>]}
[0m23:28:38.798729 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customer ................. [[32mCREATE TABLE (10.3k rows, 538.9 KB processed)[0m in 4.64s]
[0m23:28:38.801351 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customer
[0m23:28:38.803264 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:28:38.804441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:38.804919 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m23:28:38.805414 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m23:28:38.805865 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customer' was properly closed.
[0m23:28:38.806290 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m23:28:38.806842 [info ] [MainThread]: 
[0m23:28:38.807597 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.14 seconds (7.14s).
[0m23:28:38.808756 [debug] [MainThread]: Command end result
[0m23:28:38.838363 [info ] [MainThread]: 
[0m23:28:38.839604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:28:38.840745 [info ] [MainThread]: 
[0m23:28:38.841599 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:28:38.842482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0c4994e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a07ffe7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a08345000>]}
[0m23:28:38.843147 [debug] [MainThread]: Flushing usage events


============================== 2023-06-27 23:59:12.310911 | 731fffc7-6f73-451b-ba04-bc1191825825 ==============================
[0m23:59:12.310911 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:59:12.313484 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_product'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:59:12.314367 [debug] [MainThread]: Tracking: tracking
[0m23:59:12.316578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9068fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9068f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9068f820>]}
[0m23:59:12.368803 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:59:12.544009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m23:59:12.545180 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.yml
[0m23:59:12.545891 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.sql
[0m23:59:12.546612 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_product.sql
[0m23:59:12.571333 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m23:59:12.587975 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m23:59:12.605539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce903d6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce904545e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce90455510>]}
[0m23:59:12.606048 [debug] [MainThread]: Flushing usage events
[0m23:59:14.228708 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/gold/dim_products.yml @ models: {'name': 'dim_product', 'description': 'This table contains information about products of Adventure Works', 'columns': [{'name': 'product_sk', 'description': 'Single promo record.', 'tests': ['not_null', 'unique']}, {'name': 'category_name', 'description': "product's name description."}, {'name': 'subcategory_name'}, {'name': 'product_name'}, {'name': 'product_number'}, {'name': 'makeflag'}, {'name': 'finished_goods_flag'}, {'name': None}, {'name': None}, {'name': None}, {'name': None}, {'name': None}, {'name': None}], 'original_file_path': 'models/gold/dim_products.yml', 'yaml_key': 'models', 'package_name': 'desafioaethaina'} - at path ['columns'][7]['name']: None is not of type 'string'


============================== 2023-06-27 23:59:44.847154 | 4c0b780a-e4fb-4a4f-83ed-0911c5033e71 ==============================
[0m23:59:44.847154 [info ] [MainThread]: Running with dbt=1.4.6
[0m23:59:44.849241 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_product'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:59:44.849726 [debug] [MainThread]: Tracking: tracking
[0m23:59:44.851977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6865b67400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6865b664a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6865b673d0>]}
[0m23:59:44.877230 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m23:59:45.078021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m23:59:45.079088 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.yml
[0m23:59:45.079531 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.sql
[0m23:59:45.079955 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_product.sql
[0m23:59:45.103685 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m23:59:45.119509 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m23:59:45.136386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686593fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6865727af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6865727d00>]}
[0m23:59:45.136825 [debug] [MainThread]: Flushing usage events
[0m23:59:46.185405 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/gold/dim_products.yml @ models: {'name': 'dim_product', 'description': 'This table contains information about products of Adventure Works', 'columns': [{'name': 'product_sk', 'description': 'Single promo record.', 'tests': ['not_null', 'unique']}, {'name': 'category_name', 'description': "product's name description."}, {'name': 'subcategory_name'}, {'name': 'product_name'}, {'name': 'product_number'}, {'name': 'makeflag'}, {'name': 'finished_goods_flag'}, {'name': None}, {'name': None}, {'name': None}, {'name': None}, {'name': None}, {'name': None}], 'original_file_path': 'models/gold/dim_products.yml', 'yaml_key': 'models', 'package_name': 'desafioaethaina'} - at path ['columns'][7]['name']: None is not of type 'string'


============================== 2023-06-28 00:00:12.149147 | 2c12bfb8-e9cf-4f7b-a3a0-7e00a274f4bd ==============================
[0m00:00:12.149147 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:00:12.151647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_product'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:00:12.152200 [debug] [MainThread]: Tracking: tracking
[0m00:00:12.155140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9876a63eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9876a63730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9876a63e80>]}
[0m00:00:12.208128 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:00:12.382573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m00:00:12.383464 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.sql
[0m00:00:12.384243 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.yml
[0m00:00:12.384970 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_product.sql
[0m00:00:12.410511 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m00:00:12.427889 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m00:00:12.450027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f987683b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9876623520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9876623be0>]}
[0m00:00:12.450539 [debug] [MainThread]: Flushing usage events
[0m00:00:13.724348 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/gold/dim_products.yml @ models: {'name': 'dim_product', 'description': 'This table contains information about products of Adventure Works', 'columns': [{'name': 'product_sk', 'description': 'Single promo record.', 'tests': ['not_null', 'unique']}, {'name': 'category_name', 'description': "product's name description."}, {'name': 'subcategory_name'}, {'name': 'product_name'}, {'name': 'product_number'}, {'name': 'makeflag'}, {'name': 'finished_goods_flag'}, {'name': None}, {'name': None}, {'name': None}, {'name': None}, {'name': None}, {'name': None}], 'original_file_path': 'models/gold/dim_products.yml', 'yaml_key': 'models', 'package_name': 'desafioaethaina'} - at path ['columns'][7]['name']: None is not of type 'string'


============================== 2023-06-28 00:02:56.985683 | 100c5f42-8447-4539-a1c6-82c2d3bc568f ==============================
[0m00:02:56.985683 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:02:56.987928 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_product'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:02:56.988474 [debug] [MainThread]: Tracking: tracking
[0m00:02:56.991282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d02b8a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d02b891e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d02b8a770>]}
[0m00:02:57.042900 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:02:57.170733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m00:02:57.171658 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.yml
[0m00:02:57.172251 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.sql
[0m00:02:57.172833 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_product.sql
[0m00:02:57.207823 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m00:02:57.225160 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m00:02:57.255247 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_product' in the 'models' section of file 'models/gold/dim_products.yml'
[0m00:02:57.299497 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.not_null_dim_product_product_sk.271feb5417' (models/gold/dim_products.yml) depends on a node named 'dim_product' in package '' which was not found
[0m00:02:57.300607 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c' (models/gold/dim_products.yml) depends on a node named 'dim_product' in package '' which was not found
[0m00:02:57.333854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '100c5f42-8447-4539-a1c6-82c2d3bc568f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d01ffbeb0>]}
[0m00:02:57.370507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '100c5f42-8447-4539-a1c6-82c2d3bc568f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d02a1a590>]}
[0m00:02:57.371016 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m00:02:57.371534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100c5f42-8447-4539-a1c6-82c2d3bc568f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d02b92ec0>]}
[0m00:02:57.375795 [info ] [MainThread]: 
[0m00:02:57.378758 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:02:57.380795 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m00:02:57.381759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:58.444415 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m00:02:58.445774 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m00:02:58.446220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:02:58.447533 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m00:02:58.447825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:58.448699 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m00:02:58.451415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:58.484461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:00.092300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100c5f42-8447-4539-a1c6-82c2d3bc568f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d02aab5b0>]}
[0m00:03:00.097025 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:03:00.099052 [info ] [MainThread]: 
[0m00:03:00.114793 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_product
[0m00:03:00.115863 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_product ............... [RUN]
[0m00:03:00.119157 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m00:03:00.119801 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_product
[0m00:03:00.131530 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m00:03:00.135818 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-06-28 00:03:00.120243 => 2023-06-28 00:03:00.135528
[0m00:03:00.137053 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_product
[0m00:03:00.188726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:01.181539 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m00:03:01.182780 [debug] [Thread-1 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from subcategory
    left join product
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from category
	left join union_product_subcategory
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from model
	left join union_product_category
    on union_product_category.product_model_id = model.model_id
)

, union_product_location as (
    select 
        union_product_model.*
        , location_name
        , cost_rate as cost_rate_location
        , availability as availability_location
    from location
    left join union_product_model
    on union_product_model.location_id = location.location_id
)

, union_product_inventory as (
    select 
        union_product_location.*
        , quantity_inventory
        , shelf
        , bin
    from inventory
    left join union_product_inventory
    on union_product_inventory.product_id = inventory.product_id
)

select * 
from union_product_inventory
    );
  
[0m00:03:01.559352 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "union_product_inventory" must be qualified with a dataset (e.g. dataset.table).')
[0m00:03:02.379457 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8ea37586-e8a1-4cd5-b4e1-3fdd8cd2468a&page=queryresults
[0m00:03:02.380306 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-06-28 00:03:00.137859 => 2023-06-28 00:03:02.380173
[0m00:03:02.383090 [debug] [Thread-1 (]: Database Error in model int_product (models/intermediate/int_product.sql)
  Table "union_product_inventory" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/desafioaethaina/models/intermediate/int_product.sql
[0m00:03:02.383805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100c5f42-8447-4539-a1c6-82c2d3bc568f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d02043d60>]}
[0m00:03:02.384483 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_product ...... [[31mERROR[0m in 2.27s]
[0m00:03:02.387035 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_product
[0m00:03:02.388931 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:03:02.391068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:02.391796 [debug] [MainThread]: Connection 'model.desafioaethaina.int_product' was properly closed.
[0m00:03:02.392405 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m00:03:02.392816 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m00:03:02.393284 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m00:03:02.395426 [info ] [MainThread]: 
[0m00:03:02.400036 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m00:03:02.402744 [debug] [MainThread]: Command end result
[0m00:03:02.441870 [info ] [MainThread]: 
[0m00:03:02.442722 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:03:02.443593 [info ] [MainThread]: 
[0m00:03:02.444519 [error] [MainThread]: [33mDatabase Error in model int_product (models/intermediate/int_product.sql)[0m
[0m00:03:02.445482 [error] [MainThread]:   Table "union_product_inventory" must be qualified with a dataset (e.g. dataset.table).
[0m00:03:02.446429 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_product.sql
[0m00:03:02.447430 [info ] [MainThread]: 
[0m00:03:02.448457 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:03:02.449593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d02b91270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0205c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0205fc70>]}
[0m00:03:02.450431 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 00:03:28.298029 | 7231a73a-5365-4f43-aff8-fd2fc82d87e2 ==============================
[0m00:03:28.298029 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:03:28.300207 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_product'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:03:28.300806 [debug] [MainThread]: Tracking: tracking
[0m00:03:28.303139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6e92680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6e910c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6e92650>]}
[0m00:03:28.343871 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:03:28.486551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:03:28.486895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:03:28.500317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7231a73a-5365-4f43-aff8-fd2fc82d87e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6c1bf10>]}
[0m00:03:28.524086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7231a73a-5365-4f43-aff8-fd2fc82d87e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6bbfeb0>]}
[0m00:03:28.524864 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m00:03:28.525608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7231a73a-5365-4f43-aff8-fd2fc82d87e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6bd42b0>]}
[0m00:03:28.529561 [info ] [MainThread]: 
[0m00:03:28.532297 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:03:28.533716 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m00:03:28.534270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:29.420794 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m00:03:29.421450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:29.422567 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m00:03:29.423882 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m00:03:29.461899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:29.461037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m00:03:29.458776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:29.462890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:30.807433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7231a73a-5365-4f43-aff8-fd2fc82d87e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6eabca0>]}
[0m00:03:30.809231 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:03:30.809731 [info ] [MainThread]: 
[0m00:03:30.815304 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_product
[0m00:03:30.816106 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_product ............... [RUN]
[0m00:03:30.817756 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m00:03:30.818378 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_product
[0m00:03:30.830967 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m00:03:30.834001 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-06-28 00:03:30.818807 => 2023-06-28 00:03:30.833573
[0m00:03:30.836575 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_product
[0m00:03:30.878402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:31.942794 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m00:03:31.945169 [debug] [Thread-1 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from subcategory
    left join product
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from category
	left join union_product_subcategory
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from model
	left join union_product_category
    on union_product_category.product_model_id = model.model_id
)

, union_product_location as (
    select 
        union_product_model.*
        , location_name
        , cost_rate as cost_rate_location
        , availability as availability_location
    from location
    left join union_product_model
    on union_product_model.location_id = location.location_id
)

, union_product_inventory as (
    select 
        union_product_location.*
        , quantity_inventory
        , shelf
        , bin
    from inventory
    left join union_product_inventory
    on union_product_inventory.product_id = inventory.product_id
)

select * 
from union_product_inventory
    );
  
[0m00:03:32.383775 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "union_product_inventory" must be qualified with a dataset (e.g. dataset.table).')
[0m00:03:33.447613 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:baddfb2e-844b-4b19-b394-d64e0d52dad0&page=queryresults
[0m00:03:33.448562 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-06-28 00:03:30.837715 => 2023-06-28 00:03:33.448428
[0m00:03:33.452703 [debug] [Thread-1 (]: Database Error in model int_product (models/intermediate/int_product.sql)
  Table "union_product_inventory" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/desafioaethaina/models/intermediate/int_product.sql
[0m00:03:33.453452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7231a73a-5365-4f43-aff8-fd2fc82d87e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6c19c90>]}
[0m00:03:33.454350 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_product ...... [[31mERROR[0m in 2.64s]
[0m00:03:33.457766 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_product
[0m00:03:33.460072 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:03:33.462604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:33.463141 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m00:03:33.463615 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m00:03:33.464157 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m00:03:33.464698 [debug] [MainThread]: Connection 'model.desafioaethaina.int_product' was properly closed.
[0m00:03:33.465634 [info ] [MainThread]: 
[0m00:03:33.466606 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m00:03:33.468214 [debug] [MainThread]: Command end result
[0m00:03:33.506901 [info ] [MainThread]: 
[0m00:03:33.508334 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:03:33.510068 [info ] [MainThread]: 
[0m00:03:33.511073 [error] [MainThread]: [33mDatabase Error in model int_product (models/intermediate/int_product.sql)[0m
[0m00:03:33.511847 [error] [MainThread]:   Table "union_product_inventory" must be qualified with a dataset (e.g. dataset.table).
[0m00:03:33.513027 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_product.sql
[0m00:03:33.514542 [info ] [MainThread]: 
[0m00:03:33.516180 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:03:33.518847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6bd4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6c0c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28d6aa3dc0>]}
[0m00:03:33.519556 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 00:04:06.156443 | ccfd0dd0-f390-4394-8db9-7c503252c3bf ==============================
[0m00:04:06.156443 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:04:06.158684 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_product'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:04:06.159197 [debug] [MainThread]: Tracking: tracking
[0m00:04:06.161590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f3967b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f3966620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f3966b90>]}
[0m00:04:06.187399 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:04:06.346552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:04:06.347519 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_product.sql
[0m00:04:06.371819 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m00:04:06.409047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccfd0dd0-f390-4394-8db9-7c503252c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f352cb50>]}
[0m00:04:06.432759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccfd0dd0-f390-4394-8db9-7c503252c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f3603e20>]}
[0m00:04:06.433421 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m00:04:06.433967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccfd0dd0-f390-4394-8db9-7c503252c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f3603ee0>]}
[0m00:04:06.437758 [info ] [MainThread]: 
[0m00:04:06.440349 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:04:06.441784 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m00:04:06.442631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:07.416632 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m00:04:07.417378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:07.418455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m00:04:07.419814 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m00:04:07.420925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m00:04:07.421481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:07.456888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:07.458682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:08.783619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccfd0dd0-f390-4394-8db9-7c503252c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f3497e50>]}
[0m00:04:08.784843 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:04:08.785597 [info ] [MainThread]: 
[0m00:04:08.789962 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_product
[0m00:04:08.790625 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_product ............... [RUN]
[0m00:04:08.791959 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m00:04:08.792489 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_product
[0m00:04:08.802011 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m00:04:08.803941 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-06-28 00:04:08.792979 => 2023-06-28 00:04:08.803458
[0m00:04:08.805847 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_product
[0m00:04:08.843395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:09.788947 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m00:04:09.790645 [debug] [Thread-1 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from subcategory
    left join product
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from category
	left join union_product_subcategory
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from model
	left join union_product_category
    on union_product_category.product_model_id = model.model_id
)

, union_product_location as (
    select 
        union_product_model.*
        , location_name
        , cost_rate as cost_rate_location
        , availability as availability_location
    from location
    left join union_product_model
    on union_product_model.location_id = location.location_id
)

, union_product_inventory as (
    select 
        union_product_location.*
        , quantity_inventory
        , shelf
        , bin
    from inventory
    left join union_product_location
    on union_product_location.product_id = inventory.product_id
)

select * 
from union_product_inventory
    );
  
[0m00:04:11.091482 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name location_id not found inside union_product_model at [79:28]')
[0m00:04:12.732608 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:466dc1cb-bfee-4260-b6c6-2de19e109028&page=queryresults
[0m00:04:12.734086 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-06-28 00:04:08.807162 => 2023-06-28 00:04:12.733775
[0m00:04:12.740420 [debug] [Thread-1 (]: Database Error in model int_product (models/intermediate/int_product.sql)
  Name location_id not found inside union_product_model at [79:28]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_product.sql
[0m00:04:12.743907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccfd0dd0-f390-4394-8db9-7c503252c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f2dd03a0>]}
[0m00:04:12.746058 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_product ...... [[31mERROR[0m in 3.95s]
[0m00:04:12.750769 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_product
[0m00:04:12.758501 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:04:12.763342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:12.764280 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m00:04:12.765171 [debug] [MainThread]: Connection 'model.desafioaethaina.int_product' was properly closed.
[0m00:04:12.766209 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m00:04:12.767070 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m00:04:12.767830 [info ] [MainThread]: 
[0m00:04:12.769698 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m00:04:12.771806 [debug] [MainThread]: Command end result
[0m00:04:12.855857 [info ] [MainThread]: 
[0m00:04:12.857177 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:04:12.858828 [info ] [MainThread]: 
[0m00:04:12.860175 [error] [MainThread]: [33mDatabase Error in model int_product (models/intermediate/int_product.sql)[0m
[0m00:04:12.861620 [error] [MainThread]:   Name location_id not found inside union_product_model at [79:28]
[0m00:04:12.862994 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_product.sql
[0m00:04:12.864060 [info ] [MainThread]: 
[0m00:04:12.864753 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:04:12.865794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f2de8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f2de9db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f2debbe0>]}
[0m00:04:12.866496 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 00:07:12.709015 | 95bc6296-53ce-4f6a-b3c8-872e071f301a ==============================
[0m00:07:12.709015 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:07:12.711274 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_product'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:07:12.711723 [debug] [MainThread]: Tracking: tracking
[0m00:07:12.713724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc94172ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc941726e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc94172e90>]}
[0m00:07:12.761734 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:07:12.909535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:12.910646 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_product.sql
[0m00:07:12.935598 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m00:07:12.974848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95bc6296-53ce-4f6a-b3c8-872e071f301a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc93d60af0>]}
[0m00:07:12.999869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95bc6296-53ce-4f6a-b3c8-872e071f301a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc93e13dc0>]}
[0m00:07:13.000459 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m00:07:13.001192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95bc6296-53ce-4f6a-b3c8-872e071f301a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc93e13e80>]}
[0m00:07:13.005015 [info ] [MainThread]: 
[0m00:07:13.007983 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:07:13.010575 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m00:07:13.011380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:13.943232 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m00:07:13.943682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:13.946516 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m00:07:13.979812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:13.984539 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m00:07:14.018318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:14.019630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m00:07:14.024413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:15.234855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95bc6296-53ce-4f6a-b3c8-872e071f301a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc93e13e20>]}
[0m00:07:15.236029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:07:15.236748 [info ] [MainThread]: 
[0m00:07:15.240757 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_product
[0m00:07:15.241350 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_product ............... [RUN]
[0m00:07:15.242439 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m00:07:15.242852 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_product
[0m00:07:15.250785 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m00:07:15.252209 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-06-28 00:07:15.243107 => 2023-06-28 00:07:15.251913
[0m00:07:15.253711 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_product
[0m00:07:15.287366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:16.127355 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m00:07:16.129243 [debug] [Thread-1 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from subcategory
    left join product
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from category
	left join union_product_subcategory
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from model
	left join union_product_category
    on union_product_category.product_model_id = model.model_id
)

, union_product_inventory as (
    select 
        union_product_model.*
        , quantity_inventory
        , shelf
        , bin
    from inventory
    left join union_product_model
    on union_product_model.product_id = inventory.product_id
)

, union_product_location as (
    select 
        union_product_inventory.*
        , location_name
        , cost_rate as cost_rate_location
        , availability as availability_location
    from location
    left join union_product_inventory
    on union_product_inventory.location_id = location.location_id
)

select * 
from union_product_location
    );
  
[0m00:07:17.357543 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name location_id not found inside union_product_inventory at [90:32]')
[0m00:07:18.639596 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7ecdc0f2-aef4-4273-a16b-8257b349ca9c&page=queryresults
[0m00:07:18.641797 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-06-28 00:07:15.254480 => 2023-06-28 00:07:18.641393
[0m00:07:18.648039 [debug] [Thread-1 (]: Database Error in model int_product (models/intermediate/int_product.sql)
  Name location_id not found inside union_product_inventory at [90:32]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_product.sql
[0m00:07:18.648652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95bc6296-53ce-4f6a-b3c8-872e071f301a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc935e0460>]}
[0m00:07:18.649542 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_product ...... [[31mERROR[0m in 3.41s]
[0m00:07:18.652003 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_product
[0m00:07:18.654371 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:07:18.655843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:18.656338 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m00:07:18.656661 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m00:07:18.657151 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m00:07:18.658030 [debug] [MainThread]: Connection 'model.desafioaethaina.int_product' was properly closed.
[0m00:07:18.659243 [info ] [MainThread]: 
[0m00:07:18.660506 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m00:07:18.661630 [debug] [MainThread]: Command end result
[0m00:07:18.705475 [info ] [MainThread]: 
[0m00:07:18.706696 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:07:18.708104 [info ] [MainThread]: 
[0m00:07:18.709320 [error] [MainThread]: [33mDatabase Error in model int_product (models/intermediate/int_product.sql)[0m
[0m00:07:18.710704 [error] [MainThread]:   Name location_id not found inside union_product_inventory at [90:32]
[0m00:07:18.711628 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_product.sql
[0m00:07:18.712442 [info ] [MainThread]: 
[0m00:07:18.713428 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:07:18.714829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc93e13ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc935faf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc935f8ca0>]}
[0m00:07:18.716281 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 00:11:56.000383 | dada46c2-476a-48a5-ac5e-b2f80c3d0c91 ==============================
[0m00:11:56.000383 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:11:56.003225 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_product'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:11:56.004271 [debug] [MainThread]: Tracking: tracking
[0m00:11:56.008980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e9976c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e9976260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e9976770>]}
[0m00:11:56.066314 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:11:56.277918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:11:56.280228 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_product.sql
[0m00:11:56.308467 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m00:11:56.361038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dada46c2-476a-48a5-ac5e-b2f80c3d0c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e9560cd0>]}
[0m00:11:56.391686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dada46c2-476a-48a5-ac5e-b2f80c3d0c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e9613fa0>]}
[0m00:11:56.393050 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m00:11:56.394338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dada46c2-476a-48a5-ac5e-b2f80c3d0c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e9624100>]}
[0m00:11:56.400289 [info ] [MainThread]: 
[0m00:11:56.404395 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:11:56.405863 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m00:11:56.406379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:57.606573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m00:11:57.607203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:57.608223 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m00:11:57.609385 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m00:11:57.612108 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m00:11:57.650228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:57.651990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:57.652567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:59.211678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dada46c2-476a-48a5-ac5e-b2f80c3d0c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e99762c0>]}
[0m00:11:59.212937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:11:59.213950 [info ] [MainThread]: 
[0m00:11:59.220166 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_product
[0m00:11:59.220986 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_product ............... [RUN]
[0m00:11:59.222473 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m00:11:59.223074 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_product
[0m00:11:59.231152 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m00:11:59.231886 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-06-28 00:11:59.223505 => 2023-06-28 00:11:59.231744
[0m00:11:59.232523 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_product
[0m00:11:59.269807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:00.361069 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m00:12:00.362453 [debug] [Thread-1 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from subcategory
    left join product
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from category
	left join union_product_subcategory
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from model
	left join union_product_category
    on union_product_category.product_model_id = model.model_id
)

, union_product_inventory as (
    select 
        union_product_model.*
        , quantity_inventory
        , shelf
        , bin
    from inventory
    left join union_product_model
    on union_product_model.product_id = inventory.product_id
)

select * 
from union_product_inventory
    );
  
[0m00:12:04.624632 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6a8feb2f-11a1-418d-a4aa-3ffba8783786&page=queryresults
[0m00:12:04.645263 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-06-28 00:11:59.232991 => 2023-06-28 00:12:04.645176
[0m00:12:04.646425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dada46c2-476a-48a5-ac5e-b2f80c3d0c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e8be0580>]}
[0m00:12:04.647125 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_product .......... [[32mCREATE TABLE (1.1k rows, 93.1 KB processed)[0m in 5.42s]
[0m00:12:04.649552 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_product
[0m00:12:04.651415 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:12:04.652876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:04.653281 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m00:12:04.653643 [debug] [MainThread]: Connection 'model.desafioaethaina.int_product' was properly closed.
[0m00:12:04.653951 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m00:12:04.654276 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m00:12:04.654731 [info ] [MainThread]: 
[0m00:12:04.655380 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.25 seconds (8.25s).
[0m00:12:04.656338 [debug] [MainThread]: Command end result
[0m00:12:04.705508 [info ] [MainThread]: 
[0m00:12:04.707312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:12:04.708897 [info ] [MainThread]: 
[0m00:12:04.709808 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:12:04.710703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8eda51480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e8bfba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e8bfb160>]}
[0m00:12:04.711372 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 00:13:04.108293 | c2dc6d75-5414-416e-ac22-8c6c6eff58eb ==============================
[0m00:13:04.108293 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:13:04.110219 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:13:04.110642 [debug] [MainThread]: Tracking: tracking
[0m00:13:04.113134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30bc8a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30bc89d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30bc8a380>]}
[0m00:13:04.158328 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:13:04.309465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:13:04.310658 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_products.sql
[0m00:13:04.334832 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m00:13:04.374040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2dc6d75-5414-416e-ac22-8c6c6eff58eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30ba609a0>]}
[0m00:13:04.398358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2dc6d75-5414-416e-ac22-8c6c6eff58eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30bb27ac0>]}
[0m00:13:04.399012 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m00:13:04.399714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2dc6d75-5414-416e-ac22-8c6c6eff58eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30bb27b80>]}
[0m00:13:04.406587 [info ] [MainThread]: 
[0m00:13:04.410973 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:04.413564 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m00:13:04.414226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:05.465341 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m00:13:05.466025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:05.467275 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m00:13:05.468389 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m00:13:05.470279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:05.471184 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m00:13:05.472778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:05.543613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:06.913673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2dc6d75-5414-416e-ac22-8c6c6eff58eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30b9b6440>]}
[0m00:13:06.916597 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:13:06.917634 [info ] [MainThread]: 
[0m00:13:06.925986 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_products
[0m00:13:06.926506 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m00:13:06.927718 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m00:13:06.928152 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_products
[0m00:13:06.931873 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m00:13:06.932589 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-06-28 00:13:06.928442 => 2023-06-28 00:13:06.932444
[0m00:13:06.933230 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_products
[0m00:13:07.005217 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m00:13:07.005842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:07.008575 [debug] [Thread-1 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_prodcut
)

, prodcut_with_sk  as (
    select
        row_number() over (order by product_id) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m00:13:07.897363 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "int_prodcut" must be qualified with a dataset (e.g. dataset.table).')
[0m00:13:08.629111 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e8b02e32-63e5-472d-8527-0778788a50a0&page=queryresults
[0m00:13:08.630006 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-06-28 00:13:06.933745 => 2023-06-28 00:13:08.629855
[0m00:13:08.633288 [debug] [Thread-1 (]: Database Error in model dim_products (models/gold/dim_products.sql)
  Table "int_prodcut" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/desafioaethaina/models/gold/dim_products.sql
[0m00:13:08.633978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2dc6d75-5414-416e-ac22-8c6c6eff58eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30b0dbf70>]}
[0m00:13:08.634996 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_products ............. [[31mERROR[0m in 1.71s]
[0m00:13:08.637526 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_products
[0m00:13:08.639317 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:08.640415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:08.640931 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m00:13:08.641582 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m00:13:08.642243 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_products' was properly closed.
[0m00:13:08.642704 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m00:13:08.643222 [info ] [MainThread]: 
[0m00:13:08.644363 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m00:13:08.646717 [debug] [MainThread]: Command end result
[0m00:13:08.695089 [info ] [MainThread]: 
[0m00:13:08.696639 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:13:08.697386 [info ] [MainThread]: 
[0m00:13:08.698132 [error] [MainThread]: [33mDatabase Error in model dim_products (models/gold/dim_products.sql)[0m
[0m00:13:08.698907 [error] [MainThread]:   Table "int_prodcut" must be qualified with a dataset (e.g. dataset.table).
[0m00:13:08.700031 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_products.sql
[0m00:13:08.701649 [info ] [MainThread]: 
[0m00:13:08.702781 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:13:08.704111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30ff294b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30ba0e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30bb27af0>]}
[0m00:13:08.705287 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 00:13:29.455195 | 5f35d763-d166-4c33-b192-9541037d1ea6 ==============================
[0m00:13:29.455195 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:13:29.457192 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:13:29.457689 [debug] [MainThread]: Tracking: tracking
[0m00:13:29.460134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40faf66620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40faf65060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40faf665f0>]}
[0m00:13:29.511501 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:13:29.646662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:13:29.647766 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_products.sql
[0m00:13:29.672488 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m00:13:29.687428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40faabb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40faabb880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40faaf4f70>]}
[0m00:13:29.687930 [debug] [MainThread]: Flushing usage events
[0m00:13:30.852371 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.desafioaethaina.dim_products' (models/gold/dim_products.sql) depends on a node named 'int_products' which was not found


============================== 2023-06-28 00:13:45.010793 | f75e952b-3186-4191-a74d-f9ffc7ee653d ==============================
[0m00:13:45.010793 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:13:45.017185 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:13:45.017870 [debug] [MainThread]: Tracking: tracking
[0m00:13:45.021235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f0096770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f00962f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f0096740>]}
[0m00:13:45.070220 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:13:45.213150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:13:45.213565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:13:45.227557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f75e952b-3186-4191-a74d-f9ffc7ee653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37efe122f0>]}
[0m00:13:45.250115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f75e952b-3186-4191-a74d-f9ffc7ee653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37effb3850>]}
[0m00:13:45.250681 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m00:13:45.251252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f75e952b-3186-4191-a74d-f9ffc7ee653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37effb39d0>]}
[0m00:13:45.254995 [info ] [MainThread]: 
[0m00:13:45.257498 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:45.258842 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m00:13:45.259378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:46.223025 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m00:13:46.224242 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m00:13:46.224757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:46.225799 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m00:13:46.226974 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m00:13:46.227424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:46.262382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:46.264170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:47.519562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f75e952b-3186-4191-a74d-f9ffc7ee653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37efdbf9a0>]}
[0m00:13:47.522225 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:13:47.522997 [info ] [MainThread]: 
[0m00:13:47.529161 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_products
[0m00:13:47.530459 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m00:13:47.532210 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m00:13:47.532881 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_products
[0m00:13:47.541586 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m00:13:47.542800 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-06-28 00:13:47.533387 => 2023-06-28 00:13:47.542535
[0m00:13:47.544075 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_products
[0m00:13:47.622070 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m00:13:47.622948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:47.625846 [debug] [Thread-1 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_prodcut
)

, prodcut_with_sk  as (
    select
        row_number() over (order by product_id) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m00:13:48.674844 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "int_prodcut" must be qualified with a dataset (e.g. dataset.table).')
[0m00:13:49.287110 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bb8fd7ea-2949-4428-9403-d6da1da33223&page=queryresults
[0m00:13:49.288119 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-06-28 00:13:47.544822 => 2023-06-28 00:13:49.287961
[0m00:13:49.291549 [debug] [Thread-1 (]: Database Error in model dim_products (models/gold/dim_products.sql)
  Table "int_prodcut" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/desafioaethaina/models/gold/dim_products.sql
[0m00:13:49.292226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f75e952b-3186-4191-a74d-f9ffc7ee653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37efdbf9a0>]}
[0m00:13:49.293250 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_products ............. [[31mERROR[0m in 1.76s]
[0m00:13:49.296459 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_products
[0m00:13:49.299424 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:49.300961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:49.301948 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m00:13:49.302806 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m00:13:49.303561 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m00:13:49.304375 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_products' was properly closed.
[0m00:13:49.305136 [info ] [MainThread]: 
[0m00:13:49.307578 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m00:13:49.310522 [debug] [MainThread]: Command end result
[0m00:13:49.339873 [info ] [MainThread]: 
[0m00:13:49.340736 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:13:49.341486 [info ] [MainThread]: 
[0m00:13:49.342271 [error] [MainThread]: [33mDatabase Error in model dim_products (models/gold/dim_products.sql)[0m
[0m00:13:49.342957 [error] [MainThread]:   Table "int_prodcut" must be qualified with a dataset (e.g. dataset.table).
[0m00:13:49.343614 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_products.sql
[0m00:13:49.344338 [info ] [MainThread]: 
[0m00:13:49.345342 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:13:49.346769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37f34f15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37effb3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37effb37c0>]}
[0m00:13:49.347639 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 00:14:06.358496 | 2c1a2a4a-6bc6-4a88-845d-c718bc220609 ==============================
[0m00:14:06.358496 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:14:06.360434 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:14:06.360856 [debug] [MainThread]: Tracking: tracking
[0m00:14:06.363354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6083b73970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6083b70e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6083b73af0>]}
[0m00:14:06.404815 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:14:06.547290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:06.548214 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_products.sql
[0m00:14:06.572289 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m00:14:06.609607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c1a2a4a-6bc6-4a88-845d-c718bc220609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6083760ee0>]}
[0m00:14:06.633750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c1a2a4a-6bc6-4a88-845d-c718bc220609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60838201c0>]}
[0m00:14:06.634377 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m00:14:06.635088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c1a2a4a-6bc6-4a88-845d-c718bc220609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6083820280>]}
[0m00:14:06.641575 [info ] [MainThread]: 
[0m00:14:06.645551 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:14:06.648046 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m00:14:06.648782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:07.727925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m00:14:07.728589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:07.729708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m00:14:07.730970 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m00:14:07.732051 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m00:14:07.732405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:07.767293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:07.768950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:09.173016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c1a2a4a-6bc6-4a88-845d-c718bc220609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60836f1fc0>]}
[0m00:14:09.174237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:14:09.174959 [info ] [MainThread]: 
[0m00:14:09.179932 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_products
[0m00:14:09.181761 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m00:14:09.183243 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m00:14:09.183882 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_products
[0m00:14:09.190640 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m00:14:09.191586 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-06-28 00:14:09.184320 => 2023-06-28 00:14:09.191443
[0m00:14:09.192271 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_products
[0m00:14:09.277669 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m00:14:09.278289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:09.281188 [debug] [Thread-1 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
)

, prodcut_with_sk  as (
    select
        row_number() over (order by product_id) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m00:14:13.739673 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8b955884-5324-4b5c-bf89-f2a30acf41d0&page=queryresults
[0m00:14:13.761848 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-06-28 00:14:09.192728 => 2023-06-28 00:14:13.761780
[0m00:14:13.762919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c1a2a4a-6bc6-4a88-845d-c718bc220609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6082fdc820>]}
[0m00:14:13.763545 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_products ................. [[32mCREATE TABLE (224.0 rows, 70.9 KB processed)[0m in 4.58s]
[0m00:14:13.766173 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_products
[0m00:14:13.768206 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:14:13.769445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:13.770029 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m00:14:13.770480 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m00:14:13.770900 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_products' was properly closed.
[0m00:14:13.771307 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m00:14:13.771779 [info ] [MainThread]: 
[0m00:14:13.772502 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m00:14:13.773608 [debug] [MainThread]: Command end result
[0m00:14:13.826861 [info ] [MainThread]: 
[0m00:14:13.827764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:13.828566 [info ] [MainThread]: 
[0m00:14:13.829198 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:14:13.830739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6087cfd540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60836f1fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6082febdf0>]}
[0m00:14:13.831257 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 00:14:48.549941 | 7b358cde-6a16-4308-a3e6-e5f513c2dd48 ==============================
[0m00:14:48.549941 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:14:48.554121 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:14:48.554575 [debug] [MainThread]: Tracking: tracking
[0m00:14:48.558384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f08825f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f0880880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f08825c0>]}
[0m00:14:48.621479 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:14:48.922232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:48.924767 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_products.yml
[0m00:14:48.976447 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_product' in the 'models' section of file 'models/gold/dim_products.yml'
[0m00:14:49.062389 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.not_null_dim_product_product_sk.271feb5417' (models/gold/dim_products.yml) depends on a node named 'dim_product' in package '' which was not found
[0m00:14:49.064369 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c' (models/gold/dim_products.yml) depends on a node named 'dim_product' in package '' which was not found
[0m00:14:49.132630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b358cde-6a16-4308-a3e6-e5f513c2dd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f065d330>]}
[0m00:14:49.181284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b358cde-6a16-4308-a3e6-e5f513c2dd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f05abe50>]}
[0m00:14:49.182092 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m00:14:49.182890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b358cde-6a16-4308-a3e6-e5f513c2dd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f05abf40>]}
[0m00:14:49.189233 [info ] [MainThread]: 
[0m00:14:49.192887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:14:49.195549 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m00:14:49.196528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:50.156097 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m00:14:50.157215 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m00:14:50.157625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:50.158751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m00:14:50.159230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:50.160137 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m00:14:50.161648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:50.242642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:52.080447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b358cde-6a16-4308-a3e6-e5f513c2dd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f07834f0>]}
[0m00:14:52.082002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:14:52.082752 [info ] [MainThread]: 
[0m00:14:52.086198 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_products
[0m00:14:52.087175 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m00:14:52.088498 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m00:14:52.089222 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_products
[0m00:14:52.095435 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m00:14:52.096269 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-06-28 00:14:52.089734 => 2023-06-28 00:14:52.096152
[0m00:14:52.096861 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_products
[0m00:14:52.128787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:53.219571 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m00:14:53.221283 [debug] [Thread-1 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
)

, prodcut_with_sk  as (
    select
        row_number() over (order by product_id) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m00:14:56.875036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:896577ed-cde0-47b2-a22b-e2b8295999b6&page=queryresults
[0m00:14:56.899654 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-06-28 00:14:52.097282 => 2023-06-28 00:14:56.899522
[0m00:14:56.901115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b358cde-6a16-4308-a3e6-e5f513c2dd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f056fb80>]}
[0m00:14:56.902060 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_products ................. [[32mCREATE TABLE (224.0 rows, 70.9 KB processed)[0m in 4.81s]
[0m00:14:56.905196 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_products
[0m00:14:56.907131 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:14:56.908191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:56.908587 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m00:14:56.908905 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_products' was properly closed.
[0m00:14:56.909175 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m00:14:56.909485 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m00:14:56.909842 [info ] [MainThread]: 
[0m00:14:56.910440 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m00:14:56.911329 [debug] [MainThread]: Command end result
[0m00:14:56.933728 [info ] [MainThread]: 
[0m00:14:56.934488 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:56.935879 [info ] [MainThread]: 
[0m00:14:56.937558 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:14:56.938884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f056ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f056de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f056c9a0>]}
[0m00:14:56.940211 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 00:32:30.384651 | 15726c1a-8c56-4486-ad9c-ebb5bd5f00bb ==============================
[0m00:32:30.384651 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:32:30.386756 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:32:30.387269 [debug] [MainThread]: Tracking: tracking
[0m00:32:30.389609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1f27a770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1f27a2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1f27a740>]}
[0m00:32:30.444285 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:32:30.584267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m00:32:30.585457 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address.sql
[0m00:32:30.586160 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address.yml
[0m00:32:30.586765 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m00:32:30.611353 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m00:32:30.628244 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m00:32:30.649850 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_product' in the 'models' section of file 'models/gold/dim_address.yml'
[0m00:32:30.685848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1edd7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1ee4bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1ee01750>]}
[0m00:32:30.686702 [debug] [MainThread]: Flushing usage events
[0m00:32:33.560540 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two tests with the name "not_null_dim_product_product_sk" defined on column "product_sk" in "models.dim_product".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (models/gold/dim_address.yml)
  - test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (models/gold/dim_products.yml)


============================== 2023-06-28 00:33:03.705069 | fced9bad-935b-4068-83b0-c602dc8c69de ==============================
[0m00:33:03.705069 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:33:03.708883 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:33:03.710002 [debug] [MainThread]: Tracking: tracking
[0m00:33:03.712470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27a8c80820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27a8c80f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27a8c807c0>]}
[0m00:33:03.760927 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:33:03.961595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m00:33:03.963022 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address.sql
[0m00:33:03.964064 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address.yml
[0m00:33:03.964915 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m00:33:03.999651 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m00:33:04.030752 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m00:33:04.070838 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_product' in the 'models' section of file 'models/gold/dim_address.yml'
[0m00:33:04.107744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27a89ec220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27a8a04250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27a8a04100>]}
[0m00:33:04.108474 [debug] [MainThread]: Flushing usage events
[0m00:33:05.347899 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two tests with the name "not_null_dim_product_product_sk" defined on column "product_sk" in "models.dim_product".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (models/gold/dim_address.yml)
  - test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (models/gold/dim_products.yml)


============================== 2023-06-28 00:33:50.688264 | 010e0a3d-049d-4e74-95e6-5a800d6fda76 ==============================
[0m00:33:50.688264 [info ] [MainThread]: Running with dbt=1.4.6
[0m00:33:50.690429 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:33:50.690994 [debug] [MainThread]: Tracking: tracking
[0m00:33:50.693392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da1a62620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da1a60fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da1a607c0>]}
[0m00:33:50.747918 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m00:33:50.895402 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
[0m00:33:50.896167 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address.sql
[0m00:33:50.896722 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address.yml
[0m00:33:50.897178 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_products.sql
[0m00:33:50.897781 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m00:33:50.921120 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m00:33:50.937292 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m00:33:50.958940 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_product' in the 'models' section of file 'models/gold/dim_address.yml'
[0m00:33:51.000676 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.not_null_dim_product_product_sk.271feb5417' (models/gold/dim_address.yml) depends on a node named 'dim_product' in package '' which was not found
[0m00:33:51.002768 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c' (models/gold/dim_address.yml) depends on a node named 'dim_product' in package '' which was not found
[0m00:33:51.038735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '010e0a3d-049d-4e74-95e6-5a800d6fda76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da0cf96c0>]}
[0m00:33:51.072293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '010e0a3d-049d-4e74-95e6-5a800d6fda76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da17028f0>]}
[0m00:33:51.072928 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m00:33:51.073615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '010e0a3d-049d-4e74-95e6-5a800d6fda76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da16c6da0>]}
[0m00:33:51.077316 [info ] [MainThread]: 
[0m00:33:51.079943 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:33:51.081714 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m00:33:51.082537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:52.252210 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m00:33:52.253165 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m00:33:52.253879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:52.254937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m00:33:52.256008 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m00:33:52.256528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:52.257252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:52.294273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:53.698218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '010e0a3d-049d-4e74-95e6-5a800d6fda76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da1596d70>]}
[0m00:33:53.699399 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:33:53.700197 [info ] [MainThread]: 
[0m00:33:53.709652 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m00:33:53.711178 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_address ............... [RUN]
[0m00:33:53.713156 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m00:33:53.714037 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m00:33:53.721032 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m00:33:53.722165 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-06-28 00:33:53.714836 => 2023-06-28 00:33:53.721942
[0m00:33:53.722811 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m00:33:53.757079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:33:54.648180 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m00:33:54.649431 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, union_address_business_contact as (
    select
        business_entity_address.business_entity_id
        , address_id
        , address_type_id
        , contact_type_id
    from business_entity_contact
    left join  business_entity_address
    on business_entity_address.business_entity_id = business_entity_contact.business_entity_id
)


, union_address_type as (
    select
        union_address_business_contact.*
        , address_type.address_type_id
        , contact_type_id
    from address_type
    left join union_address_business_contact
    on address_type.address_type_id = union_address_business_contact.address_type_id
)

, union_address_business_address as (
    select
    	union_address_type.*
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
        , business_entity_id
    from union_address_type
    left join address 
    on address.address_id = union_address_type.address_id
   
)

select * 
from union_address_business_address
    );
  
[0m00:33:55.889000 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name address_type_id at [13:7]')
[0m00:33:57.367153 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4cd4e90b-0b28-4362-a52e-ba528432fade&page=queryresults
[0m00:33:57.367987 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-06-28 00:33:53.723137 => 2023-06-28 00:33:57.367856
[0m00:33:57.371089 [debug] [Thread-1 (]: Database Error in model int_address (models/intermediate/int_address.sql)
  CREATE TABLE has columns with duplicate name address_type_id at [13:7]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_address.sql
[0m00:33:57.371631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '010e0a3d-049d-4e74-95e6-5a800d6fda76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da0d30a60>]}
[0m00:33:57.372288 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_address ...... [[31mERROR[0m in 3.66s]
[0m00:33:57.374716 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m00:33:57.377050 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:33:57.378538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:57.379137 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m00:33:57.379554 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m00:33:57.380052 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m00:33:57.380552 [debug] [MainThread]: Connection 'model.desafioaethaina.int_address' was properly closed.
[0m00:33:57.381396 [info ] [MainThread]: 
[0m00:33:57.382175 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m00:33:57.383394 [debug] [MainThread]: Command end result
[0m00:33:57.428467 [info ] [MainThread]: 
[0m00:33:57.429504 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:33:57.430367 [info ] [MainThread]: 
[0m00:33:57.431199 [error] [MainThread]: [33mDatabase Error in model int_address (models/intermediate/int_address.sql)[0m
[0m00:33:57.432077 [error] [MainThread]:   CREATE TABLE has columns with duplicate name address_type_id at [13:7]
[0m00:33:57.432978 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_address.sql
[0m00:33:57.434021 [info ] [MainThread]: 
[0m00:33:57.435114 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:33:57.436280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da0cfa500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da16c6d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da0d54850>]}
[0m00:33:57.437904 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 12:04:02.792257 | 1b991421-3f91-4849-8b90-41ab97f2e3f7 ==============================
[0m12:04:02.792257 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:04:02.799483 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:04:02.800282 [debug] [MainThread]: Tracking: tracking
[0m12:04:02.802779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ff3725c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ff3708b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ff372590>]}
[0m12:04:02.858660 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:04:03.113729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:04:03.114554 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m12:04:03.137162 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m12:04:03.174552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b991421-3f91-4849-8b90-41ab97f2e3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fef64d90>]}
[0m12:04:03.195379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b991421-3f91-4849-8b90-41ab97f2e3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ff00fa30>]}
[0m12:04:03.195904 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m12:04:03.196345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b991421-3f91-4849-8b90-41ab97f2e3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ff00faf0>]}
[0m12:04:03.199768 [info ] [MainThread]: 
[0m12:04:03.203140 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:04:03.204403 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m12:04:03.205048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:04.400390 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m12:04:04.402039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m12:04:04.402573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:04.404998 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m12:04:04.406827 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m12:04:04.464903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:04.463811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:04.411825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:06.241650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b991421-3f91-4849-8b90-41ab97f2e3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76feea3be0>]}
[0m12:04:06.243042 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:04:06.247986 [info ] [MainThread]: 
[0m12:04:06.263141 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m12:04:06.264007 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_address ............... [RUN]
[0m12:04:06.265423 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m12:04:06.266115 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m12:04:06.288895 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m12:04:06.296324 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-06-28 12:04:06.266568 => 2023-06-28 12:04:06.295853
[0m12:04:06.297072 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m12:04:06.360568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:07.672615 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m12:04:07.674590 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, union_address_business_contact as (
    select
        business_entity_address.business_entity_id
        , address_id
        , address_type_id
        , contact_type_id
        , peson_id
    from business_entity_contact
    left join  business_entity_address
    on business_entity_address.business_entity_id = business_entity_contact.business_entity_id
)


, union_address_type as (
    select
        union_address_business_contact.*
        , address_type_name
    from address_type
    left join union_address_business_contact
    on address_type.address_type_id = union_address_business_contact.address_type_id
)

, union_address_business_address as (
    select
    	union_address_type.*
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
        , business_entity_id
    from union_address_type
    left join address 
    on address.address_id = union_address_type.address_id
   
)

select * 
from union_address_business_address
    );
  
[0m12:04:08.804167 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: peson_id; Did you mean person_id? at [39:11]')
[0m12:04:10.337206 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1edd518d-e097-44eb-bd93-307459f7d322&page=queryresults
[0m12:04:10.344110 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-06-28 12:04:06.297576 => 2023-06-28 12:04:10.343919
[0m12:04:10.363811 [debug] [Thread-1 (]: Database Error in model int_address (models/intermediate/int_address.sql)
  Unrecognized name: peson_id; Did you mean person_id? at [39:11]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_address.sql
[0m12:04:10.364571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b991421-3f91-4849-8b90-41ab97f2e3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fe7e89d0>]}
[0m12:04:10.365732 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_address ...... [[31mERROR[0m in 4.10s]
[0m12:04:10.370577 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m12:04:10.377031 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:04:10.380180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:10.381449 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m12:04:10.382557 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m12:04:10.386609 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m12:04:10.387764 [debug] [MainThread]: Connection 'model.desafioaethaina.int_address' was properly closed.
[0m12:04:10.388756 [info ] [MainThread]: 
[0m12:04:10.390313 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m12:04:10.394620 [debug] [MainThread]: Command end result
[0m12:04:10.487120 [info ] [MainThread]: 
[0m12:04:10.488732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:04:10.489992 [info ] [MainThread]: 
[0m12:04:10.491335 [error] [MainThread]: [33mDatabase Error in model int_address (models/intermediate/int_address.sql)[0m
[0m12:04:10.493117 [error] [MainThread]:   Unrecognized name: peson_id; Did you mean person_id? at [39:11]
[0m12:04:10.495430 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_address.sql
[0m12:04:10.497677 [info ] [MainThread]: 
[0m12:04:10.499686 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:04:10.501681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fefd2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fe802dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fe802cb0>]}
[0m12:04:10.502840 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 12:04:26.454577 | 8bc2bbe5-2bcc-4c58-8e25-7584373e5188 ==============================
[0m12:04:26.454577 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:04:26.458418 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:04:26.458960 [debug] [MainThread]: Tracking: tracking
[0m12:04:26.461504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2f9824a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2f9813c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2f982380>]}
[0m12:04:26.512867 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:04:26.750073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:04:26.752241 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m12:04:26.797727 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m12:04:26.866572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bc2bbe5-2bcc-4c58-8e25-7584373e5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2f764f40>]}
[0m12:04:26.897891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bc2bbe5-2bcc-4c58-8e25-7584373e5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2f817c40>]}
[0m12:04:26.898880 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m12:04:26.899731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bc2bbe5-2bcc-4c58-8e25-7584373e5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2f817d00>]}
[0m12:04:26.907147 [info ] [MainThread]: 
[0m12:04:26.911036 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:04:26.913137 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m12:04:26.913866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:27.986087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m12:04:27.989045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:27.987724 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m12:04:27.991642 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m12:04:28.004990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:28.003807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:27.993408 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m12:04:28.158654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:29.936287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bc2bbe5-2bcc-4c58-8e25-7584373e5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2f980d90>]}
[0m12:04:29.937858 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:04:29.938763 [info ] [MainThread]: 
[0m12:04:29.942985 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m12:04:29.943682 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_address ............... [RUN]
[0m12:04:29.944911 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m12:04:29.945387 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m12:04:29.954440 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m12:04:29.955586 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-06-28 12:04:29.945632 => 2023-06-28 12:04:29.955406
[0m12:04:29.957410 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m12:04:30.032746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:31.041851 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m12:04:31.042900 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, union_address_business_contact as (
    select
        business_entity_address.business_entity_id
        , address_id
        , address_type_id
        , contact_type_id
        , person_id
    from business_entity_contact
    left join  business_entity_address
    on business_entity_address.business_entity_id = business_entity_contact.business_entity_id
)


, union_address_type as (
    select
        union_address_business_contact.*
        , address_type_name
    from address_type
    left join union_address_business_contact
    on address_type.address_type_id = union_address_business_contact.address_type_id
)

, union_address_business_address as (
    select
    	union_address_type.*
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
        , business_entity_id
    from union_address_type
    left join address 
    on address.address_id = union_address_type.address_id
   
)

select * 
from union_address_business_address
    );
  
[0m12:04:32.280055 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name business_entity_id at [13:7]')
[0m12:04:34.078402 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cddfd521-b3f0-48b3-89c9-804193beea95&page=queryresults
[0m12:04:34.079276 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-06-28 12:04:29.957873 => 2023-06-28 12:04:34.079148
[0m12:04:34.082437 [debug] [Thread-1 (]: Database Error in model int_address (models/intermediate/int_address.sql)
  CREATE TABLE has columns with duplicate name business_entity_id at [13:7]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_address.sql
[0m12:04:34.082956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bc2bbe5-2bcc-4c58-8e25-7584373e5188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2edf0940>]}
[0m12:04:34.083522 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_address ...... [[31mERROR[0m in 4.14s]
[0m12:04:34.085810 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m12:04:34.088769 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:04:34.091349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:34.093156 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m12:04:34.094068 [debug] [MainThread]: Connection 'model.desafioaethaina.int_address' was properly closed.
[0m12:04:34.096245 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m12:04:34.097002 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m12:04:34.098098 [info ] [MainThread]: 
[0m12:04:34.099423 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m12:04:34.101263 [debug] [MainThread]: Command end result
[0m12:04:34.193017 [info ] [MainThread]: 
[0m12:04:34.194582 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:04:34.196776 [info ] [MainThread]: 
[0m12:04:34.198167 [error] [MainThread]: [33mDatabase Error in model int_address (models/intermediate/int_address.sql)[0m
[0m12:04:34.199434 [error] [MainThread]:   CREATE TABLE has columns with duplicate name business_entity_id at [13:7]
[0m12:04:34.201184 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_address.sql
[0m12:04:34.203134 [info ] [MainThread]: 
[0m12:04:34.205381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:04:34.207258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2ee08430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2ee09210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f2ee09f90>]}
[0m12:04:34.207972 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 12:05:00.185901 | 557e982e-a37d-4842-9b57-a43bcc482305 ==============================
[0m12:05:00.185901 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:05:00.189417 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:05:00.190226 [debug] [MainThread]: Tracking: tracking
[0m12:05:00.194792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d787850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d7873d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d787820>]}
[0m12:05:00.274031 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:05:00.434017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:00.434955 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m12:05:00.462377 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m12:05:00.512415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '557e982e-a37d-4842-9b57-a43bcc482305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d560b80>]}
[0m12:05:00.538474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '557e982e-a37d-4842-9b57-a43bcc482305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d61f880>]}
[0m12:05:00.539154 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m12:05:00.539691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '557e982e-a37d-4842-9b57-a43bcc482305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d61f940>]}
[0m12:05:00.543462 [info ] [MainThread]: 
[0m12:05:00.546872 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:05:00.549288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m12:05:00.550573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:01.493300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m12:05:01.494374 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m12:05:01.494692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:01.495696 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m12:05:01.495995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:01.497918 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m12:05:01.504599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:01.541758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:03.272798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '557e982e-a37d-4842-9b57-a43bcc482305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d4ba4a0>]}
[0m12:05:03.273987 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:03.274695 [info ] [MainThread]: 
[0m12:05:03.279462 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m12:05:03.281160 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_address ............... [RUN]
[0m12:05:03.283267 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m12:05:03.288175 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m12:05:03.300218 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m12:05:03.302573 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-06-28 12:05:03.290487 => 2023-06-28 12:05:03.302175
[0m12:05:03.304845 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m12:05:03.363554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:04.431775 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m12:05:04.433555 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, union_address_business_contact as (
    select
        business_entity_address.business_entity_id
        , address_id
        , address_type_id
        , contact_type_id
        , person_id
    from business_entity_contact
    left join  business_entity_address
    on business_entity_address.business_entity_id = business_entity_contact.business_entity_id
)


, union_address_type as (
    select
        union_address_business_contact.*
        , address_type_name
    from address_type
    left join union_address_business_contact
    on address_type.address_type_id = union_address_business_contact.address_type_id
)

, union_address_business_address as (
    select
    	union_address_type.*
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
    from union_address_type
    left join address 
    on address.address_id = union_address_type.address_id
   
)

select * 
from union_address_business_address
    );
  
[0m12:05:09.713383 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5fd99007-f05e-4266-9b60-913801afa7ba&page=queryresults
[0m12:05:09.753915 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-06-28 12:05:03.305781 => 2023-06-28 12:05:09.753798
[0m12:05:09.755762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '557e982e-a37d-4842-9b57-a43bcc482305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1cdf8580>]}
[0m12:05:09.756962 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_address .......... [[32mCREATE TABLE (925.0 rows, 1.5 MB processed)[0m in 6.47s]
[0m12:05:09.761121 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m12:05:09.763855 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:05:09.765291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:09.765968 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m12:05:09.767910 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m12:05:09.768427 [debug] [MainThread]: Connection 'model.desafioaethaina.int_address' was properly closed.
[0m12:05:09.768890 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m12:05:09.769462 [info ] [MainThread]: 
[0m12:05:09.770274 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.23 seconds (9.23s).
[0m12:05:09.773179 [debug] [MainThread]: Command end result
[0m12:05:09.855667 [info ] [MainThread]: 
[0m12:05:09.857107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:09.858147 [info ] [MainThread]: 
[0m12:05:09.860081 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:05:09.861361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce21a2d4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1ce0baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1ce0ba30>]}
[0m12:05:09.862131 [debug] [MainThread]: Flushing usage events


============================== 2023-06-28 19:15:05.831976 | f786dd45-1395-4327-a405-e6d7235163e4 ==============================
[0m19:15:05.831976 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:15:05.837937 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:15:05.838763 [debug] [MainThread]: Tracking: tracking
[0m19:15:05.856060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4778f6a740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4778f6a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4778f6a710>]}
[0m19:15:05.944804 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:15:06.052194 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:15:06.052712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f786dd45-1395-4327-a405-e6d7235163e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4778d80be0>]}
[0m19:15:07.961665 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m19:15:07.979389 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m19:15:07.985523 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m19:15:07.992803 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m19:15:07.999676 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer.sql
[0m19:15:08.005079 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m19:15:08.011921 [debug] [MainThread]: 1603: static parser failed on gold/dim_dates.sql
[0m19:15:08.059350 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim_dates.sql
[0m19:15:08.063278 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m19:15:08.069283 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_description.sql
[0m19:15:08.077051 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_location.sql
[0m19:15:08.087209 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_inventory.sql
[0m19:15:08.094013 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_subcategory.sql
[0m19:15:08.101318 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_category.sql
[0m19:15:08.106174 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product.sql
[0m19:15:08.113771 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_model.sql
[0m19:15:08.119543 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_detail.sql
[0m19:15:08.124487 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_ship_method.sql
[0m19:15:08.132927 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_product_vendor.sql
[0m19:15:08.138033 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_header.sql
[0m19:15:08.142841 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_vendor.sql
[0m19:15:08.150970 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_detail.sql
[0m19:15:08.156251 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency.sql
[0m19:15:08.161575 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_territory.sql
[0m19:15:08.169063 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency_rate.sql
[0m19:15:08.174248 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_reason.sql
[0m19:15:08.183866 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_customer.sql
[0m19:15:08.188672 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_country_region_currency.sql
[0m19:15:08.195875 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person.sql
[0m19:15:08.203124 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_tax_rate.sql
[0m19:15:08.207977 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person_quota_history.sql
[0m19:15:08.217038 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header_reason.sql
[0m19:15:08.221921 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header.sql
[0m19:15:08.229022 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_address_type.sql
[0m19:15:08.235192 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_state_province.sql
[0m19:15:08.239774 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_person.sql
[0m19:15:08.247339 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_address.sql
[0m19:15:08.253170 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_contact_type.sql
[0m19:15:08.257844 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_business_entity_address.sql
[0m19:15:08.264808 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_country_region.sql
[0m19:15:08.270778 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_business_entity_contact.sql
[0m19:15:08.759513 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_product' in the 'models' section of file 'models/gold/dim_address.yml'
[0m19:15:08.868013 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.not_null_dim_product_product_sk.271feb5417' (models/gold/dim_address.yml) depends on a node named 'dim_product' in package '' which was not found
[0m19:15:08.868789 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c' (models/gold/dim_address.yml) depends on a node named 'dim_product' in package '' which was not found
[0m19:15:09.010700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f786dd45-1395-4327-a405-e6d7235163e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4778424ca0>]}
[0m19:15:09.124676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f786dd45-1395-4327-a405-e6d7235163e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47783bb3a0>]}
[0m19:15:09.125183 [info ] [MainThread]: Found 40 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 34 sources, 0 exposures, 0 metrics
[0m19:15:09.125717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f786dd45-1395-4327-a405-e6d7235163e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f477906cbe0>]}
[0m19:15:09.129616 [info ] [MainThread]: 
[0m19:15:09.132459 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:15:09.135497 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:15:09.136639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:11.548966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:15:11.550701 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:15:11.552209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:11.553926 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:15:11.554699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:11.555864 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:15:11.596170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:11.597192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:13.284694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f786dd45-1395-4327-a405-e6d7235163e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47783b9d20>]}
[0m19:15:13.285653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:15:13.286136 [info ] [MainThread]: 
[0m19:15:13.298459 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m19:15:13.299472 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_address ............... [RUN]
[0m19:15:13.302099 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m19:15:13.303248 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m19:15:13.314489 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m19:15:13.316409 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-06-28 19:15:13.303555 => 2023-06-28 19:15:13.316243
[0m19:15:13.317298 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m19:15:13.380345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:14.532083 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m19:15:14.533189 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, union_address_business_contact as (
    select
        business_entity_address.business_entity_id
        , address_id
        , address_type_id
        , contact_type_id
        , person_id
    from business_entity_contact
    left join  business_entity_address
    on business_entity_address.business_entity_id = business_entity_contact.business_entity_id
)


, union_address_type as (
    select
        union_address_business_contact.*
        , address_type_name
    from address_type
    left join union_address_business_contact
    on address_type.address_type_id = union_address_business_contact.address_type_id
)

, union_address_business_address as (
    select
    	union_address_type.*
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
    from union_address_type
    left join address 
    on address.address_id = union_address_type.address_id
   
)

select * 
from union_address_business_address
    );
  
[0m19:15:19.344852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a76e035f-d6e8-4151-ad38-5df6d15cc62f&page=queryresults
[0m19:15:19.370360 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-06-28 19:15:13.318739 => 2023-06-28 19:15:19.370294
[0m19:15:19.371164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f786dd45-1395-4327-a405-e6d7235163e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4778b50850>]}
[0m19:15:19.371691 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_address .......... [[32mCREATE TABLE (925.0 rows, 1.5 MB processed)[0m in 6.07s]
[0m19:15:19.373935 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m19:15:19.376390 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:15:19.378267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:19.379278 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m19:15:19.382365 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m19:15:19.383798 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m19:15:19.384523 [debug] [MainThread]: Connection 'model.desafioaethaina.int_address' was properly closed.
[0m19:15:19.385105 [info ] [MainThread]: 
[0m19:15:19.386044 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m19:15:19.387087 [debug] [MainThread]: Command end result
[0m19:15:19.438972 [info ] [MainThread]: 
[0m19:15:19.439510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:19.440168 [info ] [MainThread]: 
[0m19:15:19.440885 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:15:19.442329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47783b1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4778ad1960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4778ad0cd0>]}
[0m19:15:19.443248 [debug] [MainThread]: Flushing usage events


============================== 2023-06-29 12:39:42.964469 | 5c1b7e54-1793-4b88-8e96-8049fa414ccf ==============================
[0m12:39:42.964469 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:39:42.968472 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'macro': 'update_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m12:39:42.969284 [debug] [MainThread]: Tracking: tracking
[0m12:39:42.976808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cd4656ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cd46566e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cd4656e90>]}
[0m12:39:43.043090 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:39:43.406254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:43.406991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:43.428437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c1b7e54-1793-4b88-8e96-8049fa414ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cd41d6800>]}
[0m12:39:43.446598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c1b7e54-1793-4b88-8e96-8049fa414ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cd4567e80>]}
[0m12:39:43.449108 [debug] [MainThread]: Acquiring new bigquery connection 'macro_update_sources'
[0m12:39:43.450209 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "update_sources" in any package
[0m12:39:43.453371 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/thaina/indicium_particular/desafio/venv/lib/python3.10/site-packages/dbt/task/run_operation.py", line 57, in run
    self._run_unsafe()
  File "/home/thaina/indicium_particular/desafio/venv/lib/python3.10/site-packages/dbt/task/run_operation.py", line 47, in _run_unsafe
    res = adapter.execute_macro(
  File "/home/thaina/indicium_particular/desafio/venv/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 978, in execute_macro
    raise DbtRuntimeError(
dbt.exceptions.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "update_sources" in any package

[0m12:39:43.454201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cd4566860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cd45651e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cd4566e90>]}
[0m12:39:43.454916 [debug] [MainThread]: Flushing usage events
[0m12:39:44.433494 [debug] [MainThread]: Connection 'macro_update_sources' was properly closed.


============================== 2023-06-30 21:42:16.695977 | fd1d8529-c492-4b07-b1b2-71bec32eba25 ==============================
[0m21:42:16.695977 [info ] [MainThread]: Running with dbt=1.4.6
[0m21:42:16.703201 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_sales_creditcard'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:42:16.704714 [debug] [MainThread]: Tracking: tracking
[0m21:42:16.707506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a8662d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a86607f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a8662560>]}
[0m21:42:16.774591 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m21:42:17.040983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m21:42:17.043001 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/silver/sales/stg_sales_creditcard.sql
[0m21:42:17.043989 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/silver/person/sources_person.yml
[0m21:42:17.046304 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/silver/sales/sources_sales.yml
[0m21:42:17.046994 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m21:42:17.080658 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_creditcard.sql
[0m21:42:17.100212 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency.sql
[0m21:42:17.105733 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency_rate.sql
[0m21:42:17.110911 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m21:42:17.116546 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m21:42:17.122350 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer.sql
[0m21:42:17.130762 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_customer.sql
[0m21:42:17.136748 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m21:42:17.142006 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_detail.sql
[0m21:42:17.148172 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header.sql
[0m21:42:17.153106 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header_reason.sql
[0m21:42:17.158579 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person.sql
[0m21:42:17.164122 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person_quota_history.sql
[0m21:42:17.169059 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_reason.sql
[0m21:42:17.173972 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_tax_rate.sql
[0m21:42:17.179445 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_territory.sql
[0m21:42:17.184730 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_country_region_currency.sql
[0m21:42:17.189557 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m21:42:17.317111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd1d8529-c492-4b07-b1b2-71bec32eba25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a7b0c0d0>]}
[0m21:42:17.351289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd1d8529-c492-4b07-b1b2-71bec32eba25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a8317c40>]}
[0m21:42:17.351939 [info ] [MainThread]: Found 41 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m21:42:17.352642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1d8529-c492-4b07-b1b2-71bec32eba25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a8317c10>]}
[0m21:42:17.356454 [info ] [MainThread]: 
[0m21:42:17.359332 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:42:17.360814 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m21:42:17.361299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:18.485842 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m21:42:18.486833 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m21:42:18.488034 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m21:42:18.488555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:18.489399 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m21:42:18.492045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:18.492494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:18.529164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:20.035527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1d8529-c492-4b07-b1b2-71bec32eba25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a8303b80>]}
[0m21:42:20.036415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:42:20.036874 [info ] [MainThread]: 
[0m21:42:20.040373 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_creditcard
[0m21:42:20.040883 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_silver.stg_sales_creditcard ............ [RUN]
[0m21:42:20.041927 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_creditcard'
[0m21:42:20.042571 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_creditcard
[0m21:42:20.046600 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_creditcard"
[0m21:42:20.047214 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (compile): 2023-06-30 21:42:20.043086 => 2023-06-30 21:42:20.047096
[0m21:42:20.047691 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_creditcard
[0m21:42:20.106904 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_creditcard"
[0m21:42:20.107523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:20.109597 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_creditcard: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_creditcard"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    creditcardid as credit_card_id
    , cardtype as card_type
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
    );
  
[0m21:42:21.957716 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: creditcardid at [15:5]')
[0m21:42:23.391366 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5098010d-fc88-4ff4-8032-b298cfe37afa&page=queryresults
[0m21:42:23.392398 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (execute): 2023-06-30 21:42:20.047905 => 2023-06-30 21:42:23.392252
[0m21:42:23.408255 [debug] [Thread-1 (]: Database Error in model stg_sales_creditcard (models/silver/sales/stg_sales_creditcard.sql)
  Unrecognized name: creditcardid at [15:5]
  compiled Code at target/run/desafioaethaina/models/silver/sales/stg_sales_creditcard.sql
[0m21:42:23.408787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1d8529-c492-4b07-b1b2-71bec32eba25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a7988f10>]}
[0m21:42:23.409375 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_silver.stg_sales_creditcard ... [[31mERROR[0m in 3.37s]
[0m21:42:23.411607 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_creditcard
[0m21:42:23.413445 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:42:23.415264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:42:23.416060 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m21:42:23.416739 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m21:42:23.417703 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_creditcard' was properly closed.
[0m21:42:23.418228 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m21:42:23.418766 [info ] [MainThread]: 
[0m21:42:23.419454 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.06 seconds (6.06s).
[0m21:42:23.420718 [debug] [MainThread]: Command end result
[0m21:42:23.449957 [info ] [MainThread]: 
[0m21:42:23.451129 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:42:23.452222 [info ] [MainThread]: 
[0m21:42:23.453035 [error] [MainThread]: [33mDatabase Error in model stg_sales_creditcard (models/silver/sales/stg_sales_creditcard.sql)[0m
[0m21:42:23.453762 [error] [MainThread]:   Unrecognized name: creditcardid at [15:5]
[0m21:42:23.454505 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/silver/sales/stg_sales_creditcard.sql
[0m21:42:23.455266 [info ] [MainThread]: 
[0m21:42:23.456096 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:42:23.456947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a8303940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a82ce2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9a8316890>]}
[0m21:42:23.457578 [debug] [MainThread]: Flushing usage events


============================== 2023-06-30 21:42:43.965697 | 179ba1b3-7e3f-4c79-be0b-e13fd07f913a ==============================
[0m21:42:43.965697 [info ] [MainThread]: Running with dbt=1.4.6
[0m21:42:43.969288 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_sales_creditcard'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:42:43.969883 [debug] [MainThread]: Tracking: tracking
[0m21:42:43.972071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71af3747f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71af374f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71af3747c0>]}
[0m21:42:44.037543 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m21:42:44.252117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:42:44.253608 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/silver/sales/stg_sales_creditcard.sql
[0m21:42:44.304422 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_creditcard.sql
[0m21:42:44.379133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '179ba1b3-7e3f-4c79-be0b-e13fd07f913a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71aef655a0>]}
[0m21:42:44.424468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '179ba1b3-7e3f-4c79-be0b-e13fd07f913a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71af011fc0>]}
[0m21:42:44.425266 [info ] [MainThread]: Found 41 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m21:42:44.425988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '179ba1b3-7e3f-4c79-be0b-e13fd07f913a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71af011f90>]}
[0m21:42:44.431973 [info ] [MainThread]: 
[0m21:42:44.435858 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:42:44.437902 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m21:42:44.438574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:45.425308 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m21:42:45.426509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:45.471651 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m21:42:45.472917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:45.519909 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m21:42:45.528638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:45.536812 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m21:42:45.579917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:47.044758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '179ba1b3-7e3f-4c79-be0b-e13fd07f913a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71aeeb2ce0>]}
[0m21:42:47.046124 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:42:47.046892 [info ] [MainThread]: 
[0m21:42:47.051907 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_creditcard
[0m21:42:47.052400 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_silver.stg_sales_creditcard ............ [RUN]
[0m21:42:47.053391 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_creditcard'
[0m21:42:47.053757 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_creditcard
[0m21:42:47.058962 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_creditcard"
[0m21:42:47.059830 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (compile): 2023-06-30 21:42:47.053998 => 2023-06-30 21:42:47.059688
[0m21:42:47.060470 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_creditcard
[0m21:42:47.138850 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_creditcard"
[0m21:42:47.139447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:47.141893 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_creditcard: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_creditcard"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    creditcardid as credit_card_id
    , cardtype as card_type
  from  `desafiothaina`.`dev_thaina`.`creditcard`
)
select *
from source_data
    );
  
[0m21:42:51.332712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:73b95dfb-ad32-4ddd-b1d1-ee5071044801&page=queryresults
[0m21:42:51.354069 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (execute): 2023-06-30 21:42:47.060899 => 2023-06-30 21:42:51.353986
[0m21:42:51.355078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '179ba1b3-7e3f-4c79-be0b-e13fd07f913a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae5edb70>]}
[0m21:42:51.355672 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_silver.stg_sales_creditcard ....... [[32mCREATE TABLE (19.1k rows, 378.8 KB processed)[0m in 4.30s]
[0m21:42:51.357945 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_creditcard
[0m21:42:51.360108 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:42:51.360935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:42:51.361249 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_creditcard' was properly closed.
[0m21:42:51.361556 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m21:42:51.361878 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m21:42:51.362145 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m21:42:51.362458 [info ] [MainThread]: 
[0m21:42:51.362924 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.93 seconds (6.93s).
[0m21:42:51.363746 [debug] [MainThread]: Command end result
[0m21:42:51.413325 [info ] [MainThread]: 
[0m21:42:51.414836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:42:51.416802 [info ] [MainThread]: 
[0m21:42:51.418747 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:42:51.420859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71af011ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae60a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae60a470>]}
[0m21:42:51.421879 [debug] [MainThread]: Flushing usage events


============================== 2023-06-30 21:44:04.877712 | 9f62df04-3812-4ce5-9bbf-57906872e0ad ==============================
[0m21:44:04.877712 [info ] [MainThread]: Running with dbt=1.4.6
[0m21:44:04.879786 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:44:04.880278 [debug] [MainThread]: Tracking: tracking
[0m21:44:04.882395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d96a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d968fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d9688e0>]}
[0m21:44:04.937167 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m21:44:05.132207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:44:05.132564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:44:05.151710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d4fc0d0>]}
[0m21:44:05.185732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d4b07c0>]}
[0m21:44:05.186619 [info ] [MainThread]: Found 41 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m21:44:05.187457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d4b0790>]}
[0m21:44:05.195696 [info ] [MainThread]: 
[0m21:44:05.199563 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:44:05.205765 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m21:44:05.207252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:05.208643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m21:44:05.210607 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m21:44:05.254359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:05.211383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:06.836725 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m21:44:06.837446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:06.885823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m21:44:06.889265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:06.891688 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m21:44:06.893253 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m21:44:06.942300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:06.936440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:08.290126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d96a590>]}
[0m21:44:08.291107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:44:08.291542 [info ] [MainThread]: 
[0m21:44:08.296862 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m21:44:08.297286 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_address
[0m21:44:08.298725 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_address_type
[0m21:44:08.299104 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_address
[0m21:44:08.299569 [info ] [Thread-1 (]: 1 of 41 START sql table model dev_thaina_gold.dim_dates ........................ [RUN]
[0m21:44:08.302297 [info ] [Thread-4 (]: 4 of 41 START sql table model dev_thaina_silver.stg_person_business_entity_address  [RUN]
[0m21:44:08.301407 [info ] [Thread-3 (]: 3 of 41 START sql table model dev_thaina_silver.stg_person_address_type ........ [RUN]
[0m21:44:08.305325 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address_type'
[0m21:44:08.303389 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m21:44:08.307174 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m21:44:08.300452 [info ] [Thread-2 (]: 2 of 41 START sql table model dev_thaina_silver.stg_person_address ............. [RUN]
[0m21:44:08.318331 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address'
[0m21:44:08.306271 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_address_type
[0m21:44:08.319445 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_address
[0m21:44:08.304172 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_address'
[0m21:44:08.355826 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address"
[0m21:44:08.368700 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (compile): 2023-06-30 21:44:08.338460 => 2023-06-30 21:44:08.368475
[0m21:44:08.369888 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_address
[0m21:44:08.367014 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address_type"
[0m21:44:08.378018 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (compile): 2023-06-30 21:44:08.331725 => 2023-06-30 21:44:08.377776
[0m21:44:08.364883 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_address
[0m21:44:08.379133 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_address_type
[0m21:44:08.430045 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_address"
[0m21:44:08.435010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:08.457058 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (compile): 2023-06-30 21:44:08.387807 => 2023-06-30 21:44:08.456901
[0m21:44:08.472777 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m21:44:08.486859 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_business_entity_address
[0m21:44:08.485973 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:08.492612 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:08.531036 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:09.927269 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address_type"
[0m21:44:09.929894 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address"
[0m21:44:09.932826 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_address"
[0m21:44:09.934870 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_business_entity_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , addressid as address_id
    , addresstypeid as address_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentityaddress`
)

select *
from source_data
    );
  
[0m21:44:09.937434 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_address_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addresstypeid as address_type_id
    , name as address_type_name 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`addresstype`
)

select *
from source_data
    );
  
[0m21:44:09.937769 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
    );
  
[0m21:44:11.325253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8017349d-8abc-40fe-8a73-9791b2a60dde&page=queryresults
[0m21:44:11.339768 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m21:44:11.340317 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-06-30 21:44:08.307733 => 2023-06-30 21:44:11.340238
[0m21:44:11.340669 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m21:44:11.736318 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m21:44:11.736918 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      /* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m21:44:13.168957 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6fb785e6-c62d-48dc-9184-488f54f06bf3&page=queryresults
[0m21:44:13.199022 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (execute): 2023-06-30 21:44:08.435458 => 2023-06-30 21:44:13.198909
[0m21:44:13.200010 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d311ab0>]}
[0m21:44:13.200524 [info ] [Thread-3 (]: 3 of 41 OK created sql table model dev_thaina_silver.stg_person_address_type ... [[32mCREATE TABLE (6.0 rows, 332.0 Bytes processed)[0m in 4.90s]
[0m21:44:13.202801 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_address_type
[0m21:44:13.203410 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_business_entity_contact
[0m21:44:13.203943 [info ] [Thread-3 (]: 5 of 41 START sql table model dev_thaina_silver.stg_person_business_entity_contact  [RUN]
[0m21:44:13.204912 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_contact'
[0m21:44:13.205449 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_contact
[0m21:44:13.209925 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m21:44:13.210779 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (compile): 2023-06-30 21:44:13.205676 => 2023-06-30 21:44:13.210653
[0m21:44:13.211439 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_business_entity_contact
[0m21:44:13.217225 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:13.471885 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cfb11dda-871e-4d70-b3b7-386024372472&page=queryresults
[0m21:44:13.475245 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (execute): 2023-06-30 21:44:08.370546 => 2023-06-30 21:44:13.475159
[0m21:44:13.476339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d286710>]}
[0m21:44:13.477024 [info ] [Thread-2 (]: 2 of 41 OK created sql table model dev_thaina_silver.stg_person_address ........ [[32mCREATE TABLE (19.6k rows, 1.7 MB processed)[0m in 5.16s]
[0m21:44:13.477944 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_address
[0m21:44:13.479029 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_contact_type
[0m21:44:13.480244 [info ] [Thread-2 (]: 6 of 41 START sql table model dev_thaina_silver.stg_person_contact_type ........ [RUN]
[0m21:44:13.482335 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_contact_type'
[0m21:44:13.483998 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_contact_type
[0m21:44:13.490010 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:96367c07-af00-4499-8ca9-ec6245087b33&page=queryresults
[0m21:44:13.491814 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_contact_type"
[0m21:44:13.498958 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (execute): 2023-06-30 21:44:08.528197 => 2023-06-30 21:44:13.498855
[0m21:44:13.500354 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d57ad40>]}
[0m21:44:13.501227 [info ] [Thread-4 (]: 4 of 41 OK created sql table model dev_thaina_silver.stg_person_business_entity_address  [[32mCREATE TABLE (19.6k rows, 1.2 MB processed)[0m in 5.20s]
[0m21:44:13.501830 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_contact_type (compile): 2023-06-30 21:44:13.484579 => 2023-06-30 21:44:13.501719
[0m21:44:13.502800 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_address
[0m21:44:13.503868 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_contact_type
[0m21:44:13.505126 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_country_region
[0m21:44:13.512561 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:13.513264 [info ] [Thread-4 (]: 7 of 41 START sql table model dev_thaina_silver.stg_person_country_region ...... [RUN]
[0m21:44:13.557549 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_country_region'
[0m21:44:13.558774 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_country_region
[0m21:44:13.566589 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_country_region"
[0m21:44:13.569083 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_country_region (compile): 2023-06-30 21:44:13.561718 => 2023-06-30 21:44:13.568957
[0m21:44:13.569577 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_country_region
[0m21:44:13.572549 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:14.201822 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m21:44:14.202481 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_business_entity_contact: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_contact"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , personid as person_id
    , contacttypeid as contact_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentitycontact`
)

select *
from source_data
    );
  
[0m21:44:14.515072 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_contact_type"
[0m21:44:14.516223 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_contact_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_contact_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    contacttypeid as contact_type_id
    , name as contact_type_name 
  from  `desafiothaina`.`dev_thaina`.`contacttype`
)

select *
from source_data
    );
  
[0m21:44:14.585749 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_country_region"
[0m21:44:14.586356 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_country_region: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_country_region"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
    );
  
[0m21:44:16.646641 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:fa3f7aca-beff-4818-8395-a7b11181689f&page=queryresults
[0m21:44:17.194169 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4cff9cad-6a07-4642-8cd3-c02fc3a2d8cd&page=queryresults
[0m21:44:17.199067 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (execute): 2023-06-30 21:44:13.211900 => 2023-06-30 21:44:17.198925
[0m21:44:17.200794 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d5737c0>]}
[0m21:44:17.201639 [info ] [Thread-3 (]: 5 of 41 OK created sql table model dev_thaina_silver.stg_person_business_entity_contact  [[32mCREATE TABLE (909.0 rows, 55.0 KB processed)[0m in 4.00s]
[0m21:44:17.202498 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_business_entity_contact
[0m21:44:17.203239 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_person
[0m21:44:17.204268 [info ] [Thread-3 (]: 8 of 41 START sql table model dev_thaina_silver.stg_person_person .............. [RUN]
[0m21:44:17.205917 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_person'
[0m21:44:17.206663 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_person
[0m21:44:17.211907 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_person"
[0m21:44:17.213038 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_person (compile): 2023-06-30 21:44:17.207011 => 2023-06-30 21:44:17.212906
[0m21:44:17.213501 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_person
[0m21:44:17.217652 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:17.337382 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:77ee20fc-c498-4c1f-af09-c2a3cde6d704&page=queryresults
[0m21:44:17.341026 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_country_region (execute): 2023-06-30 21:44:13.569793 => 2023-06-30 21:44:17.340939
[0m21:44:17.342152 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d57a800>]}
[0m21:44:17.342871 [info ] [Thread-4 (]: 7 of 41 OK created sql table model dev_thaina_silver.stg_person_country_region . [[32mCREATE TABLE (238.0 rows, 3.7 KB processed)[0m in 3.79s]
[0m21:44:17.343666 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_country_region
[0m21:44:17.344368 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_state_province
[0m21:44:17.345475 [info ] [Thread-4 (]: 9 of 41 START sql table model dev_thaina_silver.stg_person_state_province ...... [RUN]
[0m21:44:17.346992 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_state_province'
[0m21:44:17.348620 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_state_province
[0m21:44:17.359688 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_state_province"
[0m21:44:17.363039 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_state_province (compile): 2023-06-30 21:44:17.352524 => 2023-06-30 21:44:17.362670
[0m21:44:17.364511 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_state_province
[0m21:44:17.371365 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:17.427993 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-06-30 21:44:11.340879 => 2023-06-30 21:44:17.427673
[0m21:44:17.431390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d57ab00>]}
[0m21:44:17.435888 [info ] [Thread-1 (]: 1 of 41 OK created sql table model dev_thaina_gold.dim_dates ................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 9.13s]
[0m21:44:17.437987 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m21:44:17.438802 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product
[0m21:44:17.440137 [info ] [Thread-1 (]: 10 of 41 START sql table model dev_thaina_silver.stg_product ................... [RUN]
[0m21:44:17.441743 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product'
[0m21:44:17.442388 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product
[0m21:44:17.450070 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product"
[0m21:44:17.451230 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product (compile): 2023-06-30 21:44:17.442835 => 2023-06-30 21:44:17.451056
[0m21:44:17.454795 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product
[0m21:44:17.461042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:17.620753 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:23399d75-d853-421d-9aa4-075e9b325205&page=queryresults
[0m21:44:17.622956 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_contact_type (execute): 2023-06-30 21:44:13.505785 => 2023-06-30 21:44:17.622893
[0m21:44:17.623766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d579fc0>]}
[0m21:44:17.624307 [info ] [Thread-2 (]: 6 of 41 OK created sql table model dev_thaina_silver.stg_person_contact_type ... [[32mCREATE TABLE (20.0 rows, 595.0 Bytes processed)[0m in 4.14s]
[0m21:44:17.624875 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_contact_type
[0m21:44:17.625579 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_category
[0m21:44:17.627654 [info ] [Thread-2 (]: 11 of 41 START sql table model dev_thaina_silver.stg_product_category .......... [RUN]
[0m21:44:17.630190 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_category'
[0m21:44:17.630858 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_category
[0m21:44:17.647756 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_category"
[0m21:44:17.650463 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_category (compile): 2023-06-30 21:44:17.631838 => 2023-06-30 21:44:17.650294
[0m21:44:17.651442 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product_category
[0m21:44:17.658965 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:18.253446 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_person"
[0m21:44:18.254722 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
    );
  
[0m21:44:18.696151 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_state_province"
[0m21:44:18.697996 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product"
[0m21:44:18.698704 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_state_province: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_state_province"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
    );
  
[0m21:44:18.698988 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , productmodelid as product_model_id
    , productsubcategoryid as product_subcategory_id
    , name as product_name
    , productnumber as product_number
    , makeflag
    , finishedgoodsflag as finished_goods_flag
    , color
    , safetystocklevel as safety_stock_level
    , standardcost as stand_cost
    , listprice as list_price
    , size as size_product
    , style as style_product
    , weight as weight_product 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`product`
)

select * from source_data
    );
  
[0m21:44:18.726011 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_category"
[0m21:44:18.727276 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product_category: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_category"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productcategoryid as category_id
    , name as category_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productcategory`
)

select *
from source_data
    );
  
[0m21:44:21.302125 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:72f472c5-637d-4107-8c38-b5c6beaed5b9&page=queryresults
[0m21:44:21.307564 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_person (execute): 2023-06-30 21:44:17.213818 => 2023-06-30 21:44:21.307438
[0m21:44:21.308936 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d35a410>]}
[0m21:44:21.309710 [info ] [Thread-3 (]: 8 of 41 OK created sql table model dev_thaina_silver.stg_person_person ......... [[32mCREATE TABLE (20.0k rows, 1.5 MB processed)[0m in 4.10s]
[0m21:44:21.310390 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_person
[0m21:44:21.311146 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_description
[0m21:44:21.311749 [info ] [Thread-3 (]: 12 of 41 START sql table model dev_thaina_silver.stg_product_description ....... [RUN]
[0m21:44:21.312880 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_description'
[0m21:44:21.313616 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_description
[0m21:44:21.322154 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_description"
[0m21:44:21.323751 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_description (compile): 2023-06-30 21:44:21.314163 => 2023-06-30 21:44:21.323461
[0m21:44:21.324574 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_description
[0m21:44:21.331207 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:21.742666 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:de6c11bd-ce0c-48a2-a839-380c68abd390&page=queryresults
[0m21:44:21.745973 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_state_province (execute): 2023-06-30 21:44:17.365524 => 2023-06-30 21:44:21.745901
[0m21:44:21.747465 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d573be0>]}
[0m21:44:21.748188 [info ] [Thread-4 (]: 9 of 41 OK created sql table model dev_thaina_silver.stg_person_state_province . [[32mCREATE TABLE (181.0 rows, 13.4 KB processed)[0m in 4.40s]
[0m21:44:21.752674 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_state_province
[0m21:44:21.753816 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_inventory
[0m21:44:21.755323 [info ] [Thread-4 (]: 13 of 41 START sql table model dev_thaina_silver.stg_product_inventory ......... [RUN]
[0m21:44:21.758479 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_inventory'
[0m21:44:21.759666 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_inventory
[0m21:44:21.765520 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_inventory"
[0m21:44:21.766298 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_inventory (compile): 2023-06-30 21:44:21.760321 => 2023-06-30 21:44:21.766179
[0m21:44:21.766817 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product_inventory
[0m21:44:21.774091 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:22.026095 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:32a52313-3407-484e-a380-da5150a2c5d1&page=queryresults
[0m21:44:22.028432 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_category (execute): 2023-06-30 21:44:17.652280 => 2023-06-30 21:44:22.028364
[0m21:44:22.029289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d42fbe0>]}
[0m21:44:22.029847 [info ] [Thread-2 (]: 11 of 41 OK created sql table model dev_thaina_silver.stg_product_category ..... [[32mCREATE TABLE (4.0 rows, 226.0 Bytes processed)[0m in 4.40s]
[0m21:44:22.030582 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_category
[0m21:44:22.031577 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_location
[0m21:44:22.033091 [info ] [Thread-2 (]: 14 of 41 START sql table model dev_thaina_silver.stg_product_location .......... [RUN]
[0m21:44:22.035849 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_location'
[0m21:44:22.036630 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_location
[0m21:44:22.041660 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_location"
[0m21:44:22.042291 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_location (compile): 2023-06-30 21:44:22.037115 => 2023-06-30 21:44:22.042189
[0m21:44:22.042751 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product_location
[0m21:44:22.048685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:22.141380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:de1f0061-3337-4eb6-a45f-c0d938666390&page=queryresults
[0m21:44:22.144296 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product (execute): 2023-06-30 21:44:17.455339 => 2023-06-30 21:44:22.144230
[0m21:44:22.145085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d579d20>]}
[0m21:44:22.145602 [info ] [Thread-1 (]: 10 of 41 OK created sql table model dev_thaina_silver.stg_product .............. [[32mCREATE TABLE (504.0 rows, 60.1 KB processed)[0m in 4.70s]
[0m21:44:22.146203 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product
[0m21:44:22.146987 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_model
[0m21:44:22.148116 [info ] [Thread-1 (]: 15 of 41 START sql table model dev_thaina_silver.stg_product_model ............. [RUN]
[0m21:44:22.149975 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_model'
[0m21:44:22.150616 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_model
[0m21:44:22.157538 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_model"
[0m21:44:22.158351 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_model (compile): 2023-06-30 21:44:22.151039 => 2023-06-30 21:44:22.158244
[0m21:44:22.159678 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_model
[0m21:44:22.167804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:22.258433 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_description"
[0m21:44:22.259474 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_description: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_description"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_description`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productdescriptionid as product_description_id
    , description as product_description
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productdescription`
)

select *
from source_data
    );
  
[0m21:44:22.771987 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_inventory"
[0m21:44:22.772584 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product_inventory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_inventory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , locationid as location_id
    , shelf
    , bin
    , quantity as quantity_inventory
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productinventory`
)

select *
from source_data
    );
  
[0m21:44:22.909777 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_location"
[0m21:44:22.910714 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product_location: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_location"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    locationid as location_id
    , name as location_name
    -- Standard hourly cost of the manufacturing location.
    , costrate as cost_rate
    -- Work capacity (in hours) of the manufacturing location.
    , availability 
  from  `desafiothaina`.`dev_thaina`.`location`
)

select *
from source_data
    );
  
[0m21:44:23.099208 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_model"
[0m21:44:23.099799 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_model: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_model"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productmodelid as model_id
    , name as model_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productmodel`
)

select *
from source_data
    );
  
[0m21:44:25.294693 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f70bea9e-8335-46b6-a92a-6a47fc676a69&page=queryresults
[0m21:44:25.297199 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_description (execute): 2023-06-30 21:44:21.325197 => 2023-06-30 21:44:25.297137
[0m21:44:25.297973 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d573970>]}
[0m21:44:25.298463 [info ] [Thread-3 (]: 12 of 41 OK created sql table model dev_thaina_silver.stg_product_description .. [[32mCREATE TABLE (762.0 rows, 125.4 KB processed)[0m in 3.99s]
[0m21:44:25.298985 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_description
[0m21:44:25.299528 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_subcategory
[0m21:44:25.300276 [info ] [Thread-3 (]: 16 of 41 START sql table model dev_thaina_silver.stg_product_subcategory ....... [RUN]
[0m21:44:25.301572 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_subcategory'
[0m21:44:25.302011 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_subcategory
[0m21:44:25.306296 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_subcategory"
[0m21:44:25.307168 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_subcategory (compile): 2023-06-30 21:44:25.302241 => 2023-06-30 21:44:25.307032
[0m21:44:25.307784 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_subcategory
[0m21:44:25.316486 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:25.995606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:532a199d-4162-4c0b-a2b6-056feb8e0bcb&page=queryresults
[0m21:44:25.997882 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_model (execute): 2023-06-30 21:44:22.160292 => 2023-06-30 21:44:25.997821
[0m21:44:25.998734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904c0dfe50>]}
[0m21:44:25.999272 [info ] [Thread-1 (]: 15 of 41 OK created sql table model dev_thaina_silver.stg_product_model ........ [[32mCREATE TABLE (128.0 rows, 8.0 KB processed)[0m in 3.85s]
[0m21:44:25.999864 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_model
[0m21:44:26.000517 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m21:44:26.001340 [info ] [Thread-1 (]: 17 of 41 START sql table model dev_thaina_silver.stg_purchase_order_detail ..... [RUN]
[0m21:44:26.002896 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m21:44:26.003578 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m21:44:26.010176 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m21:44:26.011027 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-06-30 21:44:26.004032 => 2023-06-30 21:44:26.010910
[0m21:44:26.011622 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchase_order_detail
[0m21:44:26.017383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:26.072933 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:93df62d0-dc0a-492e-8c3c-c8473d8e9708&page=queryresults
[0m21:44:26.080745 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_inventory (execute): 2023-06-30 21:44:21.767248 => 2023-06-30 21:44:26.080645
[0m21:44:26.082102 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d57ad40>]}
[0m21:44:26.082941 [info ] [Thread-4 (]: 13 of 41 OK created sql table model dev_thaina_silver.stg_product_inventory .... [[32mCREATE TABLE (1.1k rows, 76.8 KB processed)[0m in 4.32s]
[0m21:44:26.083965 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_inventory
[0m21:44:26.084756 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchase_order_header
[0m21:44:26.085615 [info ] [Thread-4 (]: 18 of 41 START sql table model dev_thaina_silver.stg_purchase_order_header ..... [RUN]
[0m21:44:26.087049 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_header'
[0m21:44:26.087663 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchase_order_header
[0m21:44:26.095029 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d200fb6b-c2dc-44ca-9f1b-7a9dab51c2b5&page=queryresults
[0m21:44:26.099736 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_location (execute): 2023-06-30 21:44:22.043034 => 2023-06-30 21:44:26.099616
[0m21:44:26.100847 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_header"
[0m21:44:26.104902 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d352dd0>]}
[0m21:44:26.106190 [info ] [Thread-2 (]: 14 of 41 OK created sql table model dev_thaina_silver.stg_product_location ..... [[32mCREATE TABLE (14.0 rows, 670.0 Bytes processed)[0m in 4.07s]
[0m21:44:26.107085 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (compile): 2023-06-30 21:44:26.089155 => 2023-06-30 21:44:26.106946
[0m21:44:26.107895 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_location
[0m21:44:26.108625 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_purchase_order_header
[0m21:44:26.109595 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_purchasing_product_vendor
[0m21:44:26.118612 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:26.135018 [info ] [Thread-2 (]: 19 of 41 START sql table model dev_thaina_silver.stg_purchasing_product_vendor . [RUN]
[0m21:44:26.141827 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_product_vendor'
[0m21:44:26.199603 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_subcategory"
[0m21:44:26.200611 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_purchasing_product_vendor
[0m21:44:26.208489 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m21:44:26.209941 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (compile): 2023-06-30 21:44:26.202561 => 2023-06-30 21:44:26.209634
[0m21:44:26.211485 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_subcategory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_subcategory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productsubcategoryid as subcategory_id
    , productcategoryid as category_id
    , name as subcategory_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productsubcategory`
)

select *
from source_data
    );
  
[0m21:44:26.212483 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_purchasing_product_vendor
[0m21:44:26.225894 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:26.982683 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_detail"
[0m21:44:26.983570 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchase_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , purchaseorderdetailid as purchase_order_detail_id
    , duedate as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m21:44:27.300045 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_header"
[0m21:44:27.302248 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m21:44:27.302870 [debug] [Thread-4 (]: On model.desafioaethaina.stg_purchase_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    purchaseorderid as purchase_order_id
    , revisionnumber as revision_number
    , status as status_order
    , employeeid as employee_id
    , vendorid as vendor_id
    , shipmethodid as ship_method_id
    , shipdate as ship_date
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight  
    /* Total due to vendor. Computed as Subtotal + TaxAmt + Freight.
Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0))  */
  from
    `desafiothaina`.`dev_thaina`.`purchaseorderheader`
)

select * 
  from source_data
    );
  
[0m21:44:27.306814 [debug] [Thread-2 (]: On model.desafioaethaina.stg_purchasing_product_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_product_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_product_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , productid as product_id
    , standardprice as standard_price
    , minorderqty as min_order_qty
    , maxorderqty as max_order_qty
    , onorderqty as on_order_qty
    , unitmeasurecode as unit_measure_code
  from  `desafiothaina`.`dev_thaina`.`productvendor`
)

select *
from source_data
    );
  
[0m21:44:29.441427 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:329d1975-b0dc-4069-9f41-cb8793e6ffbc&page=queryresults
[0m21:44:29.445451 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_subcategory (execute): 2023-06-30 21:44:25.308165 => 2023-06-30 21:44:29.445388
[0m21:44:29.446240 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d573820>]}
[0m21:44:29.446719 [info ] [Thread-3 (]: 16 of 41 OK created sql table model dev_thaina_silver.stg_product_subcategory .. [[32mCREATE TABLE (37.0 rows, 2.3 KB processed)[0m in 4.15s]
[0m21:44:29.447236 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_subcategory
[0m21:44:29.447886 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchasing_ship_method
[0m21:44:29.448716 [info ] [Thread-3 (]: 20 of 41 START sql table model dev_thaina_silver.stg_purchasing_ship_method .... [RUN]
[0m21:44:29.449858 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_ship_method'
[0m21:44:29.450219 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchasing_ship_method
[0m21:44:29.453805 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m21:44:29.454440 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (compile): 2023-06-30 21:44:29.450434 => 2023-06-30 21:44:29.454324
[0m21:44:29.454952 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchasing_ship_method
[0m21:44:29.460285 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:29.869394 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4d71e306-80fa-4a0f-ac2d-1e52c3b44b5c&page=queryresults
[0m21:44:29.873455 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (execute): 2023-06-30 21:44:26.012052 => 2023-06-30 21:44:29.873361
[0m21:44:29.875865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904c0dc100>]}
[0m21:44:29.876749 [info ] [Thread-1 (]: 17 of 41 OK created sql table model dev_thaina_silver.stg_purchase_order_detail  [[32mCREATE TABLE (8.8k rows, 837.9 KB processed)[0m in 3.87s]
[0m21:44:29.877636 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m21:44:29.878307 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchasing_vendor
[0m21:44:29.878959 [info ] [Thread-1 (]: 21 of 41 START sql table model dev_thaina_silver.stg_purchasing_vendor ......... [RUN]
[0m21:44:29.881118 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_vendor'
[0m21:44:29.881769 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchasing_vendor
[0m21:44:29.887780 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_vendor"
[0m21:44:29.889854 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (compile): 2023-06-30 21:44:29.882265 => 2023-06-30 21:44:29.889693
[0m21:44:29.890674 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchasing_vendor
[0m21:44:29.898317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:30.234293 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e013e96d-74ba-4647-a746-1d217161f1a3&page=queryresults
[0m21:44:30.237633 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (execute): 2023-06-30 21:44:26.110450 => 2023-06-30 21:44:30.237516
[0m21:44:30.238707 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d5782b0>]}
[0m21:44:30.239274 [info ] [Thread-4 (]: 18 of 41 OK created sql table model dev_thaina_silver.stg_purchase_order_header  [[32mCREATE TABLE (4.0k rows, 380.0 KB processed)[0m in 4.15s]
[0m21:44:30.239998 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchase_order_header
[0m21:44:30.240867 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_country_region_currency
[0m21:44:30.242309 [info ] [Thread-4 (]: 22 of 41 START sql table model dev_thaina_silver.stg_sales_country_region_currency  [RUN]
[0m21:44:30.244113 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_country_region_currency'
[0m21:44:30.244779 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_country_region_currency
[0m21:44:30.253034 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m21:44:30.254647 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (compile): 2023-06-30 21:44:30.245223 => 2023-06-30 21:44:30.254390
[0m21:44:30.255689 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_country_region_currency
[0m21:44:30.262266 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:30.440892 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m21:44:30.442637 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchasing_ship_method: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_ship_method"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
    );
  
[0m21:44:30.508123 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:16759467-3f2f-4cae-bff1-b937646ef984&page=queryresults
[0m21:44:30.510612 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (execute): 2023-06-30 21:44:26.220208 => 2023-06-30 21:44:30.510522
[0m21:44:30.511761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904c143f70>]}
[0m21:44:30.512282 [info ] [Thread-2 (]: 19 of 41 OK created sql table model dev_thaina_silver.stg_purchasing_product_vendor  [[32mCREATE TABLE (460.0 rows, 21.4 KB processed)[0m in 4.37s]
[0m21:44:30.513132 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_purchasing_product_vendor
[0m21:44:30.513893 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_creditcard
[0m21:44:30.514725 [info ] [Thread-2 (]: 23 of 41 START sql table model dev_thaina_silver.stg_sales_creditcard .......... [RUN]
[0m21:44:30.516543 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_creditcard'
[0m21:44:30.517277 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_creditcard
[0m21:44:30.689427 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_creditcard"
[0m21:44:30.690067 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (compile): 2023-06-30 21:44:30.517813 => 2023-06-30 21:44:30.689970
[0m21:44:30.690499 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_creditcard
[0m21:44:30.693441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:30.919538 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_vendor"
[0m21:44:30.920534 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchasing_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , accountnumber as account_number
    , name as company_name
    -- 1 = Superior, 2 = Excellent, 3 = Above average, 4 = Average, 5 = Below
    , creditrating as credit_rate
    , activeflag as active_flag
  from  `desafiothaina`.`dev_thaina`.`vendor`
)

select *
from source_data
    );
  
[0m21:44:31.339564 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m21:44:31.340478 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_country_region_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_country_region_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_country_region_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
      countryregioncode as country_region_code
      , currencycode as currency_code
    from `desafiothaina`.`dev_thaina`.`countryregioncurrency`
  )
select  *
from source_data
    );
  
[0m21:44:31.701013 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_creditcard"
[0m21:44:31.701903 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_creditcard: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_creditcard"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    creditcardid as credit_card_id
    , cardtype as card_type
  from  `desafiothaina`.`dev_thaina`.`creditcard`
)
select *
from source_data
    );
  
[0m21:44:33.419434 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1bab8a45-05e2-4e96-ba05-a5854cf2a57f&page=queryresults
[0m21:44:33.423331 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (execute): 2023-06-30 21:44:29.455189 => 2023-06-30 21:44:33.423232
[0m21:44:33.425250 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9045770eb0>]}
[0m21:44:33.426161 [info ] [Thread-3 (]: 20 of 41 OK created sql table model dev_thaina_silver.stg_purchasing_ship_method  [[32mCREATE TABLE (5.0 rows, 400.0 Bytes processed)[0m in 3.98s]
[0m21:44:33.427258 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchasing_ship_method
[0m21:44:33.430303 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_currency
[0m21:44:33.431236 [info ] [Thread-3 (]: 24 of 41 START sql table model dev_thaina_silver.stg_sales_currency ............ [RUN]
[0m21:44:33.432803 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency'
[0m21:44:33.433495 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_currency
[0m21:44:33.441385 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency"
[0m21:44:33.442774 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_currency (compile): 2023-06-30 21:44:33.433982 => 2023-06-30 21:44:33.442600
[0m21:44:33.443815 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_currency
[0m21:44:33.450828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:33.863896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7fcd108b-9968-4d2a-a5db-c5df2e3c099b&page=queryresults
[0m21:44:33.867841 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (execute): 2023-06-30 21:44:29.891230 => 2023-06-30 21:44:33.867733
[0m21:44:33.869165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9045746d10>]}
[0m21:44:33.870086 [info ] [Thread-1 (]: 21 of 41 OK created sql table model dev_thaina_silver.stg_purchasing_vendor .... [[32mCREATE TABLE (104.0 rows, 5.1 KB processed)[0m in 3.99s]
[0m21:44:33.876650 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchasing_vendor
[0m21:44:33.877438 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_currency_rate
[0m21:44:33.879562 [info ] [Thread-1 (]: 25 of 41 START sql table model dev_thaina_silver.stg_sales_currency_rate ....... [RUN]
[0m21:44:33.881069 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency_rate'
[0m21:44:33.881707 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_currency_rate
[0m21:44:33.889106 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency_rate"
[0m21:44:33.895120 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (compile): 2023-06-30 21:44:33.882120 => 2023-06-30 21:44:33.894969
[0m21:44:33.895780 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_currency_rate
[0m21:44:33.901294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:34.435442 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:03d6b17f-3a12-4da8-beac-e2b16e756cec&page=queryresults
[0m21:44:34.439358 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (execute): 2023-06-30 21:44:30.256410 => 2023-06-30 21:44:34.439258
[0m21:44:34.440621 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d3c3e50>]}
[0m21:44:34.441466 [info ] [Thread-4 (]: 22 of 41 OK created sql table model dev_thaina_silver.stg_sales_country_region_currency  [[32mCREATE TABLE (109.0 rows, 981.0 Bytes processed)[0m in 4.20s]
[0m21:44:34.453062 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_country_region_currency
[0m21:44:34.456354 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_customer
[0m21:44:34.457298 [info ] [Thread-4 (]: 26 of 41 START sql table model dev_thaina_silver.stg_sales_customer ............ [RUN]
[0m21:44:34.460923 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_customer'
[0m21:44:34.461525 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_customer
[0m21:44:34.495849 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_customer"
[0m21:44:34.497448 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_customer (compile): 2023-06-30 21:44:34.461929 => 2023-06-30 21:44:34.497243
[0m21:44:34.487473 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency"
[0m21:44:34.501651 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    currencycode as currency_code
    , name as currency_name
  from  `desafiothaina`.`dev_thaina`.`currency`
)

select *
from source_data
    );
  
[0m21:44:34.500212 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_customer
[0m21:44:34.517127 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:34.852630 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency_rate"
[0m21:44:34.854323 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      currencyrateid as currency_rate_id
      , currencyratedate as currency_rate_date
      , fromcurrencycode as from_currency_code
      , tocurrencycode as to_currency_code
      , averagerate as avg_rate
      , endofdayrate as end_of_day_rate
    from `desafiothaina`.`dev_thaina`.`currencyrate`
  )
select  *
from source_data
    );
  
[0m21:44:34.948769 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b8c17f9e-4231-4afc-95fd-ae88700d5b6b&page=queryresults
[0m21:44:34.953981 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (execute): 2023-06-30 21:44:30.690740 => 2023-06-30 21:44:34.953862
[0m21:44:34.955576 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904c143f40>]}
[0m21:44:34.956622 [info ] [Thread-2 (]: 23 of 41 OK created sql table model dev_thaina_silver.stg_sales_creditcard ..... [[32mCREATE TABLE (19.1k rows, 378.8 KB processed)[0m in 4.44s]
[0m21:44:34.957596 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_creditcard
[0m21:44:34.958408 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_order_detail
[0m21:44:34.960348 [info ] [Thread-2 (]: 27 of 41 START sql table model dev_thaina_silver.stg_sales_order_detail ........ [RUN]
[0m21:44:34.962058 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_detail'
[0m21:44:34.962761 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_order_detail
[0m21:44:34.969553 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_detail"
[0m21:44:34.970389 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (compile): 2023-06-30 21:44:34.963208 => 2023-06-30 21:44:34.970271
[0m21:44:34.970943 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_order_detail
[0m21:44:34.976625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:35.439220 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_customer"
[0m21:44:35.440170 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
    );
  
[0m21:44:36.105620 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_detail"
[0m21:44:36.109383 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
    );
  
[0m21:44:37.739833 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:02c1006b-255c-4a8f-8826-de7e0aae0a96&page=queryresults
[0m21:44:37.742167 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_currency (execute): 2023-06-30 21:44:33.444260 => 2023-06-30 21:44:37.742101
[0m21:44:37.743266 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d315c30>]}
[0m21:44:37.744062 [info ] [Thread-3 (]: 24 of 41 OK created sql table model dev_thaina_silver.stg_sales_currency ....... [[32mCREATE TABLE (105.0 rows, 2.0 KB processed)[0m in 4.31s]
[0m21:44:37.745597 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_currency
[0m21:44:37.746493 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m21:44:37.747381 [info ] [Thread-3 (]: 28 of 41 START sql table model dev_thaina_silver.stg_sales_order_header ........ [RUN]
[0m21:44:37.748985 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m21:44:37.749637 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m21:44:37.756748 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m21:44:37.758674 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-06-30 21:44:37.750079 => 2023-06-30 21:44:37.758406
[0m21:44:37.759335 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m21:44:37.768897 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:37.842096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:09f5c60a-9faf-4fbe-aba2-3fcd81cb23da&page=queryresults
[0m21:44:37.845723 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (execute): 2023-06-30 21:44:33.896173 => 2023-06-30 21:44:37.845623
[0m21:44:37.847073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d3d9fc0>]}
[0m21:44:38.479938 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:aad3c181-7768-4748-ae94-1a64e7bb99b8&page=queryresults
[0m21:44:38.483564 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_customer (execute): 2023-06-30 21:44:34.508480 => 2023-06-30 21:44:38.483465
[0m21:44:38.485357 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d3129e0>]}
[0m21:44:38.753950 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m21:44:38.754603 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , orderdate as order_date
    , duedate as due_date
    , shipdate as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m21:44:40.111378 [info ] [Thread-1 (]: 25 of 41 OK created sql table model dev_thaina_silver.stg_sales_currency_rate .. [[32mCREATE TABLE (13.5k rows, 779.7 KB processed)[0m in 3.97s]
[0m21:44:40.113196 [info ] [Thread-4 (]: 26 of 41 OK created sql table model dev_thaina_silver.stg_sales_customer ....... [[32mCREATE TABLE (19.8k rows, 1.2 MB processed)[0m in 4.02s]
[0m21:44:40.115163 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_customer
[0m21:44:40.116103 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_order_header_reason
[0m21:44:40.117189 [info ] [Thread-4 (]: 29 of 41 START sql table model dev_thaina_silver.stg_sales_order_header_reason . [RUN]
[0m21:44:40.120669 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header_reason'
[0m21:44:40.121467 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_order_header_reason
[0m21:44:40.114103 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_currency_rate
[0m21:44:40.131201 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_person
[0m21:44:40.137316 [info ] [Thread-1 (]: 30 of 41 START sql table model dev_thaina_silver.stg_sales_person .............. [RUN]
[0m21:44:40.143224 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person'
[0m21:44:40.144216 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_person
[0m21:44:40.160102 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m21:44:40.161764 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (compile): 2023-06-30 21:44:40.122019 => 2023-06-30 21:44:40.161606
[0m21:44:40.162562 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_order_header_reason
[0m21:44:40.168986 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:40.154620 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person"
[0m21:44:40.170925 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_person (compile): 2023-06-30 21:44:40.144774 => 2023-06-30 21:44:40.170746
[0m21:44:40.171930 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_person
[0m21:44:40.177216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:40.281585 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c9ebebf5-f90d-4161-a634-c4533f7d43fc&page=queryresults
[0m21:44:40.286068 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (execute): 2023-06-30 21:44:34.971338 => 2023-06-30 21:44:40.285955
[0m21:44:40.288161 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d314550>]}
[0m21:44:40.289186 [info ] [Thread-2 (]: 27 of 41 OK created sql table model dev_thaina_silver.stg_sales_order_detail ... [[32mCREATE TABLE (121.3k rows, 10.8 MB processed)[0m in 5.33s]
[0m21:44:40.290154 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_order_detail
[0m21:44:40.297739 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_person_quota_history
[0m21:44:40.298529 [info ] [Thread-2 (]: 31 of 41 START sql table model dev_thaina_silver.stg_sales_person_quota_history  [RUN]
[0m21:44:40.304514 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person_quota_history'
[0m21:44:40.305388 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_person_quota_history
[0m21:44:40.312520 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m21:44:40.322790 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (compile): 2023-06-30 21:44:40.305806 => 2023-06-30 21:44:40.321940
[0m21:44:40.327927 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_person_quota_history
[0m21:44:40.339401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:41.579988 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m21:44:41.581963 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_order_header_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
    );
  
[0m21:44:41.722230 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person"
[0m21:44:41.723669 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , territoryid as territory_id
      , salesquota as sales_quota
      , bonus
      , commissionpct as commission_pct
      , salesytd as sales_total
      , saleslastyear as sales_last_year
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salesperson`
  )

select  *
from source_data
    );
  
[0m21:44:41.740652 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m21:44:41.741515 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_person_quota_history: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person_quota_history"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person_quota_history`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , quotadate as quota_date
      , salesquota as sales_quota
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salespersonquotahistory`
  )

select  *
from source_data
    );
  
[0m21:44:42.326542 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:537cf6d8-ff9c-429a-afe9-84cb0103b2c2&page=queryresults
[0m21:44:42.330408 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-06-30 21:44:37.759898 => 2023-06-30 21:44:42.330304
[0m21:44:42.331860 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904c1cba30>]}
[0m21:44:42.332787 [info ] [Thread-3 (]: 28 of 41 OK created sql table model dev_thaina_silver.stg_sales_order_header ... [[32mCREATE TABLE (31.5k rows, 7.4 MB processed)[0m in 4.58s]
[0m21:44:42.335748 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m21:44:42.336498 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_reason
[0m21:44:42.337713 [info ] [Thread-3 (]: 32 of 41 START sql table model dev_thaina_silver.stg_sales_reason .............. [RUN]
[0m21:44:42.341486 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_reason'
[0m21:44:42.342259 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_reason
[0m21:44:42.349535 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_reason"
[0m21:44:42.351198 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_reason (compile): 2023-06-30 21:44:42.342884 => 2023-06-30 21:44:42.351011
[0m21:44:42.351935 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_reason
[0m21:44:42.360190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:43.483515 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_reason"
[0m21:44:43.485543 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salesreasonid as sales_reason_id
      , name as name_reason
      , reasontype as reason_type
    from `desafiothaina`.`dev_thaina`.`salesreason`
  )

select  *
from source_data
    );
  
[0m21:44:44.787651 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2708c132-9477-4ff5-9a14-82ed930d5715&page=queryresults
[0m21:44:44.791423 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (execute): 2023-06-30 21:44:40.328632 => 2023-06-30 21:44:44.791324
[0m21:44:44.792943 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d42fd30>]}
[0m21:44:44.793841 [info ] [Thread-2 (]: 31 of 41 OK created sql table model dev_thaina_silver.stg_sales_person_quota_history  [[32mCREATE TABLE (163.0 rows, 12.6 KB processed)[0m in 4.49s]
[0m21:44:44.794957 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_person_quota_history
[0m21:44:44.795828 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_tax_rate
[0m21:44:44.796806 [info ] [Thread-2 (]: 33 of 41 START sql table model dev_thaina_silver.stg_sales_tax_rate ............ [RUN]
[0m21:44:44.798311 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_tax_rate'
[0m21:44:44.798959 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_tax_rate
[0m21:44:44.806179 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_tax_rate"
[0m21:44:44.809286 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (compile): 2023-06-30 21:44:44.799379 => 2023-06-30 21:44:44.809068
[0m21:44:44.810061 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_tax_rate
[0m21:44:44.817912 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:44.870384 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:790f5568-da3a-42e9-8785-ae47b39bb903&page=queryresults
[0m21:44:44.879990 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_person (execute): 2023-06-30 21:44:40.172538 => 2023-06-30 21:44:44.879882
[0m21:44:44.882420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d2c6080>]}
[0m21:44:44.887768 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5b742956-bde1-4b45-84fb-b00cc5af91c7&page=queryresults
[0m21:44:44.892881 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (execute): 2023-06-30 21:44:40.163145 => 2023-06-30 21:44:44.892815
[0m21:44:44.893878 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d312fe0>]}
[0m21:44:44.894642 [info ] [Thread-1 (]: 30 of 41 OK created sql table model dev_thaina_silver.stg_sales_person ......... [[32mCREATE TABLE (17.0 rows, 1.5 KB processed)[0m in 4.74s]
[0m21:44:44.896396 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_person
[0m21:44:44.897271 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_territory
[0m21:44:44.895308 [info ] [Thread-4 (]: 29 of 41 OK created sql table model dev_thaina_silver.stg_sales_order_header_reason  [[32mCREATE TABLE (27.6k rows, 432.0 KB processed)[0m in 4.77s]
[0m21:44:44.899207 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_order_header_reason
[0m21:44:44.900857 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_address
[0m21:44:44.898170 [info ] [Thread-1 (]: 34 of 41 START sql table model dev_thaina_silver.stg_sales_territory ........... [RUN]
[0m21:44:44.904349 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_territory'
[0m21:44:44.904986 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_territory
[0m21:44:44.912048 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_territory"
[0m21:44:44.913433 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_territory (compile): 2023-06-30 21:44:44.905420 => 2023-06-30 21:44:44.913266
[0m21:44:44.914612 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_territory
[0m21:44:44.902748 [info ] [Thread-4 (]: 35 of 41 START sql table model dev_thaina_intermediate.int_address ............. [RUN]
[0m21:44:44.927376 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m21:44:44.928891 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_address
[0m21:44:44.943022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:44.948519 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m21:44:44.953350 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-06-30 21:44:44.929896 => 2023-06-30 21:44:44.952944
[0m21:44:44.954615 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.int_address
[0m21:44:44.969240 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:45.926708 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_tax_rate"
[0m21:44:45.928817 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_tax_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_tax_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_tax_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salestaxrateid as sales_tax_rate_id
      , stateprovinceid as state_province_id
      , taxtype as tax_type
      , taxrate as tax_rate
      , name as name_tax_rate_desciption
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salestaxrate`
  )

select  *
from source_data
    );
  
[0m21:44:46.151541 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m21:44:46.155165 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_territory"
[0m21:44:46.156122 [debug] [Thread-4 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, union_address_business_contact as (
    select
        business_entity_address.business_entity_id
        , address_id
        , address_type_id
        , contact_type_id
        , person_id
    from business_entity_contact
    left join  business_entity_address
    on business_entity_address.business_entity_id = business_entity_contact.business_entity_id
)


, union_address_type as (
    select
        union_address_business_contact.*
        , address_type_name
    from address_type
    left join union_address_business_contact
    on address_type.address_type_id = union_address_business_contact.address_type_id
)

, union_address_business_address as (
    select
    	union_address_type.*
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
    from union_address_type
    left join address 
    on address.address_id = union_address_type.address_id
)

select * 
from union_address_business_address
    );
  
[0m21:44:46.160800 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_territory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_territory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
    );
  
[0m21:44:46.765131 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8e37b87b-6def-48d2-ac4e-1c0ddb0cf68c&page=queryresults
[0m21:44:46.769094 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_reason (execute): 2023-06-30 21:44:42.352597 => 2023-06-30 21:44:46.768985
[0m21:44:46.770424 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904c25e0b0>]}
[0m21:44:46.771314 [info ] [Thread-3 (]: 32 of 41 OK created sql table model dev_thaina_silver.stg_sales_reason ......... [[32mCREATE TABLE (10.0 rows, 305.0 Bytes processed)[0m in 4.43s]
[0m21:44:46.773214 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_reason
[0m21:44:46.774200 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_product
[0m21:44:46.776730 [info ] [Thread-3 (]: 36 of 41 START sql table model dev_thaina_intermediate.int_product ............. [RUN]
[0m21:44:46.779745 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m21:44:46.780559 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_product
[0m21:44:46.790893 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m21:44:46.792595 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-06-30 21:44:46.781142 => 2023-06-30 21:44:46.792375
[0m21:44:46.793710 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.int_product
[0m21:44:46.802143 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:47.783169 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m21:44:47.784051 [debug] [Thread-3 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from subcategory
    left join product
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from category
	left join union_product_subcategory
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from model
	left join union_product_category
    on union_product_category.product_model_id = model.model_id
)

, union_product_inventory as (
    select 
        union_product_model.*
        , quantity_inventory
        , shelf
        , bin
    from inventory
    left join union_product_model
    on union_product_model.product_id = inventory.product_id
)

select * 
from union_product_inventory
    );
  
[0m21:44:49.006544 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0965d15e-bde9-461c-ba9b-e80a755aff6f&page=queryresults
[0m21:44:49.007345 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0be2d02b-5bb9-4ca1-a19d-22036d3dc69c&page=queryresults
[0m21:44:49.010812 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_territory (execute): 2023-06-30 21:44:44.915267 => 2023-06-30 21:44:49.010710
[0m21:44:49.014936 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (execute): 2023-06-30 21:44:44.811634 => 2023-06-30 21:44:49.014846
[0m21:44:49.016320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d3d8730>]}
[0m21:44:49.017516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904c143f40>]}
[0m21:44:49.018416 [info ] [Thread-1 (]: 34 of 41 OK created sql table model dev_thaina_silver.stg_sales_territory ...... [[32mCREATE TABLE (10.0 rows, 925.0 Bytes processed)[0m in 4.11s]
[0m21:44:49.019335 [info ] [Thread-2 (]: 33 of 41 OK created sql table model dev_thaina_silver.stg_sales_tax_rate ....... [[32mCREATE TABLE (29.0 rows, 2.6 KB processed)[0m in 4.22s]
[0m21:44:49.026546 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_tax_rate
[0m21:44:49.027361 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_sales
[0m21:44:49.028141 [info ] [Thread-2 (]: 37 of 41 START sql table model dev_thaina_intermediate.int_sales ............... [RUN]
[0m21:44:49.029554 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m21:44:49.030194 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_sales
[0m21:44:49.037688 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m21:44:49.039059 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-06-30 21:44:49.030617 => 2023-06-30 21:44:49.038697
[0m21:44:49.041165 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.int_sales
[0m21:44:49.039900 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_territory
[0m21:44:49.055130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:49.056665 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_customer
[0m21:44:49.058719 [info ] [Thread-1 (]: 38 of 41 START sql table model dev_thaina_intermediate.int_customer ............ [RUN]
[0m21:44:49.103244 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer'
[0m21:44:49.104515 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_customer
[0m21:44:49.125775 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_customer"
[0m21:44:49.127697 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer (compile): 2023-06-30 21:44:49.105301 => 2023-06-30 21:44:49.127531
[0m21:44:49.128335 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_customer
[0m21:44:49.136500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:49.703521 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:68c34bf1-b57a-4554-8f2f-a97d56ba1acb&page=queryresults
[0m21:44:49.708061 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-06-30 21:44:44.955326 => 2023-06-30 21:44:49.707966
[0m21:44:49.709454 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d3166e0>]}
[0m21:44:49.710434 [info ] [Thread-4 (]: 35 of 41 OK created sql table model dev_thaina_intermediate.int_address ........ [[32mCREATE TABLE (925.0 rows, 1.5 MB processed)[0m in 4.78s]
[0m21:44:49.711487 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_address
[0m21:44:49.720319 [debug] [Thread-4 (]: Began running node model.desafioaethaina.dim_address
[0m21:44:49.721662 [info ] [Thread-4 (]: 39 of 41 START sql table model dev_thaina_gold.dim_address ..................... [RUN]
[0m21:44:49.723191 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m21:44:49.724748 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.dim_address
[0m21:44:49.742132 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m21:44:49.747089 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-06-30 21:44:49.725266 => 2023-06-30 21:44:49.746604
[0m21:44:49.750897 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.dim_address
[0m21:44:49.763492 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m21:44:49.765691 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:44:49.772235 [debug] [Thread-4 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
)

, prodcut_with_sk  as (
    select
        row_number() over (order by product_id) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m21:44:50.240758 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m21:44:50.241642 [debug] [Thread-2 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, sales_order_detail_id
		, carrier_tracking_number
		, order_qty
		, product_id
		, unit_price
		, unit_price_discount
	from order_header
	left join order_header_reason
	on order_header_reason.sales_order_id = order_header.sales_order_id
	left join order_detail 
	on order_detail.sales_order_id =  order_header.sales_order_id
)

select * from union_header_reason
    );
  
[0m21:44:50.258429 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_customer"
[0m21:44:50.259300 [debug] [Thread-1 (]: On model.desafioaethaina.int_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , group_geo
        , sales_territory_year
        , bussiness_cost_in_territory
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

select * 
from union_customer_country
    );
  
[0m21:44:51.163000 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:abf81d92-2905-420e-a472-093cdb4ee4a8&page=queryresults
[0m21:44:51.166706 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-06-30 21:44:46.794794 => 2023-06-30 21:44:51.166588
[0m21:44:51.168239 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9045715c00>]}
[0m21:44:51.169343 [info ] [Thread-3 (]: 36 of 41 OK created sql table model dev_thaina_intermediate.int_product ........ [[32mCREATE TABLE (1.1k rows, 93.1 KB processed)[0m in 4.39s]
[0m21:44:51.170444 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_product
[0m21:44:51.213272 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: product_id at [21:43]')
[0m21:44:53.311444 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:dc1ab83b-abc7-4326-a256-ff240e60d921&page=queryresults
[0m21:44:53.318356 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-06-30 21:44:49.752951 => 2023-06-30 21:44:53.318219
[0m21:44:53.323100 [debug] [Thread-4 (]: Database Error in model dim_address (models/gold/dim_address.sql)
  Unrecognized name: product_id at [21:43]
  compiled Code at target/run/desafioaethaina/models/gold/dim_address.sql
[0m21:44:53.323825 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d40fee0>]}
[0m21:44:53.324584 [error] [Thread-4 (]: 39 of 41 ERROR creating sql table model dev_thaina_gold.dim_address ............ [[31mERROR[0m in 3.60s]
[0m21:44:53.325463 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.dim_address
[0m21:44:53.993881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:dbf83a4f-6f39-4123-a60d-0212f9495d63&page=queryresults
[0m21:44:53.996117 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer (execute): 2023-06-30 21:44:49.129084 => 2023-06-30 21:44:53.996056
[0m21:44:53.996868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d333580>]}
[0m21:44:53.997360 [info ] [Thread-1 (]: 38 of 41 OK created sql table model dev_thaina_intermediate.int_customer ....... [[32mCREATE TABLE (10.3k rows, 1.2 MB processed)[0m in 4.89s]
[0m21:44:53.997986 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_customer
[0m21:44:53.998913 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_customer
[0m21:44:53.999732 [info ] [Thread-3 (]: 40 of 41 START sql table model dev_thaina_gold.dim_customer .................... [RUN]
[0m21:44:54.001051 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customer'
[0m21:44:54.001652 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_customer
[0m21:44:54.012587 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_customer"
[0m21:44:54.013768 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_customer (compile): 2023-06-30 21:44:54.002026 => 2023-06-30 21:44:54.013566
[0m21:44:54.014931 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_customer
[0m21:44:54.024049 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:44:54.947348 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_customer"
[0m21:44:54.948143 [debug] [Thread-3 (]: On model.desafioaethaina.dim_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customer`
    
    
    OPTIONS(
      description="""This table contains information about customers of Adventure Works"""
    )
    as (
      with int_customer as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by customer_id order by customer_id) as dedup_index
    from int_customer
)

, customer_with_sk  as (
    select
        row_number() over (order by customer_id) as customer_sk
        , full_name
		, suffix
		, store_id
		, territory_id 
        , person_type
		, name_style
		, courtesy_title
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m21:44:56.380201 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:364b4711-97f6-42b9-bc55-53d3fe6612fb&page=queryresults
[0m21:44:56.382720 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-06-30 21:44:49.042055 => 2023-06-30 21:44:56.382653
[0m21:44:56.383564 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d314070>]}
[0m21:44:56.384151 [info ] [Thread-2 (]: 37 of 41 OK created sql table model dev_thaina_intermediate.int_sales .......... [[32mCREATE TABLE (131.9k rows, 14.2 MB processed)[0m in 7.35s]
[0m21:44:56.384842 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_sales
[0m21:44:56.385801 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_customer_and_sales
[0m21:44:56.386381 [info ] [Thread-1 (]: 41 of 41 START sql table model dev_thaina_intermediate.int_customer_and_sales .. [RUN]
[0m21:44:56.387673 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer_and_sales'
[0m21:44:56.388127 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_customer_and_sales
[0m21:44:56.394660 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_customer_and_sales"
[0m21:44:56.395653 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (compile): 2023-06-30 21:44:56.388400 => 2023-06-30 21:44:56.395476
[0m21:44:56.396524 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_customer_and_sales
[0m21:44:56.402158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:57.403156 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_customer_and_sales"
[0m21:44:57.403820 [debug] [Thread-1 (]: On model.desafioaethaina.int_customer_and_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with customer as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`	
)

, sales as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, person_type
		, name_style
		, courtesy_title
		, full_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m21:44:58.630404 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:02016470-a281-4336-bf5b-c89107fb9d83&page=queryresults
[0m21:44:59.657467 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_customer (execute): 2023-06-30 21:44:54.015757 => 2023-06-30 21:44:59.657393
[0m21:44:59.658377 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904c2668c0>]}
[0m21:44:59.658894 [info ] [Thread-3 (]: 40 of 41 OK created sql table model dev_thaina_gold.dim_customer ............... [[32mCREATE TABLE (10.3k rows, 538.9 KB processed)[0m in 5.66s]
[0m21:44:59.659427 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_customer
[0m21:45:03.012796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cb8da648-c9f7-4a18-8900-efde656442ef&page=queryresults
[0m21:45:03.015280 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (execute): 2023-06-30 21:44:56.397164 => 2023-06-30 21:45:03.015217
[0m21:45:03.016065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f62df04-3812-4ce5-9bbf-57906872e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9045785e10>]}
[0m21:45:03.016556 [info ] [Thread-1 (]: 41 of 41 OK created sql table model dev_thaina_intermediate.int_customer_and_sales  [[32mCREATE TABLE (44.6k rows, 39.4 MB processed)[0m in 6.63s]
[0m21:45:03.017058 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_customer_and_sales
[0m21:45:03.019129 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:45:03.019918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:03.020214 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m21:45:03.020534 [debug] [MainThread]: Connection 'model.desafioaethaina.int_customer_and_sales' was properly closed.
[0m21:45:03.020795 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m21:45:03.021051 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customer' was properly closed.
[0m21:45:03.021523 [info ] [MainThread]: 
[0m21:45:03.021994 [info ] [MainThread]: Finished running 41 table models in 0 hours 0 minutes and 57.82 seconds (57.82s).
[0m21:45:03.026260 [debug] [MainThread]: Command end result
[0m21:45:03.073635 [info ] [MainThread]: 
[0m21:45:03.074809 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:45:03.075525 [info ] [MainThread]: 
[0m21:45:03.076204 [error] [MainThread]: [33mDatabase Error in model dim_address (models/gold/dim_address.sql)[0m
[0m21:45:03.076927 [error] [MainThread]:   Unrecognized name: product_id at [21:43]
[0m21:45:03.077588 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_address.sql
[0m21:45:03.078767 [info ] [MainThread]: 
[0m21:45:03.080351 [info ] [MainThread]: Done. PASS=40 WARN=0 ERROR=1 SKIP=0 TOTAL=41
[0m21:45:03.081927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d3cef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d4fc1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904d4fc4c0>]}
[0m21:45:03.083250 [debug] [MainThread]: Flushing usage events


============================== 2023-06-30 21:47:42.578884 | fd856d01-9265-41be-a3f8-5c21b0623e12 ==============================
[0m21:47:42.578884 [info ] [MainThread]: Running with dbt=1.4.6
[0m21:47:42.580880 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_product'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:47:42.581273 [debug] [MainThread]: Tracking: tracking
[0m21:47:42.583409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be58863b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be5885d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be5886380>]}
[0m21:47:42.628629 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m21:47:42.761447 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m21:47:42.762197 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_product.sql
[0m21:47:42.762478 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_address.sql
[0m21:47:42.785931 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_product.sql
[0m21:47:42.822150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd856d01-9265-41be-a3f8-5c21b0623e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be5660fa0>]}
[0m21:47:42.843290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd856d01-9265-41be-a3f8-5c21b0623e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be55bbf70>]}
[0m21:47:42.843799 [info ] [MainThread]: Found 41 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m21:47:42.844279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd856d01-9265-41be-a3f8-5c21b0623e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be55bbf40>]}
[0m21:47:42.847836 [info ] [MainThread]: 
[0m21:47:42.850322 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:47:42.851700 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m21:47:42.852516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:43.914060 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m21:47:43.914664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:47:43.915586 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m21:47:43.918997 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m21:47:43.956402 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m21:47:43.956738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:43.957615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:43.958183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:45.137576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd856d01-9265-41be-a3f8-5c21b0623e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be55c8190>]}
[0m21:47:45.138506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:47:45.138968 [info ] [MainThread]: 
[0m21:47:45.143395 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_product
[0m21:47:45.143971 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_product ....................... [RUN]
[0m21:47:45.145061 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_product'
[0m21:47:45.145454 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_product
[0m21:47:45.150191 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_product"
[0m21:47:45.151083 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_product (compile): 2023-06-30 21:47:45.145682 => 2023-06-30 21:47:45.150937
[0m21:47:45.152065 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_product
[0m21:47:45.216857 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_product"
[0m21:47:45.217473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:47:45.219472 [debug] [Thread-1 (]: On model.desafioaethaina.dim_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
)

, prodcut_with_sk  as (
    select
        row_number() over (order by product_id) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m21:47:49.441235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:73f054ea-76e8-41fa-9b8b-d9754dc8fc55&page=queryresults
[0m21:47:49.458178 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_product (execute): 2023-06-30 21:47:45.152626 => 2023-06-30 21:47:49.458112
[0m21:47:49.458948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd856d01-9265-41be-a3f8-5c21b0623e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be4ef53f0>]}
[0m21:47:49.459448 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_product .................. [[32mCREATE TABLE (224.0 rows, 70.9 KB processed)[0m in 4.31s]
[0m21:47:49.470429 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_product
[0m21:47:49.473072 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:47:49.474039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:47:49.474395 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m21:47:49.474651 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m21:47:49.474900 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_product' was properly closed.
[0m21:47:49.475169 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m21:47:49.475619 [info ] [MainThread]: 
[0m21:47:49.476140 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.63 seconds (6.63s).
[0m21:47:49.477058 [debug] [MainThread]: Command end result
[0m21:47:49.509973 [info ] [MainThread]: 
[0m21:47:49.512920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:47:49.515823 [info ] [MainThread]: 
[0m21:47:49.516847 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:47:49.517751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be4f1eaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be4f1fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be4f1ebc0>]}
[0m21:47:49.518300 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 10:17:49.030645 | 07e053f0-c678-45c8-adb1-ceafaaa94b31 ==============================
[0m10:17:49.030645 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:17:49.040359 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:17:49.041492 [debug] [MainThread]: Tracking: tracking
[0m10:17:49.044475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f317d889360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f317d888910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f317d889270>]}
[0m10:17:49.121165 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:17:49.453702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:17:49.454808 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address.sql
[0m10:17:49.455363 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.yml
[0m10:17:49.483498 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m10:17:49.587292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07e053f0-c678-45c8-adb1-ceafaaa94b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f317ccf17b0>]}
[0m10:17:49.612058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07e053f0-c678-45c8-adb1-ceafaaa94b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f317d5c3f70>]}
[0m10:17:49.612701 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m10:17:49.613522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07e053f0-c678-45c8-adb1-ceafaaa94b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f317d5c3ee0>]}
[0m10:17:49.617337 [info ] [MainThread]: 
[0m10:17:49.619943 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:17:49.622350 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m10:17:49.623142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:50.510099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m10:17:50.510543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:50.511628 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m10:17:50.513657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:50.546108 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m10:17:50.548147 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m10:17:50.548986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:50.585696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:51.738757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07e053f0-c678-45c8-adb1-ceafaaa94b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f317d5c2ef0>]}
[0m10:17:51.739628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:51.740203 [info ] [MainThread]: 
[0m10:17:51.749480 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m10:17:51.750399 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_address ............... [RUN]
[0m10:17:51.754072 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m10:17:51.756109 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m10:17:51.767132 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m10:17:51.768118 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-07-01 10:17:51.756888 => 2023-07-01 10:17:51.767953
[0m10:17:51.768700 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m10:17:51.802220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:52.716644 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m10:17:52.717768 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, union_address_business_contact as (
    select
        business_entity_address.business_entity_id
        , address_id
        , address_type_id
        , contact_type_id
        , person_id
    from business_entity_contact
    left join  business_entity_address
    on business_entity_address.business_entity_id = business_entity_contact.business_entity_id
)


, union_address_type as (
    select
        union_address_business_contact.*
        , address_type_name
    from address_type
    left join union_address_business_contact
    on address_type.address_type_id = union_address_business_contact.address_type_id
)

, union_address_business_address as (
    select
    	union_address_type.*
        , concat(address_line1, ' ', address_line2, ' ', postal_code) as address
        , city
        , state_province_id
    from union_address_type
    left join address 
    on address.address_id = union_address_type.address_id
)

select * 
from union_address_business_address
    );
  
[0m10:17:56.218159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a22a3d19-f472-469e-b590-daf8dce2f95d&page=queryresults
[0m10:17:56.254359 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-07-01 10:17:51.769185 => 2023-07-01 10:17:56.254220
[0m10:17:56.255965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e053f0-c678-45c8-adb1-ceafaaa94b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f317cd69030>]}
[0m10:17:56.257078 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_address .......... [[32mCREATE TABLE (925.0 rows, 1.5 MB processed)[0m in 4.50s]
[0m10:17:56.260917 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m10:17:56.263293 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:17:56.264197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:56.264642 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m10:17:56.265108 [debug] [MainThread]: Connection 'model.desafioaethaina.int_address' was properly closed.
[0m10:17:56.265653 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m10:17:56.266195 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m10:17:56.266660 [info ] [MainThread]: 
[0m10:17:56.267847 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m10:17:56.269193 [debug] [MainThread]: Command end result
[0m10:17:56.307284 [info ] [MainThread]: 
[0m10:17:56.308469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:56.309480 [info ] [MainThread]: 
[0m10:17:56.310399 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:17:56.311453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f317ccf2230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3181bc9540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f317cd70a00>]}
[0m10:17:56.312286 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 10:30:38.608257 | ad59c1d0-1c5a-4295-8f08-6a975ab5e2ff ==============================
[0m10:30:38.608257 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:30:38.610357 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:30:38.610785 [debug] [MainThread]: Tracking: tracking
[0m10:30:38.612994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5d847f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5d84f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5d847c0>]}
[0m10:30:38.672024 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:30:38.857364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:30:38.858204 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m10:30:38.883602 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m10:30:38.920377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad59c1d0-1c5a-4295-8f08-6a975ab5e2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5b680d0>]}
[0m10:30:38.942380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad59c1d0-1c5a-4295-8f08-6a975ab5e2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5c27d30>]}
[0m10:30:38.942907 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m10:30:38.943396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad59c1d0-1c5a-4295-8f08-6a975ab5e2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5c27d00>]}
[0m10:30:38.947068 [info ] [MainThread]: 
[0m10:30:38.949554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:30:38.951465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m10:30:38.952281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:40.018163 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m10:30:40.019524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:40.024657 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m10:30:40.039504 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m10:30:40.089383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:40.086703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m10:30:40.099587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:40.087962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:41.773857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad59c1d0-1c5a-4295-8f08-6a975ab5e2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5ac7340>]}
[0m10:30:41.774771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:41.775247 [info ] [MainThread]: 
[0m10:30:41.779075 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m10:30:41.779622 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_address ............... [RUN]
[0m10:30:41.780690 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m10:30:41.781115 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m10:30:41.787529 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m10:30:41.788761 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-07-01 10:30:41.781353 => 2023-07-01 10:30:41.788565
[0m10:30:41.789273 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m10:30:41.831344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:42.729953 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m10:30:42.731095 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, union_address_business_contact as (
    select
        business_entity_address.business_entity_id
        , address_id
        , address_type_id
        , contact_type_id
        , person_id
    from business_entity_contact
    left join  business_entity_address
    on business_entity_address.business_entity_id = business_entity_contact.business_entity_id
)


, union_address_type as (
    select
        union_address_business_contact.*
        , address_type_name
    from address_type
    left join union_address_business_contact
    on address_type.address_type_id = union_address_business_contact.address_type_id
)

, union_address_business_address as (
    select
    	union_address_type.*
        , concat(address_line1, ' ', ifnull('',address_line2), ' ', postal_code) as address
        , city
        , state_province_id
    from union_address_type
    left join address 
    on address.address_id = union_address_type.address_id
)

select * 
from union_address_business_address
    );
  
[0m10:30:46.355134 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c9433906-f2b7-4d54-b521-1027a2ee8af2&page=queryresults
[0m10:30:46.379604 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-07-01 10:30:41.789696 => 2023-07-01 10:30:46.379534
[0m10:30:46.380532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad59c1d0-1c5a-4295-8f08-6a975ab5e2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5b6bcd0>]}
[0m10:30:46.381095 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_address .......... [[32mCREATE TABLE (925.0 rows, 1.5 MB processed)[0m in 4.60s]
[0m10:30:46.384110 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m10:30:46.386337 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:30:46.387838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:46.388436 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m10:30:46.388881 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m10:30:46.389323 [debug] [MainThread]: Connection 'model.desafioaethaina.int_address' was properly closed.
[0m10:30:46.389764 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m10:30:46.390286 [info ] [MainThread]: 
[0m10:30:46.391000 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.44 seconds (7.44s).
[0m10:30:46.392097 [debug] [MainThread]: Command end result
[0m10:30:46.429846 [info ] [MainThread]: 
[0m10:30:46.432857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:46.434587 [info ] [MainThread]: 
[0m10:30:46.435621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:30:46.436537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5c27d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5b23550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5b6bbb0>]}
[0m10:30:46.437154 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 10:34:16.095883 | 26d4ef66-6536-4a0a-9b4e-8e4a78a56b94 ==============================
[0m10:34:16.095883 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:34:16.099287 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:34:16.099878 [debug] [MainThread]: Tracking: tracking
[0m10:34:16.101769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d4f86470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d4f86bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d4f864d0>]}
[0m10:34:16.160352 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:34:16.337159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:34:16.338913 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m10:34:16.405147 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m10:34:16.506983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26d4ef66-6536-4a0a-9b4e-8e4a78a56b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d4d0c0d0>]}
[0m10:34:16.572366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26d4ef66-6536-4a0a-9b4e-8e4a78a56b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d4e404c0>]}
[0m10:34:16.573610 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m10:34:16.575040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26d4ef66-6536-4a0a-9b4e-8e4a78a56b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d4e40490>]}
[0m10:34:16.583438 [info ] [MainThread]: 
[0m10:34:16.587210 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:34:16.589319 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m10:34:16.590034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:17.591852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m10:34:17.593016 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m10:34:17.594088 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m10:34:17.595621 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m10:34:17.596154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:34:17.597229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:17.597806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:17.598351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:19.179229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26d4ef66-6536-4a0a-9b4e-8e4a78a56b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d4cdd270>]}
[0m10:34:19.180954 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:34:19.181809 [info ] [MainThread]: 
[0m10:34:19.201364 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m10:34:19.203571 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m10:34:19.208526 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m10:34:19.210452 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m10:34:19.223195 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m10:34:19.224165 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 10:34:19.211347 => 2023-07-01 10:34:19.224011
[0m10:34:19.225349 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m10:34:19.353937 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m10:34:19.355203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:19.360166 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            business_entity_id
            , address_type_name 
        order by business_entity_id) as dedup_index
    from int_product
)

, prodcut_with_sk  as (
    select
        row_number() over (order by business_entity_id) as product_sk
        , address_id
        , address_type_id
        , contact_type_id
        , person_id
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m10:34:23.683204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:06b79c5b-a0b2-4ece-a351-5e60f98591bb&page=queryresults
[0m10:34:23.699954 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 10:34:19.226460 => 2023-07-01 10:34:23.699886
[0m10:34:23.700778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26d4ef66-6536-4a0a-9b4e-8e4a78a56b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d442dba0>]}
[0m10:34:23.701279 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (820.0 rows, 89.2 KB processed)[0m in 4.49s]
[0m10:34:23.703543 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m10:34:23.705256 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:34:23.706020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:23.706320 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m10:34:23.706569 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m10:34:23.706810 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m10:34:23.707044 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m10:34:23.707412 [info ] [MainThread]: 
[0m10:34:23.707880 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.12 seconds (7.12s).
[0m10:34:23.708678 [debug] [MainThread]: Command end result
[0m10:34:23.740596 [info ] [MainThread]: 
[0m10:34:23.743012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:34:23.744698 [info ] [MainThread]: 
[0m10:34:23.745456 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:34:23.746356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d4e40550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d4f9de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d4cdcc70>]}
[0m10:34:23.746843 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 10:35:29.146769 | 1f6cd4cb-2d3e-4bf0-ad41-edb9cc785b2d ==============================
[0m10:35:29.146769 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:35:29.148758 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:35:29.149195 [debug] [MainThread]: Tracking: tracking
[0m10:35:29.152092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86528626e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8652861120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86528626b0>]}
[0m10:35:29.222466 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:35:29.401486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:35:29.402686 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.yml
[0m10:35:29.403864 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m10:35:29.439795 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m10:35:29.481188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86523dc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86524447f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8652445510>]}
[0m10:35:29.481857 [debug] [MainThread]: Flushing usage events
[0m10:35:30.556291 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named dim_product. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_product in one of these files:
   - models/gold/dim_address.yml
  models/gold/dim_products.yml


============================== 2023-07-01 10:35:47.253595 | 912c6faa-1f8a-42bb-8a1c-78074f31ff3f ==============================
[0m10:35:47.253595 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:35:47.255590 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:35:47.256046 [debug] [MainThread]: Tracking: tracking
[0m10:35:47.258085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd728175270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7281746a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7281751e0>]}
[0m10:35:47.300228 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:35:47.436230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:35:47.437041 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.yml
[0m10:35:47.437475 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m10:35:47.460624 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m10:35:47.535692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '912c6faa-1f8a-42bb-8a1c-78074f31ff3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7273e40d0>]}
[0m10:35:47.558318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '912c6faa-1f8a-42bb-8a1c-78074f31ff3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd727e34e80>]}
[0m10:35:47.558905 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m10:35:47.559424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912c6faa-1f8a-42bb-8a1c-78074f31ff3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd727e34e50>]}
[0m10:35:47.563383 [info ] [MainThread]: 
[0m10:35:47.566159 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:35:47.567523 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m10:35:47.568028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:48.619985 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m10:35:48.620914 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m10:35:48.621296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:48.622346 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m10:35:48.622808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:48.623585 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m10:35:48.626243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:48.694830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:50.215542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912c6faa-1f8a-42bb-8a1c-78074f31ff3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd727f93a60>]}
[0m10:35:50.217369 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:35:50.217869 [info ] [MainThread]: 
[0m10:35:50.221862 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m10:35:50.222640 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m10:35:50.223973 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m10:35:50.224436 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m10:35:50.228082 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m10:35:50.228662 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 10:35:50.224834 => 2023-07-01 10:35:50.228579
[0m10:35:50.229080 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m10:35:50.289862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:51.409551 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m10:35:51.411571 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            business_entity_id
            , address_type_name 
        order by business_entity_id) as dedup_index
    from int_product
)

, prodcut_with_sk  as (
    select
        row_number() over (order by business_entity_id) as address_sk
        , address_id
        , address_type_id
        , contact_type_id
        , person_id
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m10:35:55.163787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:198d7f95-5692-4615-9570-9d91d7ac7110&page=queryresults
[0m10:35:56.087987 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 10:35:50.229421 => 2023-07-01 10:35:56.087901
[0m10:35:56.089015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912c6faa-1f8a-42bb-8a1c-78074f31ff3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd727436590>]}
[0m10:35:56.089604 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (820.0 rows, 89.2 KB processed)[0m in 5.87s]
[0m10:35:56.094175 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m10:35:56.096631 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:35:56.097524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:56.097929 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m10:35:56.098198 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m10:35:56.098433 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m10:35:56.098657 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m10:35:56.098936 [info ] [MainThread]: 
[0m10:35:56.099455 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m10:35:56.100321 [debug] [MainThread]: Command end result
[0m10:35:56.135019 [info ] [MainThread]: 
[0m10:35:56.136424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:56.137381 [info ] [MainThread]: 
[0m10:35:56.138406 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:35:56.139872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd727ccca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72c24d540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd727e34df0>]}
[0m10:35:56.140702 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 10:46:59.005488 | 705d4b96-df64-420e-8934-6c1f797ad4f2 ==============================
[0m10:46:59.005488 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:46:59.007369 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:46:59.007969 [debug] [MainThread]: Tracking: tracking
[0m10:46:59.009701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c03867370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c03866740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c03867340>]}
[0m10:46:59.060041 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:46:59.191555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:46:59.192610 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.yml
[0m10:46:59.193060 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.sql
[0m10:46:59.216076 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m10:46:59.231561 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m10:46:59.306230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '705d4b96-df64-420e-8934-6c1f797ad4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c02cf80d0>]}
[0m10:46:59.328364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '705d4b96-df64-420e-8934-6c1f797ad4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c03513a60>]}
[0m10:46:59.328909 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m10:46:59.329408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '705d4b96-df64-420e-8934-6c1f797ad4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c0356e500>]}
[0m10:46:59.332908 [info ] [MainThread]: 
[0m10:46:59.335720 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:46:59.336995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m10:46:59.337469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:00.450555 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m10:47:00.451560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m10:47:00.451889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:00.452688 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m10:47:00.453197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:00.453913 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m10:47:00.454803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:00.489293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:01.720642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '705d4b96-df64-420e-8934-6c1f797ad4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c03511c60>]}
[0m10:47:01.721676 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:47:01.722148 [info ] [MainThread]: 
[0m10:47:01.726298 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customer
[0m10:47:01.726827 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customer ...................... [RUN]
[0m10:47:01.728089 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customer'
[0m10:47:01.728543 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customer
[0m10:47:01.733183 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customer"
[0m10:47:01.734473 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (compile): 2023-07-01 10:47:01.728966 => 2023-07-01 10:47:01.734316
[0m10:47:01.735094 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customer
[0m10:47:01.774133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.721692 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customer"
[0m10:47:02.722786 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customer`
    
    
    OPTIONS(
      description="""This table contains information about customers of Adventure Works"""
    )
    as (
      with int_customer as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by customer_id order by customer_id) as dedup_index
    from int_customer
)

, customer_with_sk  as (
    select
        row_number() over (order by customer_id) as customer_sk
        , full_name
		, suffix
		, store_id
		, territory_id 
        , person_type
		, name_styleof employess
		, courtesy_title
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m10:47:03.925796 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: name_styleof; Did you mean name_style? at [34:19]')
[0m10:47:06.179473 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:492b8f24-4fde-4bc8-b5b7-a1583b15df98&page=queryresults
[0m10:47:06.180300 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (execute): 2023-07-01 10:47:01.735501 => 2023-07-01 10:47:06.180171
[0m10:47:06.198350 [debug] [Thread-1 (]: Database Error in model dim_customer (models/gold/dim_customer.sql)
  Unrecognized name: name_styleof; Did you mean name_style? at [34:19]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customer.sql
[0m10:47:06.199248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '705d4b96-df64-420e-8934-6c1f797ad4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c02d1e7d0>]}
[0m10:47:06.200246 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_customer ............. [[31mERROR[0m in 4.47s]
[0m10:47:06.205319 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customer
[0m10:47:06.212374 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:47:06.215410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:06.216912 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m10:47:06.217416 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m10:47:06.217933 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customer' was properly closed.
[0m10:47:06.218806 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m10:47:06.219843 [info ] [MainThread]: 
[0m10:47:06.220636 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.89 seconds (6.89s).
[0m10:47:06.221619 [debug] [MainThread]: Command end result
[0m10:47:06.272059 [info ] [MainThread]: 
[0m10:47:06.273214 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:47:06.274403 [info ] [MainThread]: 
[0m10:47:06.275314 [error] [MainThread]: [33mDatabase Error in model dim_customer (models/gold/dim_customer.sql)[0m
[0m10:47:06.276407 [error] [MainThread]:   Unrecognized name: name_styleof; Did you mean name_style? at [34:19]
[0m10:47:06.277674 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customer.sql
[0m10:47:06.279248 [info ] [MainThread]: 
[0m10:47:06.280609 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:47:06.282120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c0356e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c0356e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c036815a0>]}
[0m10:47:06.282883 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 10:48:06.260178 | 6a7d5c6b-1692-42cc-b264-c19c2a4ece11 ==============================
[0m10:48:06.260178 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:48:06.263988 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:48:06.264724 [debug] [MainThread]: Tracking: tracking
[0m10:48:06.267584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5e092590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5e091c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5e092560>]}
[0m10:48:06.337560 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:48:06.504973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:48:06.505935 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.sql
[0m10:48:06.533009 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m10:48:06.640384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a7d5c6b-1692-42cc-b264-c19c2a4ece11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5d6ee740>]}
[0m10:48:06.679220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a7d5c6b-1692-42cc-b264-c19c2a4ece11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5df4c820>]}
[0m10:48:06.679945 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m10:48:06.680657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a7d5c6b-1692-42cc-b264-c19c2a4ece11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5dd96260>]}
[0m10:48:06.688837 [info ] [MainThread]: 
[0m10:48:06.695052 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:48:06.697837 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m10:48:06.698531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:07.730193 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m10:48:07.730819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:07.732016 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m10:48:07.733661 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m10:48:07.735023 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m10:48:07.738582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:07.775107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:07.776291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:09.274829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a7d5c6b-1692-42cc-b264-c19c2a4ece11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5df4c8b0>]}
[0m10:48:09.275866 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:48:09.276501 [info ] [MainThread]: 
[0m10:48:09.282081 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customer
[0m10:48:09.282881 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customer ...................... [RUN]
[0m10:48:09.284873 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customer'
[0m10:48:09.285624 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customer
[0m10:48:09.290837 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customer"
[0m10:48:09.291974 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (compile): 2023-07-01 10:48:09.286090 => 2023-07-01 10:48:09.291827
[0m10:48:09.292621 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customer
[0m10:48:09.337257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:10.314303 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customer"
[0m10:48:10.315481 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customer`
    
    
    OPTIONS(
      description="""This table contains information about customers of Adventure Works"""
    )
    as (
      with int_customer as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by customer_id order by customer_id) as dedup_index
    from int_customer
)

, customer_with_sk  as (
    select
        row_number() over (order by customer_id) as customer_sk
        , full_name
		, suffix
		, store_id
		, territory_id 
        , person_type
		, name_style
		, courtesy_title
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m10:48:13.766527 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6de4b734-d938-4e36-b1af-7eb87361c99e&page=queryresults
[0m10:48:14.786524 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (execute): 2023-07-01 10:48:09.292961 => 2023-07-01 10:48:14.786447
[0m10:48:14.787491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7d5c6b-1692-42cc-b264-c19c2a4ece11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5d741a80>]}
[0m10:48:14.788114 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customer ................. [[32mCREATE TABLE (9.8k rows, 538.9 KB processed)[0m in 5.50s]
[0m10:48:14.790675 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customer
[0m10:48:14.792555 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:48:14.793354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:14.793683 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m10:48:14.794136 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m10:48:14.794598 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m10:48:14.794908 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customer' was properly closed.
[0m10:48:14.795262 [info ] [MainThread]: 
[0m10:48:14.796016 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m10:48:14.797059 [debug] [MainThread]: Command end result
[0m10:48:14.834070 [info ] [MainThread]: 
[0m10:48:14.835212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:14.836348 [info ] [MainThread]: 
[0m10:48:14.837072 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:48:14.837913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5dde44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5df37e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac623b15d0>]}
[0m10:48:14.838701 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 10:50:18.533882 | a827d6fe-afb5-41cf-b327-973c4c580258 ==============================
[0m10:50:18.533882 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:50:18.535873 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:50:18.536294 [debug] [MainThread]: Tracking: tracking
[0m10:50:18.538078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f45986860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f45984ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f45986bc0>]}
[0m10:50:18.589618 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:50:18.722675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:50:18.723479 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.sql
[0m10:50:18.746319 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m10:50:18.820444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a827d6fe-afb5-41cf-b327-973c4c580258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f44de80d0>]}
[0m10:50:18.843776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a827d6fe-afb5-41cf-b327-973c4c580258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f45840f70>]}
[0m10:50:18.844317 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m10:50:18.844938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a827d6fe-afb5-41cf-b327-973c4c580258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f4568e9b0>]}
[0m10:50:18.851845 [info ] [MainThread]: 
[0m10:50:18.855876 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:50:18.857570 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m10:50:18.858068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:19.831746 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m10:50:19.832649 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m10:50:19.833302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:19.834107 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m10:50:19.834624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:19.835394 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m10:50:19.836199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:19.870330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:21.189094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a827d6fe-afb5-41cf-b327-973c4c580258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f458409d0>]}
[0m10:50:21.190081 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:50:21.190617 [info ] [MainThread]: 
[0m10:50:21.195439 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customer
[0m10:50:21.196670 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customer ...................... [RUN]
[0m10:50:21.199953 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customer'
[0m10:50:21.200753 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customer
[0m10:50:21.206869 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customer"
[0m10:50:21.207877 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (compile): 2023-07-01 10:50:21.201264 => 2023-07-01 10:50:21.207684
[0m10:50:21.208313 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customer
[0m10:50:21.246254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:22.334648 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customer"
[0m10:50:22.337026 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customer`
    
    
    OPTIONS(
      description="""This table contains information about customers of Adventure Works"""
    )
    as (
      with int_customer as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_customer`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by customer_id order by customer_id) as dedup_index
    from int_customer
)

, customer_with_sk  as (
    select
        row_number() over (order by customer_id) as customer_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m10:50:25.757190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5521fced-f852-45d0-a6a8-e16f7fb10358&page=queryresults
[0m10:50:26.507087 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (execute): 2023-07-01 10:50:21.208632 => 2023-07-01 10:50:26.506987
[0m10:50:26.508096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a827d6fe-afb5-41cf-b327-973c4c580258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f44e3a3e0>]}
[0m10:50:26.509188 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customer ................. [[32mCREATE TABLE (9.8k rows, 524.9 KB processed)[0m in 5.31s]
[0m10:50:26.513084 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customer
[0m10:50:26.516199 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:50:26.518323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:26.518849 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m10:50:26.519265 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m10:50:26.519868 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customer' was properly closed.
[0m10:50:26.520347 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m10:50:26.520756 [info ] [MainThread]: 
[0m10:50:26.521711 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m10:50:26.522855 [debug] [MainThread]: Command end result
[0m10:50:26.564592 [info ] [MainThread]: 
[0m10:50:26.565679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:50:26.567432 [info ] [MainThread]: 
[0m10:50:26.568519 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:50:26.569353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f456dc940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f456c6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f45840eb0>]}
[0m10:50:26.569829 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 10:52:41.104886 | 25132526-3338-4efe-baf1-a9c94779299a ==============================
[0m10:52:41.104886 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:52:41.111614 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:52:41.112172 [debug] [MainThread]: Tracking: tracking
[0m10:52:41.124019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29517725c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2951771000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2951772590>]}
[0m10:52:41.184892 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:52:41.433531 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 1 files changed.
[0m10:52:41.434487 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.yml
[0m10:52:41.435030 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.sql
[0m10:52:41.435991 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/intermediate/int_person.sql
[0m10:52:41.437349 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.yml
[0m10:52:41.438713 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/intermediate/int_customer.sql
[0m10:52:41.482505 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m10:52:41.516585 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m10:52:41.529100 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m10:52:41.537210 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m10:52:41.613522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2951317e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2951303820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2951302170>]}
[0m10:52:41.614124 [debug] [MainThread]: Flushing usage events
[0m10:52:42.596564 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named dim_customer. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_customer in one of these files:
   - models/gold/dim_customer.yml
  models/gold/dim_workers.yml


============================== 2023-07-01 10:52:58.080657 | db9c7aef-fa0e-4ac6-8612-de6d8ec977a7 ==============================
[0m10:52:58.080657 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:52:58.082741 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:52:58.083174 [debug] [MainThread]: Tracking: tracking
[0m10:52:58.084987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18bc6766e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18bc675120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18bc6766b0>]}
[0m10:52:58.132706 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:52:58.267361 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 2 files changed.
[0m10:52:58.268152 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.yml
[0m10:52:58.268519 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/intermediate/int_person.sql
[0m10:52:58.268848 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.sql
[0m10:52:58.269327 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.yml
[0m10:52:58.269683 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/intermediate/int_customer.sql
[0m10:52:58.270011 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.sql
[0m10:52:58.293168 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m10:52:58.308661 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m10:52:58.313312 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m10:52:58.318048 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m10:52:58.360346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18bc21b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18bc204670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18bc204610>]}
[0m10:52:58.360836 [debug] [MainThread]: Flushing usage events
[0m10:52:59.369779 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named dim_customer. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_customer in one of these files:
   - models/gold/dim_customer.yml
  models/gold/dim_workers.yml


============================== 2023-07-01 10:53:13.258813 | a530fa54-db4d-409b-871f-8d289fe253e9 ==============================
[0m10:53:13.258813 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:53:13.260890 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:53:13.261319 [debug] [MainThread]: Tracking: tracking
[0m10:53:13.263441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2188c5a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2188c59390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2188c5a470>]}
[0m10:53:13.316676 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:53:13.491070 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 2 files changed.
[0m10:53:13.491779 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/intermediate/int_person.sql
[0m10:53:13.492107 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.sql
[0m10:53:13.492451 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.yml
[0m10:53:13.492896 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.yml
[0m10:53:13.493223 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/intermediate/int_customer.sql
[0m10:53:13.493515 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.sql
[0m10:53:13.516767 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m10:53:13.532667 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m10:53:13.537569 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m10:53:13.542498 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m10:53:13.584092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21887fb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21887e4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21887e4340>]}
[0m10:53:13.584546 [debug] [MainThread]: Flushing usage events
[0m10:53:14.833149 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named dim_customer. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_customer in one of these files:
   - models/gold/dim_customer.yml
  models/gold/dim_workers.yml


============================== 2023-07-01 10:54:07.281800 | 14ffd7ee-2d28-4961-bf17-11a7ae67f4e3 ==============================
[0m10:54:07.281800 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:54:07.284511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:54:07.285067 [debug] [MainThread]: Tracking: tracking
[0m10:54:07.286860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f9887af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f9884e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f98854b0>]}
[0m10:54:07.322955 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:54:07.456077 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m10:54:07.456836 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/intermediate/int_person.sql
[0m10:54:07.457206 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_customer.sql
[0m10:54:07.457569 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/intermediate/int_customer.sql
[0m10:54:07.484592 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m10:54:07.501647 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m10:54:07.505451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f95f4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f9616bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f9622c80>]}
[0m10:54:07.505892 [debug] [MainThread]: Flushing usage events
[0m10:54:08.597079 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.desafioaethaina.int_customer_and_sales' (models/intermediate/int_customer_and_sales.sql) depends on a node named 'int_customer' which was not found


============================== 2023-07-01 10:54:39.362940 | b3246a32-9723-4948-9f17-0a311e312ea3 ==============================
[0m10:54:39.362940 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:54:39.365084 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:54:39.365537 [debug] [MainThread]: Tracking: tracking
[0m10:54:39.367216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9de63c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9de634c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9de63c10>]}
[0m10:54:39.405112 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:54:39.535409 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 1 files changed.
[0m10:54:39.536276 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/intermediate/int_person.sql
[0m10:54:39.536679 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_customer.sql
[0m10:54:39.537072 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/intermediate/int_customer.sql
[0m10:54:39.537460 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_customer_and_sales.sql
[0m10:54:39.560769 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m10:54:39.576259 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customer_and_sales.sql
[0m10:54:39.602554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3246a32-9723-4948-9f17-0a311e312ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9da101c0>]}
[0m10:54:39.625386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3246a32-9723-4948-9f17-0a311e312ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9db24550>]}
[0m10:54:39.625932 [info ] [MainThread]: Found 41 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m10:54:39.626447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3246a32-9723-4948-9f17-0a311e312ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9d987b50>]}
[0m10:54:39.633473 [info ] [MainThread]: 
[0m10:54:39.637623 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:54:39.639543 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m10:54:39.640130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:40.756843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m10:54:40.757265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:40.758235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m10:54:40.759274 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m10:54:40.759584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:40.761924 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m10:54:40.794106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:40.796176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:41.984714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3246a32-9723-4948-9f17-0a311e312ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9d9bc1f0>]}
[0m10:54:41.985672 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:54:41.986186 [info ] [MainThread]: 
[0m10:54:41.990887 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_person
[0m10:54:41.992113 [info ] [Thread-1 (]: 1 of 2 START sql table model dev_thaina_intermediate.int_person ................ [RUN]
[0m10:54:41.993659 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m10:54:41.994242 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_person
[0m10:54:42.008213 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m10:54:42.011356 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 10:54:41.994615 => 2023-07-01 10:54:42.011037
[0m10:54:42.012697 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_person
[0m10:54:42.098071 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_person"
[0m10:54:42.098892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:42.101054 [debug] [Thread-1 (]: On model.desafioaethaina.int_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , group_geo
        , sales_territory_year
        , bussiness_cost_in_territory
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

select * 
from union_customer_country
    );
  
[0m10:54:46.142483 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e7e434fb-bb9f-40d6-b38c-90c23afd95e1&page=queryresults
[0m10:54:46.159492 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (execute): 2023-07-01 10:54:42.013416 => 2023-07-01 10:54:46.159419
[0m10:54:46.160371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3246a32-9723-4948-9f17-0a311e312ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9d9a7ca0>]}
[0m10:54:46.160934 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev_thaina_intermediate.int_person ........... [[32mCREATE TABLE (10.3k rows, 1.2 MB processed)[0m in 4.17s]
[0m10:54:46.163502 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_person
[0m10:54:46.164489 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_customer_and_sales
[0m10:54:46.165387 [info ] [Thread-3 (]: 2 of 2 START sql table model dev_thaina_intermediate.int_customer_and_sales .... [RUN]
[0m10:54:46.166828 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer_and_sales'
[0m10:54:46.167673 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_customer_and_sales
[0m10:54:46.174641 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_customer_and_sales"
[0m10:54:46.176128 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_customer_and_sales (compile): 2023-07-01 10:54:46.168148 => 2023-07-01 10:54:46.175962
[0m10:54:46.177105 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.int_customer_and_sales
[0m10:54:46.185001 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:54:47.100012 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.int_customer_and_sales"
[0m10:54:47.100691 [debug] [Thread-3 (]: On model.desafioaethaina.int_customer_and_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with customer as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_person`	
)

, sales as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, person_type
		, name_style
		, courtesy_title
		, full_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m10:54:52.626785 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:40321956-76ac-49cb-b770-1480922374bc&page=queryresults
[0m10:54:52.634511 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_customer_and_sales (execute): 2023-07-01 10:54:46.178034 => 2023-07-01 10:54:52.634421
[0m10:54:52.635755 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3246a32-9723-4948-9f17-0a311e312ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9d9a77f0>]}
[0m10:54:52.636544 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev_thaina_intermediate.int_customer_and_sales  [[32mCREATE TABLE (44.6k rows, 39.4 MB processed)[0m in 6.47s]
[0m10:54:52.637389 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_customer_and_sales
[0m10:54:52.639687 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:54:52.640912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:52.641483 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m10:54:52.641948 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m10:54:52.642383 [debug] [MainThread]: Connection 'model.desafioaethaina.int_customer_and_sales' was properly closed.
[0m10:54:52.642808 [debug] [MainThread]: Connection 'model.desafioaethaina.int_person' was properly closed.
[0m10:54:52.643248 [info ] [MainThread]: 
[0m10:54:52.643874 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 13.01 seconds (13.01s).
[0m10:54:52.644683 [debug] [MainThread]: Command end result
[0m10:54:52.690591 [info ] [MainThread]: 
[0m10:54:52.692388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:54:52.694070 [info ] [MainThread]: 
[0m10:54:52.695189 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:54:52.696363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9d987b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9d2f7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9d2f6470>]}
[0m10:54:52.697083 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 10:57:24.346012 | c5147f28-16d5-48aa-93b1-6de769d4e18d ==============================
[0m10:57:24.346012 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:57:24.347923 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:57:24.348474 [debug] [MainThread]: Tracking: tracking
[0m10:57:24.350512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3067c926e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3067c91e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3067c926b0>]}
[0m10:57:24.409133 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:57:24.539079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m10:57:24.539946 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.sql
[0m10:57:24.540374 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.yml
[0m10:57:24.540748 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.yml
[0m10:57:24.541095 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.sql
[0m10:57:24.564958 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m10:57:24.580663 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m10:57:24.622477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3067a002b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3067a66710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3067a1dea0>]}
[0m10:57:24.622915 [debug] [MainThread]: Flushing usage events
[0m10:57:25.659286 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named dim_customer. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_customer in one of these files:
   - models/gold/dim_workers.yml
  models/gold/dim_customer.yml


============================== 2023-07-01 10:58:10.600508 | dfab175b-a413-4c93-88eb-35a9b31ad50f ==============================
[0m10:58:10.600508 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:58:10.602603 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_workers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:58:10.603124 [debug] [MainThread]: Tracking: tracking
[0m10:58:10.605262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc0e8a440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc0e8a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc0e8a3b0>]}
[0m10:58:10.653664 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:58:10.796464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m10:58:10.797145 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.sql
[0m10:58:10.797512 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.yml
[0m10:58:10.797809 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.sql
[0m10:58:10.798132 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.yml
[0m10:58:10.822318 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m10:58:10.837774 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m10:58:10.878435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc0bf48b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc0c62260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc0c1a440>]}
[0m10:58:10.878867 [debug] [MainThread]: Flushing usage events
[0m10:58:11.905413 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named dim_customer. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_customer in one of these files:
   - models/gold/dim_customer.yml
  models/gold/dim_workers.yml


============================== 2023-07-01 11:07:01.513964 | 7860a284-022a-4c9d-b580-db0a5c433fc6 ==============================
[0m11:07:01.513964 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:07:01.518740 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:07:01.519678 [debug] [MainThread]: Tracking: tracking
[0m11:07:01.528169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf75576590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf75574fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf755748e0>]}
[0m11:07:01.593023 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:07:01.775307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m11:07:01.776172 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.yml
[0m11:07:01.776585 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.sql
[0m11:07:01.776984 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.yml
[0m11:07:01.777308 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.sql
[0m11:07:01.777791 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m11:07:01.813362 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m11:07:01.843608 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m11:07:01.851912 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m11:07:01.922094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf750e88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf751083d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf751084f0>]}
[0m11:07:01.922687 [debug] [MainThread]: Flushing usage events
[0m11:07:03.332036 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named dim_customer. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_customer in one of these files:
   - models/gold/dim_workers.yml
  models/gold/dim_customer.yml


============================== 2023-07-01 11:07:36.475040 | c4433c57-9350-44d5-b0cd-809119e95b5d ==============================
[0m11:07:36.475040 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:07:36.477854 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:07:36.478307 [debug] [MainThread]: Tracking: tracking
[0m11:07:36.479862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa3893850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa38933d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa3893820>]}
[0m11:07:36.521179 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:07:36.680162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m11:07:36.680982 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.yml
[0m11:07:36.681399 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.sql
[0m11:07:36.681819 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.yml
[0m11:07:36.682151 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.sql
[0m11:07:36.682574 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m11:07:36.716671 [debug] [MainThread]: 1603: static parser failed on gold/dim_customer.sql
[0m11:07:36.724206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa35dd180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa3638580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa3638d60>]}
[0m11:07:36.724808 [debug] [MainThread]: Flushing usage events
[0m11:07:37.770643 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_customer (models/gold/dim_customer.sql)
  ref() takes at most two arguments (0 given)


============================== 2023-07-01 11:08:05.317077 | 013a255d-2978-4719-94ec-40b18edffc39 ==============================
[0m11:08:05.317077 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:08:05.319116 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:08:05.319578 [debug] [MainThread]: Tracking: tracking
[0m11:08:05.321637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81226923e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8122691330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81226923b0>]}
[0m11:08:05.370733 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:08:05.515427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m11:08:05.516217 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.sql
[0m11:08:05.516635 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.yml
[0m11:08:05.516966 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.sql
[0m11:08:05.517311 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.yml
[0m11:08:05.517666 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m11:08:05.541923 [debug] [MainThread]: 1603: static parser failed on gold/dim_workers.sql
[0m11:08:05.545864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81223e1570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8122434970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8122435150>]}
[0m11:08:05.546303 [debug] [MainThread]: Flushing usage events
[0m11:08:06.858757 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_workers (models/gold/dim_workers.sql)
  ref() takes at most two arguments (0 given)


============================== 2023-07-01 11:08:47.223370 | 2a669e8d-ccaf-474a-a103-06525506bbac ==============================
[0m11:08:47.223370 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:08:47.228954 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:08:47.229654 [debug] [MainThread]: Tracking: tracking
[0m11:08:47.232307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2fe8e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2fe8dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2fe8e380>]}
[0m11:08:47.271189 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:08:47.485970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:08:47.487896 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m11:08:47.529693 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m11:08:47.590462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a669e8d-ccaf-474a-a103-06525506bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2fc61450>]}
[0m11:08:47.634841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a669e8d-ccaf-474a-a103-06525506bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2fd44160>]}
[0m11:08:47.635785 [info ] [MainThread]: Found 41 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:08:47.636651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a669e8d-ccaf-474a-a103-06525506bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2fd44100>]}
[0m11:08:47.645396 [info ] [MainThread]: 
[0m11:08:47.650544 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:08:47.652589 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:08:47.653231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:48.749007 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:08:48.750132 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:08:48.750442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:48.751520 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:08:48.752473 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:08:48.752938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:48.753844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:48.788085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:50.356842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a669e8d-ccaf-474a-a103-06525506bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2fbd8790>]}
[0m11:08:50.357967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:08:50.358463 [info ] [MainThread]: 
[0m11:08:50.362004 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_person
[0m11:08:50.362920 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_person ................ [RUN]
[0m11:08:50.364378 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m11:08:50.364822 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_person
[0m11:08:50.375118 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m11:08:50.375767 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 11:08:50.365202 => 2023-07-01 11:08:50.375613
[0m11:08:50.376139 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_person
[0m11:08:50.411485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:51.434974 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_person"
[0m11:08:51.436292 [debug] [Thread-1 (]: On model.desafioaethaina.int_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , group_geo
        , sales_territory_year
        , bussiness_cost_in_territory
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	customer_id as fixed_person_id
	, person_id as fixes_customer_id
	, person_type
	, full_name
	, suffix
	, courtesy_title	
	, email_promotion
	, store_id
	, territory_id 
	, name_territory_description
	, country_region_code
	, group_geo
	, sales_territory_year
	, bussiness_cost_in_territory
 	, country_region_name
	, state_province_id
	, state_province_code
	, name_province_description
	, only_state_province_flag
	, state_province_name
)

select * 
from union_customer_country
    );
  
[0m11:08:51.816181 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "customer_id" at [118:9]')
[0m11:08:52.595789 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:051127b6-98d3-4b4f-9200-e69f42112dd7&page=queryresults
[0m11:08:52.597301 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (execute): 2023-07-01 11:08:50.376387 => 2023-07-01 11:08:52.597117
[0m11:08:52.602176 [debug] [Thread-1 (]: Database Error in model int_person (models/intermediate/int_person.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "customer_id" at [118:9]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_person.sql
[0m11:08:52.603043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a669e8d-ccaf-474a-a103-06525506bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2fea2bf0>]}
[0m11:08:52.603968 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_person ....... [[31mERROR[0m in 2.24s]
[0m11:08:52.608327 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_person
[0m11:08:52.613062 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:08:52.614821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:52.615355 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m11:08:52.615885 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m11:08:52.616366 [debug] [MainThread]: Connection 'model.desafioaethaina.int_person' was properly closed.
[0m11:08:52.616803 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:08:52.617350 [info ] [MainThread]: 
[0m11:08:52.618092 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m11:08:52.618955 [debug] [MainThread]: Command end result
[0m11:08:52.663845 [info ] [MainThread]: 
[0m11:08:52.665400 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:08:52.666456 [info ] [MainThread]: 
[0m11:08:52.667452 [error] [MainThread]: [33mDatabase Error in model int_person (models/intermediate/int_person.sql)[0m
[0m11:08:52.668351 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "customer_id" at [118:9]
[0m11:08:52.669390 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_person.sql
[0m11:08:52.670294 [info ] [MainThread]: 
[0m11:08:52.671859 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:08:52.673074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2fd2ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb341fd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2fd44190>]}
[0m11:08:52.673778 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:09:51.597075 | a5f3d712-484d-4a98-ac7c-c4318db650d7 ==============================
[0m11:09:51.597075 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:09:51.599030 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:09:51.599417 [debug] [MainThread]: Tracking: tracking
[0m11:09:51.601586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa77867370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa77866740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa77867340>]}
[0m11:09:51.647587 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:09:51.779433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:09:51.780283 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m11:09:51.803427 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m11:09:51.839489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5f3d712-484d-4a98-ac7c-c4318db650d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa7745d510>]}
[0m11:09:51.860503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5f3d712-484d-4a98-ac7c-c4318db650d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa77524430>]}
[0m11:09:51.861014 [info ] [MainThread]: Found 41 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:09:51.861484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5f3d712-484d-4a98-ac7c-c4318db650d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa77524400>]}
[0m11:09:51.864988 [info ] [MainThread]: 
[0m11:09:51.867402 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:09:51.869711 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:09:51.870719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:52.854780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:09:52.855900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:09:52.856504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:52.857465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:09:52.857849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:52.859362 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:09:52.950816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:52.904878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:54.293399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5f3d712-484d-4a98-ac7c-c4318db650d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa77866410>]}
[0m11:09:54.294397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:54.294874 [info ] [MainThread]: 
[0m11:09:54.302714 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_person
[0m11:09:54.303251 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_person ................ [RUN]
[0m11:09:54.304390 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m11:09:54.304781 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_person
[0m11:09:54.312196 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m11:09:54.313040 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 11:09:54.304987 => 2023-07-01 11:09:54.312888
[0m11:09:54.313597 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_person
[0m11:09:54.338422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:55.344810 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_person"
[0m11:09:55.346512 [debug] [Thread-1 (]: On model.desafioaethaina.int_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , group_geo
        , sales_territory_year
        , bussiness_cost_in_territory
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixes_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
	from union_customer_state_province
)

select * 
from change_columns_name
    );
  
[0m11:10:01.726123 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b08e6bf1-195d-48a3-9a4c-0620dddc2a04&page=queryresults
[0m11:10:01.767631 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (execute): 2023-07-01 11:09:54.314065 => 2023-07-01 11:10:01.767479
[0m11:10:01.769061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5f3d712-484d-4a98-ac7c-c4318db650d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa76d18c10>]}
[0m11:10:01.770287 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_person ........... [[32mCREATE TABLE (358.7k rows, 1.2 MB processed)[0m in 7.47s]
[0m11:10:01.776821 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_person
[0m11:10:01.779339 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:10:01.780124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:01.780628 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m11:10:01.781112 [debug] [MainThread]: Connection 'model.desafioaethaina.int_person' was properly closed.
[0m11:10:01.781447 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m11:10:01.781724 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m11:10:01.782193 [info ] [MainThread]: 
[0m11:10:01.782733 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m11:10:01.783842 [debug] [MainThread]: Command end result
[0m11:10:01.818296 [info ] [MainThread]: 
[0m11:10:01.819421 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:01.820369 [info ] [MainThread]: 
[0m11:10:01.821233 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:10:01.822140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa76cfd300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa76d1a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa76d1a590>]}
[0m11:10:01.822805 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:13:25.142167 | 1c1c907c-1a01-4a05-8684-30e5fc0e088a ==============================
[0m11:13:25.142167 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:13:25.144126 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:13:25.144585 [debug] [MainThread]: Tracking: tracking
[0m11:13:25.146385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fd366680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fd3650c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fd366650>]}
[0m11:13:25.187062 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:13:25.345585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:13:25.346374 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m11:13:25.369640 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m11:13:25.406307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c1c907c-1a01-4a05-8684-30e5fc0e088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fcf5d7e0>]}
[0m11:13:25.428129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c1c907c-1a01-4a05-8684-30e5fc0e088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fd024700>]}
[0m11:13:25.428634 [info ] [MainThread]: Found 41 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:13:25.429040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1c907c-1a01-4a05-8684-30e5fc0e088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fd0246d0>]}
[0m11:13:25.432677 [info ] [MainThread]: 
[0m11:13:25.435350 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:13:25.437645 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:13:25.438515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:26.456306 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:13:26.457447 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:13:26.457843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:26.458729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:13:26.459678 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:13:26.459992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:26.460790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:26.494783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:27.896936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1c907c-1a01-4a05-8684-30e5fc0e088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fcebca90>]}
[0m11:13:27.897978 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:13:27.898650 [info ] [MainThread]: 
[0m11:13:27.902802 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_person
[0m11:13:27.903366 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_person ................ [RUN]
[0m11:13:27.904746 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m11:13:27.905238 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_person
[0m11:13:27.911929 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m11:13:27.913683 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 11:13:27.905608 => 2023-07-01 11:13:27.913512
[0m11:13:27.914258 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_person
[0m11:13:27.952224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:28.936043 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_person"
[0m11:13:28.937128 [debug] [Thread-1 (]: On model.desafioaethaina.int_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , sales_territory_year
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixed_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, sales_territory_year
		, country_region_name
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
	from union_customer_state_province
	where fixed_person_id is not null

)

select * 
from change_columns_name
    );
  
[0m11:13:30.134420 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: fixed_person_id at [136:15]')
[0m11:13:31.728870 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b85be167-38bb-4773-924a-b270ddc8448c&page=queryresults
[0m11:13:31.729844 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (execute): 2023-07-01 11:13:27.914563 => 2023-07-01 11:13:31.729688
[0m11:13:31.735049 [debug] [Thread-1 (]: Database Error in model int_person (models/intermediate/int_person.sql)
  Unrecognized name: fixed_person_id at [136:15]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_person.sql
[0m11:13:31.735872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c1c907c-1a01-4a05-8684-30e5fc0e088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fc80ace0>]}
[0m11:13:31.737058 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_person ....... [[31mERROR[0m in 3.83s]
[0m11:13:31.741932 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_person
[0m11:13:31.745823 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:13:31.747152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:31.747769 [debug] [MainThread]: Connection 'model.desafioaethaina.int_person' was properly closed.
[0m11:13:31.748335 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m11:13:31.748814 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m11:13:31.749267 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:13:31.749863 [info ] [MainThread]: 
[0m11:13:31.751208 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m11:13:31.752603 [debug] [MainThread]: Command end result
[0m11:13:31.787437 [info ] [MainThread]: 
[0m11:13:31.788317 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:13:31.789097 [info ] [MainThread]: 
[0m11:13:31.789632 [error] [MainThread]: [33mDatabase Error in model int_person (models/intermediate/int_person.sql)[0m
[0m11:13:31.790155 [error] [MainThread]:   Unrecognized name: fixed_person_id at [136:15]
[0m11:13:31.790743 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_person.sql
[0m11:13:31.791239 [info ] [MainThread]: 
[0m11:13:31.791746 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:13:31.792560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290144d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fcea7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fcea6d70>]}
[0m11:13:31.793275 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:13:46.805032 | 127ae730-642f-4c9a-b786-5c982a538527 ==============================
[0m11:13:46.805032 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:13:46.807200 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:13:46.807656 [debug] [MainThread]: Tracking: tracking
[0m11:13:46.809391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c6371360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c6370910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c6371270>]}
[0m11:13:46.848308 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:13:46.986389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:13:46.987152 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m11:13:47.010345 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m11:13:47.047003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '127ae730-642f-4c9a-b786-5c982a538527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c5f61ae0>]}
[0m11:13:47.068222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '127ae730-642f-4c9a-b786-5c982a538527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c6028a00>]}
[0m11:13:47.068725 [info ] [MainThread]: Found 41 models, 4 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:13:47.069211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '127ae730-642f-4c9a-b786-5c982a538527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c60289d0>]}
[0m11:13:47.073042 [info ] [MainThread]: 
[0m11:13:47.075855 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:13:47.077735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:13:47.078863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:48.059237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:13:48.059825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:48.060610 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:13:48.093718 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:13:48.095704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:48.096427 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:13:48.097085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:48.097900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:49.224952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '127ae730-642f-4c9a-b786-5c982a538527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c6372fe0>]}
[0m11:13:49.226119 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:13:49.226832 [info ] [MainThread]: 
[0m11:13:49.232180 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_person
[0m11:13:49.233088 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_person ................ [RUN]
[0m11:13:49.234935 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m11:13:49.235549 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_person
[0m11:13:49.243709 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m11:13:49.244443 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 11:13:49.236016 => 2023-07-01 11:13:49.244313
[0m11:13:49.244901 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_person
[0m11:13:49.277777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:50.296169 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_person"
[0m11:13:50.297948 [debug] [Thread-1 (]: On model.desafioaethaina.int_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , sales_territory_year
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixed_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, sales_territory_year
		, country_region_name
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
	from union_customer_state_province
	where person_id is not null

)

select * 
from change_columns_name
    );
  
[0m11:13:55.694109 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:95421e99-8398-4c70-84c7-86102eb0bff3&page=queryresults
[0m11:13:55.743928 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (execute): 2023-07-01 11:13:49.245147 => 2023-07-01 11:13:55.743697
[0m11:13:55.745393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '127ae730-642f-4c9a-b786-5c982a538527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c5828f40>]}
[0m11:13:55.746321 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_person ........... [[32mCREATE TABLE (337.8k rows, 1.2 MB processed)[0m in 6.51s]
[0m11:13:55.750396 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_person
[0m11:13:55.753642 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:13:55.755926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:55.756798 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m11:13:55.757853 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m11:13:55.758450 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:13:55.759372 [debug] [MainThread]: Connection 'model.desafioaethaina.int_person' was properly closed.
[0m11:13:55.760089 [info ] [MainThread]: 
[0m11:13:55.761014 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m11:13:55.762118 [debug] [MainThread]: Command end result
[0m11:13:55.796393 [info ] [MainThread]: 
[0m11:13:55.797629 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:55.798548 [info ] [MainThread]: 
[0m11:13:55.799437 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:13:55.800558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c5809630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c5ecc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c582ad70>]}
[0m11:13:55.801323 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:17:58.367329 | 07a6ce6f-0992-4024-b9e5-ac397ebdcb10 ==============================
[0m11:17:58.367329 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:17:58.370509 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_person'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:17:58.371055 [debug] [MainThread]: Tracking: tracking
[0m11:17:58.372834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feae66d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feae64820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feae66d40>]}
[0m11:17:58.419152 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:17:58.561796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m11:17:58.562495 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.sql
[0m11:17:58.562901 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.yml
[0m11:17:58.563293 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m11:17:58.586533 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m11:17:58.605038 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m11:17:58.677962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07a6ce6f-0992-4024-b9e5-ac397ebdcb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fea2f5d20>]}
[0m11:17:58.703240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07a6ce6f-0992-4024-b9e5-ac397ebdcb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feab244c0>]}
[0m11:17:58.703771 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:17:58.704212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07a6ce6f-0992-4024-b9e5-ac397ebdcb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feab24490>]}
[0m11:17:58.707588 [info ] [MainThread]: 
[0m11:17:58.710198 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:17:58.711568 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:17:58.712160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:59.583244 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:17:59.583968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:59.584778 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:17:59.586163 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:17:59.587398 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:17:59.620291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:59.622069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:59.622486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:00.784527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07a6ce6f-0992-4024-b9e5-ac397ebdcb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feac80fa0>]}
[0m11:18:00.787177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:00.788041 [info ] [MainThread]: 
[0m11:18:00.798016 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_person
[0m11:18:00.798818 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_person ................ [RUN]
[0m11:18:00.800278 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m11:18:00.800898 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_person
[0m11:18:00.808539 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m11:18:00.809774 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 11:18:00.801299 => 2023-07-01 11:18:00.809618
[0m11:18:00.810418 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_person
[0m11:18:00.851544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:01.973047 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_person"
[0m11:18:01.974557 [debug] [Thread-1 (]: On model.desafioaethaina.int_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      

with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , sales_territory_year
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixed_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, sales_territory_year
		, country_region_name
		, state_province_id
		, state_province_code
		, name_province_description
		, only_state_province_flag
		, state_province_name
	from union_customer_state_province
	where customer_id is not null

)

select * 
from change_columns_name
    );
  
[0m11:18:07.225405 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:15e6400f-8e2f-490f-91b1-dd070e296a9c&page=queryresults
[0m11:18:07.252902 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (execute): 2023-07-01 11:18:00.810851 => 2023-07-01 11:18:07.252786
[0m11:18:07.254313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a6ce6f-0992-4024-b9e5-ac397ebdcb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fea33d5a0>]}
[0m11:18:07.255277 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_person ........... [[32mCREATE TABLE (358.6k rows, 1.2 MB processed)[0m in 6.45s]
[0m11:18:07.260280 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_person
[0m11:18:07.263308 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:18:07.265049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:07.265692 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m11:18:07.266251 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m11:18:07.266783 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:18:07.267278 [debug] [MainThread]: Connection 'model.desafioaethaina.int_person' was properly closed.
[0m11:18:07.267833 [info ] [MainThread]: 
[0m11:18:07.268639 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.56 seconds (8.56s).
[0m11:18:07.269733 [debug] [MainThread]: Command end result
[0m11:18:07.307715 [info ] [MainThread]: 
[0m11:18:07.309045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:07.310555 [info ] [MainThread]: 
[0m11:18:07.311493 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:07.313022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fea9b85e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feab24550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feac825f0>]}
[0m11:18:07.313849 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:26:35.933242 | a0378b01-fd1a-493a-9997-75578a935c76 ==============================
[0m11:26:35.933242 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:26:35.935285 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:26:35.935898 [debug] [MainThread]: Tracking: tracking
[0m11:26:35.937652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35995807c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3599580f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3599582860>]}
[0m11:26:35.979325 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:26:36.151930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:26:36.153105 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.sql
[0m11:26:36.153869 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m11:26:36.191298 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m11:26:36.206957 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m11:26:36.268376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0378b01-fd1a-493a-9997-75578a935c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35989e80d0>]}
[0m11:26:36.291261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0378b01-fd1a-493a-9997-75578a935c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359943cb50>]}
[0m11:26:36.291770 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:26:36.292206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0378b01-fd1a-493a-9997-75578a935c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359943cb80>]}
[0m11:26:36.295372 [info ] [MainThread]: 
[0m11:26:36.297742 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:26:36.299358 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:26:36.299904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:37.159864 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:26:37.160462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:37.161329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:26:37.162351 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:26:37.197258 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:26:37.197632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:37.198311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:37.198737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:38.464230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0378b01-fd1a-493a-9997-75578a935c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359943c850>]}
[0m11:26:38.465169 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:26:38.465713 [info ] [MainThread]: 
[0m11:26:38.470549 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customer
[0m11:26:38.471628 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customer ...................... [RUN]
[0m11:26:38.472968 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customer'
[0m11:26:38.473572 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customer
[0m11:26:38.479841 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customer"
[0m11:26:38.481021 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (compile): 2023-07-01 11:26:38.473932 => 2023-07-01 11:26:38.480870
[0m11:26:38.481643 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customer
[0m11:26:38.517496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:39.599849 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customer"
[0m11:26:39.600946 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customer`
    
    
    OPTIONS(
      description="""This table contains information about customers of Adventure Works"""
    )
    as (
      with int_customer as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_customer
)

, customer_with_sk  as (
    select
        row_number() over (order by fixed_customer_id) as worker_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , territory_id
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m11:26:41.112443 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name territory_id at [13:7]')
[0m11:26:43.160742 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c0a95002-c5c0-4ba1-9206-4ad6d197cf58&page=queryresults
[0m11:26:43.161544 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (execute): 2023-07-01 11:26:38.482092 => 2023-07-01 11:26:43.161414
[0m11:26:43.165572 [debug] [Thread-1 (]: Database Error in model dim_customer (models/gold/dim_customer.sql)
  CREATE TABLE has columns with duplicate name territory_id at [13:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customer.sql
[0m11:26:43.166351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0378b01-fd1a-493a-9997-75578a935c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3598a36bc0>]}
[0m11:26:43.167210 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_customer ............. [[31mERROR[0m in 4.69s]
[0m11:26:43.170661 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customer
[0m11:26:43.172830 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:26:43.174411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:43.175092 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m11:26:43.175874 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customer' was properly closed.
[0m11:26:43.176765 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m11:26:43.177691 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:26:43.178793 [info ] [MainThread]: 
[0m11:26:43.181216 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m11:26:43.183297 [debug] [MainThread]: Command end result
[0m11:26:43.218427 [info ] [MainThread]: 
[0m11:26:43.220492 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:26:43.222435 [info ] [MainThread]: 
[0m11:26:43.223543 [error] [MainThread]: [33mDatabase Error in model dim_customer (models/gold/dim_customer.sql)[0m
[0m11:26:43.224523 [error] [MainThread]:   CREATE TABLE has columns with duplicate name territory_id at [13:7]
[0m11:26:43.225363 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customer.sql
[0m11:26:43.226305 [info ] [MainThread]: 
[0m11:26:43.227475 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:26:43.228764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3598a5dd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3598a5ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3598a5e2c0>]}
[0m11:26:43.229568 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:26:59.529282 | 2eb334e8-b508-4c1f-90ca-87ea9567616d ==============================
[0m11:26:59.529282 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:26:59.533760 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:26:59.534410 [debug] [MainThread]: Tracking: tracking
[0m11:26:59.539310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe946167340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe946166710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe946166ec0>]}
[0m11:26:59.593548 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:26:59.769789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:26:59.770151 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:26:59.785130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eb334e8-b508-4c1f-90ca-87ea9567616d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe945d000d0>]}
[0m11:26:59.814923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eb334e8-b508-4c1f-90ca-87ea9567616d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe945cc12d0>]}
[0m11:26:59.815665 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:26:59.816421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb334e8-b508-4c1f-90ca-87ea9567616d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe945cc14b0>]}
[0m11:26:59.822061 [info ] [MainThread]: 
[0m11:26:59.825550 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:26:59.828659 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:26:59.830267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:00.778535 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:27:00.779172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:00.780048 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:27:00.781158 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:27:00.781827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:00.782730 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:27:00.816647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:00.817309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:02.187352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb334e8-b508-4c1f-90ca-87ea9567616d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe945cc0340>]}
[0m11:27:02.188961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:27:02.189478 [info ] [MainThread]: 
[0m11:27:02.194979 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customer
[0m11:27:02.195823 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customer ...................... [RUN]
[0m11:27:02.197267 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customer'
[0m11:27:02.197906 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customer
[0m11:27:02.205034 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customer"
[0m11:27:02.206106 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (compile): 2023-07-01 11:27:02.198350 => 2023-07-01 11:27:02.205956
[0m11:27:02.206752 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customer
[0m11:27:02.242364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:03.189020 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customer"
[0m11:27:03.190795 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customer`
    
    
    OPTIONS(
      description="""This table contains information about customers of Adventure Works"""
    )
    as (
      with int_customer as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_customer
)

, customer_with_sk  as (
    select
        row_number() over (order by fixed_customer_id) as worker_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , territory_id
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m11:27:04.459612 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name territory_id at [13:7]')
[0m11:27:05.987540 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:39562854-9f35-4a74-aa5a-2729741c6a38&page=queryresults
[0m11:27:05.988509 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (execute): 2023-07-01 11:27:02.207801 => 2023-07-01 11:27:05.988336
[0m11:27:05.993277 [debug] [Thread-1 (]: Database Error in model dim_customer (models/gold/dim_customer.sql)
  CREATE TABLE has columns with duplicate name territory_id at [13:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customer.sql
[0m11:27:05.994125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb334e8-b508-4c1f-90ca-87ea9567616d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe945b808e0>]}
[0m11:27:05.994990 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_customer ............. [[31mERROR[0m in 3.80s]
[0m11:27:05.998983 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customer
[0m11:27:06.003104 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:27:06.004819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:27:06.005600 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m11:27:06.006327 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m11:27:06.007199 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:27:06.008347 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customer' was properly closed.
[0m11:27:06.009995 [info ] [MainThread]: 
[0m11:27:06.011405 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.19 seconds (6.19s).
[0m11:27:06.013372 [debug] [MainThread]: Command end result
[0m11:27:06.047587 [info ] [MainThread]: 
[0m11:27:06.048431 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:27:06.049249 [info ] [MainThread]: 
[0m11:27:06.050458 [error] [MainThread]: [33mDatabase Error in model dim_customer (models/gold/dim_customer.sql)[0m
[0m11:27:06.051599 [error] [MainThread]:   CREATE TABLE has columns with duplicate name territory_id at [13:7]
[0m11:27:06.052725 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customer.sql
[0m11:27:06.053722 [info ] [MainThread]: 
[0m11:27:06.055425 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:27:06.057360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe945f80760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe945b9f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe945b9dc90>]}
[0m11:27:06.058945 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:27:20.810608 | 6f4eca70-6cee-4cfb-9646-41f59472bd6c ==============================
[0m11:27:20.810608 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:27:20.813865 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:27:20.814336 [debug] [MainThread]: Tracking: tracking
[0m11:27:20.816589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f6080820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f6080f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f60807c0>]}
[0m11:27:20.866744 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:27:21.020271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:27:21.021121 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.sql
[0m11:27:21.049754 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m11:27:21.138578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f4eca70-6cee-4cfb-9646-41f59472bd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f54f00d0>]}
[0m11:27:21.166762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f4eca70-6cee-4cfb-9646-41f59472bd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f5f3cee0>]}
[0m11:27:21.167304 [info ] [MainThread]: Found 42 models, 6 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:27:21.167952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4eca70-6cee-4cfb-9646-41f59472bd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f5f3cf10>]}
[0m11:27:21.171838 [info ] [MainThread]: 
[0m11:27:21.174802 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:27:21.177963 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:27:21.179920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:22.283460 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:27:22.284267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:22.285255 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:27:22.286328 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:27:22.320426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:22.322578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:27:22.322962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:22.356958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:23.756809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4eca70-6cee-4cfb-9646-41f59472bd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f5dc7010>]}
[0m11:27:23.758075 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:27:23.758838 [info ] [MainThread]: 
[0m11:27:23.763704 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customer
[0m11:27:23.764276 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customer ...................... [RUN]
[0m11:27:23.765454 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customer'
[0m11:27:23.765825 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customer
[0m11:27:23.771270 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customer"
[0m11:27:23.772568 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (compile): 2023-07-01 11:27:23.766062 => 2023-07-01 11:27:23.772312
[0m11:27:23.773794 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customer
[0m11:27:23.816985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:24.861651 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customer"
[0m11:27:24.863598 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customer`
    
    
    OPTIONS(
      description="""This table contains information about customers of Adventure Works"""
    )
    as (
      with int_customer as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_customer
)

, customer_with_sk  as (
    select
        row_number() over (order by fixed_customer_id) as worker_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m11:27:28.376726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3810faeb-71c3-4569-961e-3290f38a8f57&page=queryresults
[0m11:27:29.245143 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customer (execute): 2023-07-01 11:27:23.774412 => 2023-07-01 11:27:29.245047
[0m11:27:29.246209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f4eca70-6cee-4cfb-9646-41f59472bd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f553a650>]}
[0m11:27:29.246799 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customer ................. [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 5.48s]
[0m11:27:29.249831 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customer
[0m11:27:29.251944 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:27:29.252871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:27:29.253231 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:27:29.253563 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m11:27:29.253858 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customer' was properly closed.
[0m11:27:29.254147 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m11:27:29.254489 [info ] [MainThread]: 
[0m11:27:29.254984 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.08 seconds (8.08s).
[0m11:27:29.255856 [debug] [MainThread]: Command end result
[0m11:27:29.294586 [info ] [MainThread]: 
[0m11:27:29.295539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:27:29.296329 [info ] [MainThread]: 
[0m11:27:29.297364 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:27:29.298812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10fa3255a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f5f3cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f5559ab0>]}
[0m11:27:29.299837 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:33:45.661383 | b825c2ef-8dc8-4277-af3b-39fb8d610f5d ==============================
[0m11:33:45.661383 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:33:45.663259 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_worker'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:33:45.663700 [debug] [MainThread]: Tracking: tracking
[0m11:33:45.665775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba107648e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba10764fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba10764820>]}
[0m11:33:45.704044 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:33:45.841385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m11:33:45.842116 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.sql
[0m11:33:45.842520 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.yml
[0m11:33:45.842942 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.sql
[0m11:33:45.866424 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m11:33:45.881849 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m11:33:45.955399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b825c2ef-8dc8-4277-af3b-39fb8d610f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba0f9f0130>]}
[0m11:33:45.978143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b825c2ef-8dc8-4277-af3b-39fb8d610f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba10424e80>]}
[0m11:33:45.978648 [info ] [MainThread]: Found 43 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:33:45.979033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b825c2ef-8dc8-4277-af3b-39fb8d610f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba10424eb0>]}
[0m11:33:45.980832 [warn ] [MainThread]: The selection criterion 'dim_worker' does not match any nodes
[0m11:33:45.983534 [info ] [MainThread]: 
[0m11:33:45.984326 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:33:45.984928 [debug] [MainThread]: Command end result
[0m11:33:46.007492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba10424a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba10424970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba10424d60>]}
[0m11:33:46.008096 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:33:52.279395 | fc6d60a1-bc9b-4694-88c9-8152e073fabd ==============================
[0m11:33:52.279395 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:33:52.281452 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_workers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:33:52.281892 [debug] [MainThread]: Tracking: tracking
[0m11:33:52.283959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9470892590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9470891c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9470892560>]}
[0m11:33:52.336924 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:33:52.472953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:33:52.473312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:33:52.486656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc6d60a1-bc9b-4694-88c9-8152e073fabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9470638400>]}
[0m11:33:52.512753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc6d60a1-bc9b-4694-88c9-8152e073fabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94705f5a50>]}
[0m11:33:52.513249 [info ] [MainThread]: Found 43 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:33:52.513703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc6d60a1-bc9b-4694-88c9-8152e073fabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94705f5c30>]}
[0m11:33:52.517504 [info ] [MainThread]: 
[0m11:33:52.520425 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:33:52.521965 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:33:52.522600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:53.600252 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:33:53.600934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:53.601807 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:33:53.602845 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:33:53.640516 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:33:53.640912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:53.641666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:53.642174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:55.039823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc6d60a1-bc9b-4694-88c9-8152e073fabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9470892590>]}
[0m11:33:55.041607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:33:55.042292 [info ] [MainThread]: 
[0m11:33:55.047685 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_workers
[0m11:33:55.048455 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_workers ....................... [RUN]
[0m11:33:55.049543 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m11:33:55.049935 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_workers
[0m11:33:55.053849 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m11:33:55.054496 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 11:33:55.050203 => 2023-07-01 11:33:55.054374
[0m11:33:55.055119 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_workers
[0m11:33:55.122016 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m11:33:55.122664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:55.124825 [debug] [Thread-1 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workerss of Adventure Works"""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, person_with_sk  as (
    select
        row_number() over (order by fixed_person_id) as worker_sk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m11:33:56.236834 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "worker_with_sk" must be qualified with a dataset (e.g. dataset.table).')
[0m11:33:57.533634 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:71a6a953-1791-4126-a577-9b3afaa7a75a&page=queryresults
[0m11:33:57.534662 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 11:33:55.055453 => 2023-07-01 11:33:57.534512
[0m11:33:57.538492 [debug] [Thread-1 (]: Database Error in model dim_workers (models/gold/dim_workers.sql)
  Table "worker_with_sk" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.sql
[0m11:33:57.539246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc6d60a1-bc9b-4694-88c9-8152e073fabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94705d70d0>]}
[0m11:33:57.539918 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_workers .............. [[31mERROR[0m in 2.49s]
[0m11:33:57.543475 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_workers
[0m11:33:57.548440 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:33:57.551548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:57.552440 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:33:57.553027 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m11:33:57.553544 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m11:33:57.554061 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m11:33:57.554739 [info ] [MainThread]: 
[0m11:33:57.557070 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m11:33:57.558151 [debug] [MainThread]: Command end result
[0m11:33:57.593677 [info ] [MainThread]: 
[0m11:33:57.594510 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:33:57.595294 [info ] [MainThread]: 
[0m11:33:57.596316 [error] [MainThread]: [33mDatabase Error in model dim_workers (models/gold/dim_workers.sql)[0m
[0m11:33:57.597234 [error] [MainThread]:   Table "worker_with_sk" must be qualified with a dataset (e.g. dataset.table).
[0m11:33:57.598228 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.sql
[0m11:33:57.599146 [info ] [MainThread]: 
[0m11:33:57.600226 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:33:57.601397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9470638610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94705f5a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94705f5840>]}
[0m11:33:57.602088 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:34:06.855345 | 20198aa0-f57e-40fa-a4ec-fe1bf9f663ea ==============================
[0m11:34:06.855345 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:34:06.858894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_workers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:34:06.859504 [debug] [MainThread]: Tracking: tracking
[0m11:34:06.861645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42182530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42181cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42182500>]}
[0m11:34:06.909610 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:34:07.094496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:07.095601 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.yml
[0m11:34:07.121858 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m11:34:07.202413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20198aa0-f57e-40fa-a4ec-fe1bf9f663ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f417dc0d0>]}
[0m11:34:07.226747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20198aa0-f57e-40fa-a4ec-fe1bf9f663ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f41ee5cf0>]}
[0m11:34:07.227535 [info ] [MainThread]: Found 43 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:34:07.228344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20198aa0-f57e-40fa-a4ec-fe1bf9f663ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f41ee5c30>]}
[0m11:34:07.234503 [info ] [MainThread]: 
[0m11:34:07.239239 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:34:07.241171 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:34:07.241717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:08.122414 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:34:08.123039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:08.123829 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:34:08.125089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:34:08.126564 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:34:08.163775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:08.165462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:08.165938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:09.705721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20198aa0-f57e-40fa-a4ec-fe1bf9f663ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f4203caf0>]}
[0m11:34:09.706725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:34:09.707269 [info ] [MainThread]: 
[0m11:34:09.712340 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_workers
[0m11:34:09.712991 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_workers ....................... [RUN]
[0m11:34:09.714311 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m11:34:09.715058 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_workers
[0m11:34:09.722183 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m11:34:09.723233 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 11:34:09.715543 => 2023-07-01 11:34:09.723050
[0m11:34:09.724152 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_workers
[0m11:34:09.830062 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m11:34:09.830977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:09.835665 [debug] [Thread-1 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workerss of Adventure Works"""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, person_with_sk  as (
    select
        row_number() over (order by fixed_person_id) as worker_sk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m11:34:11.392169 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "worker_with_sk" must be qualified with a dataset (e.g. dataset.table).')
[0m11:34:11.943315 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ecba529a-5a1d-4cf1-a19e-239c2fd34606&page=queryresults
[0m11:34:11.944218 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 11:34:09.724640 => 2023-07-01 11:34:11.944081
[0m11:34:11.946985 [debug] [Thread-1 (]: Database Error in model dim_workers (models/gold/dim_workers.sql)
  Table "worker_with_sk" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.sql
[0m11:34:11.947511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20198aa0-f57e-40fa-a4ec-fe1bf9f663ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f4183e590>]}
[0m11:34:11.948174 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_workers .............. [[31mERROR[0m in 2.23s]
[0m11:34:11.950906 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_workers
[0m11:34:11.952667 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:34:11.953411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:11.954020 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m11:34:11.954721 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:34:11.955500 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m11:34:11.956167 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m11:34:11.956908 [info ] [MainThread]: 
[0m11:34:11.958322 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m11:34:11.959313 [debug] [MainThread]: Command end result
[0m11:34:11.997215 [info ] [MainThread]: 
[0m11:34:11.998190 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:34:11.999125 [info ] [MainThread]: 
[0m11:34:12.000096 [error] [MainThread]: [33mDatabase Error in model dim_workers (models/gold/dim_workers.sql)[0m
[0m11:34:12.000935 [error] [MainThread]:   Table "worker_with_sk" must be qualified with a dataset (e.g. dataset.table).
[0m11:34:12.001751 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.sql
[0m11:34:12.002643 [info ] [MainThread]: 
[0m11:34:12.003589 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:34:12.004842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f41ee5600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f41ee5480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f41ee5900>]}
[0m11:34:12.005815 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:34:16.735728 | a6b7f4d2-0ca4-4399-a6d7-e04a3468b61d ==============================
[0m11:34:16.735728 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:34:16.737821 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_workers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:34:16.738273 [debug] [MainThread]: Tracking: tracking
[0m11:34:16.740122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51c476860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51c474ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51c476bc0>]}
[0m11:34:16.782778 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:34:16.978662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:16.980225 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.sql
[0m11:34:17.011297 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m11:34:17.084636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6b7f4d2-0ca4-4399-a6d7-e04a3468b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51b8840d0>]}
[0m11:34:17.106297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6b7f4d2-0ca4-4399-a6d7-e04a3468b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51c1395a0>]}
[0m11:34:17.106788 [info ] [MainThread]: Found 43 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:34:17.107213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6b7f4d2-0ca4-4399-a6d7-e04a3468b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51c1395d0>]}
[0m11:34:17.111408 [info ] [MainThread]: 
[0m11:34:17.113882 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:34:17.116455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:34:17.117292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:17.974014 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:34:17.974653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:17.975573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:34:17.976203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:17.976954 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:34:18.010834 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:34:18.047177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:18.047618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:20.556972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6b7f4d2-0ca4-4399-a6d7-e04a3468b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51c1392a0>]}
[0m11:34:20.557904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:34:20.558393 [info ] [MainThread]: 
[0m11:34:20.562565 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_workers
[0m11:34:20.563143 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_workers ....................... [RUN]
[0m11:34:20.564374 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m11:34:20.564825 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_workers
[0m11:34:20.570392 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m11:34:20.571350 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 11:34:20.565103 => 2023-07-01 11:34:20.571144
[0m11:34:20.572011 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_workers
[0m11:34:20.636601 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m11:34:20.637482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:20.639900 [debug] [Thread-1 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workerss of Adventure Works"""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, worker_with_sk  as (
    select
        row_number() over (order by fixed_person_id) as worker_sk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m11:34:24.812560 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c0039fb9-93a1-4818-9938-95c3d0052a06&page=queryresults
[0m11:34:25.915741 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 11:34:20.572334 => 2023-07-01 11:34:25.915657
[0m11:34:25.916603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6b7f4d2-0ca4-4399-a6d7-e04a3468b61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51b936dd0>]}
[0m11:34:25.917135 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_workers .................. [[32mCREATE TABLE (496.0 rows, 38.2 MB processed)[0m in 5.35s]
[0m11:34:25.919502 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_workers
[0m11:34:25.921490 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:34:25.922797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:25.923342 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:34:25.923818 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m11:34:25.924215 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m11:34:25.924641 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m11:34:25.925121 [info ] [MainThread]: 
[0m11:34:25.925828 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.81 seconds (8.81s).
[0m11:34:25.926764 [debug] [MainThread]: Command end result
[0m11:34:25.963191 [info ] [MainThread]: 
[0m11:34:25.963842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:34:25.964516 [info ] [MainThread]: 
[0m11:34:25.965652 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:34:25.967173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51bfc3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5205495d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51c023f40>]}
[0m11:34:25.967891 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:51:28.218475 | d2e5d83e-a688-42ea-b473-a4e26b4d7b65 ==============================
[0m11:51:28.218475 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:51:28.222426 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_workers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:51:28.222878 [debug] [MainThread]: Tracking: tracking
[0m11:51:28.225124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa027865f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa02785000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa02786590>]}
[0m11:51:28.277583 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:51:28.544736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:28.545494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:28.573694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2e5d83e-a688-42ea-b473-a4e26b4d7b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa02530a00>]}
[0m11:51:28.627778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2e5d83e-a688-42ea-b473-a4e26b4d7b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa024ee020>]}
[0m11:51:28.628607 [info ] [MainThread]: Found 43 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:51:28.629557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e5d83e-a688-42ea-b473-a4e26b4d7b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa024ee0e0>]}
[0m11:51:28.636434 [info ] [MainThread]: 
[0m11:51:28.639799 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:51:28.641681 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:51:28.642394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:29.698187 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:51:29.698841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:29.699666 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:51:29.700844 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:51:29.736843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:29.737718 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:51:29.738287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:29.738952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:31.260936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e5d83e-a688-42ea-b473-a4e26b4d7b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0279d690>]}
[0m11:51:31.262675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:51:31.263363 [info ] [MainThread]: 
[0m11:51:31.269032 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_workers
[0m11:51:31.269675 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_workers ....................... [RUN]
[0m11:51:31.270704 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m11:51:31.271106 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_workers
[0m11:51:31.278173 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m11:51:31.279209 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 11:51:31.271386 => 2023-07-01 11:51:31.279061
[0m11:51:31.280104 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_workers
[0m11:51:31.314566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:32.299107 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m11:51:32.301828 [debug] [Thread-1 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workerss of Adventure Works"""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, worker_with_sk  as (
    select
        row_number() over (order by fixed_person_id) as worker_sk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m11:51:35.603805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:57be9450-b4ed-4dd2-bda8-25c4b49329eb&page=queryresults
[0m11:51:36.506794 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 11:51:31.280579 => 2023-07-01 11:51:36.506712
[0m11:51:36.507877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2e5d83e-a688-42ea-b473-a4e26b4d7b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa02530b50>]}
[0m11:51:36.508591 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_workers .................. [[32mCREATE TABLE (496.0 rows, 38.2 MB processed)[0m in 5.24s]
[0m11:51:36.511287 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_workers
[0m11:51:36.513672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:51:36.514906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:36.515457 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m11:51:36.515947 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m11:51:36.516394 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:51:36.516846 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m11:51:36.517344 [info ] [MainThread]: 
[0m11:51:36.518171 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m11:51:36.519126 [debug] [MainThread]: Command end result
[0m11:51:36.557980 [info ] [MainThread]: 
[0m11:51:36.559075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:36.559900 [info ] [MainThread]: 
[0m11:51:36.560697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:36.561676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa05cce530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa024ecdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa024ede10>]}
[0m11:51:36.562306 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 11:53:48.194442 | ee358e37-d85a-4dd8-a8af-4bcedd6bc266 ==============================
[0m11:53:48.194442 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:53:48.199130 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_workers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:53:48.200395 [debug] [MainThread]: Tracking: tracking
[0m11:53:48.202996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26327a2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2632796c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26327a2c0>]}
[0m11:53:48.252469 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:53:48.415843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:53:48.416772 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.yml
[0m11:53:48.417273 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.yml
[0m11:53:48.441160 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customer.sql
[0m11:53:48.457120 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m11:53:48.553648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee358e37-d85a-4dd8-a8af-4bcedd6bc266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2624e40d0>]}
[0m11:53:48.615979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee358e37-d85a-4dd8-a8af-4bcedd6bc266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb262de1c60>]}
[0m11:53:48.617460 [info ] [MainThread]: Found 43 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m11:53:48.621007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee358e37-d85a-4dd8-a8af-4bcedd6bc266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb262de1db0>]}
[0m11:53:48.628373 [info ] [MainThread]: 
[0m11:53:48.633671 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:53:48.635988 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m11:53:48.636635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:49.663399 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m11:53:49.664928 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m11:53:49.665471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:49.667715 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m11:53:49.717524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:49.668774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:49.716054 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m11:53:49.780827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:51.722363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee358e37-d85a-4dd8-a8af-4bcedd6bc266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb262f38f70>]}
[0m11:53:51.723264 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:53:51.723869 [info ] [MainThread]: 
[0m11:53:51.727581 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_workers
[0m11:53:51.728355 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_workers ....................... [RUN]
[0m11:53:51.729483 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m11:53:51.729873 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_workers
[0m11:53:51.747554 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m11:53:51.748389 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 11:53:51.730125 => 2023-07-01 11:53:51.748263
[0m11:53:51.749013 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_workers
[0m11:53:51.795959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:52.856996 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m11:53:52.858257 [debug] [Thread-1 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workers of Adventure Works"""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, worker_with_sk  as (
    select
        row_number() over (order by fixed_person_id) as worker_sk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m11:53:55.978491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0854311b-825a-4c40-b2c9-89b431af94f0&page=queryresults
[0m11:53:56.868962 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 11:53:51.749486 => 2023-07-01 11:53:56.868886
[0m11:53:56.870053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee358e37-d85a-4dd8-a8af-4bcedd6bc266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2623cbee0>]}
[0m11:53:56.870798 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_workers .................. [[32mCREATE TABLE (496.0 rows, 38.2 MB processed)[0m in 5.14s]
[0m11:53:56.874022 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_workers
[0m11:53:56.875832 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:53:56.876613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:56.876971 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m11:53:56.877233 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m11:53:56.877475 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m11:53:56.877710 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m11:53:56.878019 [info ] [MainThread]: 
[0m11:53:56.878536 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.25 seconds (8.25s).
[0m11:53:56.879285 [debug] [MainThread]: Command end result
[0m11:53:56.909602 [info ] [MainThread]: 
[0m11:53:56.910935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:56.911890 [info ] [MainThread]: 
[0m11:53:56.913455 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:53:56.914809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2665c2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2623cbd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2623c8df0>]}
[0m11:53:56.916046 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:06:04.510266 | bf6c4bed-d723-4409-9fb5-27dd96bd24fd ==============================
[0m13:06:04.510266 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:06:04.513535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:06:04.514175 [debug] [MainThread]: Tracking: tracking
[0m13:06:04.516562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3148e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3148d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3148e3b0>]}
[0m13:06:04.551617 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:06:04.826371 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 2 files changed.
[0m13:06:04.827172 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_cards_type.yml
[0m13:06:04.827556 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_cards_type.sql
[0m13:06:04.827864 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customers.sql
[0m13:06:04.828123 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_customer.sql
[0m13:06:04.828494 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m13:06:04.828854 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m13:06:04.851534 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_cards_type.sql
[0m13:06:04.867291 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m13:06:04.872188 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m13:06:04.877076 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m13:06:04.896969 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customer' in the 'models' section of file 'models/gold/dim_cards_type.yml'
[0m13:06:04.938409 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customer' in the 'models' section of file 'models/gold/dim_customer.yml'
[0m13:06:04.947158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae311f6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae31237e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae31237ca0>]}
[0m13:06:04.947943 [debug] [MainThread]: Flushing usage events
[0m13:06:06.705978 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two tests with the name "not_null_dim_customer_customer_sk" defined on column "customer_sk" in "models.dim_customer".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.desafioaethaina.not_null_dim_customer_customer_sk.69b9dd095b (models/gold/dim_customer.yml)
  - test.desafioaethaina.not_null_dim_customer_customer_sk.69b9dd095b (models/gold/dim_cards_type.yml)


============================== 2023-07-01 13:07:10.846904 | efab36ea-2d47-420d-bfba-dbc931802db5 ==============================
[0m13:07:10.846904 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:07:10.848819 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:07:10.849397 [debug] [MainThread]: Tracking: tracking
[0m13:07:10.851536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f4b84820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f4b84f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f4b847f0>]}
[0m13:07:10.907781 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:07:11.042284 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m13:07:11.043083 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customers.sql
[0m13:07:11.043663 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customer.yml
[0m13:07:11.044168 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.yml
[0m13:07:11.044426 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_customer.sql
[0m13:07:11.044786 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m13:07:11.045133 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m13:07:11.067679 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m13:07:11.083112 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m13:07:11.088143 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m13:07:11.092986 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m13:07:11.113028 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customer' in the 'models' section of file 'models/gold/dim_customer.yml'
[0m13:07:11.121997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f4976500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f4976890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f4976a10>]}
[0m13:07:11.122425 [debug] [MainThread]: Flushing usage events
[0m13:07:12.240597 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.desafioaethaina.int_sales' (models/intermediate/int_sales.sql) depends on a node named 'stg_sales_credit_card' which was not found


============================== 2023-07-01 13:07:53.039953 | 781d5927-f295-4772-9b61-d91a2bae362e ==============================
[0m13:07:53.039953 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:07:53.042238 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:07:53.042932 [debug] [MainThread]: Tracking: tracking
[0m13:07:53.044463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee1788b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee1788a6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee1788bb50>]}
[0m13:07:53.093026 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:07:53.230707 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 0 files added, 2 files changed.
[0m13:07:53.231543 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_workers.sql
[0m13:07:53.231800 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_product.sql
[0m13:07:53.232035 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_address.sql
[0m13:07:53.232289 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_customer.sql
[0m13:07:53.232570 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_dates.sql
[0m13:07:53.233178 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m13:07:53.233623 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m13:07:53.256957 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m13:07:53.272567 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m13:07:53.276321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee1760bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee17629ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee1763a740>]}
[0m13:07:53.276724 [debug] [MainThread]: Flushing usage events
[0m13:07:54.220588 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.desafioaethaina.int_sales' (models/intermediate/int_sales.sql) depends on a node named 'stg_sales_credit_card' which was not found


============================== 2023-07-01 13:08:31.924723 | 1f53beb5-8e7e-471b-81bc-b45d1a8a0c57 ==============================
[0m13:08:31.924723 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:08:31.926678 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:08:31.927635 [debug] [MainThread]: Tracking: tracking
[0m13:08:31.929453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1301782710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1301781e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13017826e0>]}
[0m13:08:31.974290 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:08:32.103495 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 0 files added, 2 files changed.
[0m13:08:32.104318 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_dates.sql
[0m13:08:32.104576 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_product.sql
[0m13:08:32.104838 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_workers.sql
[0m13:08:32.105112 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_address.sql
[0m13:08:32.105364 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_customer.sql
[0m13:08:32.105803 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_person.sql
[0m13:08:32.106185 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m13:08:32.129107 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m13:08:32.144618 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m13:08:32.169692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f53beb5-8e7e-471b-81bc-b45d1a8a0c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1301569420>]}
[0m13:08:32.189536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f53beb5-8e7e-471b-81bc-b45d1a8a0c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f130149a770>]}
[0m13:08:32.190068 [info ] [MainThread]: Found 38 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:08:32.190561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f53beb5-8e7e-471b-81bc-b45d1a8a0c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f130149a3e0>]}
[0m13:08:32.193801 [info ] [MainThread]: 
[0m13:08:32.196284 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:08:32.197619 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:08:32.198093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:33.079127 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:08:33.080179 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:08:33.081187 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:08:33.081588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:33.082178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:33.082616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:34.191170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f53beb5-8e7e-471b-81bc-b45d1a8a0c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1301640d00>]}
[0m13:08:34.192338 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:08:34.192863 [info ] [MainThread]: 
[0m13:08:34.201863 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m13:08:34.202693 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m13:08:34.204578 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m13:08:34.205443 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m13:08:34.217008 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m13:08:34.217986 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 13:08:34.205901 => 2023-07-01 13:08:34.217792
[0m13:08:34.218635 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m13:08:34.243331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:35.205346 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m13:08:35.206530 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, name_reason
		, reason_type
	from order_header 
	left join union_reason
		on union_reason.sales_order_id =  order_header.sales_order_id
	left join credit_card
		on credit_card.credit_card_id = order_header_reason.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
)

select * 
from union_header_detail
    );
  
[0m13:08:36.409213 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: order_header_reason at [57:49]')
[0m13:08:37.892975 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:fa5f87fd-a9ca-4a5b-b255-aaa40988f85c&page=queryresults
[0m13:08:37.895050 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 13:08:34.219027 => 2023-07-01 13:08:37.894660
[0m13:08:37.912959 [debug] [Thread-1 (]: Database Error in model int_sales (models/intermediate/int_sales.sql)
  Unrecognized name: order_header_reason at [57:49]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_sales.sql
[0m13:08:37.913542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f53beb5-8e7e-471b-81bc-b45d1a8a0c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1300e09bd0>]}
[0m13:08:37.914131 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_sales ........ [[31mERROR[0m in 3.71s]
[0m13:08:37.916216 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m13:08:37.917889 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:08:37.918562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:37.918817 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m13:08:37.919057 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:08:37.919307 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:08:37.919647 [info ] [MainThread]: 
[0m13:08:37.920049 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m13:08:37.920695 [debug] [MainThread]: Command end result
[0m13:08:37.952091 [info ] [MainThread]: 
[0m13:08:37.952908 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:08:37.953716 [info ] [MainThread]: 
[0m13:08:37.954461 [error] [MainThread]: [33mDatabase Error in model int_sales (models/intermediate/int_sales.sql)[0m
[0m13:08:37.955235 [error] [MainThread]:   Unrecognized name: order_header_reason at [57:49]
[0m13:08:37.955966 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_sales.sql
[0m13:08:37.956880 [info ] [MainThread]: 
[0m13:08:37.957677 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:08:37.958701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1301640e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1304b470a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f130149a350>]}
[0m13:08:37.959682 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:11:50.993181 | e889f62a-b6fb-4793-b9ce-4d864ada8114 ==============================
[0m13:11:50.993181 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:11:50.995074 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:11:50.995545 [debug] [MainThread]: Tracking: tracking
[0m13:11:50.997688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9270186770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9270185180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9270186740>]}
[0m13:11:51.050049 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:11:51.184864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:11:51.185635 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m13:11:51.211585 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m13:11:51.249287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e889f62a-b6fb-4793-b9ce-4d864ada8114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926ff4c0d0>]}
[0m13:11:51.270115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e889f62a-b6fb-4793-b9ce-4d864ada8114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9270012b30>]}
[0m13:11:51.270613 [info ] [MainThread]: Found 38 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:11:51.271104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e889f62a-b6fb-4793-b9ce-4d864ada8114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926fe9ba30>]}
[0m13:11:51.274605 [info ] [MainThread]: 
[0m13:11:51.278138 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:11:51.279600 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:11:51.280154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:52.202793 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:11:52.203435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:52.204238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:11:52.205278 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:11:52.205612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:52.239536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:53.269200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e889f62a-b6fb-4793-b9ce-4d864ada8114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926fea9a50>]}
[0m13:11:53.270944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:53.271539 [info ] [MainThread]: 
[0m13:11:53.276471 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m13:11:53.277292 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m13:11:53.278799 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m13:11:53.279441 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m13:11:53.288537 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m13:11:53.289949 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 13:11:53.279834 => 2023-07-01 13:11:53.289775
[0m13:11:53.291030 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m13:11:53.329018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:54.288813 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m13:11:54.290492 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, name_reason
		, reason_type
	from order_header 
	left join union_reason
		on union_reason.sales_order_id =  order_header.sales_order_id
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
)

select * 
from union_header_detail
    );
  
[0m13:12:00.593039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e5b96711-7040-4201-938b-7028522d8f8c&page=queryresults
[0m13:12:00.634099 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 13:11:53.292068 => 2023-07-01 13:12:00.633980
[0m13:12:00.635735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e889f62a-b6fb-4793-b9ce-4d864ada8114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926f7e5ff0>]}
[0m13:12:00.637139 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_sales ............ [[32mCREATE TABLE (131.9k rows, 14.3 MB processed)[0m in 7.36s]
[0m13:12:00.641241 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m13:12:00.642919 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:12:00.644585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:00.645385 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:12:00.646416 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m13:12:00.647216 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m13:12:00.648103 [info ] [MainThread]: 
[0m13:12:00.649518 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.37 seconds (9.37s).
[0m13:12:00.651470 [debug] [MainThread]: Command end result
[0m13:12:00.684021 [info ] [MainThread]: 
[0m13:12:00.684953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:00.686143 [info ] [MainThread]: 
[0m13:12:00.687473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:12:00.688952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9270012c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92706fa1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926fea91b0>]}
[0m13:12:00.689808 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:18:22.239051 | fc803929-8859-452d-ab28-d3bdc7e2fce5 ==============================
[0m13:18:22.239051 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:18:22.241236 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_cards_type'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:18:22.241760 [debug] [MainThread]: Tracking: tracking
[0m13:18:22.243520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1494a773d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1494a76c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1494a773a0>]}
[0m13:18:22.276291 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:18:22.411436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 12 files added, 1 files changed.
[0m13:18:22.413455 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address.yml
[0m13:18:22.414283 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.sql
[0m13:18:22.414870 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customers.sql
[0m13:18:22.415694 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_product.sql
[0m13:18:22.416418 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address.sql
[0m13:18:22.417227 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_cards_type.yml
[0m13:18:22.417786 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_cards_type.sql
[0m13:18:22.418214 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customer.yml
[0m13:18:22.418606 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_dates.yml
[0m13:18:22.419007 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.yml
[0m13:18:22.419503 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_workers.yml
[0m13:18:22.419851 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_dates.sql
[0m13:18:22.420251 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m13:18:22.448227 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m13:18:22.468411 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m13:18:22.475804 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_product.sql
[0m13:18:22.481329 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m13:18:22.489767 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_cards_type.sql
[0m13:18:22.495506 [debug] [MainThread]: 1603: static parser failed on gold/dim_dates.sql
[0m13:18:22.540881 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim_dates.sql
[0m13:18:22.544787 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m13:18:22.594331 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customer' in the 'models' section of file 'models/gold/dim_cards_type.yml'
[0m13:18:22.604506 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customer' in the 'models' section of file 'models/gold/dim_customer.yml'
[0m13:18:22.665832 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.not_null_dim_customer_customer_sk.69b9dd095b' (models/gold/dim_customer.yml) depends on a node named 'dim_customer' in package '' which was not found
[0m13:18:22.666681 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.unique_dim_customer_customer_sk.c225f6f263' (models/gold/dim_customer.yml) depends on a node named 'dim_customer' in package '' which was not found
[0m13:18:22.707811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc803929-8859-452d-ab28-d3bdc7e2fce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1494124d00>]}
[0m13:18:22.734291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc803929-8859-452d-ab28-d3bdc7e2fce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1494702980>]}
[0m13:18:22.734917 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:18:22.735472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc803929-8859-452d-ab28-d3bdc7e2fce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149458f7c0>]}
[0m13:18:22.739265 [info ] [MainThread]: 
[0m13:18:22.741825 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:22.743098 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:18:22.743694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:23.784309 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:18:23.785043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:23.785851 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:18:23.786817 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:18:23.823199 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:18:23.824691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:23.825313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:23.825877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:25.140468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc803929-8859-452d-ab28-d3bdc7e2fce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149459eda0>]}
[0m13:18:25.141596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:18:25.142073 [info ] [MainThread]: 
[0m13:18:25.147598 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_cards_type
[0m13:18:25.148162 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_cards_type .................... [RUN]
[0m13:18:25.149202 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m13:18:25.149647 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m13:18:25.156782 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m13:18:25.158167 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 13:18:25.150098 => 2023-07-01 13:18:25.157932
[0m13:18:25.158947 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m13:18:25.211703 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m13:18:25.212269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:25.214228 [debug] [Thread-1 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
	select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by credit_card_id order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        row_number() over (order by credit_card_id) as credit_card_sk
        , card_type
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_sk
    );
  
[0m13:18:26.226402 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "credit_card_sk" must be qualified with a dataset (e.g. dataset.table).')
[0m13:18:26.841358 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4d805343-a502-4f8f-92a0-76643e79728e&page=queryresults
[0m13:18:26.842537 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 13:18:25.159243 => 2023-07-01 13:18:26.842384
[0m13:18:26.848001 [debug] [Thread-1 (]: Database Error in model dim_cards_type (models/gold/dim_cards_type.sql)
  Table "credit_card_sk" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/desafioaethaina/models/gold/dim_cards_type.sql
[0m13:18:26.848828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc803929-8859-452d-ab28-d3bdc7e2fce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f148fd10400>]}
[0m13:18:26.849775 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_cards_type ........... [[31mERROR[0m in 1.70s]
[0m13:18:26.853293 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m13:18:26.855902 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:26.857224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:26.857803 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m13:18:26.858414 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:18:26.858994 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:18:26.859648 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m13:18:26.860673 [info ] [MainThread]: 
[0m13:18:26.862129 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m13:18:26.863526 [debug] [MainThread]: Command end result
[0m13:18:26.899879 [info ] [MainThread]: 
[0m13:18:26.900953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:18:26.902212 [info ] [MainThread]: 
[0m13:18:26.903528 [error] [MainThread]: [33mDatabase Error in model dim_cards_type (models/gold/dim_cards_type.sql)[0m
[0m13:18:26.904481 [error] [MainThread]:   Table "credit_card_sk" must be qualified with a dataset (e.g. dataset.table).
[0m13:18:26.905815 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_cards_type.sql
[0m13:18:26.906969 [info ] [MainThread]: 
[0m13:18:26.908387 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:18:26.909345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14947029b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14945b0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149459fbb0>]}
[0m13:18:26.910132 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:18:51.056277 | 25248096-fc33-4347-92de-8e01a0bd926e ==============================
[0m13:18:51.056277 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:18:51.058519 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_cards_type'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:18:51.059057 [debug] [MainThread]: Tracking: tracking
[0m13:18:51.060645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9659a61300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9659a60940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9659a61360>]}
[0m13:18:51.094654 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:18:51.230831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:51.231738 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_cards_type.sql
[0m13:18:51.254577 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_cards_type.sql
[0m13:18:51.291589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25248096-fc33-4347-92de-8e01a0bd926e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965966be80>]}
[0m13:18:51.313650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25248096-fc33-4347-92de-8e01a0bd926e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9659730100>]}
[0m13:18:51.314162 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:18:51.314655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25248096-fc33-4347-92de-8e01a0bd926e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965cdaf3d0>]}
[0m13:18:51.318146 [info ] [MainThread]: 
[0m13:18:51.320682 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:51.322505 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:18:51.323268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:52.242972 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:18:52.244080 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:18:52.244405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:52.245272 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:18:52.245611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:52.246649 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:18:52.280918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:52.281512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:53.431370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25248096-fc33-4347-92de-8e01a0bd926e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96595bb9d0>]}
[0m13:18:53.432279 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:18:53.432802 [info ] [MainThread]: 
[0m13:18:53.436404 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_cards_type
[0m13:18:53.437202 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_cards_type .................... [RUN]
[0m13:18:53.438176 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m13:18:53.438647 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m13:18:53.444615 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m13:18:53.445571 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 13:18:53.438993 => 2023-07-01 13:18:53.445397
[0m13:18:53.446763 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m13:18:53.522311 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m13:18:53.522914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:53.524916 [debug] [Thread-1 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
	select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by credit_card_id order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        row_number() over (order by credit_card_id) as credit_card_sk
        , card_type
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m13:18:55.512818 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: card_type at [28:11]')
[0m13:18:56.627092 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5413770b-df28-4972-8ffa-5ee751953bd3&page=queryresults
[0m13:18:56.628028 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 13:18:53.447614 => 2023-07-01 13:18:56.627876
[0m13:18:56.632554 [debug] [Thread-1 (]: Database Error in model dim_cards_type (models/gold/dim_cards_type.sql)
  Unrecognized name: card_type at [28:11]
  compiled Code at target/run/desafioaethaina/models/gold/dim_cards_type.sql
[0m13:18:56.633378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25248096-fc33-4347-92de-8e01a0bd926e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9659a7b010>]}
[0m13:18:56.634369 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_cards_type ........... [[31mERROR[0m in 3.20s]
[0m13:18:56.638212 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m13:18:56.640866 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:56.642089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:56.642663 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:18:56.643274 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m13:18:56.643725 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:18:56.644109 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m13:18:56.644573 [info ] [MainThread]: 
[0m13:18:56.645251 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m13:18:56.646216 [debug] [MainThread]: Command end result
[0m13:18:56.675178 [info ] [MainThread]: 
[0m13:18:56.675847 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:18:56.676380 [info ] [MainThread]: 
[0m13:18:56.676950 [error] [MainThread]: [33mDatabase Error in model dim_cards_type (models/gold/dim_cards_type.sql)[0m
[0m13:18:56.677651 [error] [MainThread]:   Unrecognized name: card_type at [28:11]
[0m13:18:56.678306 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_cards_type.sql
[0m13:18:56.678931 [info ] [MainThread]: 
[0m13:18:56.679606 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:18:56.680397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9659713fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9659a79960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9659a78e50>]}
[0m13:18:56.680938 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:20:07.899750 | b91829d6-d36e-4ee8-b629-c02689bed7d5 ==============================
[0m13:20:07.899750 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:20:07.901719 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_cards_type'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:20:07.902151 [debug] [MainThread]: Tracking: tracking
[0m13:20:07.904032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcbe7a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcbe79b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcbe7a5f0>]}
[0m13:20:07.945206 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:20:08.099337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:08.099922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:08.114462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b91829d6-d36e-4ee8-b629-c02689bed7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcba2cbe0>]}
[0m13:20:08.139236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b91829d6-d36e-4ee8-b629-c02689bed7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcb9e62c0>]}
[0m13:20:08.139864 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:20:08.140367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91829d6-d36e-4ee8-b629-c02689bed7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcb9e5ff0>]}
[0m13:20:08.147638 [info ] [MainThread]: 
[0m13:20:08.152019 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:08.154490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:20:08.155767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:09.248578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:20:09.249169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:09.249898 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:20:09.251028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:20:09.251300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:09.253548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:09.254376 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:20:09.326120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:10.469458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91829d6-d36e-4ee8-b629-c02689bed7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcbc93070>]}
[0m13:20:10.471246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:20:10.471910 [info ] [MainThread]: 
[0m13:20:10.476473 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_cards_type
[0m13:20:10.477127 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_cards_type .................... [RUN]
[0m13:20:10.478081 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m13:20:10.478507 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m13:20:10.483775 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m13:20:10.484458 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 13:20:10.478774 => 2023-07-01 13:20:10.484318
[0m13:20:10.485045 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m13:20:10.565579 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m13:20:10.566813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:10.569902 [debug] [Thread-1 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
	select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by credit_card_id order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        row_number() over (order by credit_card_id) as credit_card_sk
        , card_type
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m13:20:12.514653 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: card_type at [28:11]')
[0m13:20:14.099370 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ce1831bf-fd6e-42e7-85e2-6a79d265b927&page=queryresults
[0m13:20:14.100325 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 13:20:10.485326 => 2023-07-01 13:20:14.100176
[0m13:20:14.103710 [debug] [Thread-1 (]: Database Error in model dim_cards_type (models/gold/dim_cards_type.sql)
  Unrecognized name: card_type at [28:11]
  compiled Code at target/run/desafioaethaina/models/gold/dim_cards_type.sql
[0m13:20:14.104304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91829d6-d36e-4ee8-b629-c02689bed7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcb8b1540>]}
[0m13:20:14.104975 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_cards_type ........... [[31mERROR[0m in 3.63s]
[0m13:20:14.107323 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m13:20:14.109414 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:14.110950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:14.111642 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m13:20:14.112118 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:20:14.112522 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m13:20:14.112907 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m13:20:14.113579 [info ] [MainThread]: 
[0m13:20:14.114316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.96 seconds (5.96s).
[0m13:20:14.115547 [debug] [MainThread]: Command end result
[0m13:20:14.146597 [info ] [MainThread]: 
[0m13:20:14.147402 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:20:14.148377 [info ] [MainThread]: 
[0m13:20:14.149599 [error] [MainThread]: [33mDatabase Error in model dim_cards_type (models/gold/dim_cards_type.sql)[0m
[0m13:20:14.150558 [error] [MainThread]:   Unrecognized name: card_type at [28:11]
[0m13:20:14.151612 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_cards_type.sql
[0m13:20:14.152471 [info ] [MainThread]: 
[0m13:20:14.153107 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:20:14.153741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcf1dc5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcb8e7ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcb8e4250>]}
[0m13:20:14.154259 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:23:04.328586 | 037b6ad6-849f-4a2b-b16f-5442e29910c4 ==============================
[0m13:23:04.328586 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:23:04.331810 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:23:04.332633 [debug] [MainThread]: Tracking: tracking
[0m13:23:04.335422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b27a82650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b27a81090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b27a82620>]}
[0m13:23:04.375646 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:23:04.519139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:23:04.519631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:23:04.533456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '037b6ad6-849f-4a2b-b16f-5442e29910c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b27831210>]}
[0m13:23:04.559229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '037b6ad6-849f-4a2b-b16f-5442e29910c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b277ea890>]}
[0m13:23:04.559842 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:23:04.560369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '037b6ad6-849f-4a2b-b16f-5442e29910c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b277ea620>]}
[0m13:23:04.567469 [info ] [MainThread]: 
[0m13:23:04.571041 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:04.572875 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:23:04.573987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:05.579217 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:23:05.580555 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:23:05.581262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:05.582126 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:23:05.582787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:05.586411 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:23:05.622508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:05.659791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:07.247311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '037b6ad6-849f-4a2b-b16f-5442e29910c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b277d7fa0>]}
[0m13:23:07.248409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:07.249176 [info ] [MainThread]: 
[0m13:23:07.256169 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m13:23:07.257054 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m13:23:07.262650 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m13:23:07.263467 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m13:23:07.278096 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m13:23:07.279991 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 13:23:07.263978 => 2023-07-01 13:23:07.279764
[0m13:23:07.281767 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m13:23:07.325460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:08.474115 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m13:23:08.475393 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, name_reason
		, reason_type
	from order_header 
	left join union_reason
		on union_reason.sales_order_id =  order_header.sales_order_id
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
)

select * 
from union_header_detail
    );
  
[0m13:23:14.379170 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7c5500d7-7d7f-431f-af7c-a73dfd9a02a6&page=queryresults
[0m13:23:14.402546 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 13:23:07.282676 => 2023-07-01 13:23:14.402481
[0m13:23:14.403375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '037b6ad6-849f-4a2b-b16f-5442e29910c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b277e92a0>]}
[0m13:23:14.403875 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_sales ............ [[32mCREATE TABLE (131.9k rows, 14.3 MB processed)[0m in 7.15s]
[0m13:23:14.406318 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m13:23:14.408440 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:14.409782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:14.410360 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m13:23:14.410822 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:23:14.411255 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:23:14.411709 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m13:23:14.412203 [info ] [MainThread]: 
[0m13:23:14.412986 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.84 seconds (9.84s).
[0m13:23:14.414317 [debug] [MainThread]: Command end result
[0m13:23:14.437303 [info ] [MainThread]: 
[0m13:23:14.438320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:14.439311 [info ] [MainThread]: 
[0m13:23:14.440207 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:23:14.441372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b27a9aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b276d5330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b277ea590>]}
[0m13:23:14.442277 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:23:32.385249 | 6c187a97-f14f-430e-806d-ac7486579ac8 ==============================
[0m13:23:32.385249 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:23:32.387580 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:23:32.388232 [debug] [MainThread]: Tracking: tracking
[0m13:23:32.390022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0368f673d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0368f66c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0368f673a0>]}
[0m13:23:32.441125 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:23:32.593088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:23:32.593887 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m13:23:32.618453 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m13:23:32.662414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c187a97-f14f-430e-806d-ac7486579ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0368b64250>]}
[0m13:23:32.686972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c187a97-f14f-430e-806d-ac7486579ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0368c1be50>]}
[0m13:23:32.687477 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:23:32.687973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c187a97-f14f-430e-806d-ac7486579ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0368a82770>]}
[0m13:23:32.692592 [info ] [MainThread]: 
[0m13:23:32.696178 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:32.698138 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:23:32.699048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:33.636968 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:23:33.637425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:33.638560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:23:33.638997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:33.640115 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:23:33.677037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:23:33.716682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:33.717288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:34.924670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c187a97-f14f-430e-806d-ac7486579ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0368abffa0>]}
[0m13:23:34.925512 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:34.926080 [info ] [MainThread]: 
[0m13:23:34.929886 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m13:23:34.930418 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m13:23:34.931694 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m13:23:34.932118 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m13:23:34.941214 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m13:23:34.942547 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 13:23:34.932338 => 2023-07-01 13:23:34.942401
[0m13:23:34.943007 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m13:23:34.976093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:35.864672 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m13:23:35.866189 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, name_reason
		, reason_type
		, card_type
	from order_header 
	left join union_reason
		on union_reason.sales_order_id =  order_header.sales_order_id
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
)

select * 
from union_header_detail
    );
  
[0m13:23:42.515459 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e233c405-29c5-48ef-a1d7-cbbaa95a664b&page=queryresults
[0m13:23:42.534971 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 13:23:34.943828 => 2023-07-01 13:23:42.534904
[0m13:23:42.535849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c187a97-f14f-430e-806d-ac7486579ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036821b310>]}
[0m13:23:42.536376 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_sales ............ [[32mCREATE TABLE (131.9k rows, 14.6 MB processed)[0m in 7.60s]
[0m13:23:42.539135 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m13:23:42.541155 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:42.541935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:42.542247 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m13:23:42.542687 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m13:23:42.543137 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m13:23:42.543619 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:23:42.544113 [info ] [MainThread]: 
[0m13:23:42.544999 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.85 seconds (9.85s).
[0m13:23:42.545997 [debug] [MainThread]: Command end result
[0m13:23:42.583540 [info ] [MainThread]: 
[0m13:23:42.584539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:42.585708 [info ] [MainThread]: 
[0m13:23:42.587042 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:23:42.588637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0368c1bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0368a826e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0368a82740>]}
[0m13:23:42.589611 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:24:06.447902 | 72e36b3f-8327-4cef-87bb-f74eeb260d09 ==============================
[0m13:24:06.447902 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:24:06.451883 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_cards_type'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:24:06.452457 [debug] [MainThread]: Tracking: tracking
[0m13:24:06.458589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec862c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec862260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec862770>]}
[0m13:24:06.527344 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:24:06.712730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:06.713516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:06.745281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72e36b3f-8327-4cef-87bb-f74eeb260d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec415150>]}
[0m13:24:06.797566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72e36b3f-8327-4cef-87bb-f74eeb260d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec3ce7d0>]}
[0m13:24:06.798346 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:24:06.799105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72e36b3f-8327-4cef-87bb-f74eeb260d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec3cc820>]}
[0m13:24:06.806024 [info ] [MainThread]: 
[0m13:24:06.810803 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:24:06.813012 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:24:06.813701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:07.750528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:24:07.751427 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:24:07.751765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:07.752948 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:24:07.753502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:07.759810 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:24:07.760537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:07.837546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:09.273534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72e36b3f-8327-4cef-87bb-f74eeb260d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec3cdba0>]}
[0m13:24:09.275016 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:24:09.275894 [info ] [MainThread]: 
[0m13:24:09.285944 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_cards_type
[0m13:24:09.287082 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_cards_type .................... [RUN]
[0m13:24:09.290732 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m13:24:09.292940 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m13:24:09.303166 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m13:24:09.305048 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 13:24:09.293482 => 2023-07-01 13:24:09.304792
[0m13:24:09.306681 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m13:24:09.403688 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m13:24:09.404535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:09.407621 [debug] [Thread-1 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
	select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by credit_card_id order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        row_number() over (order by credit_card_id) as credit_card_sk
        , card_type
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m13:24:13.290003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:436429eb-b8d7-4630-9cb8-d51f70c5831f&page=queryresults
[0m13:24:13.326310 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 13:24:09.307519 => 2023-07-01 13:24:13.326201
[0m13:24:13.327685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e36b3f-8327-4cef-87bb-f74eeb260d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec3cda80>]}
[0m13:24:13.328638 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_cards_type ............... [[32mCREATE TABLE (18.4k rows, 2.5 MB processed)[0m in 4.04s]
[0m13:24:13.338814 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m13:24:13.345786 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:24:13.347679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:13.348228 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:24:13.348875 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m13:24:13.349585 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m13:24:13.350442 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m13:24:13.351683 [info ] [MainThread]: 
[0m13:24:13.352858 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.54 seconds (6.54s).
[0m13:24:13.354824 [debug] [MainThread]: Command end result
[0m13:24:13.388741 [info ] [MainThread]: 
[0m13:24:13.389687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:13.390789 [info ] [MainThread]: 
[0m13:24:13.392343 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:24:13.393464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec2c2d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec2c2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aec2c3910>]}
[0m13:24:13.394224 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:34:19.813621 | 9e724a1f-bc18-4009-a1a5-78c9cef02623 ==============================
[0m13:34:19.813621 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:34:19.815721 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_sales_order_header'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:34:19.816333 [debug] [MainThread]: Tracking: tracking
[0m13:34:19.817985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5959266470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5959265450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5959266440>]}
[0m13:34:19.861562 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:34:20.004033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:34:20.004803 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/silver/purchasing/stg_purchase_order_detail.sql
[0m13:34:20.005198 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/silver/sales/stg_sales_order_header.sql
[0m13:34:20.027875 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_detail.sql
[0m13:34:20.043070 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header.sql
[0m13:34:20.070618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e724a1f-bc18-4009-a1a5-78c9cef02623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5958e649a0>]}
[0m13:34:20.093754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e724a1f-bc18-4009-a1a5-78c9cef02623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5958d87100>]}
[0m13:34:20.094319 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:34:20.094831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e724a1f-bc18-4009-a1a5-78c9cef02623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5958d87f70>]}
[0m13:34:20.099136 [info ] [MainThread]: 
[0m13:34:20.101919 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:34:20.104300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:34:20.105091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:21.015262 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:34:21.015723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:21.016803 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:34:21.017875 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:34:21.019552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:21.051770 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:34:21.053429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:21.056148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:22.405532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e724a1f-bc18-4009-a1a5-78c9cef02623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5958dbb970>]}
[0m13:34:22.406550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:22.407038 [info ] [MainThread]: 
[0m13:34:22.410888 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m13:34:22.411445 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_silver.stg_sales_order_header .......... [RUN]
[0m13:34:22.412641 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m13:34:22.413093 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m13:34:22.419086 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m13:34:22.420138 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-07-01 13:34:22.413332 => 2023-07-01 13:34:22.419972
[0m13:34:22.420962 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m13:34:22.457407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:23.436423 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m13:34:23.438642 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(orderdate as date) as order_date
    , cast(duedate as date) as due_date
    , cast(shipdate as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m13:34:25.254503 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2011-05-31 00:00:00.000'")
[0m13:34:27.025809 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:345676d2-a966-45d0-8519-c313a365187e&page=queryresults
[0m13:34:27.026741 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-07-01 13:34:22.421548 => 2023-07-01 13:34:27.026591
[0m13:34:27.029650 [debug] [Thread-1 (]: Database Error in model stg_sales_order_header (models/silver/sales/stg_sales_order_header.sql)
  Invalid date: '2011-05-31 00:00:00.000'
  compiled Code at target/run/desafioaethaina/models/silver/sales/stg_sales_order_header.sql
[0m13:34:27.030235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e724a1f-bc18-4009-a1a5-78c9cef02623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5958707d90>]}
[0m13:34:27.030825 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_silver.stg_sales_order_header . [[31mERROR[0m in 4.62s]
[0m13:34:27.033185 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m13:34:27.034922 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:34:27.035629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:27.035920 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m13:34:27.036253 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m13:34:27.036509 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:34:27.036744 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_order_header' was properly closed.
[0m13:34:27.037035 [info ] [MainThread]: 
[0m13:34:27.037545 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.94 seconds (6.94s).
[0m13:34:27.038336 [debug] [MainThread]: Command end result
[0m13:34:27.070479 [info ] [MainThread]: 
[0m13:34:27.071242 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:34:27.071941 [info ] [MainThread]: 
[0m13:34:27.072722 [error] [MainThread]: [33mDatabase Error in model stg_sales_order_header (models/silver/sales/stg_sales_order_header.sql)[0m
[0m13:34:27.073577 [error] [MainThread]:   Invalid date: '2011-05-31 00:00:00.000'
[0m13:34:27.074455 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/silver/sales/stg_sales_order_header.sql
[0m13:34:27.075442 [info ] [MainThread]: 
[0m13:34:27.076203 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:34:27.077038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5958d90040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595871be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595871bee0>]}
[0m13:34:27.077568 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:36:54.189092 | a5157933-f33a-484f-a6ac-2aa6b4580c2f ==============================
[0m13:36:54.189092 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:36:54.191147 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_sales_order_header'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:36:54.191631 [debug] [MainThread]: Tracking: tracking
[0m13:36:54.193606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d77c76440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d77c76380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d77c76da0>]}
[0m13:36:54.234185 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:36:54.363605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:36:54.364407 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/silver/sales/stg_sales_order_header.sql
[0m13:36:54.387477 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header.sql
[0m13:36:54.424398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5157933-f33a-484f-a6ac-2aa6b4580c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d77818490>]}
[0m13:36:54.446297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5157933-f33a-484f-a6ac-2aa6b4580c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d779455a0>]}
[0m13:36:54.446810 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:36:54.447236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5157933-f33a-484f-a6ac-2aa6b4580c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d777a4370>]}
[0m13:36:54.450995 [info ] [MainThread]: 
[0m13:36:54.453776 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:36:54.455840 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:36:54.456752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:55.496710 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:36:55.497396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:55.498153 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:36:55.499153 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:36:55.500145 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:36:55.532882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:55.534824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:55.535261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:56.562270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5157933-f33a-484f-a6ac-2aa6b4580c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d777cfc70>]}
[0m13:36:56.563173 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:56.563673 [info ] [MainThread]: 
[0m13:36:56.567305 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m13:36:56.568127 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_silver.stg_sales_order_header .......... [RUN]
[0m13:36:56.569132 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m13:36:56.569610 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m13:36:56.575290 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m13:36:56.576327 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-07-01 13:36:56.570078 => 2023-07-01 13:36:56.576173
[0m13:36:56.576739 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m13:36:56.607727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:57.658737 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m13:36:57.660907 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(cast(orderdate as date) as date) as order_date
    , cast(cast(duedate as date) as date) as due_date
    , cast(cast(shipdate as date) as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m13:36:58.963044 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2011-05-31 00:00:00.000'")
[0m13:37:01.016576 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:eb35a10b-2d3d-4ed9-9c92-e6e95afa926a&page=queryresults
[0m13:37:01.017490 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-07-01 13:36:56.577108 => 2023-07-01 13:37:01.017337
[0m13:37:01.020491 [debug] [Thread-1 (]: Database Error in model stg_sales_order_header (models/silver/sales/stg_sales_order_header.sql)
  Invalid date: '2011-05-31 00:00:00.000'
  compiled Code at target/run/desafioaethaina/models/silver/sales/stg_sales_order_header.sql
[0m13:37:01.021110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5157933-f33a-484f-a6ac-2aa6b4580c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d77115780>]}
[0m13:37:01.021946 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_silver.stg_sales_order_header . [[31mERROR[0m in 4.45s]
[0m13:37:01.024450 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m13:37:01.027312 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:37:01.028481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:01.029045 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m13:37:01.029412 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m13:37:01.029693 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:37:01.030008 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_order_header' was properly closed.
[0m13:37:01.030386 [info ] [MainThread]: 
[0m13:37:01.031001 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m13:37:01.032419 [debug] [MainThread]: Command end result
[0m13:37:01.056694 [info ] [MainThread]: 
[0m13:37:01.057266 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:37:01.057995 [info ] [MainThread]: 
[0m13:37:01.058493 [error] [MainThread]: [33mDatabase Error in model stg_sales_order_header (models/silver/sales/stg_sales_order_header.sql)[0m
[0m13:37:01.059137 [error] [MainThread]:   Invalid date: '2011-05-31 00:00:00.000'
[0m13:37:01.059756 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/silver/sales/stg_sales_order_header.sql
[0m13:37:01.060354 [info ] [MainThread]: 
[0m13:37:01.061042 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:37:01.061891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d7bdad540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d777a42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d777cf610>]}
[0m13:37:01.062404 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:39:41.334313 | 72536d08-0306-454f-98cc-9ac6f5d520cc ==============================
[0m13:39:41.334313 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:39:41.336312 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_sales_order_header'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:39:41.336769 [debug] [MainThread]: Tracking: tracking
[0m13:39:41.338940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd837186e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd837186680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd837186e30>]}
[0m13:39:41.381198 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:39:41.510041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:39:41.510847 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/silver/sales/stg_sales_order_header.sql
[0m13:39:41.534172 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header.sql
[0m13:39:41.571425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72536d08-0306-454f-98cc-9ac6f5d520cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd836f70370>]}
[0m13:39:41.594054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72536d08-0306-454f-98cc-9ac6f5d520cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8370513f0>]}
[0m13:39:41.594569 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:39:41.595067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72536d08-0306-454f-98cc-9ac6f5d520cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd836eb0220>]}
[0m13:39:41.598575 [info ] [MainThread]: 
[0m13:39:41.601072 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:39:41.603535 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:39:41.604240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:42.495643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:39:42.496254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:42.497108 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:39:42.498318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:39:42.498796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:42.531982 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:39:42.533573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:42.534343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:43.751435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72536d08-0306-454f-98cc-9ac6f5d520cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83719f610>]}
[0m13:39:43.752449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:43.752913 [info ] [MainThread]: 
[0m13:39:43.756413 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m13:39:43.757186 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_silver.stg_sales_order_header .......... [RUN]
[0m13:39:43.758137 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m13:39:43.758533 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m13:39:43.764326 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m13:39:43.765441 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-07-01 13:39:43.758777 => 2023-07-01 13:39:43.765293
[0m13:39:43.766494 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m13:39:43.798498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:44.677892 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m13:39:44.678944 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(cast(orderdate as timestamp) as date) as order_date
    , cast(cast(duedate as timestamp) as date) as due_date
    , cast(cast(shipdate as timestamp) as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m13:39:49.302140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d619f67d-6016-4c73-a049-98fe5f3f1e2e&page=queryresults
[0m13:39:49.323793 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-07-01 13:39:43.767238 => 2023-07-01 13:39:49.323666
[0m13:39:49.325379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72536d08-0306-454f-98cc-9ac6f5d520cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd836edbc40>]}
[0m13:39:49.326405 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_silver.stg_sales_order_header ..... [[32mCREATE TABLE (31.5k rows, 7.4 MB processed)[0m in 5.57s]
[0m13:39:49.330822 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m13:39:49.333556 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:39:49.334490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:49.334907 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m13:39:49.335260 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:39:49.335609 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_sales_order_header' was properly closed.
[0m13:39:49.335913 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m13:39:49.336293 [info ] [MainThread]: 
[0m13:39:49.336809 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.74 seconds (7.74s).
[0m13:39:49.337668 [debug] [MainThread]: Command end result
[0m13:39:49.367096 [info ] [MainThread]: 
[0m13:39:49.368283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:49.369765 [info ] [MainThread]: 
[0m13:39:49.371096 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:39:49.372673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8370514b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd837187100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd836eb0190>]}
[0m13:39:49.373602 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:39:55.203786 | e88c4c14-8b66-47aa-a848-26bbff82222f ==============================
[0m13:39:55.203786 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:39:55.206248 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_sales_order_header+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:39:55.206728 [debug] [MainThread]: Tracking: tracking
[0m13:39:55.209057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a0a891e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a0a88670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a0a89180>]}
[0m13:39:55.253174 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:39:55.403565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:55.404003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:55.422233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e88c4c14-8b66-47aa-a848-26bbff82222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a08414b0>]}
[0m13:39:55.456341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e88c4c14-8b66-47aa-a848-26bbff82222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a07feb90>]}
[0m13:39:55.457212 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:39:55.458056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e88c4c14-8b66-47aa-a848-26bbff82222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a07fcb80>]}
[0m13:39:55.465337 [info ] [MainThread]: 
[0m13:39:55.468200 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:39:55.471280 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:39:55.472302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:55.520173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:39:55.522166 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:39:55.523097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:55.526060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:56.985840 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:39:56.986800 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:39:56.987682 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:39:56.987990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:56.988537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:56.990117 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:39:56.991091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:57.070091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:58.389153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e88c4c14-8b66-47aa-a848-26bbff82222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a0a89180>]}
[0m13:39:58.390369 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:58.390981 [info ] [MainThread]: 
[0m13:39:58.395677 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m13:39:58.396246 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_thaina_silver.stg_sales_order_header .......... [RUN]
[0m13:39:58.397342 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m13:39:58.397740 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m13:39:58.404643 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m13:39:58.406086 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-07-01 13:39:58.397968 => 2023-07-01 13:39:58.405901
[0m13:39:58.407106 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m13:39:58.438522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:59.430289 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m13:39:59.431530 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(cast(orderdate as timestamp) as date) as order_date
    , cast(cast(duedate as timestamp) as date) as due_date
    , cast(cast(shipdate as timestamp) as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m13:40:03.064225 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:dda84669-dda3-409e-b344-4e39aa992618&page=queryresults
[0m13:40:03.086281 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-07-01 13:39:58.407857 => 2023-07-01 13:40:03.086213
[0m13:40:03.087154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e88c4c14-8b66-47aa-a848-26bbff82222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a07497b0>]}
[0m13:40:03.087688 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_thaina_silver.stg_sales_order_header ..... [[32mCREATE TABLE (31.5k rows, 7.4 MB processed)[0m in 4.69s]
[0m13:40:03.090950 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m13:40:03.092819 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_sales
[0m13:40:03.093597 [info ] [Thread-3 (]: 2 of 4 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m13:40:03.094995 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m13:40:03.095712 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_sales
[0m13:40:03.105367 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m13:40:03.107107 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 13:40:03.096177 => 2023-07-01 13:40:03.106912
[0m13:40:03.108084 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.int_sales
[0m13:40:03.114448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:40:04.071328 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m13:40:04.072080 [debug] [Thread-3 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, name_reason
		, reason_type
		, card_type
	from order_header 
	left join union_reason
		on union_reason.sales_order_id =  order_header.sales_order_id
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
)

select * 
from union_header_detail
    );
  
[0m13:40:11.075024 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a9167e6b-ad01-476a-8764-c671ab221461&page=queryresults
[0m13:40:11.077829 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 13:40:03.108740 => 2023-07-01 13:40:11.077760
[0m13:40:11.078644 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e88c4c14-8b66-47aa-a848-26bbff82222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a0748fd0>]}
[0m13:40:11.079185 [info ] [Thread-3 (]: 2 of 4 OK created sql table model dev_thaina_intermediate.int_sales ............ [[32mCREATE TABLE (131.9k rows, 13.0 MB processed)[0m in 7.98s]
[0m13:40:11.079937 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_sales
[0m13:40:11.081209 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_cards_type
[0m13:40:11.081732 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_customer_and_sales
[0m13:40:11.082341 [info ] [Thread-2 (]: 3 of 4 START sql table model dev_thaina_gold.dim_cards_type .................... [RUN]
[0m13:40:11.083294 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_thaina_intermediate.int_customer_and_sales .... [RUN]
[0m13:40:11.084835 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m13:40:11.086109 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_customer_and_sales'
[0m13:40:11.087226 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m13:40:11.087993 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_customer_and_sales
[0m13:40:11.092858 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m13:40:11.101765 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 13:40:11.088272 => 2023-07-01 13:40:11.101495
[0m13:40:11.102654 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m13:40:11.100083 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_customer_and_sales"
[0m13:40:11.108582 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:40:11.109565 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (compile): 2023-07-01 13:40:11.093472 => 2023-07-01 13:40:11.109383
[0m13:40:11.110340 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_customer_and_sales
[0m13:40:11.155148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:12.158522 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m13:40:12.161080 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_customer_and_sales"
[0m13:40:12.161573 [debug] [Thread-2 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
	select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by credit_card_id order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        row_number() over (order by credit_card_id) as credit_card_sk
        , card_type
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m13:40:12.163655 [debug] [Thread-1 (]: On model.desafioaethaina.int_customer_and_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_customer_and_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_customer_and_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with customer as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_person`	
)

, sales as (
	select * 
	from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`	
)

, union_header_reason as (
	select 
		sales.*
		, person_id
		, store_id
		, customer.territory_id as c_territory_id
		, person_type
		, name_style
		, courtesy_title
		, full_name
		, suffix
		, email_promotion
		, name_territory_description
		, country_region_code
		, group_geo
		, sales_territory_year
		, bussiness_cost_in_territory
		, country_region_name
	from customer
	left join sales
	on sales.customer_id = customer.customer_id
)

select * from union_header_reason
    );
  
[0m13:40:13.364710 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name customer_id not found inside customer at [43:41]')
[0m13:40:15.176347 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0b9a8f47-9618-43c4-9dfd-fcbee81656d4&page=queryresults
[0m13:40:15.177277 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_customer_and_sales (execute): 2023-07-01 13:40:11.148433 => 2023-07-01 13:40:15.177143
[0m13:40:15.181601 [debug] [Thread-1 (]: Database Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)
  Name customer_id not found inside customer at [43:41]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_customer_and_sales.sql
[0m13:40:15.182643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e88c4c14-8b66-47aa-a848-26bbff82222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a05a1420>]}
[0m13:40:15.183547 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dev_thaina_intermediate.int_customer_and_sales  [[31mERROR[0m in 4.10s]
[0m13:40:15.184415 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_customer_and_sales
[0m13:40:15.581827 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:405c0127-dcf2-433c-86f1-fc9149d18b25&page=queryresults
[0m13:40:15.584127 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 13:40:11.103511 => 2023-07-01 13:40:15.584068
[0m13:40:15.584892 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e88c4c14-8b66-47aa-a848-26bbff82222f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a05ce530>]}
[0m13:40:15.585387 [info ] [Thread-2 (]: 3 of 4 OK created sql table model dev_thaina_gold.dim_cards_type ............... [[32mCREATE TABLE (18.4k rows, 2.5 MB processed)[0m in 4.50s]
[0m13:40:15.586012 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m13:40:15.587850 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:40:15.588572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:15.588871 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:40:15.589140 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m13:40:15.589386 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m13:40:15.589626 [debug] [MainThread]: Connection 'model.desafioaethaina.int_customer_and_sales' was properly closed.
[0m13:40:15.589945 [info ] [MainThread]: 
[0m13:40:15.590344 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 20.12 seconds (20.12s).
[0m13:40:15.591279 [debug] [MainThread]: Command end result
[0m13:40:15.616455 [info ] [MainThread]: 
[0m13:40:15.617006 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:40:15.617548 [info ] [MainThread]: 
[0m13:40:15.618116 [error] [MainThread]: [33mDatabase Error in model int_customer_and_sales (models/intermediate/int_customer_and_sales.sql)[0m
[0m13:40:15.618649 [error] [MainThread]:   Name customer_id not found inside customer at [43:41]
[0m13:40:15.619165 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_customer_and_sales.sql
[0m13:40:15.619872 [info ] [MainThread]: 
[0m13:40:15.620560 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:40:15.621391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a3ff63b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a05ce800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a05ce710>]}
[0m13:40:15.621898 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:43:14.134873 | 00011b2b-4ee1-41e2-a93b-a6889327bef8 ==============================
[0m13:43:14.134873 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:43:14.137373 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_cards_type'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:43:14.139084 [debug] [MainThread]: Tracking: tracking
[0m13:43:14.141728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca739851e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca73984670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca73985180>]}
[0m13:43:14.184080 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:43:14.319929 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m13:43:14.320611 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/intermediate/int_customer_and_sales.sql
[0m13:43:14.321095 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_cards_type.sql
[0m13:43:14.344979 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_cards_type.sql
[0m13:43:14.383718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00011b2b-4ee1-41e2-a93b-a6889327bef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7377be20>]}
[0m13:43:14.406705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00011b2b-4ee1-41e2-a93b-a6889327bef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca73851360>]}
[0m13:43:14.407262 [info ] [MainThread]: Found 43 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:43:14.407832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00011b2b-4ee1-41e2-a93b-a6889327bef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7369f070>]}
[0m13:43:14.414743 [info ] [MainThread]: 
[0m13:43:14.419207 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:43:14.422306 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:43:14.423543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:15.410285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:43:15.411747 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:43:15.412237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:15.414097 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:43:15.414596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:15.416170 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:43:15.498558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:15.420759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:16.839597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00011b2b-4ee1-41e2-a93b-a6889327bef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca736dbd00>]}
[0m13:43:16.840786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:43:16.841345 [info ] [MainThread]: 
[0m13:43:16.845860 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_cards_type
[0m13:43:16.846849 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_cards_type .................... [RUN]
[0m13:43:16.848113 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m13:43:16.848562 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m13:43:16.853849 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m13:43:16.854598 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 13:43:16.848808 => 2023-07-01 13:43:16.854484
[0m13:43:16.854941 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m13:43:16.886676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:17.985199 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m13:43:17.986450 [debug] [Thread-1 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
	select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by credit_card_id, credit_card_approval_code order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        row_number() over (order by credit_card_id, credit_card_approval_code) as credit_card_sk
        , card_type
        , credit_card_approval_code
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m13:43:21.544905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:28fa3f63-27cf-45e2-98e4-18fdff110491&page=queryresults
[0m13:43:21.563869 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 13:43:16.855209 => 2023-07-01 13:43:21.563804
[0m13:43:21.564649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00011b2b-4ee1-41e2-a93b-a6889327bef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca736dbd00>]}
[0m13:43:21.565148 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_cards_type ............... [[32mCREATE TABLE (30.3k rows, 4.3 MB processed)[0m in 4.72s]
[0m13:43:21.569409 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m13:43:21.572132 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:43:21.573169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:21.573588 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:43:21.573989 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:43:21.574317 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m13:43:21.574640 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m13:43:21.575027 [info ] [MainThread]: 
[0m13:43:21.575658 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.16 seconds (7.16s).
[0m13:43:21.576730 [debug] [MainThread]: Command end result
[0m13:43:21.614703 [info ] [MainThread]: 
[0m13:43:21.615234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:21.615873 [info ] [MainThread]: 
[0m13:43:21.616470 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:43:21.617144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca73987640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7369efe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7399ec50>]}
[0m13:43:21.617702 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:47:05.564151 | 7f96e9d8-12f4-447c-be9a-2d36a2cf9631 ==============================
[0m13:47:05.564151 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:47:05.567280 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_reasons'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:47:05.567808 [debug] [MainThread]: Tracking: tracking
[0m13:47:05.570114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adce864d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adce853f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adce864a0>]}
[0m13:47:05.622250 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:47:05.818678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m13:47:05.819591 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_reasons.yml
[0m13:47:05.820050 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_reasons.sql
[0m13:47:05.820587 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m13:47:05.821026 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_cards_type.sql
[0m13:47:05.847967 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_reasons.sql
[0m13:47:05.863625 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m13:47:05.868212 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_cards_type.sql
[0m13:47:05.884294 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_reason' in the 'models' section of file 'models/gold/dim_reasons.yml'
[0m13:47:05.931380 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.not_null_dim_reason_reason_sk.3df7e0353d' (models/gold/dim_reasons.yml) depends on a node named 'dim_reason' in package '' which was not found
[0m13:47:05.932243 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.unique_dim_reason_reason_sk.359f0eaaf1' (models/gold/dim_reasons.yml) depends on a node named 'dim_reason' in package '' which was not found
[0m13:47:05.965504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f96e9d8-12f4-447c-be9a-2d36a2cf9631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adc4ad450>]}
[0m13:47:05.996159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f96e9d8-12f4-447c-be9a-2d36a2cf9631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adcd4cfd0>]}
[0m13:47:05.997441 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:47:05.998369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f96e9d8-12f4-447c-be9a-2d36a2cf9631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adcd4d060>]}
[0m13:47:06.005743 [info ] [MainThread]: 
[0m13:47:06.009680 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:47:06.011727 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:47:06.012507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:07.144573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:47:07.145504 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:47:07.146083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:07.147161 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:47:07.147582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:07.148668 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:47:07.183095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:07.187443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:08.346522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f96e9d8-12f4-447c-be9a-2d36a2cf9631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adcd372b0>]}
[0m13:47:08.347426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:08.347949 [info ] [MainThread]: 
[0m13:47:08.352018 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_reasons
[0m13:47:08.352902 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_reasons ....................... [RUN]
[0m13:47:08.354126 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_reasons'
[0m13:47:08.354821 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_reasons
[0m13:47:08.361688 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_reasons"
[0m13:47:08.362446 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (compile): 2023-07-01 13:47:08.355444 => 2023-07-01 13:47:08.362338
[0m13:47:08.362861 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_reasons
[0m13:47:08.419185 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_reasons"
[0m13:47:08.420133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:08.423426 [debug] [Thread-1 (]: On model.desafioaethaina.dim_reasons: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_reasons"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_reasons`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_reason_id order by sales_reason_id) as dedup_index
    from int_sales
)

, reason_with_sk  as (
    select
        row_number() over (order by sales_reason_id) as reason_sk
        , name_reason
        , reason_type
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m13:47:09.385924 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "prodcut_with_sk" must be qualified with a dataset (e.g. dataset.table).')
[0m13:47:10.612748 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a8ffb5c4-73cb-4217-a3cc-8f37200b94fa&page=queryresults
[0m13:47:10.613648 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (execute): 2023-07-01 13:47:08.363153 => 2023-07-01 13:47:10.613495
[0m13:47:10.616300 [debug] [Thread-1 (]: Database Error in model dim_reasons (models/gold/dim_reasons.sql)
  Table "prodcut_with_sk" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/desafioaethaina/models/gold/dim_reasons.sql
[0m13:47:10.616843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f96e9d8-12f4-447c-be9a-2d36a2cf9631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adc3881c0>]}
[0m13:47:10.617431 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_reasons .............. [[31mERROR[0m in 2.26s]
[0m13:47:10.619847 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_reasons
[0m13:47:10.622367 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:47:10.623876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:10.624598 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:47:10.625131 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m13:47:10.625562 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:47:10.625907 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_reasons' was properly closed.
[0m13:47:10.626314 [info ] [MainThread]: 
[0m13:47:10.627002 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m13:47:10.628177 [debug] [MainThread]: Command end result
[0m13:47:10.649839 [info ] [MainThread]: 
[0m13:47:10.650339 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:47:10.650895 [info ] [MainThread]: 
[0m13:47:10.651627 [error] [MainThread]: [33mDatabase Error in model dim_reasons (models/gold/dim_reasons.sql)[0m
[0m13:47:10.652226 [error] [MainThread]:   Table "prodcut_with_sk" must be qualified with a dataset (e.g. dataset.table).
[0m13:47:10.653077 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_reasons.sql
[0m13:47:10.653904 [info ] [MainThread]: 
[0m13:47:10.654660 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:47:10.655647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adcd4cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adcd4d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adcd37c40>]}
[0m13:47:10.656354 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 13:47:33.119794 | 6cbed8dd-dc72-4986-adf8-0885b649a26c ==============================
[0m13:47:33.119794 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:47:33.122033 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_reasons'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:47:33.122640 [debug] [MainThread]: Tracking: tracking
[0m13:47:33.125111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f192946e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f192946dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f192946e380>]}
[0m13:47:33.165276 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:47:33.299077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:33.299873 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_reasons.sql
[0m13:47:33.322421 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_reasons.sql
[0m13:47:33.360853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cbed8dd-dc72-4986-adf8-0885b649a26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1929063eb0>]}
[0m13:47:33.383115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cbed8dd-dc72-4986-adf8-0885b649a26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19291389a0>]}
[0m13:47:33.383635 [info ] [MainThread]: Found 44 models, 8 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m13:47:33.384140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cbed8dd-dc72-4986-adf8-0885b649a26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1929138a30>]}
[0m13:47:33.387662 [info ] [MainThread]: 
[0m13:47:33.390319 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:47:33.392007 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m13:47:33.393041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:34.378614 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m13:47:34.379205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:34.380054 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m13:47:34.381224 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m13:47:34.381516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:34.415441 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m13:47:34.417667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:34.451461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:35.617283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cbed8dd-dc72-4986-adf8-0885b649a26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1929287580>]}
[0m13:47:35.618457 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:35.619075 [info ] [MainThread]: 
[0m13:47:35.623579 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_reasons
[0m13:47:35.624729 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_reasons ....................... [RUN]
[0m13:47:35.626030 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_reasons'
[0m13:47:35.626636 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_reasons
[0m13:47:35.632335 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_reasons"
[0m13:47:35.633368 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (compile): 2023-07-01 13:47:35.627014 => 2023-07-01 13:47:35.633108
[0m13:47:35.634323 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_reasons
[0m13:47:35.705535 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_reasons"
[0m13:47:35.706253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:35.708432 [debug] [Thread-1 (]: On model.desafioaethaina.dim_reasons: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_reasons"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_reasons`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_reason_id order by sales_reason_id) as dedup_index
    from int_sales
)

, reason_with_sk  as (
    select
        row_number() over (order by sales_reason_id) as reason_sk
        , name_reason
        , reason_type
      from deduplication_data
    where dedup_index = 1
)

select *
from reason_with_sk
    );
  
[0m13:47:39.753972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6090014d-0712-4869-b89a-804c45b049ce&page=queryresults
[0m13:47:39.775742 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (execute): 2023-07-01 13:47:35.634794 => 2023-07-01 13:47:39.775668
[0m13:47:39.776593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbed8dd-dc72-4986-adf8-0885b649a26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19292867d0>]}
[0m13:47:39.777174 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_reasons .................. [[32mCREATE TABLE (8.0 rows, 1.5 MB processed)[0m in 4.15s]
[0m13:47:39.782510 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_reasons
[0m13:47:39.786274 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:47:39.788443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:39.789329 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m13:47:39.790137 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_reasons' was properly closed.
[0m13:47:39.790928 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m13:47:39.791726 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m13:47:39.792647 [info ] [MainThread]: 
[0m13:47:39.794050 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m13:47:39.795780 [debug] [MainThread]: Command end result
[0m13:47:39.842529 [info ] [MainThread]: 
[0m13:47:39.843967 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:39.845461 [info ] [MainThread]: 
[0m13:47:39.846561 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:39.848261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f192d6015d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19292867d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1928fc3df0>]}
[0m13:47:39.849269 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:48:29.514256 | 16faff5f-580a-4371-8467-fbcd9257429f ==============================
[0m15:48:29.514256 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:48:29.516446 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:48:29.517451 [debug] [MainThread]: Tracking: tracking
[0m15:48:29.519103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb706986da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7069863e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7069864a0>]}
[0m15:48:29.555678 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:48:29.687864 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m15:48:29.689458 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_customers.yml
[0m15:48:29.689914 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/fact_sales.yml
[0m15:48:29.690275 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/fact_sales.sql
[0m15:48:29.712859 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m15:48:29.743686 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customer' in the 'models' section of file 'models/gold/dim_customers.yml'
[0m15:48:29.805008 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.not_null_dim_customer_customer_sk.69b9dd095b' (models/gold/dim_customers.yml) depends on a node named 'dim_customer' in package '' which was not found
[0m15:48:29.805752 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.unique_dim_customer_customer_sk.c225f6f263' (models/gold/dim_customers.yml) depends on a node named 'dim_customer' in package '' which was not found
[0m15:48:29.839720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16faff5f-580a-4371-8467-fbcd9257429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e000d0>]}
[0m15:48:29.864849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16faff5f-580a-4371-8467-fbcd9257429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7066da230>]}
[0m15:48:29.865376 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:48:29.865986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16faff5f-580a-4371-8467-fbcd9257429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7066da2c0>]}
[0m15:48:29.869670 [info ] [MainThread]: 
[0m15:48:29.872635 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:48:29.873991 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:48:29.874468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:30.942595 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:48:30.943109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:30.944226 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:48:30.982805 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:48:30.984118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:30.985688 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:48:30.986066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:30.986851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:32.168333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16faff5f-580a-4371-8467-fbcd9257429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7066dba00>]}
[0m15:48:32.169278 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:48:32.170943 [info ] [MainThread]: 
[0m15:48:32.174822 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m15:48:32.175384 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m15:48:32.176428 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m15:48:32.176822 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m15:48:32.183609 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m15:48:32.184250 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 15:48:32.177080 => 2023-07-01 15:48:32.184138
[0m15:48:32.184717 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m15:48:32.251172 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m15:48:32.251895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:32.254052 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (sales_order_id, customer_id, order_date, sales_order_detail_id order by fixed_person_id) as sale_identifier_sk
        , row_number() over (order_date) as order_date
        , row_number() over (customer_id) as customer_fk
        , row_number() over (sales_person_id) as _fk
        , row_number() over (territory_id) as territory_fk
        , row_number() over (bill_to_address_id) as bill_to_address_fk
        , row_number() over (ship_to_address_id) as ship_to_address_fk
        , row_number() over (ship_method_id) as ship_method_fk
        , row_number() over (product_id) as product_fk
        , sub_total
        , tax_amout
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m15:48:33.084558 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword ORDER at [21:43]')
[0m15:48:34.109061 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3b51b764-68a3-4828-97eb-80604695c8c1&page=queryresults
[0m15:48:34.110586 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 15:48:32.184960 => 2023-07-01 15:48:34.110244
[0m15:48:34.113638 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Syntax error: Unexpected keyword ORDER at [21:43]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:48:34.114331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16faff5f-580a-4371-8467-fbcd9257429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e67670>]}
[0m15:48:34.115233 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 1.94s]
[0m15:48:34.118194 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m15:48:34.119988 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:48:34.120786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:34.121127 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m15:48:34.121494 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:48:34.121784 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:48:34.122053 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m15:48:34.122374 [info ] [MainThread]: 
[0m15:48:34.122863 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m15:48:34.123678 [debug] [MainThread]: Command end result
[0m15:48:34.156902 [info ] [MainThread]: 
[0m15:48:34.157837 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:48:34.158837 [info ] [MainThread]: 
[0m15:48:34.159882 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m15:48:34.160812 [error] [MainThread]:   Syntax error: Unexpected keyword ORDER at [21:43]
[0m15:48:34.161686 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:48:34.162338 [info ] [MainThread]: 
[0m15:48:34.163051 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:48:34.163924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70acfd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e01960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e01de0>]}
[0m15:48:34.164518 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:49:32.473111 | b6df29e9-cf67-4c0c-91e8-9e9da5acfea4 ==============================
[0m15:49:32.473111 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:49:32.475210 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:49:32.475738 [debug] [MainThread]: Tracking: tracking
[0m15:49:32.477485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654b8baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654b88e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654b8a530>]}
[0m15:49:32.515263 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:49:32.711157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:49:32.711829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:49:32.736471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6df29e9-cf67-4c0c-91e8-9e9da5acfea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654946800>]}
[0m15:49:32.763354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6df29e9-cf67-4c0c-91e8-9e9da5acfea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654aa7ee0>]}
[0m15:49:32.763909 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:49:32.764448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6df29e9-cf67-4c0c-91e8-9e9da5acfea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654aa7c10>]}
[0m15:49:32.771705 [info ] [MainThread]: 
[0m15:49:32.776037 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:49:32.778400 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:49:32.779394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:33.694344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:49:33.694771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:33.695753 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:49:33.696750 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:49:33.697082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:33.730906 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:49:33.731664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:33.733340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:35.076756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6df29e9-cf67-4c0c-91e8-9e9da5acfea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66548fb4c0>]}
[0m15:49:35.077638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:49:35.078153 [info ] [MainThread]: 
[0m15:49:35.083529 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m15:49:35.084177 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m15:49:35.085458 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m15:49:35.085919 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m15:49:35.093527 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m15:49:35.095090 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 15:49:35.086190 => 2023-07-01 15:49:35.094821
[0m15:49:35.095869 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m15:49:35.207877 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m15:49:35.208713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:35.212248 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)with order

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        row_number() over (order by fixed_customer_id) as customer_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotionwith orderwith order
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m15:49:36.167335 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [17:2]')
[0m15:49:37.195387 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:df6becc4-768a-4189-94c6-7553a85214ae&page=queryresults
[0m15:49:37.196348 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 15:49:35.096251 => 2023-07-01 15:49:37.196204
[0m15:49:37.199307 [debug] [Thread-1 (]: Database Error in model dim_customers (models/gold/dim_customers.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [17:2]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m15:49:37.199900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6df29e9-cf67-4c0c-91e8-9e9da5acfea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66547cbeb0>]}
[0m15:49:37.200523 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_customers ............ [[31mERROR[0m in 2.11s]
[0m15:49:37.202985 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m15:49:37.205181 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:49:37.206301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:37.206794 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:49:37.207329 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m15:49:37.208055 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m15:49:37.208510 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m15:49:37.209142 [info ] [MainThread]: 
[0m15:49:37.210427 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m15:49:37.211392 [debug] [MainThread]: Command end result
[0m15:49:37.242016 [info ] [MainThread]: 
[0m15:49:37.243580 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:49:37.245238 [info ] [MainThread]: 
[0m15:49:37.247192 [error] [MainThread]: [33mDatabase Error in model dim_customers (models/gold/dim_customers.sql)[0m
[0m15:49:37.248808 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [17:2]
[0m15:49:37.249972 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m15:49:37.250798 [info ] [MainThread]: 
[0m15:49:37.251634 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:49:37.253690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66580d33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654ba19f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654ba3eb0>]}
[0m15:49:37.254764 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:50:12.570967 | 0feae34f-0813-406a-9045-02acc4ccac63 ==============================
[0m15:50:12.570967 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:50:12.572973 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:50:12.573414 [debug] [MainThread]: Tracking: tracking
[0m15:50:12.575421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4935d748e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4935d74f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4935d747f0>]}
[0m15:50:12.635889 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:50:12.770359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:12.771731 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m15:50:12.793612 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m15:50:12.831524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0feae34f-0813-406a-9045-02acc4ccac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4935942140>]}
[0m15:50:12.853763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0feae34f-0813-406a-9045-02acc4ccac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4935a36fb0>]}
[0m15:50:12.854256 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:50:12.854743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0feae34f-0813-406a-9045-02acc4ccac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49358db8e0>]}
[0m15:50:12.858925 [info ] [MainThread]: 
[0m15:50:12.862777 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:50:12.864566 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:50:12.865111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:13.862273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:50:13.862919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:13.863819 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:50:13.864822 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:50:13.865142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:13.866031 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:50:13.866510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:13.900745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:15.097837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0feae34f-0813-406a-9045-02acc4ccac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4935a93bb0>]}
[0m15:50:15.098828 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:15.099299 [info ] [MainThread]: 
[0m15:50:15.102749 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m15:50:15.103517 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m15:50:15.104513 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m15:50:15.104925 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m15:50:15.116151 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m15:50:15.117925 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 15:50:15.105153 => 2023-07-01 15:50:15.117756
[0m15:50:15.118689 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m15:50:15.201582 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m15:50:15.202191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:15.204210 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        row_number() over (order by fixed_customer_id) as customer_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotionwith orderwith order
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m15:50:16.106253 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword BY but got "," at [34:9]')
[0m15:50:17.131771 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b8c77b41-fcad-4401-9a3f-08788bb6c1bf&page=queryresults
[0m15:50:17.132821 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 15:50:15.119324 => 2023-07-01 15:50:17.132664
[0m15:50:17.136838 [debug] [Thread-1 (]: Database Error in model dim_customers (models/gold/dim_customers.sql)
  Syntax error: Expected keyword BY but got "," at [34:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m15:50:17.137594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0feae34f-0813-406a-9045-02acc4ccac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4935903760>]}
[0m15:50:17.138453 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_customers ............ [[31mERROR[0m in 2.03s]
[0m15:50:17.141859 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m15:50:17.143817 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:50:17.144606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:17.144913 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m15:50:17.145198 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:50:17.145467 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m15:50:17.145746 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:50:17.146073 [info ] [MainThread]: 
[0m15:50:17.146920 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m15:50:17.148129 [debug] [MainThread]: Command end result
[0m15:50:17.193123 [info ] [MainThread]: 
[0m15:50:17.193987 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:17.194687 [info ] [MainThread]: 
[0m15:50:17.195417 [error] [MainThread]: [33mDatabase Error in model dim_customers (models/gold/dim_customers.sql)[0m
[0m15:50:17.196157 [error] [MainThread]:   Syntax error: Expected keyword BY but got "," at [34:9]
[0m15:50:17.196903 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m15:50:17.198330 [info ] [MainThread]: 
[0m15:50:17.199554 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:50:17.200766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4935a37070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49358dab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49358e97b0>]}
[0m15:50:17.201859 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:51:50.476194 | 63bca776-f619-4c69-a6a5-7026e4f88db4 ==============================
[0m15:51:50.476194 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:51:50.478407 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:51:50.478866 [debug] [MainThread]: Tracking: tracking
[0m15:51:50.480772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4491b7a6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4491b79120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4491b7a6b0>]}
[0m15:51:50.527907 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:51:50.666317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:50.667731 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m15:51:50.689893 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m15:51:50.728258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63bca776-f619-4c69-a6a5-7026e4f88db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449174a140>]}
[0m15:51:50.754486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63bca776-f619-4c69-a6a5-7026e4f88db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4491851de0>]}
[0m15:51:50.754996 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:51:50.755429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63bca776-f619-4c69-a6a5-7026e4f88db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44916df3a0>]}
[0m15:51:50.762176 [info ] [MainThread]: 
[0m15:51:50.766003 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:50.767846 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:51:50.768426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:51.761926 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:51:51.762612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:51.763402 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:51:51.764503 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:51:51.764923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:51.765870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:51:51.798837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:51.800887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:52.891974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63bca776-f619-4c69-a6a5-7026e4f88db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44916f7c10>]}
[0m15:51:52.892932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:52.893521 [info ] [MainThread]: 
[0m15:51:52.898449 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m15:51:52.899541 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m15:51:52.901172 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m15:51:52.901800 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m15:51:52.916312 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m15:51:52.917601 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 15:51:52.902212 => 2023-07-01 15:51:52.917431
[0m15:51:52.918366 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m15:51:53.006003 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m15:51:53.006678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:53.008842 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        row_number() over (order by fixed_customer_id) as customer_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m15:51:57.490101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:331df143-667f-4e41-b610-c89089b9b64c&page=queryresults
[0m15:51:57.507396 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 15:51:52.918778 => 2023-07-01 15:51:57.507298
[0m15:51:57.508271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bca776-f619-4c69-a6a5-7026e4f88db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44916f0fd0>]}
[0m15:51:57.508859 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customers ................ [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 4.61s]
[0m15:51:57.511760 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m15:51:57.513661 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:57.514466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:57.514847 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m15:51:57.515144 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:51:57.515425 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m15:51:57.515679 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:51:57.515999 [info ] [MainThread]: 
[0m15:51:57.516700 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.75 seconds (6.75s).
[0m15:51:57.517584 [debug] [MainThread]: Command end result
[0m15:51:57.552544 [info ] [MainThread]: 
[0m15:51:57.553459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:57.555449 [info ] [MainThread]: 
[0m15:51:57.557252 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:51:57.560268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4491851ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4495c555a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44916de5c0>]}
[0m15:51:57.562207 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:52:03.208929 | c740f4a9-e37b-444d-9f27-5a06a6929dc9 ==============================
[0m15:52:03.208929 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:52:03.211144 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:52:03.211784 [debug] [MainThread]: Tracking: tracking
[0m15:52:03.214004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9e8a6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9e890c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9e8a650>]}
[0m15:52:03.261690 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:52:03.397407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:03.397742 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:03.410744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c740f4a9-e37b-444d-9f27-5a06a6929dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9c4a620>]}
[0m15:52:03.433566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c740f4a9-e37b-444d-9f27-5a06a6929dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9c03ca0>]}
[0m15:52:03.434056 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:52:03.434483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c740f4a9-e37b-444d-9f27-5a06a6929dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9c03a30>]}
[0m15:52:03.438253 [info ] [MainThread]: 
[0m15:52:03.440889 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:52:03.442312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:52:03.442897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:04.460874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:52:04.461818 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:52:04.462390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:04.463176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:52:04.463767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:04.464542 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:52:04.465056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:04.532242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:05.817959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c740f4a9-e37b-444d-9f27-5a06a6929dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9bffd30>]}
[0m15:52:05.819028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:05.819706 [info ] [MainThread]: 
[0m15:52:05.832547 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m15:52:05.833587 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m15:52:05.834950 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m15:52:05.835547 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m15:52:05.842770 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m15:52:05.843821 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 15:52:05.835960 => 2023-07-01 15:52:05.843668
[0m15:52:05.844821 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m15:52:05.922715 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m15:52:05.923834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:05.926766 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (sales_order_id, customer_id, order_date, sales_order_detail_id order by fixed_person_id) as sale_identifier_sk
        , row_number() over (order_date) as order_date
        , row_number() over (customer_id) as customer_fk
        , row_number() over (sales_person_id) as _fk
        , row_number() over (territory_id) as territory_fk
        , row_number() over (bill_to_address_id) as bill_to_address_fk
        , row_number() over (ship_to_address_id) as ship_to_address_fk
        , row_number() over (ship_method_id) as ship_method_fk
        , row_number() over (product_id) as product_fk
        , sub_total
        , tax_amout
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m15:52:06.751492 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword ORDER at [21:43]')
[0m15:52:07.116363 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0d29cb8b-87d8-4c87-a717-04387910ad0a&page=queryresults
[0m15:52:07.117241 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 15:52:05.845292 => 2023-07-01 15:52:07.117100
[0m15:52:07.120200 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Syntax error: Unexpected keyword ORDER at [21:43]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:52:07.120772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c740f4a9-e37b-444d-9f27-5a06a6929dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9c02380>]}
[0m15:52:07.121471 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 1.29s]
[0m15:52:07.123847 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m15:52:07.126113 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:52:07.127298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:07.127808 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:52:07.128249 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m15:52:07.128665 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m15:52:07.129080 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:52:07.129619 [info ] [MainThread]: 
[0m15:52:07.130501 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m15:52:07.131695 [debug] [MainThread]: Command end result
[0m15:52:07.166872 [info ] [MainThread]: 
[0m15:52:07.169450 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:52:07.171726 [info ] [MainThread]: 
[0m15:52:07.173615 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m15:52:07.175844 [error] [MainThread]:   Syntax error: Unexpected keyword ORDER at [21:43]
[0m15:52:07.177423 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:52:07.178899 [info ] [MainThread]: 
[0m15:52:07.180774 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:52:07.182619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ce1fd600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9c03c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9c03130>]}
[0m15:52:07.184084 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:53:18.452067 | 2aea0dcc-860a-4a9c-bd91-d62d9b35af9f ==============================
[0m15:53:18.452067 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:53:18.454022 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:53:18.454398 [debug] [MainThread]: Tracking: tracking
[0m15:53:18.456551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595277a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595277aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595277a620>]}
[0m15:53:18.507864 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:53:18.639893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:53:18.641214 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_reasons.yml
[0m15:53:18.641680 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m15:53:18.663756 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m15:53:18.770875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aea0dcc-860a-4a9c-bd91-d62d9b35af9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5951c0c0d0>]}
[0m15:53:18.795920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2aea0dcc-860a-4a9c-bd91-d62d9b35af9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5952451600>]}
[0m15:53:18.796407 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:53:18.796828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aea0dcc-860a-4a9c-bd91-d62d9b35af9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59522deda0>]}
[0m15:53:18.800514 [info ] [MainThread]: 
[0m15:53:18.802865 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:53:18.804470 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:53:18.805228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:19.730403 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:53:19.731040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:19.732039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:53:19.733285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:53:19.771563 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:53:19.773292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:19.774011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:19.774520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:20.963336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aea0dcc-860a-4a9c-bd91-d62d9b35af9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5952451090>]}
[0m15:53:20.964258 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:53:20.964718 [info ] [MainThread]: 
[0m15:53:20.968884 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m15:53:20.969390 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m15:53:20.970366 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m15:53:20.970750 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m15:53:20.974482 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m15:53:20.975134 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 15:53:20.970973 => 2023-07-01 15:53:20.975014
[0m15:53:20.975778 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m15:53:21.056163 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m15:53:21.056847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:21.058929 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (sales_order_id, customer_id, order_date, sales_order_detail_id order by fixed_person_id) as sale_identifier_sk
        , row_number() over (order_date) as order_date
        , row_number() over (customer_id) as customer_fk
        , row_number() over (sales_person_id) as _fk
        , row_number() over (territory_id) as territory_fk
        , row_number() over (bill_to_address_id) as bill_to_address_fk
        , row_number() over (ship_to_address_id) as ship_to_address_fk
        , row_number() over (ship_method_id) as ship_method_fk
        , row_number() over (product_id) as product_fk
        , sub_total
        , tax_amout
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m15:53:22.076709 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword BY at [21:81]')
[0m15:53:23.220545 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cdaaba39-7d7a-4756-b458-432cb6975e3e&page=queryresults
[0m15:53:23.221356 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 15:53:20.976248 => 2023-07-01 15:53:23.221229
[0m15:53:23.224243 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Syntax error: Expected ")" but got keyword BY at [21:81]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:53:23.224980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aea0dcc-860a-4a9c-bd91-d62d9b35af9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5951c79fc0>]}
[0m15:53:23.225764 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 2.25s]
[0m15:53:23.229240 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m15:53:23.231132 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:53:23.231868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:23.232152 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:53:23.232392 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m15:53:23.232624 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m15:53:23.232855 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:53:23.233158 [info ] [MainThread]: 
[0m15:53:23.233999 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m15:53:23.235278 [debug] [MainThread]: Command end result
[0m15:53:23.283824 [info ] [MainThread]: 
[0m15:53:23.284747 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:53:23.285639 [info ] [MainThread]: 
[0m15:53:23.286722 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m15:53:23.287595 [error] [MainThread]:   Syntax error: Expected ")" but got keyword BY at [21:81]
[0m15:53:23.288474 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:53:23.289600 [info ] [MainThread]: 
[0m15:53:23.290428 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:53:23.291911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5952451030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5952451060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59522dec50>]}
[0m15:53:23.293239 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:54:32.054995 | 4ac02de8-2445-4ac9-aee1-cdcb68452604 ==============================
[0m15:54:32.054995 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:54:32.057346 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:54:32.057965 [debug] [MainThread]: Tracking: tracking
[0m15:54:32.060406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b65457370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b65456740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b65457340>]}
[0m15:54:32.110311 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:54:32.249193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:54:32.250643 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m15:54:32.273237 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m15:54:32.361612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ac02de8-2445-4ac9-aee1-cdcb68452604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b648fc0d0>]}
[0m15:54:32.385657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ac02de8-2445-4ac9-aee1-cdcb68452604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b65131b40>]}
[0m15:54:32.386229 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:54:32.386805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ac02de8-2445-4ac9-aee1-cdcb68452604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b64fbf100>]}
[0m15:54:32.390615 [info ] [MainThread]: 
[0m15:54:32.393090 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:54:32.394375 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:54:32.394816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:33.563119 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:54:33.563560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:33.564628 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:54:33.565653 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:54:33.566304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:33.567079 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:54:33.599978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:33.601839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:35.031503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ac02de8-2445-4ac9-aee1-cdcb68452604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b651315d0>]}
[0m15:54:35.032453 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:54:35.032899 [info ] [MainThread]: 
[0m15:54:35.036665 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m15:54:35.037168 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m15:54:35.038254 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m15:54:35.038744 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m15:54:35.043445 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m15:54:35.044792 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 15:54:35.039034 => 2023-07-01 15:54:35.044498
[0m15:54:35.045481 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m15:54:35.121572 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m15:54:35.122289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:35.124423 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, customer_id, order_date, sales_order_detail_id order by fixed_person_id) as sale_identifier_sk
        , row_number() over (order by order_date) as order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as _fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amout
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m15:54:35.967618 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword BY at [21:81]')
[0m15:54:36.529034 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c99b76fa-88f1-4ebd-baab-1e9872a6d661&page=queryresults
[0m15:54:36.529947 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 15:54:35.045773 => 2023-07-01 15:54:36.529799
[0m15:54:36.533316 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Syntax error: Expected ")" but got keyword BY at [21:81]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:54:36.533943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac02de8-2445-4ac9-aee1-cdcb68452604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b6495a1d0>]}
[0m15:54:36.534620 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 1.50s]
[0m15:54:36.538183 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m15:54:36.540259 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:54:36.541042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:36.541356 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:54:36.541653 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:54:36.542016 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m15:54:36.542535 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m15:54:36.543138 [info ] [MainThread]: 
[0m15:54:36.544250 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.15 seconds (4.15s).
[0m15:54:36.545214 [debug] [MainThread]: Command end result
[0m15:54:36.585154 [info ] [MainThread]: 
[0m15:54:36.586271 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:54:36.587928 [info ] [MainThread]: 
[0m15:54:36.588764 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m15:54:36.589718 [error] [MainThread]:   Syntax error: Expected ")" but got keyword BY at [21:81]
[0m15:54:36.590566 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:54:36.591314 [info ] [MainThread]: 
[0m15:54:36.592348 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:54:36.593655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b65131570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b651315a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b64fbefb0>]}
[0m15:54:36.594932 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:55:14.921597 | 52657884-b7f6-4a65-99d1-7dc2f861dc90 ==============================
[0m15:55:14.921597 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:55:14.923531 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:55:14.923981 [debug] [MainThread]: Tracking: tracking
[0m15:55:14.925722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2ae81270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2ae806a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2ae811e0>]}
[0m15:55:14.968509 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:55:15.111303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:55:15.112925 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m15:55:15.136955 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m15:55:15.230021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52657884-b7f6-4a65-99d1-7dc2f861dc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2a51c0d0>]}
[0m15:55:15.254963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52657884-b7f6-4a65-99d1-7dc2f861dc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2ad56140>]}
[0m15:55:15.255482 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:55:15.255904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52657884-b7f6-4a65-99d1-7dc2f861dc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2abe3700>]}
[0m15:55:15.259556 [info ] [MainThread]: 
[0m15:55:15.262009 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:55:15.263440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:55:15.264033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:16.164640 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:55:16.165282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:16.166193 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:55:16.168846 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:55:16.169190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:16.204594 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:55:16.205270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:16.205872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:17.609886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52657884-b7f6-4a65-99d1-7dc2f861dc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2ad55bd0>]}
[0m15:55:17.610859 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:55:17.611390 [info ] [MainThread]: 
[0m15:55:17.616446 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m15:55:17.617198 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m15:55:17.618743 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m15:55:17.619336 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m15:55:17.625710 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m15:55:17.626537 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 15:55:17.619751 => 2023-07-01 15:55:17.626421
[0m15:55:17.627113 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m15:55:17.715041 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m15:55:17.716299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:17.720544 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (partition by sales_order_id, customer_id, order_date, sales_order_detail_id order by fixed_person_id) as sale_identifier_sk
        , row_number() over (order by order_date) as order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as _fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amout
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m15:55:18.617304 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword BY at [21:81]')
[0m15:55:19.441033 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:16e1b4de-a289-4850-b14a-1ea77a70acae&page=queryresults
[0m15:55:19.442180 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 15:55:17.627553 => 2023-07-01 15:55:19.441972
[0m15:55:19.447146 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Syntax error: Expected ")" but got keyword BY at [21:81]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:55:19.448000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52657884-b7f6-4a65-99d1-7dc2f861dc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2a37e710>]}
[0m15:55:19.448594 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 1.83s]
[0m15:55:19.450822 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m15:55:19.452646 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:55:19.453390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:19.453689 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m15:55:19.453965 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:55:19.454498 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:55:19.455098 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m15:55:19.455886 [info ] [MainThread]: 
[0m15:55:19.456725 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m15:55:19.457914 [debug] [MainThread]: Command end result
[0m15:55:19.498133 [info ] [MainThread]: 
[0m15:55:19.499911 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:55:19.501462 [info ] [MainThread]: 
[0m15:55:19.502690 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m15:55:19.503762 [error] [MainThread]:   Syntax error: Expected ")" but got keyword BY at [21:81]
[0m15:55:19.504561 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:55:19.506018 [info ] [MainThread]: 
[0m15:55:19.507494 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:55:19.509279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2ad55b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2ad55ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2abe35b0>]}
[0m15:55:19.510655 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:56:29.822427 | 021caa85-5517-413b-8a8f-17ce43a62aee ==============================
[0m15:56:29.822427 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:56:29.824668 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:56:29.825033 [debug] [MainThread]: Tracking: tracking
[0m15:56:29.826756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaea8f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaea8ec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaea8f3a0>]}
[0m15:56:29.879614 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:56:30.013756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:56:30.015162 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m15:56:30.037457 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m15:56:30.125607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '021caa85-5517-413b-8a8f-17ce43a62aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aae1180d0>]}
[0m15:56:30.148465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '021caa85-5517-413b-8a8f-17ce43a62aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aae961ae0>]}
[0m15:56:30.149027 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:56:30.149554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '021caa85-5517-413b-8a8f-17ce43a62aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aae7f30a0>]}
[0m15:56:30.156599 [info ] [MainThread]: 
[0m15:56:30.160808 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:56:30.162609 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:56:30.163351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:31.127062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:56:31.128262 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:56:31.128656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:31.129730 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:56:31.130113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:31.131068 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:56:31.131658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:31.199875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:32.555334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '021caa85-5517-413b-8a8f-17ce43a62aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aae961570>]}
[0m15:56:32.556334 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:32.556851 [info ] [MainThread]: 
[0m15:56:32.560476 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m15:56:32.560989 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m15:56:32.562003 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m15:56:32.562383 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m15:56:32.565743 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m15:56:32.566311 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 15:56:32.562595 => 2023-07-01 15:56:32.566229
[0m15:56:32.566665 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m15:56:32.633228 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m15:56:32.633835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:32.636848 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (partition by sales_order_id, customer_id, order_date, sales_order_detail_id order by fixed_person_id) as sale_identifier_sk
        , row_number() over (order by order_date) as order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        -- , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        -- , row_number() over (order by ship_method_id) as ship_method_fk
        -- , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amout
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m15:56:33.554707 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword BY at [21:81]')
[0m15:56:34.391128 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:481af418-25ba-4a04-9d87-4f51ec689d82&page=queryresults
[0m15:56:34.392441 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 15:56:32.566874 => 2023-07-01 15:56:34.392178
[0m15:56:34.400176 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Syntax error: Expected ")" but got keyword BY at [21:81]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:56:34.400907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '021caa85-5517-413b-8a8f-17ce43a62aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aadf8a200>]}
[0m15:56:34.401683 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 1.84s]
[0m15:56:34.405141 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m15:56:34.407236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:56:34.408303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:34.408737 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:56:34.409193 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m15:56:34.410816 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m15:56:34.411167 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:56:34.411674 [info ] [MainThread]: 
[0m15:56:34.412417 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m15:56:34.413810 [debug] [MainThread]: Command end result
[0m15:56:34.453029 [info ] [MainThread]: 
[0m15:56:34.453866 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:56:34.454613 [info ] [MainThread]: 
[0m15:56:34.455349 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m15:56:34.456236 [error] [MainThread]:   Syntax error: Expected ")" but got keyword BY at [21:81]
[0m15:56:34.457021 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:56:34.457872 [info ] [MainThread]: 
[0m15:56:34.458720 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:56:34.459744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aae961510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aae961540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aae7f2f50>]}
[0m15:56:34.461179 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:56:44.784041 | f5f0f16b-1074-401e-9e8f-d4a9d3eb66bb ==============================
[0m15:56:44.784041 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:56:44.787471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:56:44.787976 [debug] [MainThread]: Tracking: tracking
[0m15:56:44.789763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5cf8a740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5cf8a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5cf8a710>]}
[0m15:56:44.841254 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:56:45.026714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:56:45.028146 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m15:56:45.051031 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m15:56:45.138664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5f0f16b-1074-401e-9e8f-d4a9d3eb66bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5c6200d0>]}
[0m15:56:45.163276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5f0f16b-1074-401e-9e8f-d4a9d3eb66bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ce5ddb0>]}
[0m15:56:45.163863 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:56:45.164383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5f0f16b-1074-401e-9e8f-d4a9d3eb66bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5cceb370>]}
[0m15:56:45.171464 [info ] [MainThread]: 
[0m15:56:45.175711 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:56:45.177714 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:56:45.178945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:46.289247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:56:46.289737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:46.290786 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:56:46.291809 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:56:46.292339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:46.293186 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:56:46.327395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:46.328030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:47.716190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5f0f16b-1074-401e-9e8f-d4a9d3eb66bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ce5d840>]}
[0m15:56:47.717398 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:47.718044 [info ] [MainThread]: 
[0m15:56:47.723847 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m15:56:47.724874 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m15:56:47.727230 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m15:56:47.728028 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m15:56:47.734536 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m15:56:47.735561 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 15:56:47.728588 => 2023-07-01 15:56:47.735338
[0m15:56:47.736261 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m15:56:47.800998 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m15:56:47.801721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:47.803742 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (partition by sales_order_id, customer_id, order_date, sales_order_detail_id order by fixed_person_id) as sale_identifier_sk
        , row_number() over (order by order_date) as order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        -- , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        -- , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        -- , row_number() over (order by ship_method_id) as ship_method_fk
        -- , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amout
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m15:56:48.727231 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword BY at [21:81]')
[0m15:56:49.204685 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:328cf0a0-9114-42ed-ac92-e17c9bfa6afd&page=queryresults
[0m15:56:49.205993 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 15:56:47.736628 => 2023-07-01 15:56:49.205829
[0m15:56:49.211026 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Syntax error: Expected ")" but got keyword BY at [21:81]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:56:49.211844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5f0f16b-1074-401e-9e8f-d4a9d3eb66bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5c49f400>]}
[0m15:56:49.212595 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 1.49s]
[0m15:56:49.214872 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m15:56:49.216860 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:56:49.217932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:49.218439 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:56:49.219105 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m15:56:49.219761 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:56:49.220338 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m15:56:49.221225 [info ] [MainThread]: 
[0m15:56:49.222238 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m15:56:49.223635 [debug] [MainThread]: Command end result
[0m15:56:49.277360 [info ] [MainThread]: 
[0m15:56:49.278388 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:56:49.279466 [info ] [MainThread]: 
[0m15:56:49.280317 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m15:56:49.281072 [error] [MainThread]:   Syntax error: Expected ")" but got keyword BY at [21:81]
[0m15:56:49.281810 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:56:49.282555 [info ] [MainThread]: 
[0m15:56:49.283504 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:56:49.284478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ce5d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ce5d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5cceb220>]}
[0m15:56:49.285166 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:57:15.625424 | 2db9dcfd-dc25-4e6e-a4bb-dff5dac384c3 ==============================
[0m15:57:15.625424 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:57:15.627460 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:57:15.627998 [debug] [MainThread]: Tracking: tracking
[0m15:57:15.630404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f8e7a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f8e793c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f8e7a3e0>]}
[0m15:57:15.679587 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:57:15.815192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:15.816661 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m15:57:15.839246 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m15:57:15.927016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2db9dcfd-dc25-4e6e-a4bb-dff5dac384c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f81140d0>]}
[0m15:57:15.950418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2db9dcfd-dc25-4e6e-a4bb-dff5dac384c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f8b51a20>]}
[0m15:57:15.950916 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:57:15.951420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2db9dcfd-dc25-4e6e-a4bb-dff5dac384c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f89defe0>]}
[0m15:57:15.955028 [info ] [MainThread]: 
[0m15:57:15.957588 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:57:15.959028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:57:15.959578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:16.832681 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:57:16.833796 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:57:16.834161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:16.835018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:57:16.836092 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:57:16.836400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:16.837043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:16.871229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:18.239894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2db9dcfd-dc25-4e6e-a4bb-dff5dac384c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f8b514b0>]}
[0m15:57:18.240894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:18.241382 [info ] [MainThread]: 
[0m15:57:18.245789 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m15:57:18.246369 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m15:57:18.247532 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m15:57:18.248006 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m15:57:18.252065 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m15:57:18.253617 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 15:57:18.248293 => 2023-07-01 15:57:18.253316
[0m15:57:18.254622 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m15:57:18.346870 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m15:57:18.347540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:18.349585 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        -- row_number() over (partition by sales_order_id, customer_id, order_date, sales_order_detail_id order by fixed_person_id) as sale_identifier_sk
         row_number() over (order by order_date) as order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        -- , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        -- , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        -- , row_number() over (order by ship_method_id) as ship_method_fk
        -- , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amout
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m15:57:19.243431 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword BY at [21:81]')
[0m15:57:19.862827 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2372a1bf-a823-41a6-9772-82cdd28021f1&page=queryresults
[0m15:57:19.863607 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 15:57:18.255445 => 2023-07-01 15:57:19.863475
[0m15:57:19.866599 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Syntax error: Expected ")" but got keyword BY at [21:81]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:57:19.867159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2db9dcfd-dc25-4e6e-a4bb-dff5dac384c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f8176110>]}
[0m15:57:19.867775 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 1.62s]
[0m15:57:19.870238 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m15:57:19.872228 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:57:19.873046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:19.873633 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m15:57:19.874257 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:57:19.875304 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m15:57:19.876204 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:57:19.876839 [info ] [MainThread]: 
[0m15:57:19.877629 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m15:57:19.878567 [debug] [MainThread]: Command end result
[0m15:57:19.907437 [info ] [MainThread]: 
[0m15:57:19.908048 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:57:19.908666 [info ] [MainThread]: 
[0m15:57:19.909234 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m15:57:19.909688 [error] [MainThread]:   Syntax error: Expected ")" but got keyword BY at [21:81]
[0m15:57:19.910297 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:57:19.910971 [info ] [MainThread]: 
[0m15:57:19.911479 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:57:19.912139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f8b51450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f8b51480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4f89dee90>]}
[0m15:57:19.912536 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:59:09.714031 | 93d2ca23-2065-4e66-8c0c-36ba5057d41e ==============================
[0m15:59:09.714031 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:59:09.716269 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:59:09.716693 [debug] [MainThread]: Tracking: tracking
[0m15:59:09.718361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fdab7ace0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fdab788e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fdab7ad10>]}
[0m15:59:09.758959 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:59:09.899141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:09.900921 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m15:59:09.923631 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m15:59:10.011317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93d2ca23-2065-4e66-8c0c-36ba5057d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd9e180d0>]}
[0m15:59:10.034399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93d2ca23-2065-4e66-8c0c-36ba5057d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fda851c60>]}
[0m15:59:10.034881 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:59:10.035323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93d2ca23-2065-4e66-8c0c-36ba5057d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fda6e3220>]}
[0m15:59:10.041977 [info ] [MainThread]: 
[0m15:59:10.045921 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:59:10.047587 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:59:10.048092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:11.079641 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:59:11.080283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:11.081088 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:59:11.082042 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:59:11.115533 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:59:11.117311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:11.117964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:11.118466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:12.510980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93d2ca23-2065-4e66-8c0c-36ba5057d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fda8516f0>]}
[0m15:59:12.512009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:12.512520 [info ] [MainThread]: 
[0m15:59:12.516842 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m15:59:12.517418 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m15:59:12.518452 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m15:59:12.518869 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m15:59:12.522742 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m15:59:12.523910 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 15:59:12.519089 => 2023-07-01 15:59:12.523744
[0m15:59:12.524531 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m15:59:12.598805 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m15:59:12.599743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:12.601906 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (partition by sales_order_id, customer_id, order_date, sales_order_detail_id order by fixed_person_id) as sale_identifier_sk
        , row_number() over (order by order_date) as order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as _fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amout
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m15:59:14.549549 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: fixed_person_id; Did you mean sales_person_id? at [27:113]')
[0m15:59:16.701318 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b12e0ee2-daec-4b90-93e0-38b8aa78a540&page=queryresults
[0m15:59:16.702217 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 15:59:12.524996 => 2023-07-01 15:59:16.702063
[0m15:59:16.705294 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Unrecognized name: fixed_person_id; Did you mean sales_person_id? at [27:113]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:59:16.705791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d2ca23-2065-4e66-8c0c-36ba5057d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd9c7d690>]}
[0m15:59:16.706300 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 4.19s]
[0m15:59:16.708482 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m15:59:16.710439 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:59:16.711196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:16.711514 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:59:16.711776 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m15:59:16.712031 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m15:59:16.712283 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m15:59:16.712895 [info ] [MainThread]: 
[0m15:59:16.714069 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.67 seconds (6.67s).
[0m15:59:16.715295 [debug] [MainThread]: Command end result
[0m15:59:16.754308 [info ] [MainThread]: 
[0m15:59:16.754964 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:59:16.755649 [info ] [MainThread]: 
[0m15:59:16.757061 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m15:59:16.758559 [error] [MainThread]:   Unrecognized name: fixed_person_id; Did you mean sales_person_id? at [27:113]
[0m15:59:16.761793 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:59:16.763118 [info ] [MainThread]: 
[0m15:59:16.764535 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:59:16.766265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fda851a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fda8516c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fdec555a0>]}
[0m15:59:16.767066 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 15:59:37.014981 | aa117d2f-954c-4d9c-a865-e1fdf0893db6 ==============================
[0m15:59:37.014981 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:59:37.017233 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:59:37.017802 [debug] [MainThread]: Tracking: tracking
[0m15:59:37.020077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dd16d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dd16c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dd16d1e0>]}
[0m15:59:37.087898 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:59:37.221618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:37.222937 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m15:59:37.245640 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m15:59:37.335682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa117d2f-954c-4d9c-a865-e1fdf0893db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dc4080d0>]}
[0m15:59:37.359856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa117d2f-954c-4d9c-a865-e1fdf0893db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dce46140>]}
[0m15:59:37.360404 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m15:59:37.361265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa117d2f-954c-4d9c-a865-e1fdf0893db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dccd3700>]}
[0m15:59:37.365156 [info ] [MainThread]: 
[0m15:59:37.368198 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:59:37.369620 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m15:59:37.370202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:38.319630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m15:59:38.320238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:38.321123 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m15:59:38.354808 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m15:59:38.355186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:38.357745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m15:59:38.358384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:38.359158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:39.492059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa117d2f-954c-4d9c-a865-e1fdf0893db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dce45bd0>]}
[0m15:59:39.493010 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:39.493548 [info ] [MainThread]: 
[0m15:59:39.498097 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m15:59:39.498767 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m15:59:39.500096 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m15:59:39.500552 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m15:59:39.505032 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m15:59:39.506060 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 15:59:39.500837 => 2023-07-01 15:59:39.505914
[0m15:59:39.506771 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m15:59:39.603526 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m15:59:39.604841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:39.608727 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (partition by sales_order_id, customer_id, order_date, sales_order_detail_id order by sales_order_id) as sale_identifier_sk
        , row_number() over (order by order_date) as order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as _fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amout
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m15:59:41.218565 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: tax_amout; Did you mean tax_amount? at [37:11]')
[0m15:59:42.815575 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d2ba90ed-8e3f-415a-933f-173e72a0f7d3&page=queryresults
[0m15:59:42.817587 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 15:59:39.507620 => 2023-07-01 15:59:42.817227
[0m15:59:42.821098 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Unrecognized name: tax_amout; Did you mean tax_amount? at [37:11]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:59:42.821815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa117d2f-954c-4d9c-a865-e1fdf0893db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dc471c00>]}
[0m15:59:42.822461 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 3.32s]
[0m15:59:42.824940 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m15:59:42.826800 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:59:42.827480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:42.827726 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m15:59:42.827948 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m15:59:42.828166 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m15:59:42.828412 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m15:59:42.828928 [info ] [MainThread]: 
[0m15:59:42.831238 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m15:59:42.832527 [debug] [MainThread]: Command end result
[0m15:59:42.861936 [info ] [MainThread]: 
[0m15:59:42.863348 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:59:42.864683 [info ] [MainThread]: 
[0m15:59:42.865975 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m15:59:42.867467 [error] [MainThread]:   Unrecognized name: tax_amout; Did you mean tax_amount? at [37:11]
[0m15:59:42.868483 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m15:59:42.869376 [info ] [MainThread]: 
[0m15:59:42.870440 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:59:42.871832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dce45f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dce45ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dccd35b0>]}
[0m15:59:42.872789 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:00:00.127622 | 08ece1ce-6e00-45e3-b2fd-40f5f31b840a ==============================
[0m16:00:00.127622 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:00:00.129600 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:00:00.130223 [debug] [MainThread]: Tracking: tracking
[0m16:00:00.131956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b468a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b4688fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b46888e0>]}
[0m16:00:00.177936 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:00:00.326444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:00:00.327845 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m16:00:00.350147 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m16:00:00.437615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08ece1ce-6e00-45e3-b2fd-40f5f31b840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b3d200d0>]}
[0m16:00:00.460355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08ece1ce-6e00-45e3-b2fd-40f5f31b840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b455df00>]}
[0m16:00:00.460873 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:00:00.461317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08ece1ce-6e00-45e3-b2fd-40f5f31b840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b43eb4c0>]}
[0m16:00:00.468061 [info ] [MainThread]: 
[0m16:00:00.471958 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:00.473582 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m16:00:00.474092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:01.300220 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:00:01.300841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:01.301709 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:00:01.304110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:01.336986 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:00:01.338478 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:00:01.338870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:01.372844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:02.703654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08ece1ce-6e00-45e3-b2fd-40f5f31b840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b455d990>]}
[0m16:00:02.704520 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:02.704942 [info ] [MainThread]: 
[0m16:00:02.708580 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m16:00:02.709074 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m16:00:02.710271 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m16:00:02.710663 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m16:00:02.714487 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m16:00:02.715334 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 16:00:02.710910 => 2023-07-01 16:00:02.715170
[0m16:00:02.716152 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m16:00:02.801496 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m16:00:02.802338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:02.806622 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (partition by sales_order_id, customer_id, order_date, sales_order_detail_id order by sales_order_id) as sale_identifier_sk
        , row_number() over (order by order_date) as order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_dicount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m16:00:04.370415 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: unit_price_dicount; Did you mean unit_price_discount? at [42:11]')
[0m16:00:06.532686 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6b6fb7d6-9e4f-46d6-8547-85f9e429f033&page=queryresults
[0m16:00:06.533589 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 16:00:02.716764 => 2023-07-01 16:00:06.533443
[0m16:00:06.536655 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Unrecognized name: unit_price_dicount; Did you mean unit_price_discount? at [42:11]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m16:00:06.537174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ece1ce-6e00-45e3-b2fd-40f5f31b840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b3b8e1d0>]}
[0m16:00:06.537796 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 3.83s]
[0m16:00:06.540295 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m16:00:06.542578 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:06.543782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:06.544287 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m16:00:06.544731 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m16:00:06.545158 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m16:00:06.545597 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m16:00:06.546535 [info ] [MainThread]: 
[0m16:00:06.549919 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m16:00:06.550859 [debug] [MainThread]: Command end result
[0m16:00:06.590752 [info ] [MainThread]: 
[0m16:00:06.593420 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:00:06.595540 [info ] [MainThread]: 
[0m16:00:06.597069 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m16:00:06.598645 [error] [MainThread]:   Unrecognized name: unit_price_dicount; Did you mean unit_price_discount? at [42:11]
[0m16:00:06.599834 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m16:00:06.600662 [info ] [MainThread]: 
[0m16:00:06.601538 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:00:06.602935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b89c95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b455dfc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3b455d930>]}
[0m16:00:06.603635 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:00:16.752705 | 8999547e-82d2-4ec8-b916-5cef160c2f70 ==============================
[0m16:00:16.752705 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:00:16.754668 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:00:16.755101 [debug] [MainThread]: Tracking: tracking
[0m16:00:16.756817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9185e7a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9185e78ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9185e7abc0>]}
[0m16:00:16.806290 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:00:16.940402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:00:16.941770 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m16:00:16.964335 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m16:00:17.054514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8999547e-82d2-4ec8-b916-5cef160c2f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91853140d0>]}
[0m16:00:17.077531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8999547e-82d2-4ec8-b916-5cef160c2f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9185b51ff0>]}
[0m16:00:17.078064 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:00:17.078508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8999547e-82d2-4ec8-b916-5cef160c2f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91859df5b0>]}
[0m16:00:17.082250 [info ] [MainThread]: 
[0m16:00:17.084711 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:17.086147 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m16:00:17.086691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:18.050116 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:00:18.051087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:00:18.051663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:18.052445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:00:18.053366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:00:18.053858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:18.054427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:18.088262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:19.440255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8999547e-82d2-4ec8-b916-5cef160c2f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9185b51a80>]}
[0m16:00:19.441167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:19.441626 [info ] [MainThread]: 
[0m16:00:19.445338 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m16:00:19.445866 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m16:00:19.446822 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m16:00:19.447194 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m16:00:19.450907 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m16:00:19.451548 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 16:00:19.447442 => 2023-07-01 16:00:19.451463
[0m16:00:19.451878 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m16:00:19.523897 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m16:00:19.524497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:19.526446 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (partition by sales_order_id, customer_id, order_date, sales_order_detail_id order by sales_order_id) as sale_identifier_sk
        , row_number() over (order by order_date) as order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m16:00:29.206374 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9bed2e92-ebce-4925-ad29-90929f6806fa&page=queryresults
[0m16:00:30.022927 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 16:00:19.452115 => 2023-07-01 16:00:30.022862
[0m16:00:30.023777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8999547e-82d2-4ec8-b916-5cef160c2f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91851de500>]}
[0m16:00:30.024305 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 16.6 MB processed)[0m in 10.58s]
[0m16:00:30.026519 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m16:00:30.028221 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:30.028896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:30.029179 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m16:00:30.029429 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m16:00:30.029656 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m16:00:30.029870 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m16:00:30.030146 [info ] [MainThread]: 
[0m16:00:30.030711 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.95 seconds (12.95s).
[0m16:00:30.031586 [debug] [MainThread]: Command end result
[0m16:00:30.056515 [info ] [MainThread]: 
[0m16:00:30.057445 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:30.058650 [info ] [MainThread]: 
[0m16:00:30.060149 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:00:30.061953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9185b520b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91859df430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91859df400>]}
[0m16:00:30.063126 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:01:48.308401 | ab867175-1207-4c45-a3bf-d96645e436bb ==============================
[0m16:01:48.308401 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:01:48.310838 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:01:48.311629 [debug] [MainThread]: Tracking: tracking
[0m16:01:48.313783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3630865c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe363085cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe363086470>]}
[0m16:01:48.366849 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:01:48.498029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:01:48.499426 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m16:01:48.521679 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m16:01:48.609131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab867175-1207-4c45-a3bf-d96645e436bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3627140d0>]}
[0m16:01:48.632395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab867175-1207-4c45-a3bf-d96645e436bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362f59900>]}
[0m16:01:48.632918 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:01:48.633406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab867175-1207-4c45-a3bf-d96645e436bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362de6ec0>]}
[0m16:01:48.640010 [info ] [MainThread]: 
[0m16:01:48.643927 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:01:48.645591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m16:01:48.646106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:49.491783 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:01:49.492331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:49.493069 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:01:49.494276 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:01:49.494792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:49.497505 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:01:49.530187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:49.563645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:51.046084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab867175-1207-4c45-a3bf-d96645e436bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362f59390>]}
[0m16:01:51.047948 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:01:51.049288 [info ] [MainThread]: 
[0m16:01:51.055626 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m16:01:51.056237 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m16:01:51.057199 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m16:01:51.057563 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m16:01:51.061184 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m16:01:51.061754 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 16:01:51.057795 => 2023-07-01 16:01:51.061673
[0m16:01:51.062071 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m16:01:51.098170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:52.072718 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m16:01:52.073781 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id) as sale_identifier_sk
        , row_number() over (order by order_date) as order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m16:01:59.938960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:45cba15c-3672-471a-b718-00a1f739af72&page=queryresults
[0m16:02:00.950332 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 16:01:51.062343 => 2023-07-01 16:02:00.950204
[0m16:02:00.952221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab867175-1207-4c45-a3bf-d96645e436bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362595f90>]}
[0m16:02:00.953276 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 16.6 MB processed)[0m in 9.90s]
[0m16:02:00.957164 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m16:02:00.959356 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:02:00.960290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:00.960794 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m16:02:00.961282 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m16:02:00.961544 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m16:02:00.961787 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m16:02:00.962098 [info ] [MainThread]: 
[0m16:02:00.962642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.32 seconds (12.32s).
[0m16:02:00.963517 [debug] [MainThread]: Command end result
[0m16:02:00.996658 [info ] [MainThread]: 
[0m16:02:00.998505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:00.999691 [info ] [MainThread]: 
[0m16:02:01.000899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:02:01.002643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362e41570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362f599c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362f59720>]}
[0m16:02:01.003728 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:03:08.657504 | b8308be9-1868-482e-b39b-1bad2b07289b ==============================
[0m16:03:08.657504 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:03:08.663297 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m16:03:08.664014 [debug] [MainThread]: Tracking: tracking
[0m16:03:08.667074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fac8e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fac8c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fac8e470>]}
[0m16:03:08.729425 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:03:08.875932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:08.876271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:08.889550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8308be9-1868-482e-b39b-1bad2b07289b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66faa4e4d0>]}
[0m16:03:08.912353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8308be9-1868-482e-b39b-1bad2b07289b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66faa07b50>]}
[0m16:03:08.912859 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:03:08.913271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8308be9-1868-482e-b39b-1bad2b07289b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66faa078e0>]}
[0m16:03:08.922552 [info ] [MainThread]: 
[0m16:03:08.926338 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:03:08.946364 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:03:08.948168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:08.950573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:03:08.952467 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:03:08.953641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:08.954595 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:03:08.992464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:09.029392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:10.514221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8308be9-1868-482e-b39b-1bad2b07289b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66faa04ac0>]}
[0m16:03:10.515124 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:10.515592 [info ] [MainThread]: 
[0m16:03:10.519434 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:03:10.519892 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:03:10.520366 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:03:10.520916 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:03:10.521206 [info ] [Thread-1 (]: 1 of 11 START test not_null_dim_address_address_sk ............................. [RUN]
[0m16:03:10.522036 [info ] [Thread-2 (]: 2 of 11 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m16:03:10.522929 [info ] [Thread-3 (]: 3 of 11 START test not_null_dim_product_product_sk ............................. [RUN]
[0m16:03:10.523920 [info ] [Thread-4 (]: 4 of 11 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m16:03:10.525145 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m16:03:10.526089 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m16:03:10.527271 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_product_product_sk.271feb5417'
[0m16:03:10.529011 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m16:03:10.529679 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:03:10.530104 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:03:10.530599 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:03:10.531069 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:03:10.596180 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m16:03:10.601878 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m16:03:10.613187 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m16:03:10.623495 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 16:03:10.606673 => 2023-07-01 16:03:10.623382
[0m16:03:10.625365 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m16:03:10.625772 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:03:10.626073 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (compile): 2023-07-01 16:03:10.587775 => 2023-07-01 16:03:10.626012
[0m16:03:10.626377 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 16:03:10.542729 => 2023-07-01 16:03:10.626312
[0m16:03:10.637407 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:03:10.651894 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m16:03:10.652364 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 16:03:10.531839 => 2023-07-01 16:03:10.652237
[0m16:03:10.652802 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:03:10.658537 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m16:03:10.659408 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:03:10.663004 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m16:03:10.663520 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:10.667446 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m16:03:10.668070 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:10.668906 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:10.670947 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m16:03:10.673397 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_product_product_sk.271feb5417: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_product`
where product_sk is null



      
    ) dbt_internal_test
[0m16:03:10.674861 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m16:03:10.675193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:10.778451 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m16:03:13.356522 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:49596285-903d-40e8-9d08-0d6a9c763432&page=queryresults
[0m16:03:13.357990 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8ccd9095-09ee-415e-b156-0365bc2302da&page=queryresults
[0m16:03:13.358978 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a860da3a-2004-4d84-9b2e-217b76932b9b&page=queryresults
[0m16:03:13.359967 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6b05d417-83ea-44fa-bdcc-c04fad15b398&page=queryresults
[0m16:03:13.361896 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (execute): 2023-07-01 16:03:10.653088 => 2023-07-01 16:03:13.361823
[0m16:03:13.362600 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 16:03:10.626815 => 2023-07-01 16:03:13.362532
[0m16:03:13.363258 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 16:03:10.664028 => 2023-07-01 16:03:13.363192
[0m16:03:13.363888 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 16:03:10.659880 => 2023-07-01 16:03:13.363833
[0m16:03:13.364813 [info ] [Thread-3 (]: 3 of 11 PASS not_null_dim_product_product_sk ................................... [[32mPASS[0m in 2.84s]
[0m16:03:13.366133 [info ] [Thread-4 (]: 4 of 11 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 2.84s]
[0m16:03:13.367442 [info ] [Thread-1 (]: 1 of 11 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.84s]
[0m16:03:13.369054 [info ] [Thread-2 (]: 2 of 11 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.84s]
[0m16:03:13.372809 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:03:13.373510 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:03:13.373993 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:03:13.374512 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:03:13.375212 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:03:13.376001 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:03:13.376726 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:03:13.377448 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:03:13.377929 [info ] [Thread-3 (]: 5 of 11 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m16:03:13.378663 [info ] [Thread-4 (]: 6 of 11 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m16:03:13.382890 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m16:03:13.380225 [info ] [Thread-2 (]: 8 of 11 START test unique_dim_dates_metric_date ................................ [RUN]
[0m16:03:13.381454 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m16:03:13.379543 [info ] [Thread-1 (]: 7 of 11 START test unique_dim_address_address_sk ............................... [RUN]
[0m16:03:13.383755 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:03:13.385302 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m16:03:13.386131 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:03:13.387337 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m16:03:13.397013 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:03:13.434645 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m16:03:13.441234 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:03:13.443790 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m16:03:13.456322 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m16:03:13.461661 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m16:03:13.462253 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 16:03:13.409308 => 2023-07-01 16:03:13.462168
[0m16:03:13.462666 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 16:03:13.387909 => 2023-07-01 16:03:13.462604
[0m16:03:13.463456 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:03:13.463947 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 16:03:13.444169 => 2023-07-01 16:03:13.463851
[0m16:03:13.464366 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 16:03:13.456822 => 2023-07-01 16:03:13.464254
[0m16:03:13.464796 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:03:13.468057 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m16:03:13.468523 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:03:13.468886 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:03:13.472405 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m16:03:13.475708 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m16:03:13.480070 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m16:03:13.480542 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:13.481243 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:13.481648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:13.482130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:13.483768 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m16:03:13.485535 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:03:13.486887 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:13.488423 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:14.958522 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator = for argument types: INT64, DATE. Supported signature: ANY = ANY at [27:8]')
[0m16:03:15.985050 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5febfaa3-fe1b-4c64-89fa-e341e58abec5&page=queryresults
[0m16:03:15.986044 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 16:03:13.465128 => 2023-07-01 16:03:15.985961
[0m16:03:15.986972 [info ] [Thread-3 (]: 5 of 11 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.61s]
[0m16:03:15.987617 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:03:15.988304 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:03:15.988852 [info ] [Thread-3 (]: 9 of 11 START test unique_dim_product_product_sk ............................... [RUN]
[0m16:03:15.989899 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c'
[0m16:03:15.990324 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:03:15.996134 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m16:03:15.996702 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (compile): 2023-07-01 16:03:15.990561 => 2023-07-01 16:03:15.996607
[0m16:03:15.997153 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:03:16.002487 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m16:03:16.003176 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:16.007357 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_product_product_sk.2248c4335c: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_product`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:16.273409 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:34a3e310-cd1a-47a7-860f-22e69939da1c&page=queryresults
[0m16:03:16.274280 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 16:03:13.476128 => 2023-07-01 16:03:16.274199
[0m16:03:16.275203 [info ] [Thread-1 (]: 7 of 11 PASS unique_dim_address_address_sk ..................................... [[32mPASS[0m in 2.89s]
[0m16:03:16.275920 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:03:16.276759 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:03:16.277509 [info ] [Thread-1 (]: 10 of 11 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m16:03:16.279109 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m16:03:16.279895 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:03:16.290665 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m16:03:16.291883 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 16:03:16.280907 => 2023-07-01 16:03:16.291733
[0m16:03:16.292773 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:03:16.301717 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m16:03:16.302548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:16.304627 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:16.394192 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3a8e34fa-6fee-4d61-a402-bedb2423bd3d&page=queryresults
[0m16:03:16.395244 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 16:03:13.469174 => 2023-07-01 16:03:16.395110
[0m16:03:16.401712 [debug] [Thread-4 (]: Database Error in test relationships_fact_sales_order_date__metric_date__ref_dim_dates_ (models/gold/fact_sales.yml)
  No matching signature for operator = for argument types: INT64, DATE. Supported signature: ANY = ANY at [27:8]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_33dc30e2eee189b676598f310f1620da.sql
[0m16:03:16.402654 [error] [Thread-4 (]: 6 of 11 ERROR relationships_fact_sales_order_date__metric_date__ref_dim_dates_ . [[31mERROR[0m in 3.02s]
[0m16:03:16.403757 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:03:16.404706 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:03:16.405439 [info ] [Thread-4 (]: 11 of 11 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m16:03:16.407186 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m16:03:16.408000 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:03:16.446198 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m16:03:16.448040 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 16:03:16.410962 => 2023-07-01 16:03:16.447547
[0m16:03:16.449258 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:03:16.475093 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m16:03:16.476607 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:16.479443 [debug] [Thread-4 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:16.755964 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7a517b8d-83e3-4af9-ab61-dfa7f13c8c5d&page=queryresults
[0m16:03:16.756931 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 16:03:13.472928 => 2023-07-01 16:03:16.756806
[0m16:03:16.757837 [info ] [Thread-2 (]: 8 of 11 PASS unique_dim_dates_metric_date ...................................... [[32mPASS[0m in 3.37s]
[0m16:03:16.758401 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:03:18.455159 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:86f34441-86a4-49fa-a769-18b7eaed7a46&page=queryresults
[0m16:03:18.456107 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (execute): 2023-07-01 16:03:15.997548 => 2023-07-01 16:03:18.456025
[0m16:03:18.457013 [info ] [Thread-3 (]: 9 of 11 PASS unique_dim_product_product_sk ..................................... [[32mPASS[0m in 2.47s]
[0m16:03:18.457588 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:03:18.882204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:91de7743-361d-4e8e-a0fb-375086df7361&page=queryresults
[0m16:03:18.882825 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:05edecc9-67dc-4d23-9b9e-634fa80f9bd8&page=queryresults
[0m16:03:18.883616 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 16:03:16.293431 => 2023-07-01 16:03:18.883525
[0m16:03:18.884373 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 16:03:16.449794 => 2023-07-01 16:03:18.884298
[0m16:03:18.885329 [info ] [Thread-1 (]: 10 of 11 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 2.61s]
[0m16:03:18.886745 [info ] [Thread-4 (]: 11 of 11 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.48s]
[0m16:03:18.887501 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:03:18.887964 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:03:18.890173 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:03:18.891245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:18.891712 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c' was properly closed.
[0m16:03:18.892107 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m16:03:18.892473 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed' was properly closed.
[0m16:03:18.892885 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m16:03:18.893393 [info ] [MainThread]: 
[0m16:03:18.894144 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m16:03:18.895810 [debug] [MainThread]: Command end result
[0m16:03:18.943880 [info ] [MainThread]: 
[0m16:03:18.945391 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:03:18.947601 [info ] [MainThread]: 
[0m16:03:18.949072 [error] [MainThread]: [33mDatabase Error in test relationships_fact_sales_order_date__metric_date__ref_dim_dates_ (models/gold/fact_sales.yml)[0m
[0m16:03:18.950969 [error] [MainThread]:   No matching signature for operator = for argument types: INT64, DATE. Supported signature: ANY = ANY at [27:8]
[0m16:03:18.953171 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_33dc30e2eee189b676598f310f1620da.sql
[0m16:03:18.955225 [info ] [MainThread]: 
[0m16:03:18.956563 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m16:03:18.957794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fa787190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66faa04fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66faa05cf0>]}
[0m16:03:18.958896 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:03:36.741942 | 7e375c97-fd2a-4872-9fb8-a50c0db35806 ==============================
[0m16:03:36.741942 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:03:36.744035 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m16:03:36.744543 [debug] [MainThread]: Tracking: tracking
[0m16:03:36.746751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04d185360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04d1846a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04d1851e0>]}
[0m16:03:36.798431 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:03:36.932482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:36.933847 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m16:03:36.957098 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m16:03:37.045146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e375c97-fd2a-4872-9fb8-a50c0db35806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04c8280d0>]}
[0m16:03:37.067912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e375c97-fd2a-4872-9fb8-a50c0db35806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04d05a140>]}
[0m16:03:37.068418 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:03:37.068843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e375c97-fd2a-4872-9fb8-a50c0db35806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04ceeb670>]}
[0m16:03:37.073698 [info ] [MainThread]: 
[0m16:03:37.076293 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:03:37.088198 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:03:37.090613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:03:37.092120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:37.093543 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:03:37.094342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:37.095224 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:03:37.133355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:37.170313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:38.614728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e375c97-fd2a-4872-9fb8-a50c0db35806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04d187640>]}
[0m16:03:38.615947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:38.616736 [info ] [MainThread]: 
[0m16:03:38.625194 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:03:38.625793 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:03:38.626352 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:03:38.627754 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:03:38.627102 [info ] [Thread-1 (]: 1 of 11 START test not_null_dim_address_address_sk ............................. [RUN]
[0m16:03:38.631440 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m16:03:38.628369 [info ] [Thread-2 (]: 2 of 11 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m16:03:38.634151 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m16:03:38.634762 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:03:38.630315 [info ] [Thread-4 (]: 4 of 11 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m16:03:38.629756 [info ] [Thread-3 (]: 3 of 11 START test not_null_dim_product_product_sk ............................. [RUN]
[0m16:03:38.632298 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:03:38.641758 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m16:03:38.659329 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_product_product_sk.271feb5417'
[0m16:03:38.690624 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:03:38.677825 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:03:38.699171 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m16:03:38.714230 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 16:03:38.668791 => 2023-07-01 16:03:38.713880
[0m16:03:38.667454 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m16:03:38.725362 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 16:03:38.635177 => 2023-07-01 16:03:38.725228
[0m16:03:38.725920 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:03:38.712453 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m16:03:38.715527 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:03:38.758084 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m16:03:38.768590 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m16:03:38.771739 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m16:03:38.772620 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 16:03:38.699703 => 2023-07-01 16:03:38.772502
[0m16:03:38.773091 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (compile): 2023-07-01 16:03:38.691431 => 2023-07-01 16:03:38.773012
[0m16:03:38.773482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:38.773829 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:03:38.774194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:38.774503 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:03:38.777981 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m16:03:38.780228 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m16:03:38.783695 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m16:03:38.785219 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m16:03:38.818397 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:38.850334 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:38.853964 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m16:03:38.855639 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_product_product_sk.271feb5417: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_product`
where product_sk is null



      
    ) dbt_internal_test
[0m16:03:41.414088 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a5fc45e5-cd74-4030-b455-2754a0cf9246&page=queryresults
[0m16:03:41.418328 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 16:03:38.775033 => 2023-07-01 16:03:41.418158
[0m16:03:41.419532 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:610fe546-8579-47fc-b1cb-5634eb8c08db&page=queryresults
[0m16:03:41.421118 [info ] [Thread-4 (]: 4 of 11 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 2.78s]
[0m16:03:41.422782 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:985cfc0e-6a41-4fd1-bfc9-6fbe92664162&page=queryresults
[0m16:03:41.423590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:16859072-fa39-4bce-8542-7d7d86915aeb&page=queryresults
[0m16:03:41.424664 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 16:03:38.726250 => 2023-07-01 16:03:41.424497
[0m16:03:41.426963 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:03:41.428014 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (execute): 2023-07-01 16:03:38.780738 => 2023-07-01 16:03:41.427901
[0m16:03:41.428836 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 16:03:38.768850 => 2023-07-01 16:03:41.428752
[0m16:03:41.429724 [info ] [Thread-2 (]: 2 of 11 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.80s]
[0m16:03:41.436087 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:03:41.432185 [info ] [Thread-3 (]: 3 of 11 PASS not_null_dim_product_product_sk ................................... [[32mPASS[0m in 2.77s]
[0m16:03:41.439147 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:03:41.437581 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:03:41.430857 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:03:41.434597 [info ] [Thread-1 (]: 1 of 11 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.80s]
[0m16:03:41.440296 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:03:41.441257 [info ] [Thread-2 (]: 6 of 11 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m16:03:41.441974 [info ] [Thread-4 (]: 5 of 11 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m16:03:41.443868 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:03:41.444959 [info ] [Thread-3 (]: 7 of 11 START test unique_dim_address_address_sk ............................... [RUN]
[0m16:03:41.447277 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m16:03:41.448623 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m16:03:41.449971 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:03:41.452968 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m16:03:41.454071 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:03:41.454698 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:03:41.456610 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:03:41.455667 [info ] [Thread-1 (]: 8 of 11 START test unique_dim_dates_metric_date ................................ [RUN]
[0m16:03:41.497767 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m16:03:41.522887 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 16:03:41.457530 => 2023-07-01 16:03:41.522477
[0m16:03:41.520306 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m16:03:41.506423 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m16:03:41.531298 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:03:41.524380 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:03:41.543033 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m16:03:41.548937 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m16:03:41.560113 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m16:03:41.560739 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 16:03:41.481229 => 2023-07-01 16:03:41.560642
[0m16:03:41.561153 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:41.561973 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 16:03:41.473035 => 2023-07-01 16:03:41.561886
[0m16:03:41.562362 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 16:03:41.532623 => 2023-07-01 16:03:41.562295
[0m16:03:41.562711 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:03:41.565002 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:03:41.565490 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:03:41.566622 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:03:41.575492 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m16:03:41.620379 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m16:03:41.626369 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m16:03:41.627299 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:41.628027 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:41.628477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:41.630120 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:41.632281 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m16:03:41.673436 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:43.057426 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator = for argument types: INT64, DATE. Supported signature: ANY = ANY at [27:8]')
[0m16:03:44.010597 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9253060f-893e-4dd1-b5af-fcb467e41a51&page=queryresults
[0m16:03:44.011485 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 16:03:41.544435 => 2023-07-01 16:03:44.011330
[0m16:03:44.016520 [debug] [Thread-2 (]: Database Error in test relationships_fact_sales_order_date__metric_date__ref_dim_dates_ (models/gold/fact_sales.yml)
  No matching signature for operator = for argument types: INT64, DATE. Supported signature: ANY = ANY at [27:8]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_33dc30e2eee189b676598f310f1620da.sql
[0m16:03:44.017392 [error] [Thread-2 (]: 6 of 11 ERROR relationships_fact_sales_order_date__metric_date__ref_dim_dates_ . [[31mERROR[0m in 2.57s]
[0m16:03:44.018478 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:03:44.019154 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:03:44.019836 [info ] [Thread-2 (]: 9 of 11 START test unique_dim_product_product_sk ............................... [RUN]
[0m16:03:44.021273 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c'
[0m16:03:44.021884 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:03:44.033478 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m16:03:44.034997 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (compile): 2023-07-01 16:03:44.022277 => 2023-07-01 16:03:44.034618
[0m16:03:44.035911 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:03:44.044259 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m16:03:44.046066 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:44.050707 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_product_product_sk.2248c4335c: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_product`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:44.135615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8629a781-9d23-4e9c-8207-68b39770c9e4&page=queryresults
[0m16:03:44.136435 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 16:03:41.621007 => 2023-07-01 16:03:44.136360
[0m16:03:44.137449 [info ] [Thread-1 (]: 8 of 11 PASS unique_dim_dates_metric_date ...................................... [[32mPASS[0m in 2.63s]
[0m16:03:44.138134 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:03:44.138886 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:03:44.139633 [info ] [Thread-1 (]: 10 of 11 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m16:03:44.140986 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m16:03:44.141577 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:03:44.153167 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m16:03:44.154071 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 16:03:44.141976 => 2023-07-01 16:03:44.153953
[0m16:03:44.154649 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:03:44.162167 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m16:03:44.163923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:44.168048 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:44.342938 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7e23db57-7f21-4027-8e38-18b2311a7f80&page=queryresults
[0m16:03:44.343737 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 16:03:41.567465 => 2023-07-01 16:03:44.343667
[0m16:03:44.344478 [info ] [Thread-3 (]: 7 of 11 PASS unique_dim_address_address_sk ..................................... [[32mPASS[0m in 2.89s]
[0m16:03:44.345128 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:03:44.345931 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:03:44.346571 [info ] [Thread-3 (]: 11 of 11 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m16:03:44.348090 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m16:03:44.348702 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:03:44.358162 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m16:03:44.358997 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 16:03:44.349116 => 2023-07-01 16:03:44.358877
[0m16:03:44.359603 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:03:44.366719 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m16:03:44.368905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:44.372641 [debug] [Thread-3 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:44.797645 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7c24528f-2503-44f2-9217-b6b67aacda63&page=queryresults
[0m16:03:44.798485 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 16:03:41.613524 => 2023-07-01 16:03:44.798399
[0m16:03:44.799350 [info ] [Thread-4 (]: 5 of 11 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 3.35s]
[0m16:03:44.800075 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:03:46.531453 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:13530bee-ed8b-45a5-8753-4385578afe5d&page=queryresults
[0m16:03:46.531905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d6c6cdd5-0006-400f-b916-b1a7f9a3411f&page=queryresults
[0m16:03:46.532435 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c30afc4b-222f-4564-b255-9a24fde0e19f&page=queryresults
[0m16:03:46.533120 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 16:03:44.360091 => 2023-07-01 16:03:46.533050
[0m16:03:46.533780 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 16:03:44.155048 => 2023-07-01 16:03:46.533710
[0m16:03:46.534482 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (execute): 2023-07-01 16:03:44.036489 => 2023-07-01 16:03:46.534416
[0m16:03:46.535495 [info ] [Thread-3 (]: 11 of 11 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.19s]
[0m16:03:46.537284 [info ] [Thread-1 (]: 10 of 11 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 2.40s]
[0m16:03:46.538892 [info ] [Thread-2 (]: 9 of 11 PASS unique_dim_product_product_sk ..................................... [[32mPASS[0m in 2.52s]
[0m16:03:46.539896 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:03:46.540307 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:03:46.540761 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:03:46.543129 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:03:46.543964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:46.544302 [debug] [MainThread]: Connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e' was properly closed.
[0m16:03:46.544587 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c' was properly closed.
[0m16:03:46.544852 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m16:03:46.545116 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m16:03:46.545447 [info ] [MainThread]: 
[0m16:03:46.546021 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 9.47 seconds (9.47s).
[0m16:03:46.547177 [debug] [MainThread]: Command end result
[0m16:03:46.592768 [info ] [MainThread]: 
[0m16:03:46.594225 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:03:46.595143 [info ] [MainThread]: 
[0m16:03:46.596675 [error] [MainThread]: [33mDatabase Error in test relationships_fact_sales_order_date__metric_date__ref_dim_dates_ (models/gold/fact_sales.yml)[0m
[0m16:03:46.597734 [error] [MainThread]:   No matching signature for operator = for argument types: INT64, DATE. Supported signature: ANY = ANY at [27:8]
[0m16:03:46.598719 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_33dc30e2eee189b676598f310f1620da.sql
[0m16:03:46.600181 [info ] [MainThread]: 
[0m16:03:46.601015 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m16:03:46.602201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0506cf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04c681300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04d059cf0>]}
[0m16:03:46.603029 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:04:35.937583 | bb6ede48-2dd7-47b8-aa0e-b15b99bb1758 ==============================
[0m16:04:35.937583 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:04:35.942583 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:04:35.943464 [debug] [MainThread]: Tracking: tracking
[0m16:04:35.946775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59cca93e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59cca936a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59cca93df0>]}
[0m16:04:36.003191 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:04:36.329822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:36.330378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:36.357211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb6ede48-2dd7-47b8-aa0e-b15b99bb1758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59cc851b70>]}
[0m16:04:36.386681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb6ede48-2dd7-47b8-aa0e-b15b99bb1758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59cc817250>]}
[0m16:04:36.387370 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:04:36.387844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6ede48-2dd7-47b8-aa0e-b15b99bb1758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59cc815240>]}
[0m16:04:36.393725 [info ] [MainThread]: 
[0m16:04:36.398545 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:04:36.400911 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m16:04:36.401794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:37.282765 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:04:37.283377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:37.284188 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:04:37.285116 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:04:37.285434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:37.318917 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:04:37.320360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:37.321158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:38.781752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6ede48-2dd7-47b8-aa0e-b15b99bb1758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ccab2620>]}
[0m16:04:38.782743 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:38.783244 [info ] [MainThread]: 
[0m16:04:38.787417 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m16:04:38.788013 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m16:04:38.789273 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m16:04:38.789748 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m16:04:38.795041 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m16:04:38.796018 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 16:04:38.790163 => 2023-07-01 16:04:38.795847
[0m16:04:38.796950 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m16:04:38.835825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:39.807406 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m16:04:39.808499 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id) as sale_identifier_sk
        , order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m16:04:47.153298 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8bdc1534-55e5-47ff-a462-f999707a5800&page=queryresults
[0m16:04:47.860730 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 16:04:38.797303 => 2023-07-01 16:04:47.860661
[0m16:04:47.861581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6ede48-2dd7-47b8-aa0e-b15b99bb1758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ccab2bc0>]}
[0m16:04:47.862204 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 16.6 MB processed)[0m in 9.07s]
[0m16:04:47.864573 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m16:04:47.866288 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:04:47.867242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:47.867637 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m16:04:47.867910 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m16:04:47.868160 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m16:04:47.868422 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m16:04:47.868766 [info ] [MainThread]: 
[0m16:04:47.869308 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.47 seconds (11.47s).
[0m16:04:47.870167 [debug] [MainThread]: Command end result
[0m16:04:47.888427 [info ] [MainThread]: 
[0m16:04:47.889032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:47.889663 [info ] [MainThread]: 
[0m16:04:47.890211 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:04:47.890894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59cc6cf280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59d0e35570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59cca92ec0>]}
[0m16:04:47.891299 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:04:53.035489 | 0a6f073b-f69e-47ec-be58-e59bca46db4f ==============================
[0m16:04:53.035489 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:04:53.037590 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m16:04:53.038067 [debug] [MainThread]: Tracking: tracking
[0m16:04:53.040019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fcc7ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fcc78820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fcc7ad40>]}
[0m16:04:53.090753 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:04:53.225484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:53.225820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:53.239166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a6f073b-f69e-47ec-be58-e59bca46db4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc83e4a0>]}
[0m16:04:53.264600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a6f073b-f69e-47ec-be58-e59bca46db4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc7f7b80>]}
[0m16:04:53.265494 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:04:53.266172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a6f073b-f69e-47ec-be58-e59bca46db4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc7f78b0>]}
[0m16:04:53.275205 [info ] [MainThread]: 
[0m16:04:53.279257 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:04:53.294372 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:04:53.297205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:04:53.298713 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:04:53.301268 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:04:53.301946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:53.302472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:53.302782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:53.303174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:54.882712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a6f073b-f69e-47ec-be58-e59bca46db4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc7f5f60>]}
[0m16:04:54.883839 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:54.884554 [info ] [MainThread]: 
[0m16:04:54.889618 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:04:54.890254 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:04:54.891083 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:04:54.892805 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:04:54.891928 [info ] [Thread-1 (]: 1 of 11 START test not_null_dim_address_address_sk ............................. [RUN]
[0m16:04:54.894129 [info ] [Thread-2 (]: 2 of 11 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m16:04:54.900146 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m16:04:54.900909 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:04:54.895418 [info ] [Thread-3 (]: 3 of 11 START test not_null_dim_product_product_sk ............................. [RUN]
[0m16:04:54.907651 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_product_product_sk.271feb5417'
[0m16:04:54.908481 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:04:54.896539 [info ] [Thread-4 (]: 4 of 11 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m16:04:54.898781 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m16:04:54.956752 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:04:54.955408 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m16:04:54.956031 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m16:04:54.979908 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m16:04:54.971231 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:04:54.981008 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 16:04:54.901444 => 2023-07-01 16:04:54.980803
[0m16:04:54.986788 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:04:54.968660 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m16:04:55.002912 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m16:04:55.009749 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (compile): 2023-07-01 16:04:54.909294 => 2023-07-01 16:04:55.009553
[0m16:04:55.023256 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m16:04:55.024020 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:04:55.024404 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 16:04:54.957399 => 2023-07-01 16:04:55.024299
[0m16:04:55.024906 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 16:04:54.981397 => 2023-07-01 16:04:55.024824
[0m16:04:55.031166 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:04:55.030609 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:04:55.029593 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m16:04:55.031939 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:04:55.035682 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m16:04:55.037697 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m16:04:55.041530 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m16:04:55.042594 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:04:55.043553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:55.080679 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_product_product_sk.271feb5417: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_product`
where product_sk is null



      
    ) dbt_internal_test
[0m16:04:55.081190 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:04:55.083066 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m16:04:55.120298 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m16:04:58.013960 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cf1bbff4-8b51-4131-a7b3-f60b02311995&page=queryresults
[0m16:04:58.014461 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:520d4640-ab5a-4e20-86e8-7144b3d9fe9b&page=queryresults
[0m16:04:58.014988 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3fb5f4ac-bc05-41ca-9608-21b6dab019da&page=queryresults
[0m16:04:58.015428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:31c22762-c445-498e-bf26-b3a273c2f6b5&page=queryresults
[0m16:04:58.017541 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 16:04:54.987129 => 2023-07-01 16:04:58.017455
[0m16:04:58.018277 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (execute): 2023-07-01 16:04:55.025274 => 2023-07-01 16:04:58.018193
[0m16:04:58.019030 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 16:04:55.038183 => 2023-07-01 16:04:58.018953
[0m16:04:58.019905 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 16:04:55.032675 => 2023-07-01 16:04:58.019834
[0m16:04:58.020828 [info ] [Thread-2 (]: 2 of 11 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 3.12s]
[0m16:04:58.022179 [info ] [Thread-3 (]: 3 of 11 PASS not_null_dim_product_product_sk ................................... [[32mPASS[0m in 3.12s]
[0m16:04:58.023985 [info ] [Thread-4 (]: 4 of 11 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 3.07s]
[0m16:04:58.025428 [info ] [Thread-1 (]: 1 of 11 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 3.13s]
[0m16:04:58.029834 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:04:58.028618 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:04:58.029218 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:04:58.027894 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:04:58.030699 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:04:58.031825 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:04:58.032716 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:04:58.033519 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:04:58.034389 [info ] [Thread-1 (]: 5 of 11 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m16:04:58.035545 [info ] [Thread-3 (]: 6 of 11 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m16:04:58.040029 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m16:04:58.036457 [info ] [Thread-4 (]: 7 of 11 START test unique_dim_address_address_sk ............................... [RUN]
[0m16:04:58.041306 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m16:04:58.038104 [info ] [Thread-2 (]: 8 of 11 START test unique_dim_dates_metric_date ................................ [RUN]
[0m16:04:58.042181 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:04:58.043267 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m16:04:58.043770 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:04:58.044556 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m16:04:58.055142 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m16:04:58.055986 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:04:58.070881 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m16:04:58.071347 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:04:58.083011 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m16:04:58.083597 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 16:04:58.044826 => 2023-07-01 16:04:58.083465
[0m16:04:58.088657 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m16:04:58.089262 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 16:04:58.056326 => 2023-07-01 16:04:58.089151
[0m16:04:58.089671 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:04:58.090128 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 16:04:58.071815 => 2023-07-01 16:04:58.090061
[0m16:04:58.090482 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:04:58.095417 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m16:04:58.095914 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 16:04:58.083981 => 2023-07-01 16:04:58.095800
[0m16:04:58.096412 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:04:58.099816 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m16:04:58.100467 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:04:58.104949 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m16:04:58.105413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:58.109389 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m16:04:58.109933 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:04:58.110865 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:04:58.113052 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m16:04:58.114790 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:04:58.115136 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:04:58.164538 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:58.212107 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:05:00.735007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9de5e19b-a6c5-41bf-a72a-92d34258ceaf&page=queryresults
[0m16:05:00.735902 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 16:04:58.090800 => 2023-07-01 16:05:00.735823
[0m16:05:00.736709 [info ] [Thread-1 (]: 5 of 11 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.70s]
[0m16:05:00.737328 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:05:00.737981 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:05:00.738529 [info ] [Thread-1 (]: 9 of 11 START test unique_dim_product_product_sk ............................... [RUN]
[0m16:05:00.739887 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c'
[0m16:05:00.741324 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:05:00.742182 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:262cf2cf-2d03-4485-a7db-4298a1c65a43&page=queryresults
[0m16:05:00.752375 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m16:05:00.753656 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 16:04:58.105829 => 2023-07-01 16:05:00.753567
[0m16:05:00.754611 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (compile): 2023-07-01 16:05:00.742520 => 2023-07-01 16:05:00.754475
[0m16:05:00.756671 [info ] [Thread-2 (]: 8 of 11 PASS unique_dim_dates_metric_date ...................................... [[32mPASS[0m in 2.71s]
[0m16:05:00.757880 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:05:00.759105 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:05:00.764896 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m16:05:00.765670 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:05:00.766499 [info ] [Thread-2 (]: 10 of 11 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m16:05:00.768064 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m16:05:00.768721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:00.769392 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:05:00.779495 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m16:05:00.781354 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_product_product_sk.2248c4335c: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_product`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:05:00.817257 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 16:05:00.769895 => 2023-07-01 16:05:00.817021
[0m16:05:00.819992 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:05:00.827142 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m16:05:00.827939 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:05:00.829936 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:05:01.087088 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:72c653e7-6e76-4468-b124-8eaa9db45dce&page=queryresults
[0m16:05:01.087941 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 16:04:58.096751 => 2023-07-01 16:05:01.087870
[0m16:05:01.088725 [info ] [Thread-3 (]: 6 of 11 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 3.05s]
[0m16:05:01.089355 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:05:01.090122 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:05:01.090619 [info ] [Thread-3 (]: 11 of 11 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m16:05:01.091803 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m16:05:01.092269 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:05:01.098838 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m16:05:01.099986 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 16:05:01.092542 => 2023-07-01 16:05:01.099807
[0m16:05:01.100797 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:05:01.106844 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m16:05:01.107589 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:05:01.109320 [debug] [Thread-3 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:05:01.283337 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:699c7232-8510-4789-9cca-01a4414f34bb&page=queryresults
[0m16:05:01.284120 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 16:04:58.100878 => 2023-07-01 16:05:01.284042
[0m16:05:01.284942 [info ] [Thread-4 (]: 7 of 11 PASS unique_dim_address_address_sk ..................................... [[32mPASS[0m in 3.24s]
[0m16:05:01.285565 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:05:02.922153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:81dc751c-82ca-4429-9ed5-09443cf7c0af&page=queryresults
[0m16:05:02.923047 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (execute): 2023-07-01 16:05:00.759906 => 2023-07-01 16:05:02.922959
[0m16:05:02.923901 [info ] [Thread-1 (]: 9 of 11 PASS unique_dim_product_product_sk ..................................... [[32mPASS[0m in 2.18s]
[0m16:05:02.924607 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:05:02.965218 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:aecfd8a8-661b-4662-9e15-35d92a05b959&page=queryresults
[0m16:05:02.966703 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 16:05:00.823751 => 2023-07-01 16:05:02.966592
[0m16:05:02.967746 [info ] [Thread-2 (]: 10 of 11 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 2.20s]
[0m16:05:02.968421 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:05:03.742137 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c8bbfc53-4894-44fc-b881-290c445e2275&page=queryresults
[0m16:05:03.742921 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 16:05:01.101070 => 2023-07-01 16:05:03.742842
[0m16:05:03.743758 [info ] [Thread-3 (]: 11 of 11 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.65s]
[0m16:05:03.744418 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:05:03.746392 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:05:03.747353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:03.747733 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728' was properly closed.
[0m16:05:03.748100 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c' was properly closed.
[0m16:05:03.748387 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m16:05:03.748720 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m16:05:03.749065 [info ] [MainThread]: 
[0m16:05:03.749677 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 10.47 seconds (10.47s).
[0m16:05:03.750936 [debug] [MainThread]: Command end result
[0m16:05:03.778012 [info ] [MainThread]: 
[0m16:05:03.778879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:03.779785 [info ] [MainThread]: 
[0m16:05:03.780921 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m16:05:03.781929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ffff8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc5fd060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc5fd7b0>]}
[0m16:05:03.782522 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:05:45.998981 | a8fa387b-4773-4cb6-a24e-44bc87c4ff99 ==============================
[0m16:05:45.998981 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:05:46.001049 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m16:05:46.001787 [debug] [MainThread]: Tracking: tracking
[0m16:05:46.003604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c9c8ae30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c9c8a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c9c8bb50>]}
[0m16:05:46.044957 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:05:46.177233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:46.178591 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m16:05:46.201128 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m16:05:46.290330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8fa387b-4773-4cb6-a24e-44bc87c4ff99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c911c0d0>]}
[0m16:05:46.313518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8fa387b-4773-4cb6-a24e-44bc87c4ff99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c9b5dc30>]}
[0m16:05:46.314058 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:05:46.314494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8fa387b-4773-4cb6-a24e-44bc87c4ff99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c99ef160>]}
[0m16:05:46.319330 [info ] [MainThread]: 
[0m16:05:46.321726 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:05:46.331858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:05:46.333372 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:05:46.333814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:46.334884 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:05:46.335576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:46.336452 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:05:46.337181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:46.378304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:47.786813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8fa387b-4773-4cb6-a24e-44bc87c4ff99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c9b5d540>]}
[0m16:05:47.787679 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:05:47.788143 [info ] [MainThread]: 
[0m16:05:47.792641 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:05:47.793033 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:05:47.793503 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:05:47.794089 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:05:47.794391 [info ] [Thread-1 (]: 1 of 11 START test not_null_dim_address_address_sk ............................. [RUN]
[0m16:05:47.795073 [info ] [Thread-2 (]: 2 of 11 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m16:05:47.795794 [info ] [Thread-3 (]: 3 of 11 START test not_null_dim_product_product_sk ............................. [RUN]
[0m16:05:47.796533 [info ] [Thread-4 (]: 4 of 11 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m16:05:47.798247 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m16:05:47.799733 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m16:05:47.800763 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_product_product_sk.271feb5417'
[0m16:05:47.801788 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m16:05:47.802325 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:05:47.802795 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:05:47.803200 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:05:47.803748 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:05:47.824602 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m16:05:47.832720 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m16:05:47.843211 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m16:05:47.855182 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 16:05:47.804300 => 2023-07-01 16:05:47.854985
[0m16:05:47.858533 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m16:05:47.859115 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:05:47.859573 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 16:05:47.825064 => 2023-07-01 16:05:47.859463
[0m16:05:47.860042 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 16:05:47.835874 => 2023-07-01 16:05:47.859949
[0m16:05:47.882079 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:05:47.887578 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (compile): 2023-07-01 16:05:47.833063 => 2023-07-01 16:05:47.887483
[0m16:05:47.889064 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m16:05:47.889543 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:05:47.892725 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m16:05:47.893129 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:05:47.896203 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m16:05:47.896810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:47.900160 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m16:05:47.900728 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:05:47.901386 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:05:47.903473 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m16:05:47.905319 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m16:05:47.905613 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:05:47.907183 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m16:05:47.975643 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_product_product_sk.271feb5417: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_product`
where product_sk is null



      
    ) dbt_internal_test
[0m16:05:50.443659 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ef9a6bca-dd28-4bab-9089-3a2954038c75&page=queryresults
[0m16:05:50.444118 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:efad1069-dda8-4f37-b4e4-656f88a19197&page=queryresults
[0m16:05:50.444540 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:115449e1-e943-4afb-84b0-78f63e52d0b3&page=queryresults
[0m16:05:50.444906 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4d1265a5-6b2f-4c7b-8622-eb330ebc3c08&page=queryresults
[0m16:05:50.446926 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 16:05:47.889814 => 2023-07-01 16:05:50.446847
[0m16:05:50.447569 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (execute): 2023-07-01 16:05:47.897230 => 2023-07-01 16:05:50.447501
[0m16:05:50.448205 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 16:05:47.893581 => 2023-07-01 16:05:50.448146
[0m16:05:50.448785 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 16:05:47.860602 => 2023-07-01 16:05:50.448725
[0m16:05:50.449588 [info ] [Thread-2 (]: 2 of 11 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.65s]
[0m16:05:50.450994 [info ] [Thread-3 (]: 3 of 11 PASS not_null_dim_product_product_sk ................................... [[32mPASS[0m in 2.65s]
[0m16:05:50.452688 [info ] [Thread-4 (]: 4 of 11 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 2.65s]
[0m16:05:50.454057 [info ] [Thread-1 (]: 1 of 11 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.66s]
[0m16:05:50.457226 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m16:05:50.460654 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:05:50.458511 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m16:05:50.462577 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:05:50.459072 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m16:05:50.461403 [info ] [Thread-2 (]: 5 of 11 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m16:05:50.463271 [info ] [Thread-4 (]: 6 of 11 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m16:05:50.457922 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m16:05:50.470539 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:05:50.467112 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m16:05:50.472981 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:05:50.464384 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:05:50.479537 [info ] [Thread-1 (]: 7 of 11 START test unique_dim_address_address_sk ............................... [RUN]
[0m16:05:50.469184 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m16:05:50.483263 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:05:50.481016 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m16:05:50.471719 [info ] [Thread-3 (]: 8 of 11 START test unique_dim_dates_metric_date ................................ [RUN]
[0m16:05:50.489782 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:05:50.507643 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m16:05:50.506475 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m16:05:50.510284 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m16:05:50.516603 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:05:50.541184 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m16:05:50.542311 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 16:05:50.483724 => 2023-07-01 16:05:50.542139
[0m16:05:50.543634 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:05:50.548640 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m16:05:50.549450 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m16:05:50.549893 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 16:05:50.473716 => 2023-07-01 16:05:50.549812
[0m16:05:50.550320 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:05:50.550781 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:05:50.551069 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 16:05:50.524798 => 2023-07-01 16:05:50.550998
[0m16:05:50.556351 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m16:05:50.557850 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:05:50.560007 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:05:50.560404 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 16:05:50.510753 => 2023-07-01 16:05:50.560290
[0m16:05:50.564117 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m16:05:50.564518 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:05:50.598980 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:05:50.602894 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m16:05:50.604492 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m16:05:50.604913 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:05:50.640729 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:05:50.641143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:50.679893 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:05:52.690854 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0c0c7207-b450-4e93-a009-23e0a1a1a10d&page=queryresults
[0m16:05:52.698952 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 16:05:50.544137 => 2023-07-01 16:05:52.698864
[0m16:05:52.700472 [info ] [Thread-4 (]: 6 of 11 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.23s]
[0m16:05:52.701307 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m16:05:52.702255 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:05:52.702728 [info ] [Thread-4 (]: 9 of 11 START test unique_dim_product_product_sk ............................... [RUN]
[0m16:05:52.703745 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c'
[0m16:05:52.704152 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:05:52.710321 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m16:05:52.711164 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (compile): 2023-07-01 16:05:52.704375 => 2023-07-01 16:05:52.711006
[0m16:05:52.711807 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:05:52.716692 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m16:05:52.717365 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:05:52.720512 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_product_product_sk.2248c4335c: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_product`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:05:52.948374 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5c870955-f582-4851-a22c-ad5499f52d08&page=queryresults
[0m16:05:52.949189 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 16:05:50.551319 => 2023-07-01 16:05:52.949101
[0m16:05:52.950177 [info ] [Thread-2 (]: 5 of 11 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.48s]
[0m16:05:52.950828 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m16:05:52.951528 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:05:52.952010 [info ] [Thread-2 (]: 10 of 11 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m16:05:52.953175 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m16:05:52.953564 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:05:52.958942 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m16:05:52.959528 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 16:05:52.953783 => 2023-07-01 16:05:52.959447
[0m16:05:52.959881 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:05:52.963289 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m16:05:52.964432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:05:52.966257 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:05:53.005434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4bad2405-6dc5-47c3-95e4-0982c883f92d&page=queryresults
[0m16:05:53.006842 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 16:05:50.600024 => 2023-07-01 16:05:53.006703
[0m16:05:53.008388 [info ] [Thread-1 (]: 7 of 11 PASS unique_dim_address_address_sk ..................................... [[32mPASS[0m in 2.53s]
[0m16:05:53.009440 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m16:05:53.010292 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:05:53.010764 [info ] [Thread-1 (]: 11 of 11 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m16:05:53.012273 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m16:05:53.012819 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:05:53.018801 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m16:05:53.019507 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 16:05:53.013036 => 2023-07-01 16:05:53.019373
[0m16:05:53.020010 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:05:53.023156 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m16:05:53.023805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:53.026588 [debug] [Thread-1 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:05:53.066169 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:75b55c78-5f43-424d-92e7-e2e7f148e525&page=queryresults
[0m16:05:53.071218 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 16:05:50.560906 => 2023-07-01 16:05:53.071095
[0m16:05:53.073075 [info ] [Thread-3 (]: 8 of 11 PASS unique_dim_dates_metric_date ...................................... [[32mPASS[0m in 2.57s]
[0m16:05:53.074013 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m16:05:54.945814 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0de12735-6eb5-47fc-9c40-401eb1ec13de&page=queryresults
[0m16:05:54.948102 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (execute): 2023-07-01 16:05:52.712232 => 2023-07-01 16:05:54.947951
[0m16:05:54.953751 [info ] [Thread-4 (]: 9 of 11 PASS unique_dim_product_product_sk ..................................... [[32mPASS[0m in 2.25s]
[0m16:05:54.954499 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m16:05:55.352200 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a624117a-961b-4709-af21-646888ba143e&page=queryresults
[0m16:05:55.353190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:00787ea7-7a98-49c9-bab4-83efab225547&page=queryresults
[0m16:05:55.355135 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 16:05:52.960121 => 2023-07-01 16:05:55.354909
[0m16:05:55.357209 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 16:05:53.020229 => 2023-07-01 16:05:55.357007
[0m16:05:55.359226 [info ] [Thread-2 (]: 10 of 11 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 2.41s]
[0m16:05:55.362700 [info ] [Thread-1 (]: 11 of 11 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.35s]
[0m16:05:55.365405 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m16:05:55.367204 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m16:05:55.371771 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:05:55.373065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:55.373577 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c' was properly closed.
[0m16:05:55.374014 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed' was properly closed.
[0m16:05:55.374430 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m16:05:55.374846 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m16:05:55.375462 [info ] [MainThread]: 
[0m16:05:55.377516 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 9.06 seconds (9.06s).
[0m16:05:55.381447 [debug] [MainThread]: Command end result
[0m16:05:55.423744 [info ] [MainThread]: 
[0m16:05:55.425035 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:55.426617 [info ] [MainThread]: 
[0m16:05:55.427819 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m16:05:55.428937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c8f91660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c99ef040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c8f7c1c0>]}
[0m16:05:55.429875 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:06:23.867746 | ac21fe92-796b-47e7-8c8f-c1b791bf4506 ==============================
[0m16:06:23.867746 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:06:23.871106 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:06:23.871784 [debug] [MainThread]: Tracking: tracking
[0m16:06:23.875141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc388e620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc388dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc388e4d0>]}
[0m16:06:23.936647 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:06:24.114415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:06:24.116094 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m16:06:24.144596 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m16:06:24.264861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac21fe92-796b-47e7-8c8f-c1b791bf4506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc2d140d0>]}
[0m16:06:24.299811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac21fe92-796b-47e7-8c8f-c1b791bf4506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc37618a0>]}
[0m16:06:24.300637 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:06:24.301433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac21fe92-796b-47e7-8c8f-c1b791bf4506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc35eee60>]}
[0m16:06:24.307741 [info ] [MainThread]: 
[0m16:06:24.311838 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:06:24.314241 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m16:06:24.315702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:25.263661 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:06:25.265843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:06:25.266357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:25.267745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:06:25.315178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:25.269120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:25.313955 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:06:25.397963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:26.831414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac21fe92-796b-47e7-8c8f-c1b791bf4506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc3761330>]}
[0m16:06:26.832409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:26.832867 [info ] [MainThread]: 
[0m16:06:26.837913 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m16:06:26.838718 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m16:06:26.840275 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m16:06:26.840902 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m16:06:26.846958 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m16:06:26.847777 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 16:06:26.841303 => 2023-07-01 16:06:26.847644
[0m16:06:26.848388 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m16:06:26.874981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:27.958667 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m16:06:27.959750 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m16:06:35.289583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a18920c8-4628-4aaf-b766-1f100cd55893&page=queryresults
[0m16:06:36.007266 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 16:06:26.848747 => 2023-07-01 16:06:36.007197
[0m16:06:36.008741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac21fe92-796b-47e7-8c8f-c1b791bf4506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc2bb8970>]}
[0m16:06:36.009870 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 16.6 MB processed)[0m in 9.17s]
[0m16:06:36.014459 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m16:06:36.016163 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:06:36.016977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:36.017303 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m16:06:36.017548 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m16:06:36.017786 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m16:06:36.018039 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m16:06:36.018405 [info ] [MainThread]: 
[0m16:06:36.018856 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.71 seconds (11.71s).
[0m16:06:36.019717 [debug] [MainThread]: Command end result
[0m16:06:36.048297 [info ] [MainThread]: 
[0m16:06:36.049168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:36.049935 [info ] [MainThread]: 
[0m16:06:36.050687 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:06:36.051828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc3761960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc35eece0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc2ba5ff0>]}
[0m16:06:36.052694 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:06:55.719186 | a0596d73-84b0-493e-873a-f559061e7ff6 ==============================
[0m16:06:55.719186 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:06:55.725237 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:06:55.726097 [debug] [MainThread]: Tracking: tracking
[0m16:06:55.728702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f22f87340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f22f86710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f22f86ec0>]}
[0m16:06:55.784346 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:06:56.036925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:06:56.040044 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m16:06:56.084296 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m16:06:56.266201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0596d73-84b0-493e-873a-f559061e7ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f224240d0>]}
[0m16:06:56.314516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0596d73-84b0-493e-873a-f559061e7ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f22e59b70>]}
[0m16:06:56.315201 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:06:56.315826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0596d73-84b0-493e-873a-f559061e7ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f22ce7130>]}
[0m16:06:56.321506 [info ] [MainThread]: 
[0m16:06:56.325529 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:06:56.327566 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m16:06:56.328385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:57.337179 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:06:57.337771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:57.338592 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:06:57.339592 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:06:57.340179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:57.340919 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:06:57.374246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:57.376105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:58.647538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0596d73-84b0-493e-873a-f559061e7ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f22e59600>]}
[0m16:06:58.648491 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:58.648958 [info ] [MainThread]: 
[0m16:06:58.654486 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m16:06:58.655543 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m16:06:58.657148 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m16:06:58.657754 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m16:06:58.664221 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m16:06:58.665142 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 16:06:58.658140 => 2023-07-01 16:06:58.664953
[0m16:06:58.665839 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m16:06:58.702193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:59.546453 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m16:06:59.547623 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m16:07:07.047929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4832dad9-59e3-4ab0-aea0-8db0f56a2c4c&page=queryresults
[0m16:07:08.061518 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 16:06:58.666648 => 2023-07-01 16:07:08.061376
[0m16:07:08.063208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0596d73-84b0-493e-873a-f559061e7ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f2229b850>]}
[0m16:07:08.064211 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 16.6 MB processed)[0m in 9.41s]
[0m16:07:08.067663 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m16:07:08.072079 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:07:08.073304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:08.073818 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m16:07:08.074274 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m16:07:08.074723 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m16:07:08.075185 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m16:07:08.075731 [info ] [MainThread]: 
[0m16:07:08.078828 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.75 seconds (11.75s).
[0m16:07:08.080228 [debug] [MainThread]: Command end result
[0m16:07:08.118476 [info ] [MainThread]: 
[0m16:07:08.119348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:08.120345 [info ] [MainThread]: 
[0m16:07:08.121084 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:07:08.122143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f22ce6f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f22ce6fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f22cfa560>]}
[0m16:07:08.122814 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:07:58.344553 | eedd5cb8-8c25-4a1e-9ab2-914972bf9bd4 ==============================
[0m16:07:58.344553 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:07:58.349173 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:07:58.349800 [debug] [MainThread]: Tracking: tracking
[0m16:07:58.352940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c228e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c228d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c228e3b0>]}
[0m16:07:58.418051 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:07:58.618955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:58.620414 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m16:07:58.651598 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m16:07:58.794103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eedd5cb8-8c25-4a1e-9ab2-914972bf9bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c17100d0>]}
[0m16:07:58.835626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eedd5cb8-8c25-4a1e-9ab2-914972bf9bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c2161a50>]}
[0m16:07:58.836229 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:07:58.836701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eedd5cb8-8c25-4a1e-9ab2-914972bf9bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c1fef010>]}
[0m16:07:58.840624 [info ] [MainThread]: 
[0m16:07:58.844735 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:07:58.846820 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m16:07:58.847655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:59.747284 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:07:59.747922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:59.748789 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:07:59.749777 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:07:59.750272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:59.750660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:59.751392 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:07:59.862869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:01.132606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eedd5cb8-8c25-4a1e-9ab2-914972bf9bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c21614e0>]}
[0m16:08:01.133431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:08:01.133953 [info ] [MainThread]: 
[0m16:08:01.137643 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m16:08:01.138168 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m16:08:01.139252 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m16:08:01.139705 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m16:08:01.144758 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m16:08:01.146239 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 16:08:01.139957 => 2023-07-01 16:08:01.146082
[0m16:08:01.146733 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m16:08:01.174528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:02.159297 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m16:08:02.160462 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , order_id 
        , order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m16:08:03.808229 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: order_id; Did you mean order_qty? at [28:11]')
[0m16:08:05.641067 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8c739a80-2129-49ed-912d-fc838be6a4b8&page=queryresults
[0m16:08:05.641809 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 16:08:01.147158 => 2023-07-01 16:08:05.641676
[0m16:08:05.644953 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Unrecognized name: order_id; Did you mean order_qty? at [28:11]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m16:08:05.645552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eedd5cb8-8c25-4a1e-9ab2-914972bf9bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c15f0af0>]}
[0m16:08:05.646268 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 4.51s]
[0m16:08:05.648680 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m16:08:05.650637 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:08:05.652050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:05.652574 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m16:08:05.652993 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m16:08:05.653428 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m16:08:05.653872 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m16:08:05.654443 [info ] [MainThread]: 
[0m16:08:05.655555 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.81 seconds (6.81s).
[0m16:08:05.656746 [debug] [MainThread]: Command end result
[0m16:08:05.681413 [info ] [MainThread]: 
[0m16:08:05.682091 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:08:05.683097 [info ] [MainThread]: 
[0m16:08:05.684110 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m16:08:05.685027 [error] [MainThread]:   Unrecognized name: order_id; Did you mean order_qty? at [28:11]
[0m16:08:05.685606 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m16:08:05.686268 [info ] [MainThread]: 
[0m16:08:05.686951 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:08:05.688246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c2161b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c1feee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c1feeec0>]}
[0m16:08:05.688790 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 16:08:41.825775 | 30af1734-8836-46fc-bf69-19afc8c9cd14 ==============================
[0m16:08:41.825775 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:08:41.828326 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:08:41.829074 [debug] [MainThread]: Tracking: tracking
[0m16:08:41.832592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4ca89270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4ca886a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4ca891e0>]}
[0m16:08:41.880856 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:08:42.082091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:08:42.084995 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m16:08:42.119515 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m16:08:42.246740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30af1734-8836-46fc-bf69-19afc8c9cd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4c12c0d0>]}
[0m16:08:42.283820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30af1734-8836-46fc-bf69-19afc8c9cd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4c95e140>]}
[0m16:08:42.284389 [info ] [MainThread]: Found 45 models, 11 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m16:08:42.284989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30af1734-8836-46fc-bf69-19afc8c9cd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4c7eb670>]}
[0m16:08:42.291632 [info ] [MainThread]: 
[0m16:08:42.295547 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:08:42.297812 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m16:08:42.298749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:43.298678 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m16:08:43.299792 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m16:08:43.300117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:43.301052 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m16:08:43.301630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:43.302309 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m16:08:43.302995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:43.337512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:44.540203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30af1734-8836-46fc-bf69-19afc8c9cd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4c95db10>]}
[0m16:08:44.541293 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:08:44.541888 [info ] [MainThread]: 
[0m16:08:44.546374 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m16:08:44.546901 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m16:08:44.548006 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m16:08:44.548390 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m16:08:44.552830 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m16:08:44.553607 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 16:08:44.548620 => 2023-07-01 16:08:44.553465
[0m16:08:44.554488 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m16:08:44.581892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:45.576871 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m16:08:45.578020 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by territory_id) as territory_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m16:08:53.545657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6dbeb365-07a2-4bc8-9436-5cd71c4849b6&page=queryresults
[0m16:08:54.367714 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 16:08:44.555075 => 2023-07-01 16:08:54.367650
[0m16:08:54.368579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30af1734-8836-46fc-bf69-19afc8c9cd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4c12ce20>]}
[0m16:08:54.369137 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 16.6 MB processed)[0m in 9.82s]
[0m16:08:54.371324 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m16:08:54.373074 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:08:54.373856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:54.374232 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m16:08:54.374540 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m16:08:54.374822 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m16:08:54.375283 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m16:08:54.375724 [info ] [MainThread]: 
[0m16:08:54.376325 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.08 seconds (12.08s).
[0m16:08:54.377168 [debug] [MainThread]: Command end result
[0m16:08:54.407607 [info ] [MainThread]: 
[0m16:08:54.408727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:54.409603 [info ] [MainThread]: 
[0m16:08:54.410495 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:08:54.412136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4c7fa020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4ffd2560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4c7eb520>]}
[0m16:08:54.413206 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:05:16.576993 | 5a638bbd-caba-46f0-bb06-f206f0b34287 ==============================
[0m17:05:16.576993 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:05:16.581787 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:05:16.582332 [debug] [MainThread]: Tracking: tracking
[0m17:05:16.584763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a655ece0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a655c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a655ed40>]}
[0m17:05:16.641776 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:05:16.844339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:05:16.846628 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m17:05:16.847171 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m17:05:16.847767 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m17:05:16.878714 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m17:05:16.898937 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m17:05:17.002031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a6124e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a6124670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a6119300>]}
[0m17:05:17.002770 [debug] [MainThread]: Flushing usage events
[0m17:05:18.821515 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two tests with the name "relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_" defined on column "customer_fk" in "models.fact_sales".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64 (models/gold/fact_sales.yml)
  - test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64 (models/gold/fact_sales.yml)


============================== 2023-07-01 17:06:25.192919 | 2f8c55d9-8e25-4b35-8ae9-0d0baadbac5b ==============================
[0m17:06:25.192919 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:06:25.195249 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:06:25.195742 [debug] [MainThread]: Tracking: tracking
[0m17:06:25.197718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4239e8bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4239e8a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4239e8ab90>]}
[0m17:06:25.238695 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:06:25.400043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:06:25.401540 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m17:06:25.402006 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m17:06:25.402347 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m17:06:25.426008 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m17:06:25.441750 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m17:06:25.538490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4239c48e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4239c485e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4239c3da20>]}
[0m17:06:25.538931 [debug] [MainThread]: Flushing usage events
[0m17:06:26.638098 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two tests with the name "relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_" defined on column "customer_fk" in "models.fact_sales".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64 (models/gold/fact_sales.yml)
  - test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64 (models/gold/fact_sales.yml)


============================== 2023-07-01 17:07:01.992566 | 018acff9-c0c0-4f6b-9924-1ad68f45c691 ==============================
[0m17:07:01.992566 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:07:01.994669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:07:01.995169 [debug] [MainThread]: Tracking: tracking
[0m17:07:01.996826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d4176d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d4174820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d4176d40>]}
[0m17:07:02.035442 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:07:02.174953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:07:02.176470 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m17:07:02.176947 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_address.sql
[0m17:07:02.177318 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m17:07:02.199924 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m17:07:02.215396 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m17:07:02.302824 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m17:07:02.340966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '018acff9-c0c0-4f6b-9924-1ad68f45c691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d3cf3fa0>]}
[0m17:07:02.369637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '018acff9-c0c0-4f6b-9924-1ad68f45c691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d3e3a1a0>]}
[0m17:07:02.370151 [info ] [MainThread]: Found 45 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:07:02.370644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '018acff9-c0c0-4f6b-9924-1ad68f45c691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d3cdf1f0>]}
[0m17:07:02.374290 [info ] [MainThread]: 
[0m17:07:02.376613 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:07:02.377956 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:07:02.378352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:03.389884 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:07:03.390511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:03.391233 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:07:03.392249 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:07:03.393225 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:07:03.393540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:03.427895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:03.428623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:05.012350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '018acff9-c0c0-4f6b-9924-1ad68f45c691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d3cec760>]}
[0m17:07:05.013306 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:07:05.013853 [info ] [MainThread]: 
[0m17:07:05.018034 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m17:07:05.018974 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_address ............... [RUN]
[0m17:07:05.020462 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m17:07:05.021208 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m17:07:05.036537 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m17:07:05.038809 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-07-01 17:07:05.021657 => 2023-07-01 17:07:05.038623
[0m17:07:05.039651 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m17:07:05.076285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:05.957063 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m17:07:05.959194 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, contact_type_worker as (
	select  * 
    from  `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type` 
)

, union_person_addres as (
    select
        business_entity_address.address_id
        , business_entity_id
        , business_entity_address.address_type_id
        , concat(address_line1, ' ', ifnull('',address_line2), ' ', postal_code) as address
        , city
        , state_province_id
        , address_type_name
    from business_entity_address
    left join address
    on address.address_id = business_entity_address.address_id
   	left join address_type
   	on address_type.address_type_id = business_entity_address.address_type_id
)

, union_contact_type as (
	select 
		union_person_addres.*
		, person_id as worker_id
		, contact_type_worker.contact_type_id 
		, contact_type_name as contact_type_name_worker
	from union_person_addres
	left join business_entity_contact
	on business_entity_contact.business_entity_id = union_person_addres.business_entity_id 
	left join contact_type_worker
	on contact_type_worker.contact_type_id = business_entity_contact.contact_type_id
)

select * 
from union_contact_type
    );
  
[0m17:07:09.829508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f9bac7a1-dd68-42f7-9b79-e5ff520440fe&page=queryresults
[0m17:07:09.860425 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-07-01 17:07:05.040216 => 2023-07-01 17:07:09.860347
[0m17:07:09.861470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '018acff9-c0c0-4f6b-9924-1ad68f45c691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d3674af0>]}
[0m17:07:09.862098 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_address .......... [[32mCREATE TABLE (19.7k rows, 1.5 MB processed)[0m in 4.84s]
[0m17:07:09.864920 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m17:07:09.866686 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:07:09.867590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:09.867932 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:07:09.868207 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:07:09.868538 [debug] [MainThread]: Connection 'model.desafioaethaina.int_address' was properly closed.
[0m17:07:09.868804 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:07:09.869121 [info ] [MainThread]: 
[0m17:07:09.869662 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.49 seconds (7.49s).
[0m17:07:09.870433 [debug] [MainThread]: Command end result
[0m17:07:09.901793 [info ] [MainThread]: 
[0m17:07:09.902833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:09.903682 [info ] [MainThread]: 
[0m17:07:09.904580 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:07:09.905587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d8251540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d3d0b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d3f90e50>]}
[0m17:07:09.906882 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:14:52.201404 | 8f1f602f-a165-431e-8645-05562531220f ==============================
[0m17:14:52.201404 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:14:52.203396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:14:52.203845 [debug] [MainThread]: Tracking: tracking
[0m17:14:52.205926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e347a440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e347a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e347a3b0>]}
[0m17:14:52.263932 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:14:52.407542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:14:52.408643 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m17:14:52.409161 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m17:14:52.434313 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m17:14:52.451811 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m17:14:52.546130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e2fe3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e30388b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e303a410>]}
[0m17:14:52.546679 [debug] [MainThread]: Flushing usage events
[0m17:14:54.004948 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_fact_sales_ship_to_address_fk__customer_sk__ref_dim_address_ (models/gold/fact_sales.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'int_addressto'


============================== 2023-07-01 17:16:11.325106 | 1ac6f7b8-c8e6-4646-901e-8e25be5ebb8d ==============================
[0m17:16:11.325106 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:16:11.327193 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:16:11.327745 [debug] [MainThread]: Tracking: tracking
[0m17:16:11.329575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8a93ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8a934f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8a93c40>]}
[0m17:16:11.376050 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:16:11.512090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:11.512946 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m17:16:11.535064 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m17:16:11.610690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ac6f7b8-c8e6-4646-901e-8e25be5ebb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f812e860>]}
[0m17:16:11.635106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ac6f7b8-c8e6-4646-901e-8e25be5ebb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8974790>]}
[0m17:16:11.635654 [info ] [MainThread]: Found 45 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:16:11.636321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac6f7b8-c8e6-4646-901e-8e25be5ebb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f87fb340>]}
[0m17:16:11.640199 [info ] [MainThread]: 
[0m17:16:11.642749 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:16:11.644096 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:16:11.644720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:12.861060 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:16:12.861776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:12.862568 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:16:12.863495 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:16:12.898499 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:16:12.898962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:12.899578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:12.899967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:14.104509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac6f7b8-c8e6-4646-901e-8e25be5ebb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f89740d0>]}
[0m17:16:14.105439 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:16:14.105909 [info ] [MainThread]: 
[0m17:16:14.111370 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m17:16:14.112250 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m17:16:14.113645 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m17:16:14.114120 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m17:16:14.119218 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m17:16:14.119986 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 17:16:14.114411 => 2023-07-01 17:16:14.119852
[0m17:16:14.120674 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m17:16:14.153528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:15.137964 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m17:16:15.138985 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
            , worker_id 
        order by address_id) as dedup_index
    from int_address
)

, prodcut_with_sk  as (
    select
        row_number() over (order by business_entity_id) as address_sk
        , address_id
        , address_type_id
        , contact_type_id
        , worker_id
        , contact_type_id
        , contact_type_name_worker
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m17:16:16.529358 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name contact_type_id at [13:7]')
[0m17:16:17.978487 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:43cd9720-c9a5-4681-a45c-cf94c04bf85c&page=queryresults
[0m17:16:17.980898 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 17:16:14.121509 => 2023-07-01 17:16:17.980567
[0m17:16:17.989732 [debug] [Thread-1 (]: Database Error in model dim_address (models/gold/dim_address.sql)
  CREATE TABLE has columns with duplicate name contact_type_id at [13:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_address.sql
[0m17:16:17.990997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac6f7b8-c8e6-4646-901e-8e25be5ebb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ebd7e470>]}
[0m17:16:17.992056 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_address .............. [[31mERROR[0m in 3.88s]
[0m17:16:17.995704 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m17:16:17.999933 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:16:18.001693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:18.002564 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:16:18.003304 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m17:16:18.003885 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:16:18.004321 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:16:18.005158 [info ] [MainThread]: 
[0m17:16:18.006167 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.36 seconds (6.36s).
[0m17:16:18.007581 [debug] [MainThread]: Command end result
[0m17:16:18.066065 [info ] [MainThread]: 
[0m17:16:18.066867 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:16:18.067678 [info ] [MainThread]: 
[0m17:16:18.068390 [error] [MainThread]: [33mDatabase Error in model dim_address (models/gold/dim_address.sql)[0m
[0m17:16:18.069147 [error] [MainThread]:   CREATE TABLE has columns with duplicate name contact_type_id at [13:7]
[0m17:16:18.069844 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_address.sql
[0m17:16:18.070655 [info ] [MainThread]: 
[0m17:16:18.071488 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:16:18.072453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fbfdb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8974880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f8974820>]}
[0m17:16:18.073726 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:16:32.747868 | be02a053-a44a-4550-b557-809f1eae1154 ==============================
[0m17:16:32.747868 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:16:32.749787 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:16:32.750414 [debug] [MainThread]: Tracking: tracking
[0m17:16:32.752159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179f977af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179f974e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179f976530>]}
[0m17:16:32.804438 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:16:32.947101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:32.948004 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m17:16:32.974004 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m17:16:33.053218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be02a053-a44a-4550-b557-809f1eae1154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179ec0c0d0>]}
[0m17:16:33.076979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be02a053-a44a-4550-b557-809f1eae1154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179f65a6b0>]}
[0m17:16:33.077494 [info ] [MainThread]: Found 45 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:16:33.077937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be02a053-a44a-4550-b557-809f1eae1154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179f4dfca0>]}
[0m17:16:33.085054 [info ] [MainThread]: 
[0m17:16:33.088841 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:16:33.091075 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:16:33.091961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:33.964329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:16:33.964929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:33.965917 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:16:33.968917 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:16:34.000354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:34.002672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:16:34.003311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:34.037646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:35.185985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be02a053-a44a-4550-b557-809f1eae1154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179f65a1d0>]}
[0m17:16:35.186908 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:16:35.187515 [info ] [MainThread]: 
[0m17:16:35.192314 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m17:16:35.193094 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m17:16:35.194630 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m17:16:35.195284 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m17:16:35.202596 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m17:16:35.204349 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 17:16:35.195858 => 2023-07-01 17:16:35.203840
[0m17:16:35.206415 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m17:16:35.248678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:36.110519 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m17:16:36.111620 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
            , worker_id 
        order by address_id) as dedup_index
    from int_address
)

, prodcut_with_sk  as (
    select
        row_number() over (order by business_entity_id) as address_sk
        , address_id
        , address_type_id
        , contact_type_id
        , worker_id
        , contact_type_name_worker
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m17:16:39.572306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:60caca30-1f60-497f-b3bf-dd8c9a272b27&page=queryresults
[0m17:16:40.704898 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 17:16:35.207293 => 2023-07-01 17:16:40.704833
[0m17:16:40.705830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be02a053-a44a-4550-b557-809f1eae1154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179ea96fe0>]}
[0m17:16:40.706355 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.7k rows, 1.4 MB processed)[0m in 5.51s]
[0m17:16:40.709511 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m17:16:40.711310 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:16:40.712219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:40.712589 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:16:40.712856 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:16:40.713099 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m17:16:40.713344 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:16:40.713666 [info ] [MainThread]: 
[0m17:16:40.714220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m17:16:40.715013 [debug] [MainThread]: Command end result
[0m17:16:40.750254 [info ] [MainThread]: 
[0m17:16:40.751817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:40.753374 [info ] [MainThread]: 
[0m17:16:40.755648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:16:40.758406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179f4df100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a2cc33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179f65a740>]}
[0m17:16:40.759938 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:17:23.250125 | 8c7b2021-6d43-40a8-bb73-2deb5072e004 ==============================
[0m17:17:23.250125 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:17:23.252341 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:17:23.253220 [debug] [MainThread]: Tracking: tracking
[0m17:17:23.260074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89476688e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8947668fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8947668820>]}
[0m17:17:23.327491 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:17:23.596661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:23.597074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:23.614436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c7b2021-6d43-40a8-bb73-2deb5072e004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89472380d0>]}
[0m17:17:23.648492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c7b2021-6d43-40a8-bb73-2deb5072e004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8947200760>]}
[0m17:17:23.649130 [info ] [MainThread]: Found 45 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:17:23.649755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c7b2021-6d43-40a8-bb73-2deb5072e004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89472007c0>]}
[0m17:17:23.657169 [info ] [MainThread]: 
[0m17:17:23.661251 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:17:23.664348 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:17:23.665215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:24.583058 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:17:24.584179 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:17:24.584852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:24.585697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:17:24.586028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:24.587033 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:17:24.621536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:24.622383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:26.194924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c7b2021-6d43-40a8-bb73-2deb5072e004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894766b100>]}
[0m17:17:26.195914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:17:26.196411 [info ] [MainThread]: 
[0m17:17:26.200977 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m17:17:26.201699 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m17:17:26.202761 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m17:17:26.203203 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m17:17:26.208824 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m17:17:26.209936 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 17:17:26.203450 => 2023-07-01 17:17:26.209781
[0m17:17:26.210565 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m17:17:26.263961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:27.225554 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m17:17:27.226703 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
            , worker_id 
        order by address_id) as dedup_index
    from int_address
)

, prodcut_with_sk  as (
    select
        row_number() over (order by business_entity_id) as address_sk
        , address_id
        , address_type_id
        , contact_type_id
        , worker_id
        , contact_type_name_worker
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m17:17:30.486398 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e4dbf96a-268f-40cc-8ed7-f8f44e4779bb&page=queryresults
[0m17:17:31.384261 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 17:17:26.210981 => 2023-07-01 17:17:31.384191
[0m17:17:31.385292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c7b2021-6d43-40a8-bb73-2deb5072e004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894766af20>]}
[0m17:17:31.385923 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.7k rows, 1.4 MB processed)[0m in 5.18s]
[0m17:17:31.389553 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m17:17:31.391327 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:17:31.392109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:31.392510 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m17:17:31.392811 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:17:31.393064 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:17:31.393310 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:17:31.393616 [info ] [MainThread]: 
[0m17:17:31.394150 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.74 seconds (7.74s).
[0m17:17:31.394994 [debug] [MainThread]: Command end result
[0m17:17:31.427724 [info ] [MainThread]: 
[0m17:17:31.429996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:31.431096 [info ] [MainThread]: 
[0m17:17:31.432509 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:17:31.433948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89472245b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89470e00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89470e01c0>]}
[0m17:17:31.435459 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:17:56.052704 | ea4d4ba8-a232-4883-8e52-cd409f49085a ==============================
[0m17:17:56.052704 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:17:56.055089 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:17:56.055961 [debug] [MainThread]: Tracking: tracking
[0m17:17:56.058334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb074e8e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb074e8d3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb074e8e3e0>]}
[0m17:17:56.110733 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:17:56.247102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:56.248094 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m17:17:56.270815 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m17:17:56.352487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea4d4ba8-a232-4883-8e52-cd409f49085a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0743240d0>]}
[0m17:17:56.376289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea4d4ba8-a232-4883-8e52-cd409f49085a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb074d6a050>]}
[0m17:17:56.376803 [info ] [MainThread]: Found 45 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:17:56.377245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea4d4ba8-a232-4883-8e52-cd409f49085a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb074bf3640>]}
[0m17:17:56.380960 [info ] [MainThread]: 
[0m17:17:56.384887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:17:56.387510 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:17:56.388013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:57.309606 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:17:57.310194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:57.310916 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:17:57.311864 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:17:57.347733 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:17:57.348541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:57.349083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:57.349556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:58.750506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea4d4ba8-a232-4883-8e52-cd409f49085a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb074d69b70>]}
[0m17:17:58.751432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:17:58.751899 [info ] [MainThread]: 
[0m17:17:58.755617 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m17:17:58.756177 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m17:17:58.757353 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m17:17:58.757976 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m17:17:58.762424 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m17:17:58.763583 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 17:17:58.758427 => 2023-07-01 17:17:58.763447
[0m17:17:58.764024 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m17:17:58.800302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:59.791215 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m17:17:59.792333 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
            , worker_id 
        order by address_id) as dedup_index
    from int_address
)

, prodcut_with_sk  as (
    select
        row_number() over (order by address_id, business_entity_id) as address_sk
        , business_entity_id
        , address_id
        , address_type_id
        , contact_type_id
        , worker_id
        , contact_type_name_worker
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m17:18:03.444476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0c9a9fe2-684f-4191-b2dd-3413748fb765&page=queryresults
[0m17:18:04.469636 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 17:17:58.764285 => 2023-07-01 17:18:04.469533
[0m17:18:04.471153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea4d4ba8-a232-4883-8e52-cd409f49085a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0741a3340>]}
[0m17:18:04.471996 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.7k rows, 1.4 MB processed)[0m in 5.71s]
[0m17:18:04.475195 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m17:18:04.477483 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:18:04.478767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:04.479307 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:18:04.479754 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:18:04.480172 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:18:04.480547 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m17:18:04.481001 [info ] [MainThread]: 
[0m17:18:04.481706 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.10 seconds (8.10s).
[0m17:18:04.482607 [debug] [MainThread]: Command end result
[0m17:18:04.514530 [info ] [MainThread]: 
[0m17:18:04.515621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:04.516566 [info ] [MainThread]: 
[0m17:18:04.517713 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:18:04.518923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb074bf2aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0783d33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb074d6a0e0>]}
[0m17:18:04.519689 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:18:57.822478 | 03dff5ab-cce7-45ad-a996-07744b3553b5 ==============================
[0m17:18:57.822478 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:18:57.824661 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:18:57.825167 [debug] [MainThread]: Tracking: tracking
[0m17:18:57.827066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85ca8baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85ca88e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85ca8a530>]}
[0m17:18:57.881791 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:18:58.043511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:58.044512 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m17:18:58.071003 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m17:18:58.161613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03dff5ab-cce7-45ad-a996-07744b3553b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85c1100d0>]}
[0m17:18:58.188698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03dff5ab-cce7-45ad-a996-07744b3553b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85c96a620>]}
[0m17:18:58.189414 [info ] [MainThread]: Found 45 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:18:58.190028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03dff5ab-cce7-45ad-a996-07744b3553b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85c7efca0>]}
[0m17:18:58.194127 [info ] [MainThread]: 
[0m17:18:58.196789 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:18:58.198655 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:18:58.199246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:59.056852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:18:59.057306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:59.058303 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:18:59.060754 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:18:59.092319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:59.094600 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:18:59.095479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:59.128673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:00.490422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03dff5ab-cce7-45ad-a996-07744b3553b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85c96a1a0>]}
[0m17:19:00.491878 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:19:00.492659 [info ] [MainThread]: 
[0m17:19:00.503221 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m17:19:00.503934 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m17:19:00.505134 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m17:19:00.505657 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m17:19:00.515353 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m17:19:00.516567 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 17:19:00.505985 => 2023-07-01 17:19:00.516358
[0m17:19:00.517415 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m17:19:00.552750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:01.620553 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m17:19:01.623866 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
            , worker_id 
        order by address_id) as dedup_index
    from int_address
)

, prodcut_with_sk  as (
    select
        row_number() over (order by address_id) as address_sk
        , business_entity_id
        , address_type_id
        , contact_type_id
        , worker_id
        , contact_type_name_worker
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m17:19:05.472721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bcb6f116-902a-4070-9ad7-42afed62ab79&page=queryresults
[0m17:19:06.524551 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 17:19:00.518013 => 2023-07-01 17:19:06.524461
[0m17:19:06.526084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03dff5ab-cce7-45ad-a996-07744b3553b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa857d38160>]}
[0m17:19:06.526788 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.7k rows, 1.4 MB processed)[0m in 6.02s]
[0m17:19:06.529338 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m17:19:06.531297 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:19:06.532153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:06.532507 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:19:06.532849 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:19:06.533152 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:19:06.533442 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m17:19:06.533803 [info ] [MainThread]: 
[0m17:19:06.534298 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.34 seconds (8.34s).
[0m17:19:06.535094 [debug] [MainThread]: Command end result
[0m17:19:06.562533 [info ] [MainThread]: 
[0m17:19:06.563637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:06.564430 [info ] [MainThread]: 
[0m17:19:06.565487 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:19:06.566778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85c7ef0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85c10e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85c96a7a0>]}
[0m17:19:06.567578 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:19:37.020398 | 4e7291ac-fb22-46b1-94b6-68ec6b98c2d7 ==============================
[0m17:19:37.020398 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:19:37.023079 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:19:37.023991 [debug] [MainThread]: Tracking: tracking
[0m17:19:37.026142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb258164820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb258164f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2581647f0>]}
[0m17:19:37.063771 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:19:37.248231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:19:37.249872 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m17:19:37.281702 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m17:19:37.425698 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m17:19:37.468218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e7291ac-fb22-46b1-94b6-68ec6b98c2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25740bf70>]}
[0m17:19:37.494408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e7291ac-fb22-46b1-94b6-68ec6b98c2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb257cfc910>]}
[0m17:19:37.494918 [info ] [MainThread]: Found 45 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:19:37.495337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e7291ac-fb22-46b1-94b6-68ec6b98c2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb257ccfb80>]}
[0m17:19:37.503054 [info ] [MainThread]: 
[0m17:19:37.506848 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:19:37.508546 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:19:37.509070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:38.696595 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:19:38.698218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:38.704925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:19:38.761133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:38.755912 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:19:38.819960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:38.758650 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:19:38.824076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:40.305251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e7291ac-fb22-46b1-94b6-68ec6b98c2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb257cfc100>]}
[0m17:19:40.306397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:19:40.307052 [info ] [MainThread]: 
[0m17:19:40.312879 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m17:19:40.313718 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m17:19:40.315213 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m17:19:40.315870 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m17:19:40.333117 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m17:19:40.334299 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 17:19:40.316394 => 2023-07-01 17:19:40.334103
[0m17:19:40.334975 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m17:19:40.376198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:41.374774 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m17:19:41.375800 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m17:19:47.586191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e2062b05-3702-4330-94c0-5ca8fb252225&page=queryresults
[0m17:19:48.629351 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 17:19:40.335594 => 2023-07-01 17:19:48.629263
[0m17:19:48.630386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7291ac-fb22-46b1-94b6-68ec6b98c2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb257464850>]}
[0m17:19:48.630960 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 15.6 MB processed)[0m in 8.32s]
[0m17:19:48.634259 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m17:19:48.636408 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:19:48.637604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:48.638192 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:19:48.638816 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:19:48.639246 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:19:48.639683 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m17:19:48.640157 [info ] [MainThread]: 
[0m17:19:48.640871 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.14 seconds (11.14s).
[0m17:19:48.641883 [debug] [MainThread]: Command end result
[0m17:19:48.688894 [info ] [MainThread]: 
[0m17:19:48.690427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:48.691901 [info ] [MainThread]: 
[0m17:19:48.693237 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:19:48.694173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25b4b2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25c251570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25727f700>]}
[0m17:19:48.694778 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:22:22.340277 | c66893f3-29c4-430f-8b4c-9dfab6f037bf ==============================
[0m17:22:22.340277 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:22:22.342221 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:22:22.342662 [debug] [MainThread]: Tracking: tracking
[0m17:22:22.344558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b68ed40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b68c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b68e560>]}
[0m17:22:22.385510 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:22:22.523490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:22:22.524368 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m17:22:22.547021 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m17:22:22.585756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c66893f3-29c4-430f-8b4c-9dfab6f037bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b4700d0>]}
[0m17:22:22.609560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c66893f3-29c4-430f-8b4c-9dfab6f037bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b56c220>]}
[0m17:22:22.610074 [info ] [MainThread]: Found 45 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:22:22.610568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66893f3-29c4-430f-8b4c-9dfab6f037bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b3f7b20>]}
[0m17:22:22.614359 [info ] [MainThread]: 
[0m17:22:22.616762 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:22:22.618816 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:22:22.619569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:23.963875 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:22:23.964524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:23.966413 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:22:24.007663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:24.011030 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:22:24.013624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:22:24.014966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:24.015574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:25.415886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66893f3-29c4-430f-8b4c-9dfab6f037bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b6a5210>]}
[0m17:22:25.416989 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:22:25.417602 [info ] [MainThread]: 
[0m17:22:25.428755 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m17:22:25.429325 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m17:22:25.430463 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m17:22:25.430835 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m17:22:25.438535 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m17:22:25.439417 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 17:22:25.431112 => 2023-07-01 17:22:25.439239
[0m17:22:25.440054 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m17:22:25.472110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.452975 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m17:22:26.455605 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, ship_method as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, name_reason
		, reason_type
		, card_type
	from order_header 
	left join union_reason
		on union_reason.sales_order_id =  order_header.sales_order_id
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = order_detail.ship_method_id
)

select * 
from union_header_detail
    );
  
[0m17:22:27.642605 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name ship_method_id not found inside order_detail at [80:62]')
[0m17:22:29.071736 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ff76eb3f-8779-4b00-96b6-dfbcd59a4a11&page=queryresults
[0m17:22:29.073259 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 17:22:25.440605 => 2023-07-01 17:22:29.072884
[0m17:22:29.076367 [debug] [Thread-1 (]: Database Error in model int_sales (models/intermediate/int_sales.sql)
  Name ship_method_id not found inside order_detail at [80:62]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_sales.sql
[0m17:22:29.076848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c66893f3-29c4-430f-8b4c-9dfab6f037bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9ab1f850>]}
[0m17:22:29.077416 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_sales ........ [[31mERROR[0m in 3.65s]
[0m17:22:29.079778 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m17:22:29.081986 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:22:29.083016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:29.083871 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:22:29.084244 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m17:22:29.084761 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:22:29.085130 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:22:29.085551 [info ] [MainThread]: 
[0m17:22:29.086327 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.47 seconds (6.47s).
[0m17:22:29.087715 [debug] [MainThread]: Command end result
[0m17:22:29.127649 [info ] [MainThread]: 
[0m17:22:29.129096 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:29.130120 [info ] [MainThread]: 
[0m17:22:29.130999 [error] [MainThread]: [33mDatabase Error in model int_sales (models/intermediate/int_sales.sql)[0m
[0m17:22:29.131933 [error] [MainThread]:   Name ship_method_id not found inside order_detail at [80:62]
[0m17:22:29.132668 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_sales.sql
[0m17:22:29.133443 [info ] [MainThread]: 
[0m17:22:29.134161 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:22:29.136417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b3c79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9ab41f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9ab40eb0>]}
[0m17:22:29.137391 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:23:00.061159 | e6c82412-fa2e-4a96-b1da-bbd7c84bdc73 ==============================
[0m17:23:00.061159 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:23:00.063553 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:23:00.063971 [debug] [MainThread]: Tracking: tracking
[0m17:23:00.065763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff698a82860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff698a80ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff698a82bc0>]}
[0m17:23:00.110082 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:23:00.250279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:23:00.251117 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m17:23:00.273760 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m17:23:00.312385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6c82412-fa2e-4a96-b1da-bbd7c84bdc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69885b550>]}
[0m17:23:00.335180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6c82412-fa2e-4a96-b1da-bbd7c84bdc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff698962620>]}
[0m17:23:00.335695 [info ] [MainThread]: Found 45 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:23:00.336139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6c82412-fa2e-4a96-b1da-bbd7c84bdc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6987ebc10>]}
[0m17:23:00.343033 [info ] [MainThread]: 
[0m17:23:00.346802 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:23:00.348533 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:23:00.349054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:01.287395 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:23:01.287891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:01.288952 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:23:01.291792 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:23:01.324852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:01.326123 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:23:01.326778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:01.327297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:02.476948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6c82412-fa2e-4a96-b1da-bbd7c84bdc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff698a98910>]}
[0m17:23:02.478460 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:23:02.479337 [info ] [MainThread]: 
[0m17:23:02.511463 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m17:23:02.513428 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m17:23:02.515455 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m17:23:02.518863 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m17:23:02.531165 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m17:23:02.532795 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 17:23:02.519545 => 2023-07-01 17:23:02.532628
[0m17:23:02.533298 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m17:23:02.579772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:03.495581 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m17:23:03.496715 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, ship_method as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, name_reason
		, reason_type
		, card_type
	from order_header 
	left join union_reason
		on union_reason.sales_order_id =  order_header.sales_order_id
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
    );
  
[0m17:23:09.821474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:321ee9f9-53f8-4096-9d19-bcaca3f9188e&page=queryresults
[0m17:23:09.841163 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 17:23:02.533581 => 2023-07-01 17:23:09.841090
[0m17:23:09.842094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6c82412-fa2e-4a96-b1da-bbd7c84bdc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69886ce80>]}
[0m17:23:09.842674 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_sales ............ [[32mCREATE TABLE (131.9k rows, 13.0 MB processed)[0m in 7.33s]
[0m17:23:09.845144 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m17:23:09.847639 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:23:09.848865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:09.849565 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:23:09.850239 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:23:09.850881 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m17:23:09.851520 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:23:09.852220 [info ] [MainThread]: 
[0m17:23:09.853228 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.51 seconds (9.51s).
[0m17:23:09.854612 [debug] [MainThread]: Command end result
[0m17:23:09.907274 [info ] [MainThread]: 
[0m17:23:09.909878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:09.911141 [info ] [MainThread]: 
[0m17:23:09.911985 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:23:09.912880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69cd25570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6987bbac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff698a9aa10>]}
[0m17:23:09.913765 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:33:31.466021 | 01f635b7-9b3f-48cc-9934-7823eab05b4b ==============================
[0m17:33:31.466021 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:33:31.472854 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_reason'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:33:31.473617 [debug] [MainThread]: Tracking: tracking
[0m17:33:31.478869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577ec7a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577ec79e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577ec7a6e0>]}
[0m17:33:31.545796 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:33:31.750212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:33:31.751693 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/intermediate/int_reason.sql
[0m17:33:31.793793 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_reason.sql
[0m17:33:31.863427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01f635b7-9b3f-48cc-9934-7823eab05b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577e861780>]}
[0m17:33:31.905605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01f635b7-9b3f-48cc-9934-7823eab05b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577e7fbf40>]}
[0m17:33:31.906777 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:33:31.908124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01f635b7-9b3f-48cc-9934-7823eab05b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577e7e3340>]}
[0m17:33:31.913397 [info ] [MainThread]: 
[0m17:33:31.917734 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:33:31.920190 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:33:31.920996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:32.963024 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:33:32.965231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:32.966360 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:33:32.967707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:33:32.969332 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:33:32.969939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:32.970750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:33.020995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:34.730966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01f635b7-9b3f-48cc-9934-7823eab05b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577ea90ee0>]}
[0m17:33:34.732485 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:33:34.733476 [info ] [MainThread]: 
[0m17:33:34.748610 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_reason
[0m17:33:34.749486 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_reason ................ [RUN]
[0m17:33:34.751787 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_reason'
[0m17:33:34.752676 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_reason
[0m17:33:34.757978 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_reason"
[0m17:33:34.758878 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_reason (compile): 2023-07-01 17:33:34.752981 => 2023-07-01 17:33:34.758737
[0m17:33:34.759611 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_reason
[0m17:33:34.843497 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_reason"
[0m17:33:34.844633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:34.848679 [debug] [Thread-1 (]: On model.desafioaethaina.int_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

select *
from union_reason
    );
  
[0m17:33:38.677418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1767245b-5f53-4e9f-ada0-13fabff3749d&page=queryresults
[0m17:33:38.694511 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_reason (execute): 2023-07-01 17:33:34.760163 => 2023-07-01 17:33:38.694445
[0m17:33:38.695289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01f635b7-9b3f-48cc-9934-7823eab05b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577df07190>]}
[0m17:33:38.695856 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_reason ........... [[32mCREATE TABLE (27.6k rows, 432.3 KB processed)[0m in 3.94s]
[0m17:33:38.698012 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_reason
[0m17:33:38.699640 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:33:38.700517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:38.701006 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:33:38.701376 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:33:38.701795 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:33:38.702215 [debug] [MainThread]: Connection 'model.desafioaethaina.int_reason' was properly closed.
[0m17:33:38.702689 [info ] [MainThread]: 
[0m17:33:38.703461 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.79 seconds (6.79s).
[0m17:33:38.704425 [debug] [MainThread]: Command end result
[0m17:33:38.738566 [info ] [MainThread]: 
[0m17:33:38.740283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:38.742060 [info ] [MainThread]: 
[0m17:33:38.743205 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:33:38.744876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5781fe6b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577df27760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577df27af0>]}
[0m17:33:38.746207 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:34:48.564623 | 7a4fd022-13f0-4230-a7dc-5d7b30557e0c ==============================
[0m17:34:48.564623 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:34:48.566502 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_reasons'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:34:48.567012 [debug] [MainThread]: Tracking: tracking
[0m17:34:48.569233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f956560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f9547c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f956470>]}
[0m17:34:48.618925 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:34:48.752448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:48.753279 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_reasons.sql
[0m17:34:48.775559 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_reasons.sql
[0m17:34:48.814244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a4fd022-13f0-4230-a7dc-5d7b30557e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f52f610>]}
[0m17:34:48.837535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a4fd022-13f0-4230-a7dc-5d7b30557e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f63c790>]}
[0m17:34:48.838017 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:34:48.838465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4fd022-13f0-4230-a7dc-5d7b30557e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f63c7f0>]}
[0m17:34:48.842173 [info ] [MainThread]: 
[0m17:34:48.844598 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:48.845925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:34:48.846408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:49.756537 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:34:49.757767 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:34:49.758128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:49.759139 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:34:49.759732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:49.760494 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:34:49.794568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:49.829333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:51.199809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4fd022-13f0-4230-a7dc-5d7b30557e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f96d4e0>]}
[0m17:34:51.201454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:34:51.202865 [info ] [MainThread]: 
[0m17:34:51.217110 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_reasons
[0m17:34:51.218114 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_reasons ....................... [RUN]
[0m17:34:51.219606 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_reasons'
[0m17:34:51.220428 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_reasons
[0m17:34:51.227904 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_reasons"
[0m17:34:51.229440 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (compile): 2023-07-01 17:34:51.220947 => 2023-07-01 17:34:51.229257
[0m17:34:51.230128 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_reasons
[0m17:34:51.283786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:52.261043 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_reasons"
[0m17:34:52.264823 [debug] [Thread-1 (]: On model.desafioaethaina.dim_reasons: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_reasons"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_reasons`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_reason`
)

, reason_with_sk  as (
    select
        row_number() over (order by sales_reason_id ) as reason_sk
        , name_reason
        , reason_type
      from deduplication_data
    where dedup_index = 1
)

select *
from reason_with_sk
    );
  
[0m17:34:52.582644 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "deduplication_data" must be qualified with a dataset (e.g. dataset.table).')
[0m17:34:53.433199 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:02b4b9c2-82b3-472d-8b73-fc3480698cf8&page=queryresults
[0m17:34:53.434105 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (execute): 2023-07-01 17:34:51.230687 => 2023-07-01 17:34:53.433965
[0m17:34:53.436954 [debug] [Thread-1 (]: Database Error in model dim_reasons (models/gold/dim_reasons.sql)
  Table "deduplication_data" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/desafioaethaina/models/gold/dim_reasons.sql
[0m17:34:53.437674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4fd022-13f0-4230-a7dc-5d7b30557e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f5429b0>]}
[0m17:34:53.438414 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_reasons .............. [[31mERROR[0m in 2.22s]
[0m17:34:53.441355 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_reasons
[0m17:34:53.443342 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:53.444407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:53.444850 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:34:53.445355 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:34:53.445912 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_reasons' was properly closed.
[0m17:34:53.446474 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:34:53.447270 [info ] [MainThread]: 
[0m17:34:53.448190 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m17:34:53.449135 [debug] [MainThread]: Command end result
[0m17:34:53.496808 [info ] [MainThread]: 
[0m17:34:53.497988 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:34:53.499741 [info ] [MainThread]: 
[0m17:34:53.501252 [error] [MainThread]: [33mDatabase Error in model dim_reasons (models/gold/dim_reasons.sql)[0m
[0m17:34:53.503478 [error] [MainThread]:   Table "deduplication_data" must be qualified with a dataset (e.g. dataset.table).
[0m17:34:53.504375 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_reasons.sql
[0m17:34:53.505255 [info ] [MainThread]: 
[0m17:34:53.506102 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:34:53.507021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f4c76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f63c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8f63c8b0>]}
[0m17:34:53.507783 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:35:24.614992 | 6cee3ff6-11a3-466a-b9b6-15e9eaeea0ad ==============================
[0m17:35:24.614992 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:35:24.617721 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_reasons'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:35:24.618268 [debug] [MainThread]: Tracking: tracking
[0m17:35:24.620814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03053864a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03053862f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0305386c80>]}
[0m17:35:24.673119 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:35:24.832326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:24.833253 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_reasons.sql
[0m17:35:24.856458 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_reasons.sql
[0m17:35:24.896053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cee3ff6-11a3-466a-b9b6-15e9eaeea0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030515f6d0>]}
[0m17:35:24.919438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cee3ff6-11a3-466a-b9b6-15e9eaeea0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030526a5c0>]}
[0m17:35:24.919916 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:35:24.920344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cee3ff6-11a3-466a-b9b6-15e9eaeea0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03050f3ca0>]}
[0m17:35:24.924117 [info ] [MainThread]: 
[0m17:35:24.926679 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:35:24.927975 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:35:24.928405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:25.811907 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:35:25.812820 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:35:25.813319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:25.814300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:35:25.815773 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:35:25.816367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:25.817101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:25.817641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:27.042111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cee3ff6-11a3-466a-b9b6-15e9eaeea0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030514e890>]}
[0m17:35:27.043125 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:35:27.043643 [info ] [MainThread]: 
[0m17:35:27.053374 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_reasons
[0m17:35:27.054143 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_reasons ....................... [RUN]
[0m17:35:27.055633 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_reasons'
[0m17:35:27.056205 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_reasons
[0m17:35:27.063170 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_reasons"
[0m17:35:27.064725 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (compile): 2023-07-01 17:35:27.056588 => 2023-07-01 17:35:27.064470
[0m17:35:27.065661 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_reasons
[0m17:35:27.118982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:28.064862 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_reasons"
[0m17:35:28.066891 [debug] [Thread-1 (]: On model.desafioaethaina.dim_reasons: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_reasons"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_reasons`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_reason`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_reason_id order by sales_reason_id) as dedup_index
    from int_sales
)

, reason_with_sk  as (
    select
        row_number() over (order by sales_reason_id) as reason_sk
        , name_reason
        , reason_type
      from deduplication_data
    where dedup_index = 1
)

select *
from reason_with_sk
    );
  
[0m17:35:31.517097 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ce8819ca-933d-4e21-86a8-62edcc19a4fa&page=queryresults
[0m17:35:31.539276 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (execute): 2023-07-01 17:35:27.066550 => 2023-07-01 17:35:31.539186
[0m17:35:31.540505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cee3ff6-11a3-466a-b9b6-15e9eaeea0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0305170700>]}
[0m17:35:31.541264 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_reasons .................. [[32mCREATE TABLE (7.0 rows, 664.8 KB processed)[0m in 4.49s]
[0m17:35:31.544327 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_reasons
[0m17:35:31.546433 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:35:31.547219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:31.547585 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:35:31.547840 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:35:31.548076 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:35:31.548313 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_reasons' was properly closed.
[0m17:35:31.548620 [info ] [MainThread]: 
[0m17:35:31.549220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.62 seconds (6.62s).
[0m17:35:31.550048 [debug] [MainThread]: Command end result
[0m17:35:31.590086 [info ] [MainThread]: 
[0m17:35:31.592711 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:31.594019 [info ] [MainThread]: 
[0m17:35:31.596805 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:35:31.597861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03096d9540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03050f37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030539e200>]}
[0m17:35:31.598559 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:37:32.902946 | f04263da-d37d-4657-885f-1e266dfc0071 ==============================
[0m17:37:32.902946 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:37:32.905411 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:37:32.905935 [debug] [MainThread]: Tracking: tracking
[0m17:37:32.908165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c818a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c8189330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c818a3b0>]}
[0m17:37:32.966160 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:37:33.107949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:33.108807 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m17:37:33.132393 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m17:37:33.173244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f04263da-d37d-4657-885f-1e266dfc0071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c7f701f0>]}
[0m17:37:33.197560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f04263da-d37d-4657-885f-1e266dfc0071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c8069ea0>]}
[0m17:37:33.198049 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:37:33.198492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04263da-d37d-4657-885f-1e266dfc0071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c7ef3940>]}
[0m17:37:33.202167 [info ] [MainThread]: 
[0m17:37:33.204624 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:37:33.205944 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:37:33.206401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:34.202189 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:37:34.204302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:37:34.204993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:34.206746 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:37:34.209240 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:37:34.209746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:34.246332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:34.248434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:35.632514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04263da-d37d-4657-885f-1e266dfc0071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c819c610>]}
[0m17:37:35.633423 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:37:35.633996 [info ] [MainThread]: 
[0m17:37:35.640446 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m17:37:35.641002 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m17:37:35.642137 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m17:37:35.642506 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m17:37:35.649822 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m17:37:35.651070 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 17:37:35.642743 => 2023-07-01 17:37:35.650863
[0m17:37:35.651613 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m17:37:35.682197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:36.557387 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m17:37:36.558470 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, ship_method as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
)

, union_header_reason as (
	select 
		order_header.*
		, sales_reason_id
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
    );
  
[0m17:37:37.874938 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [41:19]')
[0m17:37:39.306219 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:73d35280-e491-4c49-a4bc-a8b2678fc7ec&page=queryresults
[0m17:37:39.307147 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 17:37:35.651881 => 2023-07-01 17:37:39.307000
[0m17:37:39.310222 [debug] [Thread-1 (]: Database Error in model int_sales (models/intermediate/int_sales.sql)
  Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [41:19]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_sales.sql
[0m17:37:39.310784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f04263da-d37d-4657-885f-1e266dfc0071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c7617880>]}
[0m17:37:39.311428 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_sales ........ [[31mERROR[0m in 3.67s]
[0m17:37:39.313608 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m17:37:39.315290 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:37:39.316005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:39.316298 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:37:39.316602 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:37:39.316966 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m17:37:39.317556 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:37:39.318184 [info ] [MainThread]: 
[0m17:37:39.319242 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m17:37:39.320336 [debug] [MainThread]: Command end result
[0m17:37:39.347855 [info ] [MainThread]: 
[0m17:37:39.348391 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:37:39.348940 [info ] [MainThread]: 
[0m17:37:39.349447 [error] [MainThread]: [33mDatabase Error in model int_sales (models/intermediate/int_sales.sql)[0m
[0m17:37:39.349926 [error] [MainThread]:   Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [41:19]
[0m17:37:39.350418 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_sales.sql
[0m17:37:39.350911 [info ] [MainThread]: 
[0m17:37:39.351534 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:37:39.352231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cb6ce530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c8069f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c8069f30>]}
[0m17:37:39.352609 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:38:33.649663 | afc37a3b-497e-4c98-a748-371d5f96cb44 ==============================
[0m17:38:33.649663 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:38:33.652448 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:38:33.653357 [debug] [MainThread]: Tracking: tracking
[0m17:38:33.656182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e3892770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e38922f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e3892740>]}
[0m17:38:33.708189 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:38:33.876571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:33.877432 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m17:38:33.908357 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m17:38:33.959619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afc37a3b-497e-4c98-a748-371d5f96cb44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e3676440>]}
[0m17:38:33.990126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afc37a3b-497e-4c98-a748-371d5f96cb44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e3771f60>]}
[0m17:38:33.990668 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:38:33.991197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afc37a3b-497e-4c98-a748-371d5f96cb44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e35fb640>]}
[0m17:38:33.994900 [info ] [MainThread]: 
[0m17:38:33.999518 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:38:34.001970 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:38:34.003055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:35.021108 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:38:35.022178 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:38:35.022554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:35.023517 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:38:35.023898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:35.024877 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:38:35.059674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:35.093508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:36.386218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afc37a3b-497e-4c98-a748-371d5f96cb44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e3652230>]}
[0m17:38:36.387256 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:36.387779 [info ] [MainThread]: 
[0m17:38:36.394797 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m17:38:36.395494 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m17:38:36.396757 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m17:38:36.397186 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m17:38:36.407182 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m17:38:36.408647 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 17:38:36.397478 => 2023-07-01 17:38:36.408399
[0m17:38:36.409667 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m17:38:36.448157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:37.496303 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m17:38:37.497372 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, ship_method as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
    );
  
[0m17:38:43.110417 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:aa239f69-cac4-42ae-aa7f-5b18597e5231&page=queryresults
[0m17:38:43.130115 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 17:38:36.410126 => 2023-07-01 17:38:43.130044
[0m17:38:43.130977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afc37a3b-497e-4c98-a748-371d5f96cb44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e2f1f550>]}
[0m17:38:43.131536 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_sales ............ [[32mCREATE TABLE (121.3k rows, 12.6 MB processed)[0m in 6.73s]
[0m17:38:43.135705 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m17:38:43.138538 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:38:43.140196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:43.140855 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:38:43.141481 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:38:43.142101 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:38:43.142694 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m17:38:43.143420 [info ] [MainThread]: 
[0m17:38:43.144403 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m17:38:43.145787 [debug] [MainThread]: Command end result
[0m17:38:43.192187 [info ] [MainThread]: 
[0m17:38:43.194096 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:43.195146 [info ] [MainThread]: 
[0m17:38:43.196278 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:38:43.199082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e6c56500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e35cb400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e38a4580>]}
[0m17:38:43.200591 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:48:02.681706 | e1701cfd-0d3d-4b64-ba3a-11d48c3bb80d ==============================
[0m17:48:02.681706 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:48:02.683740 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:48:02.684230 [debug] [MainThread]: Tracking: tracking
[0m17:48:02.686061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2807e56e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2807e56680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2807e56e30>]}
[0m17:48:02.729166 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:48:02.876582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:48:02.877450 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m17:48:02.877913 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m17:48:02.901825 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m17:48:02.919437 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m17:48:03.020009 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m17:48:03.069910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1701cfd-0d3d-4b64-ba3a-11d48c3bb80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2807115870>]}
[0m17:48:03.097282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1701cfd-0d3d-4b64-ba3a-11d48c3bb80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28079c7910>]}
[0m17:48:03.097813 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:48:03.098334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1701cfd-0d3d-4b64-ba3a-11d48c3bb80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28079c7af0>]}
[0m17:48:03.102096 [info ] [MainThread]: 
[0m17:48:03.104521 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:48:03.105899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:48:03.106386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:04.163018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:48:04.163681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:04.164476 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:48:04.198492 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:48:04.200666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:04.201615 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:48:04.202321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:04.202957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:05.533822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1701cfd-0d3d-4b64-ba3a-11d48c3bb80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2807b3d270>]}
[0m17:48:05.534762 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:48:05.535204 [info ] [MainThread]: 
[0m17:48:05.539182 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m17:48:05.539698 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m17:48:05.540777 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m17:48:05.541185 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m17:48:05.552299 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m17:48:05.553154 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 17:48:05.541434 => 2023-07-01 17:48:05.553022
[0m17:48:05.553738 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m17:48:05.588565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:06.554028 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m17:48:06.555029 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        -- row_number() over (order by fixed_customer_id) as customer_sk
         SHA256(customer_id) as customer_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m17:48:08.044755 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id; Did you mean store_id? at [29:17]')
[0m17:48:10.093507 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5f73eb83-1ed8-474f-901c-c0c5e5cb8f03&page=queryresults
[0m17:48:10.094314 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 17:48:05.554137 => 2023-07-01 17:48:10.094180
[0m17:48:10.098634 [debug] [Thread-1 (]: Database Error in model dim_customers (models/gold/dim_customers.sql)
  Unrecognized name: customer_id; Did you mean store_id? at [29:17]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m17:48:10.099462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1701cfd-0d3d-4b64-ba3a-11d48c3bb80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2806f8aec0>]}
[0m17:48:10.100355 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_customers ............ [[31mERROR[0m in 4.56s]
[0m17:48:10.104018 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m17:48:10.106490 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:48:10.107668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:10.108172 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:48:10.108604 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:48:10.109027 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:48:10.109457 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m17:48:10.110029 [info ] [MainThread]: 
[0m17:48:10.111017 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.01 seconds (7.01s).
[0m17:48:10.112192 [debug] [MainThread]: Command end result
[0m17:48:10.157417 [info ] [MainThread]: 
[0m17:48:10.159849 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:48:10.161649 [info ] [MainThread]: 
[0m17:48:10.162920 [error] [MainThread]: [33mDatabase Error in model dim_customers (models/gold/dim_customers.sql)[0m
[0m17:48:10.164209 [error] [MainThread]:   Unrecognized name: customer_id; Did you mean store_id? at [29:17]
[0m17:48:10.165563 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m17:48:10.166940 [info ] [MainThread]: 
[0m17:48:10.168198 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:48:10.169866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28079da8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28079c6ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28079c78e0>]}
[0m17:48:10.171311 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:48:27.162695 | 3fe8cd9d-fc45-4bad-8484-c971bf03d360 ==============================
[0m17:48:27.162695 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:48:27.164940 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:48:27.165526 [debug] [MainThread]: Tracking: tracking
[0m17:48:27.167804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf7179360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf7178910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf7179270>]}
[0m17:48:27.217640 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:48:27.353831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:27.354665 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m17:48:27.380066 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m17:48:27.426585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fe8cd9d-fc45-4bad-8484-c971bf03d360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf6d67910>]}
[0m17:48:27.451826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fe8cd9d-fc45-4bad-8484-c971bf03d360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf6e5da80>]}
[0m17:48:27.452433 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:48:27.453062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fe8cd9d-fc45-4bad-8484-c971bf03d360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf6ceb340>]}
[0m17:48:27.456444 [info ] [MainThread]: 
[0m17:48:27.458864 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:48:27.460373 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:48:27.460885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:28.309893 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:48:28.310914 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:48:28.311488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:28.312318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:48:28.313380 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:48:28.313741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:28.314418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:28.348644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:29.401061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fe8cd9d-fc45-4bad-8484-c971bf03d360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf7178970>]}
[0m17:48:29.401910 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:48:29.402377 [info ] [MainThread]: 
[0m17:48:29.411382 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m17:48:29.412112 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m17:48:29.413441 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m17:48:29.414027 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m17:48:29.420302 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m17:48:29.421710 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 17:48:29.414402 => 2023-07-01 17:48:29.421559
[0m17:48:29.422404 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m17:48:29.463144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:30.392908 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m17:48:30.393997 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        -- row_number() over (order by fixed_customer_id) as customer_sk
         SHA256(fixed_customer_id) as customer_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m17:48:31.800885 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function SHA256 for argument types: INT64. Supported signatures: SHA256(BYTES); SHA256(STRING) at [29:10]')
[0m17:48:34.054977 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3b32fc5e-888c-4f19-86d3-6c54f0b8fcfe&page=queryresults
[0m17:48:34.055890 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 17:48:29.422975 => 2023-07-01 17:48:34.055751
[0m17:48:34.059788 [debug] [Thread-1 (]: Database Error in model dim_customers (models/gold/dim_customers.sql)
  No matching signature for function SHA256 for argument types: INT64. Supported signatures: SHA256(BYTES); SHA256(STRING) at [29:10]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m17:48:34.060524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fe8cd9d-fc45-4bad-8484-c971bf03d360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf6420280>]}
[0m17:48:34.061328 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_customers ............ [[31mERROR[0m in 4.65s]
[0m17:48:34.064692 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m17:48:34.066838 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:48:34.067938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:34.068358 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:48:34.068763 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:48:34.069154 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m17:48:34.069531 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:48:34.069986 [info ] [MainThread]: 
[0m17:48:34.070758 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m17:48:34.071788 [debug] [MainThread]: Command end result
[0m17:48:34.124964 [info ] [MainThread]: 
[0m17:48:34.126286 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:48:34.127280 [info ] [MainThread]: 
[0m17:48:34.128503 [error] [MainThread]: [33mDatabase Error in model dim_customers (models/gold/dim_customers.sql)[0m
[0m17:48:34.129829 [error] [MainThread]:   No matching signature for function SHA256 for argument types: INT64. Supported signatures: SHA256(BYTES); SHA256(STRING) at [29:10]
[0m17:48:34.130758 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m17:48:34.131623 [info ] [MainThread]: 
[0m17:48:34.132700 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:48:34.134495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfa4cb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf6e5dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf6e5db70>]}
[0m17:48:34.135794 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:49:06.900579 | 9fdc665b-e12a-47a0-bad0-cade28db28e9 ==============================
[0m17:49:06.900579 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:49:06.902826 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:49:06.903420 [debug] [MainThread]: Tracking: tracking
[0m17:49:06.904978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b5148e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b5148e2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b5148e710>]}
[0m17:49:06.947753 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:49:07.085035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:07.085878 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m17:49:07.108256 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m17:49:07.149091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fdc665b-e12a-47a0-bad0-cade28db28e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b51274100>]}
[0m17:49:07.172410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fdc665b-e12a-47a0-bad0-cade28db28e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b5136df30>]}
[0m17:49:07.172934 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:49:07.173431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fdc665b-e12a-47a0-bad0-cade28db28e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b5136df90>]}
[0m17:49:07.177082 [info ] [MainThread]: 
[0m17:49:07.181045 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:49:07.182677 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:49:07.183178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:08.162056 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:49:08.162647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:08.163570 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:49:08.164522 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:49:08.165004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:08.198784 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:49:08.200959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:08.235394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:09.513283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fdc665b-e12a-47a0-bad0-cade28db28e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b514a18d0>]}
[0m17:49:09.514163 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:49:09.514693 [info ] [MainThread]: 
[0m17:49:09.521290 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m17:49:09.521800 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m17:49:09.522807 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m17:49:09.523191 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m17:49:09.529317 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m17:49:09.530548 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 17:49:09.523443 => 2023-07-01 17:49:09.530382
[0m17:49:09.531213 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m17:49:09.574319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:10.658219 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m17:49:10.659277 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        -- row_number() over (order by fixed_customer_id) as customer_sk
         SHA256(cast(fixed_customer_id as string)) as customer_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m17:49:14.089080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9db12c7e-151a-4ff5-a8bc-4c779d5d6e94&page=queryresults
[0m17:49:14.108539 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 17:49:09.531751 => 2023-07-01 17:49:14.108471
[0m17:49:14.109549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fdc665b-e12a-47a0-bad0-cade28db28e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b5091b730>]}
[0m17:49:14.110424 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customers ................ [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 4.59s]
[0m17:49:14.113022 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m17:49:14.116590 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:49:14.119197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:14.120376 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:49:14.121426 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:49:14.122323 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m17:49:14.123229 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:49:14.124326 [info ] [MainThread]: 
[0m17:49:14.125970 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.95 seconds (6.95s).
[0m17:49:14.127976 [debug] [MainThread]: Command end result
[0m17:49:14.185401 [info ] [MainThread]: 
[0m17:49:14.188044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:14.189382 [info ] [MainThread]: 
[0m17:49:14.191086 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:49:14.193713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b511f6800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b514a0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b5136e080>]}
[0m17:49:14.194718 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:49:37.875274 | 8d23c505-00c0-4ba9-9f8f-eb52c5f1e765 ==============================
[0m17:49:37.875274 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:49:37.877513 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:49:37.878016 [debug] [MainThread]: Tracking: tracking
[0m17:49:37.880256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427177a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4271779b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427177a5f0>]}
[0m17:49:37.953980 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:49:38.109358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:38.110779 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m17:49:38.139040 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m17:49:38.257458 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m17:49:38.300205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d23c505-00c0-4ba9-9f8f-eb52c5f1e765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4270c20fd0>]}
[0m17:49:38.331353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d23c505-00c0-4ba9-9f8f-eb52c5f1e765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427145df00>]}
[0m17:49:38.332498 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:49:38.333551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d23c505-00c0-4ba9-9f8f-eb52c5f1e765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42712e7790>]}
[0m17:49:38.338308 [info ] [MainThread]: 
[0m17:49:38.340789 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:49:38.342069 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:49:38.342545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:39.387331 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:49:39.388401 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:49:39.388716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:39.389653 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:49:39.389961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:39.390845 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:49:39.391517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:39.426376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:40.657321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d23c505-00c0-4ba9-9f8f-eb52c5f1e765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4271346560>]}
[0m17:49:40.658298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:49:40.658958 [info ] [MainThread]: 
[0m17:49:40.664094 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m17:49:40.664760 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m17:49:40.665860 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m17:49:40.666246 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m17:49:40.679382 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m17:49:40.680760 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 17:49:40.666473 => 2023-07-01 17:49:40.680611
[0m17:49:40.681421 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m17:49:40.715598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:41.665323 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m17:49:41.666437 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , SHA256(cast(fixed_customer_id as string)) as customer_fk
        -- , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_reason_id) as sales_reason_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m17:49:43.272640 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: fixed_customer_id at [31:23]')
[0m17:49:44.539940 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5e181dd9-cb2c-489d-a716-f459dcb0061d&page=queryresults
[0m17:49:44.540870 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 17:49:40.681906 => 2023-07-01 17:49:44.540715
[0m17:49:44.545368 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Unrecognized name: fixed_customer_id at [31:23]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m17:49:44.546359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d23c505-00c0-4ba9-9f8f-eb52c5f1e765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4270a80d90>]}
[0m17:49:44.547262 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 3.88s]
[0m17:49:44.550672 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m17:49:44.552617 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:49:44.553418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:44.553851 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:49:44.554199 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:49:44.554822 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:49:44.555717 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m17:49:44.556426 [info ] [MainThread]: 
[0m17:49:44.557391 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.22 seconds (6.22s).
[0m17:49:44.558509 [debug] [MainThread]: Command end result
[0m17:49:44.615907 [info ] [MainThread]: 
[0m17:49:44.616990 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:49:44.618046 [info ] [MainThread]: 
[0m17:49:44.618871 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m17:49:44.619841 [error] [MainThread]:   Unrecognized name: fixed_customer_id at [31:23]
[0m17:49:44.620712 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m17:49:44.621948 [info ] [MainThread]: 
[0m17:49:44.623450 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:49:44.625290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42712e7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427145df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4270a8eb60>]}
[0m17:49:44.627140 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:49:56.997590 | 988e01ac-7c09-4f2c-80a5-90c1fecf5390 ==============================
[0m17:49:56.997590 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:49:56.999843 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:49:57.000397 [debug] [MainThread]: Tracking: tracking
[0m17:49:57.002227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16d2665c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16d265cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16d266470>]}
[0m17:49:57.047622 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:49:57.210539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:57.211541 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m17:49:57.237952 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m17:49:57.448877 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m17:49:57.520518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '988e01ac-7c09-4f2c-80a5-90c1fecf5390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16c7151e0>]}
[0m17:49:57.564854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '988e01ac-7c09-4f2c-80a5-90c1fecf5390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16cf4a3b0>]}
[0m17:49:57.566612 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:49:57.567760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '988e01ac-7c09-4f2c-80a5-90c1fecf5390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16cdd39d0>]}
[0m17:49:57.574875 [info ] [MainThread]: 
[0m17:49:57.579516 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:49:57.582803 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:49:57.584042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:58.640284 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:49:58.640760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:58.641820 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:49:58.678364 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:49:58.679716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:58.681230 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:49:58.682886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:58.683984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:59.775255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '988e01ac-7c09-4f2c-80a5-90c1fecf5390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16cf49630>]}
[0m17:49:59.777338 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:49:59.778240 [info ] [MainThread]: 
[0m17:49:59.784756 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m17:49:59.785689 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m17:49:59.787408 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m17:49:59.788152 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m17:49:59.814840 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m17:49:59.816172 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 17:49:59.788677 => 2023-07-01 17:49:59.816027
[0m17:49:59.816670 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m17:49:59.854545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:00.799160 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m17:50:00.801476 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , SHA256(cast(customer_id as string)) as customer_fk
        -- , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_reason_id) as sales_reason_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m17:50:02.120182 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [33:39]')
[0m17:50:03.959041 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:919d6fff-ea35-4d68-967d-0f55e2808cdc&page=queryresults
[0m17:50:03.960351 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 17:49:59.816947 => 2023-07-01 17:50:03.960174
[0m17:50:03.963556 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [33:39]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m17:50:03.964106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '988e01ac-7c09-4f2c-80a5-90c1fecf5390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16c764f40>]}
[0m17:50:03.964865 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 4.18s]
[0m17:50:03.968730 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m17:50:03.971181 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:50:03.972510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:03.973093 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:50:03.973563 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:50:03.974029 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:50:03.974485 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m17:50:03.975101 [info ] [MainThread]: 
[0m17:50:03.976103 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m17:50:03.977026 [debug] [MainThread]: Command end result
[0m17:50:04.028109 [info ] [MainThread]: 
[0m17:50:04.029413 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:04.030771 [info ] [MainThread]: 
[0m17:50:04.031761 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m17:50:04.032753 [error] [MainThread]:   Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [33:39]
[0m17:50:04.033659 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m17:50:04.034664 [info ] [MainThread]: 
[0m17:50:04.035991 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:50:04.037654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16cde66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff171349570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16c7770a0>]}
[0m17:50:04.038440 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:50:37.307047 | a2d956c4-ba3a-4ecc-b8a8-e4ea18a64f34 ==============================
[0m17:50:37.307047 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:50:37.309057 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:50:37.309495 [debug] [MainThread]: Tracking: tracking
[0m17:50:37.311334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f188a6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f1889120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f188a6b0>]}
[0m17:50:37.350385 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:50:37.500009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:37.500356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:37.513689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2d956c4-ba3a-4ecc-b8a8-e4ea18a64f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f16540d0>]}
[0m17:50:37.537887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2d956c4-ba3a-4ecc-b8a8-e4ea18a64f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f1618f70>]}
[0m17:50:37.538377 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:50:37.538812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2d956c4-ba3a-4ecc-b8a8-e4ea18a64f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f1618fd0>]}
[0m17:50:37.542342 [info ] [MainThread]: 
[0m17:50:37.545838 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:50:37.547864 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:50:37.548594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:38.416281 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:50:38.416862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:38.417673 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:50:38.418764 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:50:38.419075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:38.419890 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:50:38.454036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:38.454762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:40.020549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2d956c4-ba3a-4ecc-b8a8-e4ea18a64f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f1618cd0>]}
[0m17:50:40.021659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:50:40.022112 [info ] [MainThread]: 
[0m17:50:40.026025 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m17:50:40.026473 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m17:50:40.027438 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m17:50:40.027830 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m17:50:40.031832 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m17:50:40.032534 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 17:50:40.028043 => 2023-07-01 17:50:40.032410
[0m17:50:40.032997 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m17:50:40.069069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:41.058843 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m17:50:41.060008 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        -- row_number() over (order by fixed_customer_id) as customer_sk
         SHA256(cast(fixed_customer_id as string)) as customer_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m17:50:44.812899 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b33cf2cc-42ad-4182-bdc8-b2492ccb727a&page=queryresults
[0m17:50:44.862260 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 17:50:40.033218 => 2023-07-01 17:50:44.862080
[0m17:50:44.864110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d956c4-ba3a-4ecc-b8a8-e4ea18a64f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f1568580>]}
[0m17:50:44.865236 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customers ................ [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 4.84s]
[0m17:50:44.868734 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m17:50:44.872580 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:50:44.874054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:44.874573 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:50:44.875026 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:50:44.875510 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:50:44.875933 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m17:50:44.876422 [info ] [MainThread]: 
[0m17:50:44.877378 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m17:50:44.878727 [debug] [MainThread]: Command end result
[0m17:50:44.932416 [info ] [MainThread]: 
[0m17:50:44.934497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:44.936283 [info ] [MainThread]: 
[0m17:50:44.937399 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:44.938963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f1888940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f14d3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08f14d3f40>]}
[0m17:50:44.939852 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:51:15.807982 | c6f662dd-130c-424f-8c2f-ded4ee144268 ==============================
[0m17:51:15.807982 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:51:15.810259 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:51:15.810886 [debug] [MainThread]: Tracking: tracking
[0m17:51:15.820707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facff372d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facff3707f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facff372560>]}
[0m17:51:15.880937 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:51:16.029177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:51:16.030253 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m17:51:16.053411 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m17:51:16.171239 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m17:51:16.226290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6f662dd-130c-424f-8c2f-ded4ee144268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfe6311b0>]}
[0m17:51:16.261816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6f662dd-130c-424f-8c2f-ded4ee144268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfeef7fd0>]}
[0m17:51:16.262380 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:51:16.262868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6f662dd-130c-424f-8c2f-ded4ee144268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfeef7f10>]}
[0m17:51:16.266409 [info ] [MainThread]: 
[0m17:51:16.268741 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:51:16.270114 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:51:16.270662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:17.180406 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:51:17.181300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:51:17.182387 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:51:17.182916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:17.183791 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:51:17.184237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:17.184550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:17.185025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:18.657585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6f662dd-130c-424f-8c2f-ded4ee144268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facff372d10>]}
[0m17:51:18.658524 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:51:18.659002 [info ] [MainThread]: 
[0m17:51:18.664907 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m17:51:18.665977 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m17:51:18.667903 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m17:51:18.668609 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m17:51:18.686200 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m17:51:18.687503 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 17:51:18.669056 => 2023-07-01 17:51:18.687258
[0m17:51:18.688244 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m17:51:18.734527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:19.659830 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m17:51:19.661175 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , SHA256(cast(customer_id as string)) as customer_fk
        -- , row_number() over (order by customer_id) as customer_fk
        , row_number() over (order by sales_reason_id) as sales_reason_fk
        , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m17:51:21.107246 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [33:39]')
[0m17:51:23.320255 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:36fa9161-ba9e-4a8b-9cd3-2ab7d7bf1496&page=queryresults
[0m17:51:23.321038 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 17:51:18.688609 => 2023-07-01 17:51:23.320908
[0m17:51:23.324952 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [33:39]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m17:51:23.325742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6f662dd-130c-424f-8c2f-ded4ee144268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfe4ab010>]}
[0m17:51:23.326549 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 4.66s]
[0m17:51:23.329957 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m17:51:23.332072 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:51:23.333276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:23.333713 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:51:23.334111 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m17:51:23.334501 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:51:23.334891 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:51:23.335339 [info ] [MainThread]: 
[0m17:51:23.336087 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.07 seconds (7.07s).
[0m17:51:23.336985 [debug] [MainThread]: Command end result
[0m17:51:23.385297 [info ] [MainThread]: 
[0m17:51:23.386344 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:51:23.387555 [info ] [MainThread]: 
[0m17:51:23.388420 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m17:51:23.389119 [error] [MainThread]:   Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [33:39]
[0m17:51:23.389877 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m17:51:23.390437 [info ] [MainThread]: 
[0m17:51:23.391108 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:51:23.391825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facff370f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfeef7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfeef79d0>]}
[0m17:51:23.392287 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:53:28.097695 | 3126cca5-ad82-4855-94a9-d9b5b6808023 ==============================
[0m17:53:28.097695 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:53:28.100629 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:53:28.105178 [debug] [MainThread]: Tracking: tracking
[0m17:53:28.110151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d9866380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d98656c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d9865de0>]}
[0m17:53:28.170998 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:53:28.342189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:53:28.343458 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m17:53:28.343857 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m17:53:28.344249 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m17:53:28.374446 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m17:53:28.393769 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m17:53:28.493071 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m17:53:28.537731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3126cca5-ad82-4855-94a9-d9b5b6808023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d8b21570>]}
[0m17:53:28.575514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3126cca5-ad82-4855-94a9-d9b5b6808023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d9549600>]}
[0m17:53:28.576075 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:53:28.576554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3126cca5-ad82-4855-94a9-d9b5b6808023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d95495a0>]}
[0m17:53:28.580050 [info ] [MainThread]: 
[0m17:53:28.582487 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:28.583925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:53:28.584638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:29.489342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:53:29.490018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:29.490810 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:53:29.491874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:53:29.526905 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:53:29.527289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:29.527976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:29.528450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:30.695252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3126cca5-ad82-4855-94a9-d9b5b6808023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d93f8070>]}
[0m17:53:30.696479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:53:30.697103 [info ] [MainThread]: 
[0m17:53:30.701835 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m17:53:30.702471 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m17:53:30.703803 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m17:53:30.704280 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m17:53:30.721618 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m17:53:30.723311 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 17:53:30.704551 => 2023-07-01 17:53:30.723142
[0m17:53:30.724628 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m17:53:30.771490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:31.753648 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m17:53:31.755180 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        -- row_number() over (order by fixed_customer_id) as customer_sk
         SHA256(cast(fixed_customer_id as string)) as customer_sk
        , SHA256(cast(full_name as string)) as customer_sk
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m17:53:32.954223 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name customer_sk at [13:7]')
[0m17:53:34.591420 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e53c6596-a891-4547-84df-8e470d704c13&page=queryresults
[0m17:53:34.592307 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 17:53:30.726246 => 2023-07-01 17:53:34.592168
[0m17:53:34.596491 [debug] [Thread-1 (]: Database Error in model dim_customers (models/gold/dim_customers.sql)
  CREATE TABLE has columns with duplicate name customer_sk at [13:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m17:53:34.597238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3126cca5-ad82-4855-94a9-d9b5b6808023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d8992e30>]}
[0m17:53:34.598099 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_customers ............ [[31mERROR[0m in 3.89s]
[0m17:53:34.601502 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m17:53:34.603677 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:34.604777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:34.605214 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:53:34.605618 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:53:34.606003 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:53:34.606380 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m17:53:34.606839 [info ] [MainThread]: 
[0m17:53:34.607545 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.03 seconds (6.03s).
[0m17:53:34.608509 [debug] [MainThread]: Command end result
[0m17:53:34.656278 [info ] [MainThread]: 
[0m17:53:34.657765 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:53:34.659122 [info ] [MainThread]: 
[0m17:53:34.660615 [error] [MainThread]: [33mDatabase Error in model dim_customers (models/gold/dim_customers.sql)[0m
[0m17:53:34.662035 [error] [MainThread]:   CREATE TABLE has columns with duplicate name customer_sk at [13:7]
[0m17:53:34.663098 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m17:53:34.663925 [info ] [MainThread]: 
[0m17:53:34.664885 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:53:34.666043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8dcbae530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d93e57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d8b5beb0>]}
[0m17:53:34.666759 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:53:44.903457 | f81458d9-bab4-4c4a-b11e-41b800b1e530 ==============================
[0m17:53:44.903457 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:53:44.905672 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:53:44.906258 [debug] [MainThread]: Tracking: tracking
[0m17:53:44.907989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5028d7a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5028d787c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5028d7a470>]}
[0m17:53:44.949891 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:53:45.096044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:45.097071 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m17:53:45.123904 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m17:53:45.166753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f81458d9-bab4-4c4a-b11e-41b800b1e530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502895b7f0>]}
[0m17:53:45.191113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f81458d9-bab4-4c4a-b11e-41b800b1e530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5028a619c0>]}
[0m17:53:45.191629 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:53:45.192073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f81458d9-bab4-4c4a-b11e-41b800b1e530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50288ebbe0>]}
[0m17:53:45.195479 [info ] [MainThread]: 
[0m17:53:45.198328 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:45.200004 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:53:45.200446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:46.270808 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:53:46.271862 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:53:46.272262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:46.273257 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:53:46.273576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:46.274558 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:53:46.275026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:46.346329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:48.032341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f81458d9-bab4-4c4a-b11e-41b800b1e530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5028d78fd0>]}
[0m17:53:48.034487 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:53:48.035433 [info ] [MainThread]: 
[0m17:53:48.049854 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m17:53:48.051003 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m17:53:48.053167 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m17:53:48.053997 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m17:53:48.060820 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m17:53:48.061667 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 17:53:48.054680 => 2023-07-01 17:53:48.061550
[0m17:53:48.062147 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m17:53:48.109178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:49.481671 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m17:53:49.483104 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        -- row_number() over (order by fixed_customer_id) as customer_sk
         SHA256(cast(fixed_customer_id as string)) as customer_sk
        , SHA256(cast(full_name as string)) as customer_skllll
        , full_name
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m17:53:53.123416 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:96cbd023-641c-4008-8663-b65f72620888&page=queryresults
[0m17:53:53.147630 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 17:53:48.062387 => 2023-07-01 17:53:53.147557
[0m17:53:53.148572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f81458d9-bab4-4c4a-b11e-41b800b1e530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5028968850>]}
[0m17:53:53.149143 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customers ................ [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 5.10s]
[0m17:53:53.153131 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m17:53:53.155841 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:53.157274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:53.157955 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:53:53.158350 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m17:53:53.158648 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:53:53.158921 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:53:53.159251 [info ] [MainThread]: 
[0m17:53:53.159808 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.96 seconds (7.96s).
[0m17:53:53.160668 [debug] [MainThread]: Command end result
[0m17:53:53.208656 [info ] [MainThread]: 
[0m17:53:53.210217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:53.212376 [info ] [MainThread]: 
[0m17:53:53.214005 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:53:53.216036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502ce55570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50288eada0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5028b96620>]}
[0m17:53:53.216701 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:54:23.430491 | 9d676d30-46e9-4e37-bddc-f9ab1bad4451 ==============================
[0m17:54:23.430491 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:54:23.434866 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:54:23.436915 [debug] [MainThread]: Tracking: tracking
[0m17:54:23.443686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc47818b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc47818a770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc47818b370>]}
[0m17:54:23.510547 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:54:23.755244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:23.756259 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m17:54:23.788184 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m17:54:23.856890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d676d30-46e9-4e37-bddc-f9ab1bad4451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc477f676a0>]}
[0m17:54:23.897788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d676d30-46e9-4e37-bddc-f9ab1bad4451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc47806e170>]}
[0m17:54:23.898496 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:54:23.899125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d676d30-46e9-4e37-bddc-f9ab1bad4451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc47806e1d0>]}
[0m17:54:23.903642 [info ] [MainThread]: 
[0m17:54:23.906349 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:54:23.908013 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:54:23.908634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:24.758290 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:54:24.759409 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:54:24.759802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:24.760442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:24.761260 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:54:24.762340 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:54:24.796105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:24.834782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:26.548172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d676d30-46e9-4e37-bddc-f9ab1bad4451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc47818aef0>]}
[0m17:54:26.549045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:54:26.549482 [info ] [MainThread]: 
[0m17:54:26.558076 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m17:54:26.558823 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m17:54:26.560365 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m17:54:26.560961 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m17:54:26.567138 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m17:54:26.568715 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 17:54:26.561335 => 2023-07-01 17:54:26.568546
[0m17:54:26.569237 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m17:54:26.595411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:27.505823 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m17:54:27.507727 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        -- row_number() over (order by fixed_customer_id) as customer_sk
        full_name
        , SHA256(cast(fixed_customer_id as string)) as customer_sk
        , SHA256(cast(full_name as string)) as customer_skllll
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m17:54:32.705866 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f264b48e-914e-46f3-bc7e-aa3286d6dabf&page=queryresults
[0m17:54:32.736124 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 17:54:26.569506 => 2023-07-01 17:54:32.736057
[0m17:54:32.737120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d676d30-46e9-4e37-bddc-f9ab1bad4451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc477f74790>]}
[0m17:54:32.737695 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customers ................ [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 6.18s]
[0m17:54:32.740081 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m17:54:32.742244 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:54:32.743782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:32.744320 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:54:32.744732 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:54:32.745168 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m17:54:32.745587 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:54:32.746036 [info ] [MainThread]: 
[0m17:54:32.746776 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.84 seconds (8.84s).
[0m17:54:32.747776 [debug] [MainThread]: Command end result
[0m17:54:32.793863 [info ] [MainThread]: 
[0m17:54:32.795721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:32.797070 [info ] [MainThread]: 
[0m17:54:32.797880 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:54:32.798815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc47c4b15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc47818b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc47806e2c0>]}
[0m17:54:32.800234 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:55:34.165927 | 6bda390c-0a8b-49cd-b0b2-89bd2c59f528 ==============================
[0m17:55:34.165927 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:55:34.167936 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:55:34.168594 [debug] [MainThread]: Tracking: tracking
[0m17:55:34.170224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873fa764d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873fa77970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873fa76d70>]}
[0m17:55:34.213245 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:55:34.354046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:55:34.354960 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m17:55:34.379714 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m17:55:34.419439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bda390c-0a8b-49cd-b0b2-89bd2c59f528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873f657880>]}
[0m17:55:34.443117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bda390c-0a8b-49cd-b0b2-89bd2c59f528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873f75e350>]}
[0m17:55:34.443640 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:55:34.444132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bda390c-0a8b-49cd-b0b2-89bd2c59f528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873f75e3b0>]}
[0m17:55:34.447823 [info ] [MainThread]: 
[0m17:55:34.450218 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:55:34.451578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:55:34.452043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:35.424843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:55:35.425493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:35.426270 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:55:35.427350 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:55:35.462201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:35.465110 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:55:35.465965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:35.467222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:36.901742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bda390c-0a8b-49cd-b0b2-89bd2c59f528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873f891f00>]}
[0m17:55:36.905462 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:55:36.909817 [info ] [MainThread]: 
[0m17:55:36.922555 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m17:55:36.924323 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m17:55:36.926704 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m17:55:36.927325 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m17:55:36.934413 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m17:55:36.936442 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 17:55:36.927743 => 2023-07-01 17:55:36.936267
[0m17:55:36.937204 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m17:55:36.972995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:37.904760 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m17:55:37.905824 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        -- row_number() over (order by fixed_customer_id) as customer_sk
        -- MD5
        SHA256(cast(fixed_customer_id as string)) as customer_sk
        , SHA256(cast(fixed_customer_id as string)) as customer_skllll
        , full_name 
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m17:55:41.564145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d7f92e3f-76ce-4d87-92ea-568fda77b55c&page=queryresults
[0m17:55:41.589689 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 17:55:36.937705 => 2023-07-01 17:55:41.589619
[0m17:55:41.590499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bda390c-0a8b-49cd-b0b2-89bd2c59f528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873f6662c0>]}
[0m17:55:41.591318 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customers ................ [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 4.66s]
[0m17:55:41.594706 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m17:55:41.597950 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:55:41.598975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:41.599728 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:55:41.600249 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m17:55:41.600592 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m17:55:41.601018 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:55:41.601555 [info ] [MainThread]: 
[0m17:55:41.604781 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m17:55:41.606111 [debug] [MainThread]: Command end result
[0m17:55:41.653214 [info ] [MainThread]: 
[0m17:55:41.654981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:41.656097 [info ] [MainThread]: 
[0m17:55:41.657321 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:55:41.658298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8743c1d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873f890850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873f75e4a0>]}
[0m17:55:41.659001 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:56:26.437340 | 998aed18-e0b2-40b2-af0e-0769874867c9 ==============================
[0m17:56:26.437340 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:56:26.439304 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:56:26.439768 [debug] [MainThread]: Tracking: tracking
[0m17:56:26.441952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44b172590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44b170fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44b1708e0>]}
[0m17:56:26.494602 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:56:26.630324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:26.631153 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m17:56:26.653550 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m17:56:26.692318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '998aed18-e0b2-40b2-af0e-0769874867c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44ad53a90>]}
[0m17:56:26.715253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '998aed18-e0b2-40b2-af0e-0769874867c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44ae56560>]}
[0m17:56:26.715765 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:56:26.716203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '998aed18-e0b2-40b2-af0e-0769874867c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44ae565c0>]}
[0m17:56:26.723000 [info ] [MainThread]: 
[0m17:56:26.726848 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:56:26.728512 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:56:26.729032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:27.595648 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:56:27.596564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:27.597442 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:56:27.598067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:27.600150 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:56:27.634806 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:56:27.635334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:27.635955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:29.097928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '998aed18-e0b2-40b2-af0e-0769874867c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44b173bb0>]}
[0m17:56:29.098969 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:56:29.099521 [info ] [MainThread]: 
[0m17:56:29.108424 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m17:56:29.109113 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m17:56:29.111076 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m17:56:29.111740 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m17:56:29.120154 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m17:56:29.121016 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 17:56:29.112630 => 2023-07-01 17:56:29.120899
[0m17:56:29.121567 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m17:56:29.161090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:30.130244 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m17:56:30.131305 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        -- row_number() over (order by fixed_customer_id) as customer_sk
        -- MD5
        MD5(fixed_customer_id) as customer_sk
        , SHA256(cast(fixed_customer_id as string)) as customer_skllll
        , full_name 
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m17:56:31.377102 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function MD5 for argument types: INT64. Supported signatures: MD5(BYTES); MD5(STRING) at [30:9]')
[0m17:56:32.555603 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c8f63bb8-be3a-4a33-842d-e8f5fe189cf2&page=queryresults
[0m17:56:32.556491 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 17:56:29.121978 => 2023-07-01 17:56:32.556362
[0m17:56:32.560678 [debug] [Thread-1 (]: Database Error in model dim_customers (models/gold/dim_customers.sql)
  No matching signature for function MD5 for argument types: INT64. Supported signatures: MD5(BYTES); MD5(STRING) at [30:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m17:56:32.561470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998aed18-e0b2-40b2-af0e-0769874867c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44ad60850>]}
[0m17:56:32.562340 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.dim_customers ............ [[31mERROR[0m in 3.45s]
[0m17:56:32.565725 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m17:56:32.567717 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:56:32.568479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:32.568786 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:56:32.569072 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:56:32.569354 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m17:56:32.569734 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:56:32.570258 [info ] [MainThread]: 
[0m17:56:32.571159 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m17:56:32.572190 [debug] [MainThread]: Command end result
[0m17:56:32.623211 [info ] [MainThread]: 
[0m17:56:32.623927 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:56:32.624634 [info ] [MainThread]: 
[0m17:56:32.625691 [error] [MainThread]: [33mDatabase Error in model dim_customers (models/gold/dim_customers.sql)[0m
[0m17:56:32.626594 [error] [MainThread]:   No matching signature for function MD5 for argument types: INT64. Supported signatures: MD5(BYTES); MD5(STRING) at [30:9]
[0m17:56:32.627570 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_customers.sql
[0m17:56:32.628242 [info ] [MainThread]: 
[0m17:56:32.628932 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:56:32.629821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44ace2e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44ae565f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44ae56680>]}
[0m17:56:32.630518 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:56:49.934628 | b2121f72-a942-4046-981e-4afbf2c268f4 ==============================
[0m17:56:49.934628 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:56:49.936611 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:56:49.937051 [debug] [MainThread]: Tracking: tracking
[0m17:56:49.939117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec711864a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec711862f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec71186c80>]}
[0m17:56:49.992378 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:56:50.133386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:50.134225 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m17:56:50.156218 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m17:56:50.194849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2121f72-a942-4046-981e-4afbf2c268f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec70f638b0>]}
[0m17:56:50.218795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2121f72-a942-4046-981e-4afbf2c268f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7106a3e0>]}
[0m17:56:50.219269 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:56:50.219812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2121f72-a942-4046-981e-4afbf2c268f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec70ef3ac0>]}
[0m17:56:50.223411 [info ] [MainThread]: 
[0m17:56:50.225801 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:56:50.227224 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m17:56:50.227777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:51.121628 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m17:56:51.122550 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m17:56:51.122956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:51.123608 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m17:56:51.124068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:51.124700 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m17:56:51.125350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:51.197072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:52.447209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2121f72-a942-4046-981e-4afbf2c268f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec71184f40>]}
[0m17:56:52.448444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:56:52.452087 [info ] [MainThread]: 
[0m17:56:52.460603 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m17:56:52.461124 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m17:56:52.462343 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m17:56:52.463250 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m17:56:52.469699 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m17:56:52.471307 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 17:56:52.463769 => 2023-07-01 17:56:52.471015
[0m17:56:52.472570 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m17:56:52.508337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:53.479138 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m17:56:53.480423 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        -- row_number() over (order by fixed_customer_id) as customer_sk
        -- MD5
        MD5(cast(fixed_customer_id as string)) as customer_sk
        , SHA256(cast(fixed_customer_id as string)) as customer_skllll
        , full_name 
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m17:56:56.810303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ece49e14-c14f-4366-bb19-39a6febdf2e4&page=queryresults
[0m17:56:56.829451 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 17:56:52.474123 => 2023-07-01 17:56:56.829385
[0m17:56:56.830752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2121f72-a942-4046-981e-4afbf2c268f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec70f727d0>]}
[0m17:56:56.831844 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_customers ................ [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 4.37s]
[0m17:56:56.836280 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m17:56:56.839595 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:56:56.840925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:56.841435 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m17:56:56.841884 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m17:56:56.842307 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m17:56:56.842726 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m17:56:56.843229 [info ] [MainThread]: 
[0m17:56:56.844276 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.62 seconds (6.62s).
[0m17:56:56.845789 [debug] [MainThread]: Command end result
[0m17:56:56.884465 [info ] [MainThread]: 
[0m17:56:56.885781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:56.887113 [info ] [MainThread]: 
[0m17:56:56.888419 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:56:56.890105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec754c9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec70ef2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec70f63b50>]}
[0m17:56:56.890856 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 17:58:30.792378 | d33edf2a-fb03-43bf-a646-292fac2e2bd7 ==============================
[0m17:58:30.792378 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:58:30.794351 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_cards'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:58:30.794770 [debug] [MainThread]: Tracking: tracking
[0m17:58:30.796563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5bc76da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5bc762f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5bc76c80>]}
[0m17:58:30.839774 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:58:30.986460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:58:30.987326 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_cards_type.sql
[0m17:58:30.987779 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_customers.sql
[0m17:58:30.988186 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m17:58:31.012458 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_cards_type.sql
[0m17:58:31.028497 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m17:58:31.033247 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m17:58:31.098855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd33edf2a-fb03-43bf-a646-292fac2e2bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5b11dab0>]}
[0m17:58:31.124149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd33edf2a-fb03-43bf-a646-292fac2e2bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5b7e6e00>]}
[0m17:58:31.124643 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m17:58:31.125063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd33edf2a-fb03-43bf-a646-292fac2e2bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5b7e7ac0>]}
[0m17:58:31.126682 [warn ] [MainThread]: The selection criterion 'dim_cards' does not match any nodes
[0m17:58:31.129568 [info ] [MainThread]: 
[0m17:58:31.130423 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:58:31.131150 [debug] [MainThread]: Command end result
[0m17:58:31.154733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5efc6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5b7e6c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5b7e6cb0>]}
[0m17:58:31.155733 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:00:50.971416 | 72fa2306-90fe-41ab-a2f0-054b9ab75c3d ==============================
[0m18:00:50.971416 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:00:50.973426 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:00:50.974088 [debug] [MainThread]: Tracking: tracking
[0m18:00:50.975884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd5082320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd50816f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd50822f0>]}
[0m18:00:51.019886 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:00:51.177577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m18:00:51.178627 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_product.sql
[0m18:00:51.179064 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_reasons.sql
[0m18:00:51.179589 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m18:00:51.180113 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_cards_type.sql
[0m18:00:51.180522 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.sql
[0m18:00:51.225873 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_product.sql
[0m18:00:51.254737 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_reasons.sql
[0m18:00:51.262734 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m18:00:51.268396 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_cards_type.sql
[0m18:00:51.274781 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m18:00:51.420870 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m18:00:51.471177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd449c490>]}
[0m18:00:51.520209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4dee8f0>]}
[0m18:00:51.520780 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:00:51.521433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4def820>]}
[0m18:00:51.531562 [info ] [MainThread]: 
[0m18:00:51.536218 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:00:51.541091 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:00:51.543079 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:00:51.543921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:51.545084 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:00:51.545843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:51.585102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:53.513735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:00:53.514734 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:00:53.515874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:00:53.516260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:53.517215 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:00:53.517833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:53.518323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:53.518897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:54.874770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4deead0>]}
[0m18:00:54.875666 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:54.876305 [info ] [MainThread]: 
[0m18:00:54.882397 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m18:00:54.883070 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_address
[0m18:00:54.884752 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_address_type
[0m18:00:54.884025 [info ] [Thread-1 (]: 1 of 46 START sql table model dev_thaina_gold.dim_dates ........................ [RUN]
[0m18:00:54.885835 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_address
[0m18:00:54.886248 [info ] [Thread-2 (]: 2 of 46 START sql table model dev_thaina_silver.stg_person_address ............. [RUN]
[0m18:00:54.886929 [info ] [Thread-3 (]: 3 of 46 START sql table model dev_thaina_silver.stg_person_address_type ........ [RUN]
[0m18:00:54.888343 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m18:00:54.889138 [info ] [Thread-4 (]: 4 of 46 START sql table model dev_thaina_silver.stg_person_business_entity_address  [RUN]
[0m18:00:54.892318 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address'
[0m18:00:54.893304 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address_type'
[0m18:00:54.894508 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m18:00:54.897244 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_address'
[0m18:00:54.905490 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_address
[0m18:00:54.899238 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_address_type
[0m18:00:54.898743 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_address
[0m18:00:54.939194 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address_type"
[0m18:00:54.940259 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_address"
[0m18:00:54.959157 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (compile): 2023-07-01 18:00:54.920768 => 2023-07-01 18:00:54.958908
[0m18:00:54.986757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:54.993413 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_address_type
[0m18:00:54.994923 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address"
[0m18:00:54.995682 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (compile): 2023-07-01 18:00:54.906504 => 2023-07-01 18:00:54.995593
[0m18:00:55.015499 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:55.016048 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_business_entity_address
[0m18:00:55.018224 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m18:00:55.018515 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (compile): 2023-07-01 18:00:54.928461 => 2023-07-01 18:00:55.018429
[0m18:00:55.053916 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:55.088452 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_address
[0m18:00:55.091755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:56.858941 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address_type"
[0m18:00:56.859800 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_address_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addresstypeid as address_type_id
    , name as address_type_name 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`addresstype`
)

select *
from source_data
    );
  
[0m18:00:57.112459 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_address"
[0m18:00:57.113452 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_business_entity_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , addressid as address_id
    , addresstypeid as address_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentityaddress`
)

select *
from source_data
    );
  
[0m18:00:57.148190 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address"
[0m18:00:57.149060 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
    );
  
[0m18:00:58.557378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e232f093-387a-4f05-a2a8-94d784fe1948&page=queryresults
[0m18:00:58.597604 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m18:00:58.598599 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-07-01 18:00:54.899650 => 2023-07-01 18:00:58.598457
[0m18:00:58.599478 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m18:00:59.239790 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m18:00:59.240769 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      /* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m18:01:00.611960 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:aea71b4c-64a1-46fa-b721-3ac7107e65b6&page=queryresults
[0m18:01:00.658004 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (execute): 2023-07-01 18:00:54.995889 => 2023-07-01 18:01:00.657896
[0m18:01:00.659418 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4385de0>]}
[0m18:01:00.660003 [info ] [Thread-3 (]: 3 of 46 OK created sql table model dev_thaina_silver.stg_person_address_type ... [[32mCREATE TABLE (6.0 rows, 332.0 Bytes processed)[0m in 5.77s]
[0m18:01:00.662758 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_address_type
[0m18:01:00.663331 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_business_entity_contact
[0m18:01:00.663949 [info ] [Thread-3 (]: 5 of 46 START sql table model dev_thaina_silver.stg_person_business_entity_contact  [RUN]
[0m18:01:00.664906 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_contact'
[0m18:01:00.665299 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_contact
[0m18:01:00.669654 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m18:01:00.670286 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (compile): 2023-07-01 18:01:00.665530 => 2023-07-01 18:01:00.670187
[0m18:01:00.670773 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_business_entity_contact
[0m18:01:00.674888 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:00.796343 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:05803bd5-6ac5-48c4-aaa8-7b31e77acd17&page=queryresults
[0m18:01:00.800249 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (execute): 2023-07-01 18:00:55.051295 => 2023-07-01 18:01:00.800137
[0m18:01:00.801845 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4386170>]}
[0m18:01:00.802883 [info ] [Thread-4 (]: 4 of 46 OK created sql table model dev_thaina_silver.stg_person_business_entity_address  [[32mCREATE TABLE (19.6k rows, 1.2 MB processed)[0m in 5.91s]
[0m18:01:00.804081 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_address
[0m18:01:00.804939 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_contact_type
[0m18:01:00.805797 [info ] [Thread-4 (]: 6 of 46 START sql table model dev_thaina_silver.stg_person_contact_type ........ [RUN]
[0m18:01:00.807235 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_contact_type'
[0m18:01:00.807934 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_contact_type
[0m18:01:00.814471 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_contact_type"
[0m18:01:00.815292 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_contact_type (compile): 2023-07-01 18:01:00.808384 => 2023-07-01 18:01:00.815176
[0m18:01:00.815888 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_contact_type
[0m18:01:00.822170 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:01.152329 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d5720a47-f79c-4ffb-b25f-0f762ede3bd1&page=queryresults
[0m18:01:01.155192 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (execute): 2023-07-01 18:00:55.089091 => 2023-07-01 18:01:01.155125
[0m18:01:01.156299 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4384ee0>]}
[0m18:01:01.156877 [info ] [Thread-2 (]: 2 of 46 OK created sql table model dev_thaina_silver.stg_person_address ........ [[32mCREATE TABLE (19.6k rows, 1.7 MB processed)[0m in 6.26s]
[0m18:01:01.157532 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_address
[0m18:01:01.158365 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_country_region
[0m18:01:01.159332 [info ] [Thread-2 (]: 7 of 46 START sql table model dev_thaina_silver.stg_person_country_region ...... [RUN]
[0m18:01:01.160816 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_country_region'
[0m18:01:01.161479 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_country_region
[0m18:01:01.168026 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_country_region"
[0m18:01:01.168843 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_country_region (compile): 2023-07-01 18:01:01.162017 => 2023-07-01 18:01:01.168725
[0m18:01:01.169387 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_country_region
[0m18:01:01.176450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:03.265164 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m18:01:03.267798 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_business_entity_contact: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_contact"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , personid as person_id
    , contacttypeid as contact_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentitycontact`
)

select *
from source_data
    );
  
[0m18:01:03.290718 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_contact_type"
[0m18:01:03.291969 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_contact_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_contact_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    contacttypeid as contact_type_id
    , name as contact_type_name 
  from  `desafiothaina`.`dev_thaina`.`contacttype`
)

select *
from source_data
    );
  
[0m18:01:03.508369 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_country_region"
[0m18:01:03.509272 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_country_region: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_country_region"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
    );
  
[0m18:01:04.221306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4ab408b7-34dc-4d33-998f-e62a7a42fe36&page=queryresults
[0m18:01:04.930210 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-07-01 18:00:58.599968 => 2023-07-01 18:01:04.930139
[0m18:01:04.931201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd43856f0>]}
[0m18:01:04.931926 [info ] [Thread-1 (]: 1 of 46 OK created sql table model dev_thaina_gold.dim_dates ................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 10.04s]
[0m18:01:04.932715 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m18:01:04.933413 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_person_person
[0m18:01:04.934274 [info ] [Thread-1 (]: 8 of 46 START sql table model dev_thaina_silver.stg_person_person .............. [RUN]
[0m18:01:04.935978 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_person'
[0m18:01:04.936468 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_person_person
[0m18:01:04.941085 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_person"
[0m18:01:04.941791 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_person_person (compile): 2023-07-01 18:01:04.936768 => 2023-07-01 18:01:04.941670
[0m18:01:04.942323 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_person_person
[0m18:01:04.945474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:05.896034 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_person"
[0m18:01:05.896962 [debug] [Thread-1 (]: On model.desafioaethaina.stg_person_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
    );
  
[0m18:01:06.029527 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7b5e9734-1e69-4a04-b8f8-4ad0dc6e06c7&page=queryresults
[0m18:01:06.034097 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_contact_type (execute): 2023-07-01 18:01:00.816301 => 2023-07-01 18:01:06.033988
[0m18:01:06.035509 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd444a980>]}
[0m18:01:06.036458 [info ] [Thread-4 (]: 6 of 46 OK created sql table model dev_thaina_silver.stg_person_contact_type ... [[32mCREATE TABLE (20.0 rows, 595.0 Bytes processed)[0m in 5.23s]
[0m18:01:06.037572 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_contact_type
[0m18:01:06.038460 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_state_province
[0m18:01:06.039609 [info ] [Thread-4 (]: 9 of 46 START sql table model dev_thaina_silver.stg_person_state_province ...... [RUN]
[0m18:01:06.041205 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_state_province'
[0m18:01:06.041894 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_state_province
[0m18:01:06.049607 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_state_province"
[0m18:01:06.050939 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_state_province (compile): 2023-07-01 18:01:06.042390 => 2023-07-01 18:01:06.050740
[0m18:01:06.051830 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_state_province
[0m18:01:06.065114 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:06.142129 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:599c330a-dc19-4a92-b723-b29b6cc43b8f&page=queryresults
[0m18:01:06.147294 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_country_region (execute): 2023-07-01 18:01:01.169896 => 2023-07-01 18:01:06.147128
[0m18:01:06.149834 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4467580>]}
[0m18:01:06.151545 [info ] [Thread-2 (]: 7 of 46 OK created sql table model dev_thaina_silver.stg_person_country_region . [[32mCREATE TABLE (238.0 rows, 3.7 KB processed)[0m in 4.99s]
[0m18:01:06.152962 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_country_region
[0m18:01:06.154257 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product
[0m18:01:06.156114 [info ] [Thread-2 (]: 10 of 46 START sql table model dev_thaina_silver.stg_product ................... [RUN]
[0m18:01:06.158340 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product'
[0m18:01:06.159786 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product
[0m18:01:06.191538 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product"
[0m18:01:06.193172 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product (compile): 2023-07-01 18:01:06.171639 => 2023-07-01 18:01:06.192948
[0m18:01:06.195025 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product
[0m18:01:06.214966 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:06.368104 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8dbd3bca-cb9c-4269-b9d2-2313871d5d53&page=queryresults
[0m18:01:06.371936 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (execute): 2023-07-01 18:01:00.671131 => 2023-07-01 18:01:06.371843
[0m18:01:06.373275 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd420a590>]}
[0m18:01:06.374151 [info ] [Thread-3 (]: 5 of 46 OK created sql table model dev_thaina_silver.stg_person_business_entity_contact  [[32mCREATE TABLE (909.0 rows, 55.0 KB processed)[0m in 5.71s]
[0m18:01:06.375097 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_business_entity_contact
[0m18:01:06.376402 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_category
[0m18:01:06.377450 [info ] [Thread-3 (]: 11 of 46 START sql table model dev_thaina_silver.stg_product_category .......... [RUN]
[0m18:01:06.379078 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_category'
[0m18:01:06.379979 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_category
[0m18:01:06.386808 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_category"
[0m18:01:06.388202 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_category (compile): 2023-07-01 18:01:06.380639 => 2023-07-01 18:01:06.388043
[0m18:01:06.388828 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_category
[0m18:01:06.396630 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:07.164557 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_state_province"
[0m18:01:07.165608 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_state_province: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_state_province"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
    );
  
[0m18:01:07.250216 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product"
[0m18:01:07.251258 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , productmodelid as product_model_id
    , productsubcategoryid as product_subcategory_id
    , name as product_name
    , productnumber as product_number
    , makeflag
    , finishedgoodsflag as finished_goods_flag
    , color
    , safetystocklevel as safety_stock_level
    , standardcost as stand_cost
    , listprice as list_price
    , size as size_product
    , style as style_product
    , weight as weight_product 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`product`
)

select * from source_data
    );
  
[0m18:01:07.563524 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_category"
[0m18:01:07.564220 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_category: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_category"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productcategoryid as category_id
    , name as category_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productcategory`
)

select *
from source_data
    );
  
[0m18:01:09.163324 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:85c6ab5a-176a-4c10-8674-81b25f37b722&page=queryresults
[0m18:01:09.166412 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_person_person (execute): 2023-07-01 18:01:04.942596 => 2023-07-01 18:01:09.166327
[0m18:01:09.167406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4384be0>]}
[0m18:01:09.167953 [info ] [Thread-1 (]: 8 of 46 OK created sql table model dev_thaina_silver.stg_person_person ......... [[32mCREATE TABLE (20.0k rows, 1.5 MB processed)[0m in 4.23s]
[0m18:01:09.168630 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_person_person
[0m18:01:09.169349 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_description
[0m18:01:09.170252 [info ] [Thread-1 (]: 12 of 46 START sql table model dev_thaina_silver.stg_product_description ....... [RUN]
[0m18:01:09.171633 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_description'
[0m18:01:09.172182 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_description
[0m18:01:09.178685 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_description"
[0m18:01:09.179663 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_description (compile): 2023-07-01 18:01:09.172538 => 2023-07-01 18:01:09.179522
[0m18:01:09.180289 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_description
[0m18:01:09.187302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:09.855158 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:daceddfa-b44e-454f-89f3-5f1f15ad4f44&page=queryresults
[0m18:01:09.857934 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_state_province (execute): 2023-07-01 18:01:06.052476 => 2023-07-01 18:01:09.857870
[0m18:01:09.858830 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd434f7c0>]}
[0m18:01:09.859756 [info ] [Thread-4 (]: 9 of 46 OK created sql table model dev_thaina_silver.stg_person_state_province . [[32mCREATE TABLE (181.0 rows, 13.4 KB processed)[0m in 3.82s]
[0m18:01:09.860783 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_state_province
[0m18:01:09.862318 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_inventory
[0m18:01:09.863752 [info ] [Thread-4 (]: 13 of 46 START sql table model dev_thaina_silver.stg_product_inventory ......... [RUN]
[0m18:01:09.865336 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_inventory'
[0m18:01:09.866016 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_inventory
[0m18:01:09.871071 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_inventory"
[0m18:01:09.871797 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_inventory (compile): 2023-07-01 18:01:09.866480 => 2023-07-01 18:01:09.871694
[0m18:01:09.872227 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product_inventory
[0m18:01:09.882621 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:10.133563 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_description"
[0m18:01:10.134217 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_description: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_description"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_description`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productdescriptionid as product_description_id
    , description as product_description
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productdescription`
)

select *
from source_data
    );
  
[0m18:01:10.213347 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b50751d6-9766-42aa-bf76-3e9de8f81d74&page=queryresults
[0m18:01:10.215742 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_category (execute): 2023-07-01 18:01:06.389231 => 2023-07-01 18:01:10.215666
[0m18:01:10.216613 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4187640>]}
[0m18:01:10.217127 [info ] [Thread-3 (]: 11 of 46 OK created sql table model dev_thaina_silver.stg_product_category ..... [[32mCREATE TABLE (4.0 rows, 226.0 Bytes processed)[0m in 3.84s]
[0m18:01:10.217778 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_category
[0m18:01:10.218334 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_location
[0m18:01:10.219008 [info ] [Thread-3 (]: 14 of 46 START sql table model dev_thaina_silver.stg_product_location .......... [RUN]
[0m18:01:10.220415 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_location'
[0m18:01:10.221025 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_location
[0m18:01:10.341257 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:23e4ff11-bd1d-4fe1-a87d-57e12dae4e24&page=queryresults
[0m18:01:10.349278 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product (execute): 2023-07-01 18:01:06.195825 => 2023-07-01 18:01:10.349209
[0m18:01:10.352825 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4186b60>]}
[0m18:01:10.354269 [info ] [Thread-2 (]: 10 of 46 OK created sql table model dev_thaina_silver.stg_product .............. [[32mCREATE TABLE (504.0 rows, 60.1 KB processed)[0m in 4.20s]
[0m18:01:10.357457 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product
[0m18:01:10.361306 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_model
[0m18:01:10.365862 [info ] [Thread-2 (]: 15 of 46 START sql table model dev_thaina_silver.stg_product_model ............. [RUN]
[0m18:01:10.370914 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_model'
[0m18:01:10.374920 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_model
[0m18:01:10.421498 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_model"
[0m18:01:10.423301 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_model (compile): 2023-07-01 18:01:10.402599 => 2023-07-01 18:01:10.423150
[0m18:01:10.423935 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product_model
[0m18:01:10.416331 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_location"
[0m18:01:10.431940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:10.433167 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_location (compile): 2023-07-01 18:01:10.221276 => 2023-07-01 18:01:10.432940
[0m18:01:10.435257 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_location
[0m18:01:10.480615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:10.898058 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_inventory"
[0m18:01:10.899001 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product_inventory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_inventory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , locationid as location_id
    , shelf
    , bin
    , quantity as quantity_inventory
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productinventory`
)

select *
from source_data
    );
  
[0m18:01:11.390249 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_model"
[0m18:01:11.390823 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product_model: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_model"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productmodelid as model_id
    , name as model_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productmodel`
)

select *
from source_data
    );
  
[0m18:01:11.430352 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_location"
[0m18:01:11.430926 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_location: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_location"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    locationid as location_id
    , name as location_name
    -- Standard hourly cost of the manufacturing location.
    , costrate as cost_rate
    -- Work capacity (in hours) of the manufacturing location.
    , availability 
  from  `desafiothaina`.`dev_thaina`.`location`
)

select *
from source_data
    );
  
[0m18:01:13.074693 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9aa44968-c26c-4525-9332-cbdc9284dc4a&page=queryresults
[0m18:01:13.078058 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_description (execute): 2023-07-01 18:01:09.180713 => 2023-07-01 18:01:13.077981
[0m18:01:13.078903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4259ab0>]}
[0m18:01:13.079476 [info ] [Thread-1 (]: 12 of 46 OK created sql table model dev_thaina_silver.stg_product_description .. [[32mCREATE TABLE (762.0 rows, 125.4 KB processed)[0m in 3.91s]
[0m18:01:13.080095 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_description
[0m18:01:13.080749 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_subcategory
[0m18:01:13.081704 [info ] [Thread-1 (]: 16 of 46 START sql table model dev_thaina_silver.stg_product_subcategory ....... [RUN]
[0m18:01:13.083020 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_subcategory'
[0m18:01:13.083699 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_subcategory
[0m18:01:13.090238 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_subcategory"
[0m18:01:13.091200 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_subcategory (compile): 2023-07-01 18:01:13.084287 => 2023-07-01 18:01:13.091087
[0m18:01:13.091745 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_subcategory
[0m18:01:13.102636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:13.491090 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b02dac25-b63e-4697-8b0d-ffd70dc0d98f&page=queryresults
[0m18:01:13.496867 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_inventory (execute): 2023-07-01 18:01:09.872437 => 2023-07-01 18:01:13.496743
[0m18:01:13.498548 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4413070>]}
[0m18:01:13.500678 [info ] [Thread-4 (]: 13 of 46 OK created sql table model dev_thaina_silver.stg_product_inventory .... [[32mCREATE TABLE (1.1k rows, 76.8 KB processed)[0m in 3.63s]
[0m18:01:13.508176 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_inventory
[0m18:01:13.509031 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m18:01:13.509805 [info ] [Thread-4 (]: 17 of 46 START sql table model dev_thaina_silver.stg_purchase_order_detail ..... [RUN]
[0m18:01:13.511070 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m18:01:13.511680 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m18:01:13.518058 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m18:01:13.523944 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-07-01 18:01:13.512093 => 2023-07-01 18:01:13.523781
[0m18:01:13.524550 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_purchase_order_detail
[0m18:01:13.532435 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:14.028714 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_subcategory"
[0m18:01:14.029678 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_subcategory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_subcategory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productsubcategoryid as subcategory_id
    , productcategoryid as category_id
    , name as subcategory_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productsubcategory`
)

select *
from source_data
    );
  
[0m18:01:14.174527 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a456f17f-c332-4a7c-9378-bc3ac275f324&page=queryresults
[0m18:01:14.178237 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_location (execute): 2023-07-01 18:01:10.474763 => 2023-07-01 18:01:14.178162
[0m18:01:14.179242 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4240f70>]}
[0m18:01:14.179935 [info ] [Thread-3 (]: 14 of 46 OK created sql table model dev_thaina_silver.stg_product_location ..... [[32mCREATE TABLE (14.0 rows, 670.0 Bytes processed)[0m in 3.96s]
[0m18:01:14.180704 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_location
[0m18:01:14.181721 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchase_order_header
[0m18:01:14.182585 [info ] [Thread-3 (]: 18 of 46 START sql table model dev_thaina_silver.stg_purchase_order_header ..... [RUN]
[0m18:01:14.184190 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_header'
[0m18:01:14.184718 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchase_order_header
[0m18:01:14.194466 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_header"
[0m18:01:14.195720 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (compile): 2023-07-01 18:01:14.185239 => 2023-07-01 18:01:14.195559
[0m18:01:14.196628 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchase_order_header
[0m18:01:14.206525 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:14.211261 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:50e5a0be-6429-4eca-861b-1abfe55c0e9b&page=queryresults
[0m18:01:14.219085 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_model (execute): 2023-07-01 18:01:10.425164 => 2023-07-01 18:01:14.218952
[0m18:01:14.272046 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4e204c0>]}
[0m18:01:14.280102 [info ] [Thread-2 (]: 15 of 46 OK created sql table model dev_thaina_silver.stg_product_model ........ [[32mCREATE TABLE (128.0 rows, 8.0 KB processed)[0m in 3.90s]
[0m18:01:14.282301 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_model
[0m18:01:14.283537 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_purchasing_product_vendor
[0m18:01:14.285689 [info ] [Thread-2 (]: 19 of 46 START sql table model dev_thaina_silver.stg_purchasing_product_vendor . [RUN]
[0m18:01:14.287551 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_product_vendor'
[0m18:01:14.288491 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_purchasing_product_vendor
[0m18:01:14.297564 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m18:01:14.299000 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (compile): 2023-07-01 18:01:14.289446 => 2023-07-01 18:01:14.298664
[0m18:01:14.300714 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_purchasing_product_vendor
[0m18:01:14.306665 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:14.440284 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_detail"
[0m18:01:14.441045 [debug] [Thread-4 (]: On model.desafioaethaina.stg_purchase_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , purchaseorderdetailid as purchase_order_detail_id
    , cast(duedate as date) as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m18:01:15.227666 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_header"
[0m18:01:15.228818 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchase_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    purchaseorderid as purchase_order_id
    , revisionnumber as revision_number
    , status as status_order
    , employeeid as employee_id
    , vendorid as vendor_id
    , shipmethodid as ship_method_id
    , shipdate as ship_date
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight  
    /* Total due to vendor. Computed as Subtotal + TaxAmt + Freight.
Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0))  */
  from
    `desafiothaina`.`dev_thaina`.`purchaseorderheader`
)

select * 
  from source_data
    );
  
[0m18:01:15.237904 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m18:01:15.238745 [debug] [Thread-2 (]: On model.desafioaethaina.stg_purchasing_product_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_product_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_product_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , productid as product_id
    , standardprice as standard_price
    , minorderqty as min_order_qty
    , maxorderqty as max_order_qty
    , onorderqty as on_order_qty
    , unitmeasurecode as unit_measure_code
  from  `desafiothaina`.`dev_thaina`.`productvendor`
)

select *
from source_data
    );
  
[0m18:01:15.771858 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '2011-04-30 00:00:00.000'")
[0m18:01:17.174038 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cba13fd7-158a-4037-b22f-c6242193bc26&page=queryresults
[0m18:01:17.176570 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_subcategory (execute): 2023-07-01 18:01:13.091991 => 2023-07-01 18:01:17.176506
[0m18:01:17.177324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd42409a0>]}
[0m18:01:17.177815 [info ] [Thread-1 (]: 16 of 46 OK created sql table model dev_thaina_silver.stg_product_subcategory .. [[32mCREATE TABLE (37.0 rows, 2.3 KB processed)[0m in 4.10s]
[0m18:01:17.179162 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_subcategory
[0m18:01:17.180414 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchasing_ship_method
[0m18:01:17.181263 [info ] [Thread-1 (]: 20 of 46 START sql table model dev_thaina_silver.stg_purchasing_ship_method .... [RUN]
[0m18:01:17.182371 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_ship_method'
[0m18:01:17.182764 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchasing_ship_method
[0m18:01:17.186490 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m18:01:17.187239 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (compile): 2023-07-01 18:01:17.183013 => 2023-07-01 18:01:17.186999
[0m18:01:17.187725 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchasing_ship_method
[0m18:01:17.192565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:17.400290 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:341cb169-dcbe-4777-8ca4-b4909e2e3f7c&page=queryresults
[0m18:01:17.401074 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (execute): 2023-07-01 18:01:13.525059 => 2023-07-01 18:01:17.400963
[0m18:01:17.405031 [debug] [Thread-4 (]: Database Error in model stg_purchase_order_detail (models/silver/purchasing/stg_purchase_order_detail.sql)
  Invalid date: '2011-04-30 00:00:00.000'
  compiled Code at target/run/desafioaethaina/models/silver/purchasing/stg_purchase_order_detail.sql
[0m18:01:17.405771 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd43bb460>]}
[0m18:01:17.406585 [error] [Thread-4 (]: 17 of 46 ERROR creating sql table model dev_thaina_silver.stg_purchase_order_detail  [[31mERROR[0m in 3.90s]
[0m18:01:17.407537 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m18:01:17.408295 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchasing_vendor
[0m18:01:17.409015 [info ] [Thread-4 (]: 21 of 46 START sql table model dev_thaina_silver.stg_purchasing_vendor ......... [RUN]
[0m18:01:17.410577 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_vendor'
[0m18:01:17.411139 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchasing_vendor
[0m18:01:17.417558 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_vendor"
[0m18:01:17.418951 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (compile): 2023-07-01 18:01:17.411541 => 2023-07-01 18:01:17.418623
[0m18:01:17.420076 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_purchasing_vendor
[0m18:01:17.427731 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:17.914481 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7476142f-8b9d-4a30-9a0d-03eb9c899d54&page=queryresults
[0m18:01:17.916750 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (execute): 2023-07-01 18:01:14.197415 => 2023-07-01 18:01:17.916687
[0m18:01:17.917518 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4459660>]}
[0m18:01:17.918068 [info ] [Thread-3 (]: 18 of 46 OK created sql table model dev_thaina_silver.stg_purchase_order_header  [[32mCREATE TABLE (4.0k rows, 380.0 KB processed)[0m in 3.73s]
[0m18:01:17.918776 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchase_order_header
[0m18:01:17.919626 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_country_region_currency
[0m18:01:17.920544 [info ] [Thread-3 (]: 22 of 46 START sql table model dev_thaina_silver.stg_sales_country_region_currency  [RUN]
[0m18:01:17.922090 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_country_region_currency'
[0m18:01:17.922711 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_country_region_currency
[0m18:01:17.929414 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m18:01:17.930206 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (compile): 2023-07-01 18:01:17.923160 => 2023-07-01 18:01:17.930105
[0m18:01:17.930791 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_country_region_currency
[0m18:01:17.937263 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:18.021258 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m18:01:18.022097 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchasing_ship_method: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_ship_method"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
    );
  
[0m18:01:18.166051 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ebe8a7e8-39dc-4220-ade7-ae725d64b5ba&page=queryresults
[0m18:01:18.169192 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (execute): 2023-07-01 18:01:14.301188 => 2023-07-01 18:01:18.169124
[0m18:01:18.169983 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd43850c0>]}
[0m18:01:18.170482 [info ] [Thread-2 (]: 19 of 46 OK created sql table model dev_thaina_silver.stg_purchasing_product_vendor  [[32mCREATE TABLE (460.0 rows, 21.4 KB processed)[0m in 3.88s]
[0m18:01:18.171015 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_purchasing_product_vendor
[0m18:01:18.171644 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_creditcard
[0m18:01:18.172354 [info ] [Thread-2 (]: 23 of 46 START sql table model dev_thaina_silver.stg_sales_creditcard .......... [RUN]
[0m18:01:18.173598 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_creditcard'
[0m18:01:18.174052 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_creditcard
[0m18:01:18.177987 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_creditcard"
[0m18:01:18.179447 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (compile): 2023-07-01 18:01:18.174348 => 2023-07-01 18:01:18.179301
[0m18:01:18.179915 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_creditcard
[0m18:01:18.183172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:18.259051 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_vendor"
[0m18:01:18.259821 [debug] [Thread-4 (]: On model.desafioaethaina.stg_purchasing_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , accountnumber as account_number
    , name as company_name
    -- 1 = Superior, 2 = Excellent, 3 = Above average, 4 = Average, 5 = Below
    , creditrating as credit_rate
    , activeflag as active_flag
  from  `desafiothaina`.`dev_thaina`.`vendor`
)

select *
from source_data
    );
  
[0m18:01:18.821819 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m18:01:18.822462 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_country_region_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_country_region_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_country_region_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
      countryregioncode as country_region_code
      , currencycode as currency_code
    from `desafiothaina`.`dev_thaina`.`countryregioncurrency`
  )
select  *
from source_data
    );
  
[0m18:01:19.044532 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_creditcard"
[0m18:01:19.045177 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_creditcard: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_creditcard"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    creditcardid as credit_card_id
    , cardtype as card_type
  from  `desafiothaina`.`dev_thaina`.`creditcard`
)
select *
from source_data
    );
  
[0m18:01:20.988910 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bd509176-5bcc-480e-968f-3e4176d35ab3&page=queryresults
[0m18:01:20.993213 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (execute): 2023-07-01 18:01:17.188006 => 2023-07-01 18:01:20.993140
[0m18:01:20.994492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4240670>]}
[0m18:01:20.995144 [info ] [Thread-1 (]: 20 of 46 OK created sql table model dev_thaina_silver.stg_purchasing_ship_method  [[32mCREATE TABLE (5.0 rows, 400.0 Bytes processed)[0m in 3.81s]
[0m18:01:20.995849 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchasing_ship_method
[0m18:01:20.996342 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_currency
[0m18:01:20.997067 [info ] [Thread-1 (]: 24 of 46 START sql table model dev_thaina_silver.stg_sales_currency ............ [RUN]
[0m18:01:20.998149 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency'
[0m18:01:20.998585 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_currency
[0m18:01:21.002528 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency"
[0m18:01:21.003139 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_currency (compile): 2023-07-01 18:01:20.998807 => 2023-07-01 18:01:21.003040
[0m18:01:21.003589 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_currency
[0m18:01:21.008648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:21.275723 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6890bcdf-3ac1-4e16-8307-44a1d1409ecb&page=queryresults
[0m18:01:21.278452 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (execute): 2023-07-01 18:01:17.420921 => 2023-07-01 18:01:21.278381
[0m18:01:21.279299 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd434f880>]}
[0m18:01:21.279898 [info ] [Thread-4 (]: 21 of 46 OK created sql table model dev_thaina_silver.stg_purchasing_vendor .... [[32mCREATE TABLE (104.0 rows, 5.1 KB processed)[0m in 3.87s]
[0m18:01:21.280554 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchasing_vendor
[0m18:01:21.281129 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_currency_rate
[0m18:01:21.281779 [info ] [Thread-4 (]: 25 of 46 START sql table model dev_thaina_silver.stg_sales_currency_rate ....... [RUN]
[0m18:01:21.282987 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency_rate'
[0m18:01:21.283446 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_currency_rate
[0m18:01:21.287473 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency_rate"
[0m18:01:21.288009 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (compile): 2023-07-01 18:01:21.283708 => 2023-07-01 18:01:21.287934
[0m18:01:21.288328 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_currency_rate
[0m18:01:21.294397 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:21.624848 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2d58ce33-212b-4338-9a82-32ffe620e461&page=queryresults
[0m18:01:21.627142 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (execute): 2023-07-01 18:01:17.931186 => 2023-07-01 18:01:21.627080
[0m18:01:21.627917 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd447f220>]}
[0m18:01:21.628422 [info ] [Thread-3 (]: 22 of 46 OK created sql table model dev_thaina_silver.stg_sales_country_region_currency  [[32mCREATE TABLE (109.0 rows, 981.0 Bytes processed)[0m in 3.71s]
[0m18:01:21.629045 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_country_region_currency
[0m18:01:21.629600 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_customer
[0m18:01:21.630202 [info ] [Thread-3 (]: 26 of 46 START sql table model dev_thaina_silver.stg_sales_customer ............ [RUN]
[0m18:01:21.631308 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_customer'
[0m18:01:21.631738 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_customer
[0m18:01:21.635592 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_customer"
[0m18:01:21.636203 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_customer (compile): 2023-07-01 18:01:21.631957 => 2023-07-01 18:01:21.636106
[0m18:01:21.636633 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_customer
[0m18:01:21.641780 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:21.861583 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency"
[0m18:01:21.862457 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    currencycode as currency_code
    , name as currency_name
  from  `desafiothaina`.`dev_thaina`.`currency`
)

select *
from source_data
    );
  
[0m18:01:21.980894 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:47e25c9b-107f-45a6-837f-fca1c1da5aab&page=queryresults
[0m18:01:21.984652 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (execute): 2023-07-01 18:01:18.180152 => 2023-07-01 18:01:21.984577
[0m18:01:21.985509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4385060>]}
[0m18:01:21.985993 [info ] [Thread-2 (]: 23 of 46 OK created sql table model dev_thaina_silver.stg_sales_creditcard ..... [[32mCREATE TABLE (19.1k rows, 378.8 KB processed)[0m in 3.81s]
[0m18:01:21.986608 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_creditcard
[0m18:01:21.987319 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_order_detail
[0m18:01:21.988172 [info ] [Thread-2 (]: 27 of 46 START sql table model dev_thaina_silver.stg_sales_order_detail ........ [RUN]
[0m18:01:21.989494 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_detail'
[0m18:01:21.990100 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_order_detail
[0m18:01:21.996745 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_detail"
[0m18:01:21.997524 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (compile): 2023-07-01 18:01:21.990481 => 2023-07-01 18:01:21.997423
[0m18:01:21.998071 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_order_detail
[0m18:01:22.003890 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:22.270256 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency_rate"
[0m18:01:22.270824 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      currencyrateid as currency_rate_id
      , currencyratedate as currency_rate_date
      , fromcurrencycode as from_currency_code
      , tocurrencycode as to_currency_code
      , averagerate as avg_rate
      , endofdayrate as end_of_day_rate
    from `desafiothaina`.`dev_thaina`.`currencyrate`
  )
select  *
from source_data
    );
  
[0m18:01:22.598830 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_customer"
[0m18:01:22.599816 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
    );
  
[0m18:01:22.892777 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_detail"
[0m18:01:22.893456 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
    );
  
[0m18:01:24.752320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:78020838-2a2e-4128-a2c3-cb8787bdd8e9&page=queryresults
[0m18:01:24.759134 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_currency (execute): 2023-07-01 18:01:21.003801 => 2023-07-01 18:01:24.759051
[0m18:01:24.762048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd439fa00>]}
[0m18:01:24.763000 [info ] [Thread-1 (]: 24 of 46 OK created sql table model dev_thaina_silver.stg_sales_currency ....... [[32mCREATE TABLE (105.0 rows, 2.0 KB processed)[0m in 3.76s]
[0m18:01:24.763784 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_currency
[0m18:01:24.764484 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m18:01:24.765234 [info ] [Thread-1 (]: 28 of 46 START sql table model dev_thaina_silver.stg_sales_order_header ........ [RUN]
[0m18:01:24.766895 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m18:01:24.767882 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m18:01:24.772734 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m18:01:24.773349 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-07-01 18:01:24.768351 => 2023-07-01 18:01:24.773252
[0m18:01:24.773784 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m18:01:24.781394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:25.050532 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2b58d663-ec06-4e44-b41d-c7d0f5d5947a&page=queryresults
[0m18:01:25.052922 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (execute): 2023-07-01 18:01:21.288536 => 2023-07-01 18:01:25.052860
[0m18:01:25.053724 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4120340>]}
[0m18:01:25.645849 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m18:01:25.646486 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(cast(orderdate as timestamp) as date) as order_date
    , cast(cast(duedate as timestamp) as date) as due_date
    , cast(cast(shipdate as timestamp) as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m18:01:25.952519 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:388352d0-213d-4b5d-9d13-262e91eac137&page=queryresults
[0m18:01:25.956857 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_customer (execute): 2023-07-01 18:01:21.636873 => 2023-07-01 18:01:25.956744
[0m18:01:25.958466 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4120e80>]}
[0m18:01:26.704476 [info ] [Thread-4 (]: 25 of 46 OK created sql table model dev_thaina_silver.stg_sales_currency_rate .. [[32mCREATE TABLE (13.5k rows, 779.7 KB processed)[0m in 3.77s]
[0m18:01:26.705147 [info ] [Thread-3 (]: 26 of 46 OK created sql table model dev_thaina_silver.stg_sales_customer ....... [[32mCREATE TABLE (19.8k rows, 1.2 MB processed)[0m in 4.33s]
[0m18:01:26.706415 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_currency_rate
[0m18:01:26.707038 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_customer
[0m18:01:26.707665 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_order_header_reason
[0m18:01:26.708236 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_person
[0m18:01:26.709008 [info ] [Thread-4 (]: 29 of 46 START sql table model dev_thaina_silver.stg_sales_order_header_reason . [RUN]
[0m18:01:26.709677 [info ] [Thread-3 (]: 30 of 46 START sql table model dev_thaina_silver.stg_sales_person .............. [RUN]
[0m18:01:26.710818 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header_reason'
[0m18:01:26.711671 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person'
[0m18:01:26.712100 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_order_header_reason
[0m18:01:26.712439 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_person
[0m18:01:26.716553 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m18:01:26.725455 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person"
[0m18:01:26.727752 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_person (compile): 2023-07-01 18:01:26.717245 => 2023-07-01 18:01:26.727542
[0m18:01:26.728882 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_person
[0m18:01:26.734381 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:26.773203 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (compile): 2023-07-01 18:01:26.712690 => 2023-07-01 18:01:26.773048
[0m18:01:26.774859 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_order_header_reason
[0m18:01:26.777992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:26.813398 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0a1d3727-061b-4d1d-a3f7-458e6022cfc7&page=queryresults
[0m18:01:26.816259 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (execute): 2023-07-01 18:01:21.998459 => 2023-07-01 18:01:26.816194
[0m18:01:26.817091 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4385120>]}
[0m18:01:26.817627 [info ] [Thread-2 (]: 27 of 46 OK created sql table model dev_thaina_silver.stg_sales_order_detail ... [[32mCREATE TABLE (121.3k rows, 10.8 MB processed)[0m in 4.83s]
[0m18:01:26.818280 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_order_detail
[0m18:01:26.819029 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_person_quota_history
[0m18:01:26.820026 [info ] [Thread-2 (]: 31 of 46 START sql table model dev_thaina_silver.stg_sales_person_quota_history  [RUN]
[0m18:01:26.821553 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person_quota_history'
[0m18:01:26.822164 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_person_quota_history
[0m18:01:26.828492 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m18:01:26.829476 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (compile): 2023-07-01 18:01:26.822579 => 2023-07-01 18:01:26.829361
[0m18:01:26.830076 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_person_quota_history
[0m18:01:26.835783 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:27.721719 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person"
[0m18:01:27.722410 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , territoryid as territory_id
      , salesquota as sales_quota
      , bonus
      , commissionpct as commission_pct
      , salesytd as sales_total
      , saleslastyear as sales_last_year
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salesperson`
  )

select  *
from source_data
    );
  
[0m18:01:27.766359 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m18:01:27.767523 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_order_header_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
    );
  
[0m18:01:27.785994 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m18:01:27.786729 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_person_quota_history: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person_quota_history"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person_quota_history`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , quotadate as quota_date
      , salesquota as sales_quota
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salespersonquotahistory`
  )

select  *
from source_data
    );
  
[0m18:01:29.460857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:afc272f2-09f8-4ed7-8911-81a1e5bb9a01&page=queryresults
[0m18:01:29.463190 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-07-01 18:01:24.773997 => 2023-07-01 18:01:29.463124
[0m18:01:29.464023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4258e20>]}
[0m18:01:29.464528 [info ] [Thread-1 (]: 28 of 46 OK created sql table model dev_thaina_silver.stg_sales_order_header ... [[32mCREATE TABLE (31.5k rows, 7.4 MB processed)[0m in 4.70s]
[0m18:01:29.465097 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m18:01:29.465751 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_reason
[0m18:01:29.466414 [info ] [Thread-1 (]: 32 of 46 START sql table model dev_thaina_silver.stg_sales_reason .............. [RUN]
[0m18:01:29.467500 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_reason'
[0m18:01:29.467911 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_reason
[0m18:01:29.473120 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_reason"
[0m18:01:29.473740 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_reason (compile): 2023-07-01 18:01:29.468125 => 2023-07-01 18:01:29.473640
[0m18:01:29.474147 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_reason
[0m18:01:29.479091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:30.290818 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:888e4701-4ad6-4d11-b077-dd84d140d3a0&page=queryresults
[0m18:01:30.292632 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_reason"
[0m18:01:30.299454 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_person (execute): 2023-07-01 18:01:26.729583 => 2023-07-01 18:01:30.299380
[0m18:01:30.301020 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4384040>]}
[0m18:01:30.301866 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salesreasonid as sales_reason_id
      , name as name_reason
      , reasontype as reason_type
    from `desafiothaina`.`dev_thaina`.`salesreason`
  )

select  *
from source_data
    );
  
[0m18:01:30.301560 [info ] [Thread-3 (]: 30 of 46 OK created sql table model dev_thaina_silver.stg_sales_person ......... [[32mCREATE TABLE (17.0 rows, 1.5 KB processed)[0m in 3.59s]
[0m18:01:30.305559 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_person
[0m18:01:30.306162 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_tax_rate
[0m18:01:30.306700 [info ] [Thread-3 (]: 33 of 46 START sql table model dev_thaina_silver.stg_sales_tax_rate ............ [RUN]
[0m18:01:30.307676 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_tax_rate'
[0m18:01:30.308107 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_tax_rate
[0m18:01:30.312389 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_tax_rate"
[0m18:01:30.313400 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (compile): 2023-07-01 18:01:30.308347 => 2023-07-01 18:01:30.313248
[0m18:01:30.314297 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_tax_rate
[0m18:01:30.318663 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:30.564616 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cdf05f7d-0b2c-40dd-848e-4c67c03b9369&page=queryresults
[0m18:01:30.568877 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (execute): 2023-07-01 18:01:26.830459 => 2023-07-01 18:01:30.568775
[0m18:01:30.570200 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4384070>]}
[0m18:01:30.571050 [info ] [Thread-2 (]: 31 of 46 OK created sql table model dev_thaina_silver.stg_sales_person_quota_history  [[32mCREATE TABLE (163.0 rows, 12.6 KB processed)[0m in 3.75s]
[0m18:01:30.571988 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_person_quota_history
[0m18:01:30.572683 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_territory
[0m18:01:30.573490 [info ] [Thread-2 (]: 34 of 46 START sql table model dev_thaina_silver.stg_sales_territory ........... [RUN]
[0m18:01:30.574848 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_territory'
[0m18:01:30.575527 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_territory
[0m18:01:30.582407 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_territory"
[0m18:01:30.583323 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_territory (compile): 2023-07-01 18:01:30.576019 => 2023-07-01 18:01:30.583200
[0m18:01:30.583995 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_territory
[0m18:01:30.592299 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:30.643482 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8fa3bca8-f1ae-4b7d-9d8e-44fd20b7e9e7&page=queryresults
[0m18:01:30.649554 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (execute): 2023-07-01 18:01:26.775119 => 2023-07-01 18:01:30.649483
[0m18:01:30.650877 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc47ba410>]}
[0m18:01:30.655227 [info ] [Thread-4 (]: 29 of 46 OK created sql table model dev_thaina_silver.stg_sales_order_header_reason  [[32mCREATE TABLE (27.6k rows, 432.0 KB processed)[0m in 3.94s]
[0m18:01:30.656200 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_order_header_reason
[0m18:01:30.657081 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_address
[0m18:01:30.657937 [info ] [Thread-4 (]: 35 of 46 START sql table model dev_thaina_intermediate.int_address ............. [RUN]
[0m18:01:30.659443 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m18:01:30.660153 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_address
[0m18:01:30.668597 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m18:01:30.669479 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-07-01 18:01:30.660562 => 2023-07-01 18:01:30.669353
[0m18:01:30.670060 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.int_address
[0m18:01:30.675173 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:31.278758 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_tax_rate"
[0m18:01:31.279606 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_tax_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_tax_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_tax_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salestaxrateid as sales_tax_rate_id
      , stateprovinceid as state_province_id
      , taxtype as tax_type
      , taxrate as tax_rate
      , name as name_tax_rate_desciption
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salestaxrate`
  )

select  *
from source_data
    );
  
[0m18:01:31.716465 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m18:01:31.718260 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_territory"
[0m18:01:31.718798 [debug] [Thread-4 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, contact_type_worker as (
	select  * 
    from  `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type` 
)

, union_person_addres as (
    select
        business_entity_address.address_id
        , business_entity_id
        , business_entity_address.address_type_id
        , concat(address_line1, ' ', ifnull('',address_line2), ' ', postal_code) as address
        , city
        , state_province_id
        , address_type_name
    from business_entity_address
    left join address
    on address.address_id = business_entity_address.address_id
   	left join address_type
   	on address_type.address_type_id = business_entity_address.address_type_id
)

, union_contact_type as (
	select 
		union_person_addres.*
		, person_id as worker_id
		, contact_type_worker.contact_type_id 
		, contact_type_name as contact_type_name_worker
	from union_person_addres
	left join business_entity_contact
	on business_entity_contact.business_entity_id = union_person_addres.business_entity_id 
	left join contact_type_worker
	on contact_type_worker.contact_type_id = business_entity_contact.contact_type_id
)

select * 
from union_contact_type
    );
  
[0m18:01:31.721108 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_territory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_territory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
    );
  
[0m18:01:33.238023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b709e538-0069-4371-8ea6-29344a511d97&page=queryresults
[0m18:01:33.240638 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_reason (execute): 2023-07-01 18:01:29.474354 => 2023-07-01 18:01:33.240571
[0m18:01:33.241437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc4715e40>]}
[0m18:01:33.241954 [info ] [Thread-1 (]: 32 of 46 OK created sql table model dev_thaina_silver.stg_sales_reason ......... [[32mCREATE TABLE (10.0 rows, 305.0 Bytes processed)[0m in 3.77s]
[0m18:01:33.242626 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_reason
[0m18:01:33.243200 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_product
[0m18:01:33.244009 [info ] [Thread-1 (]: 36 of 46 START sql table model dev_thaina_intermediate.int_product ............. [RUN]
[0m18:01:33.245167 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m18:01:33.245570 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_product
[0m18:01:33.250943 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m18:01:33.251708 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-07-01 18:01:33.245788 => 2023-07-01 18:01:33.251560
[0m18:01:33.252513 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_product
[0m18:01:33.256487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:33.854064 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:64b413f4-451f-40ba-87da-ba56ac72219f&page=queryresults
[0m18:01:33.856663 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (execute): 2023-07-01 18:01:30.314738 => 2023-07-01 18:01:33.856592
[0m18:01:33.857488 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd447f220>]}
[0m18:01:33.858051 [info ] [Thread-3 (]: 33 of 46 OK created sql table model dev_thaina_silver.stg_sales_tax_rate ....... [[32mCREATE TABLE (29.0 rows, 2.6 KB processed)[0m in 3.55s]
[0m18:01:33.858698 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_tax_rate
[0m18:01:33.859419 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_sales
[0m18:01:33.860085 [info ] [Thread-3 (]: 37 of 46 START sql table model dev_thaina_intermediate.int_sales ............... [RUN]
[0m18:01:33.862023 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m18:01:33.862649 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_sales
[0m18:01:33.879184 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m18:01:33.880740 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 18:01:33.863567 => 2023-07-01 18:01:33.880492
[0m18:01:33.882112 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.int_sales
[0m18:01:33.901137 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:34.076217 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m18:01:34.076827 [debug] [Thread-1 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from subcategory
    left join product
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from category
	left join union_product_subcategory
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from model
	left join union_product_category
    on union_product_category.product_model_id = model.model_id
)

, union_product_inventory as (
    select 
        union_product_model.*
        , quantity_inventory
        , shelf
        , bin
    from inventory
    left join union_product_model
    on union_product_model.product_id = inventory.product_id
)

select * 
from union_product_inventory
    );
  
[0m18:01:34.478159 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8dbaf006-c2b4-48bb-8f00-be4165b3f344&page=queryresults
[0m18:01:34.480845 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_territory (execute): 2023-07-01 18:01:30.584451 => 2023-07-01 18:01:34.480782
[0m18:01:34.481655 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc4627580>]}
[0m18:01:34.482160 [info ] [Thread-2 (]: 34 of 46 OK created sql table model dev_thaina_silver.stg_sales_territory ...... [[32mCREATE TABLE (10.0 rows, 925.0 Bytes processed)[0m in 3.91s]
[0m18:01:34.482763 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_territory
[0m18:01:34.483351 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_reason
[0m18:01:34.484150 [info ] [Thread-2 (]: 38 of 46 START sql table model dev_thaina_intermediate.int_reason .............. [RUN]
[0m18:01:34.485348 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_reason'
[0m18:01:34.485757 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_reason
[0m18:01:34.489560 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_reason"
[0m18:01:34.490185 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_reason (compile): 2023-07-01 18:01:34.485988 => 2023-07-01 18:01:34.490083
[0m18:01:34.490611 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.int_reason
[0m18:01:34.496307 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:34.696653 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m18:01:34.698201 [debug] [Thread-3 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, ship_method as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
    );
  
[0m18:01:35.070666 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:91d8f4fd-695d-408a-b463-9a143481f637&page=queryresults
[0m18:01:35.077438 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-07-01 18:01:30.670453 => 2023-07-01 18:01:35.077252
[0m18:01:35.078628 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc47ba1d0>]}
[0m18:01:35.079194 [info ] [Thread-4 (]: 35 of 46 OK created sql table model dev_thaina_intermediate.int_address ........ [[32mCREATE TABLE (19.7k rows, 1.5 MB processed)[0m in 4.42s]
[0m18:01:35.079926 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_address
[0m18:01:35.080649 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_person
[0m18:01:35.081422 [info ] [Thread-4 (]: 39 of 46 START sql table model dev_thaina_intermediate.int_person .............. [RUN]
[0m18:01:35.082589 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m18:01:35.082986 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_person
[0m18:01:35.090060 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m18:01:35.091001 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 18:01:35.083201 => 2023-07-01 18:01:35.090854
[0m18:01:35.091893 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.int_person
[0m18:01:35.099165 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:35.338596 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.int_reason"
[0m18:01:35.339292 [debug] [Thread-2 (]: On model.desafioaethaina.int_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

select *
from union_reason
    );
  
[0m18:01:35.922050 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.int_person"
[0m18:01:35.922715 [debug] [Thread-4 (]: On model.desafioaethaina.int_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , sales_territory_year
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixed_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, sales_territory_year
		, country_region_name
		, state_province_id
		, state_province_code
		, state_province_name
	from union_customer_state_province
	where customer_id is not null

)

select * 
from change_columns_name
    );
  
[0m18:01:37.961496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:64aa09f8-a4f0-4d4e-a276-2615052fa5e5&page=queryresults
[0m18:01:37.964912 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-07-01 18:01:33.252982 => 2023-07-01 18:01:37.964842
[0m18:01:37.966185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd411b9a0>]}
[0m18:01:37.967114 [info ] [Thread-1 (]: 36 of 46 OK created sql table model dev_thaina_intermediate.int_product ........ [[32mCREATE TABLE (1.1k rows, 93.1 KB processed)[0m in 4.72s]
[0m18:01:37.971410 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_product
[0m18:01:37.972366 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m18:01:37.973278 [info ] [Thread-1 (]: 40 of 46 START sql table model dev_thaina_gold.dim_address ..................... [RUN]
[0m18:01:37.974568 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m18:01:37.975015 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m18:01:37.979061 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m18:01:37.980105 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 18:01:37.975257 => 2023-07-01 18:01:37.979978
[0m18:01:37.980509 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m18:01:37.989579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:38.250285 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:062b4280-a342-4e8c-9ac9-3e5aaeee40c8&page=queryresults
[0m18:01:38.252459 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_reason (execute): 2023-07-01 18:01:34.490900 => 2023-07-01 18:01:38.252398
[0m18:01:38.253324 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc465ee60>]}
[0m18:01:38.253848 [info ] [Thread-2 (]: 38 of 46 OK created sql table model dev_thaina_intermediate.int_reason ......... [[32mCREATE TABLE (27.6k rows, 432.3 KB processed)[0m in 3.77s]
[0m18:01:38.254468 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_reason
[0m18:01:38.254989 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_product
[0m18:01:38.255799 [info ] [Thread-2 (]: 41 of 46 START sql table model dev_thaina_gold.dim_product ..................... [RUN]
[0m18:01:38.256902 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_product'
[0m18:01:38.257300 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.dim_product
[0m18:01:38.260998 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.dim_product"
[0m18:01:38.261719 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_product (compile): 2023-07-01 18:01:38.257529 => 2023-07-01 18:01:38.261576
[0m18:01:38.262109 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.dim_product
[0m18:01:38.265837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:38.877863 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m18:01:38.878572 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
            , worker_id 
        order by address_id) as dedup_index
    from int_address
)

, prodcut_with_sk  as (
    select
        MD5(cast(fixed_address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , contact_type_id
        , worker_id
        , contact_type_name_worker
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m18:01:39.130049 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.dim_product"
[0m18:01:39.130647 [debug] [Thread-2 (]: On model.desafioaethaina.dim_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_product`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_fk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m18:01:39.873106 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: fixed_address_id at [32:18]')
[0m18:01:40.726760 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c5516b82-69ea-4a35-ad07-b0a7d50bd6d8&page=queryresults
[0m18:01:40.729118 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 18:01:33.883176 => 2023-07-01 18:01:40.729056
[0m18:01:40.729890 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd43849d0>]}
[0m18:01:40.730403 [info ] [Thread-3 (]: 37 of 46 OK created sql table model dev_thaina_intermediate.int_sales .......... [[32mCREATE TABLE (121.3k rows, 12.6 MB processed)[0m in 6.87s]
[0m18:01:40.731678 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_sales
[0m18:01:40.732549 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_reasons
[0m18:01:40.733417 [info ] [Thread-3 (]: 42 of 46 START sql table model dev_thaina_gold.dim_reasons ..................... [RUN]
[0m18:01:40.736315 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_reasons'
[0m18:01:40.737437 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_reasons
[0m18:01:40.743926 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_reasons"
[0m18:01:40.745652 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_reasons (compile): 2023-07-01 18:01:40.738067 => 2023-07-01 18:01:40.745519
[0m18:01:40.746131 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_reasons
[0m18:01:40.753180 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:41.252760 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e7a526ae-bb72-4132-8e3a-2537246c801b&page=queryresults
[0m18:01:41.255217 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_person (execute): 2023-07-01 18:01:35.092433 => 2023-07-01 18:01:41.255148
[0m18:01:41.256070 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc47cc8e0>]}
[0m18:01:41.256616 [info ] [Thread-4 (]: 39 of 46 OK created sql table model dev_thaina_intermediate.int_person ......... [[32mCREATE TABLE (358.6k rows, 1.2 MB processed)[0m in 6.17s]
[0m18:01:41.257224 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_person
[0m18:01:41.257845 [debug] [Thread-4 (]: Began running node model.desafioaethaina.dim_cards_type
[0m18:01:41.258719 [info ] [Thread-4 (]: 43 of 46 START sql table model dev_thaina_gold.dim_cards_type .................. [RUN]
[0m18:01:41.260025 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m18:01:41.260477 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m18:01:41.264313 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m18:01:41.264963 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 18:01:41.260743 => 2023-07-01 18:01:41.264864
[0m18:01:41.265329 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m18:01:41.273171 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:41.598135 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_reasons"
[0m18:01:41.598729 [debug] [Thread-3 (]: On model.desafioaethaina.dim_reasons: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_reasons"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_reasons`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_reason`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_reason_id order by sales_reason_id) as dedup_index
    from int_sales
)

, reason_with_sk  as (
    select
        MD5(cast(sales_reason_id as string)) as sales_reason_fk
        , name_reason
        , reason_type
      from deduplication_data
    where dedup_index = 1
)

select *
from reason_with_sk
    );
  
[0m18:01:41.695224 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2d3d498b-9c2d-4a6d-ba22-b1160bc138b3&page=queryresults
[0m18:01:41.723084 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:788bcc64-74ed-4ac4-830c-7fd4ca637044&page=queryresults
[0m18:01:41.723964 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 18:01:37.980771 => 2023-07-01 18:01:41.723837
[0m18:01:41.725485 [debug] [Thread-1 (]: Database Error in model dim_address (models/gold/dim_address.sql)
  Unrecognized name: fixed_address_id at [32:18]
  compiled Code at target/run/desafioaethaina/models/gold/dim_address.sql
[0m18:01:41.726296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4240a90>]}
[0m18:01:41.726991 [error] [Thread-1 (]: 40 of 46 ERROR creating sql table model dev_thaina_gold.dim_address ............ [[31mERROR[0m in 3.75s]
[0m18:01:41.727758 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m18:01:41.728397 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m18:01:41.728977 [info ] [Thread-1 (]: 44 of 46 START sql table model dev_thaina_gold.fact_sales ...................... [RUN]
[0m18:01:41.730232 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m18:01:41.730644 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m18:01:41.734746 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m18:01:41.735666 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 18:01:41.730866 => 2023-07-01 18:01:41.735548
[0m18:01:41.736098 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m18:01:41.742135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:42.104958 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m18:01:42.105648 [debug] [Thread-4 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
	select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            credit_card_id
            , credit_card_approval_code 
        order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        MD5(cast(credit_card_id as string)) credit_card_sk
        , card_type
        , credit_card_approval_code
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m18:01:42.366489 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_product (execute): 2023-07-01 18:01:38.262334 => 2023-07-01 18:01:42.366414
[0m18:01:42.367413 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc4670250>]}
[0m18:01:42.367981 [info ] [Thread-2 (]: 41 of 46 OK created sql table model dev_thaina_gold.dim_product ................ [[32mCREATE TABLE (224.0 rows, 70.9 KB processed)[0m in 4.11s]
[0m18:01:42.368652 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_product
[0m18:01:42.369545 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_customers
[0m18:01:42.370294 [info ] [Thread-2 (]: 45 of 46 START sql table model dev_thaina_gold.dim_customers ................... [RUN]
[0m18:01:42.371505 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m18:01:42.371978 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.dim_customers
[0m18:01:42.375760 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m18:01:42.376368 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 18:01:42.372198 => 2023-07-01 18:01:42.376289
[0m18:01:42.376681 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.dim_customers
[0m18:01:42.380622 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:42.559759 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m18:01:42.561658 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , MD5(cast(customer_id as string)) as customer_fk
        -- , row_number() over (order by customer_id) as customer_fk
        -- , row_number() over (order by sales_reason_id) as sales_reason_fk
        -- , row_number() over (order by sales_person_id) as sales_person_fk
        , row_number() over (order by bill_to_address_id) as bill_to_address_fk
        , row_number() over (order by ship_to_address_id) as ship_to_address_fk
        , row_number() over (order by ship_method_id) as ship_method_fk
        , row_number() over (order by product_id) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m18:01:43.196758 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m18:01:43.198422 [debug] [Thread-2 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        MD5(cast(fixed_customer_id as string)) as customer_sk
        , full_name 
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m18:01:44.499645 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:dc642248-6ccc-4342-9b6c-3109f54332a5&page=queryresults
[0m18:01:44.502139 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_reasons (execute): 2023-07-01 18:01:40.746550 => 2023-07-01 18:01:44.502075
[0m18:01:44.502917 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc46aa7a0>]}
[0m18:01:44.503436 [info ] [Thread-3 (]: 42 of 46 OK created sql table model dev_thaina_gold.dim_reasons ................ [[32mCREATE TABLE (7.0 rows, 664.8 KB processed)[0m in 3.77s]
[0m18:01:44.504086 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_reasons
[0m18:01:44.504657 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_workers
[0m18:01:44.505346 [info ] [Thread-3 (]: 46 of 46 START sql table model dev_thaina_gold.dim_workers ..................... [RUN]
[0m18:01:44.506437 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m18:01:44.506860 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_workers
[0m18:01:44.512119 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m18:01:44.512784 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 18:01:44.507075 => 2023-07-01 18:01:44.512666
[0m18:01:44.513333 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_workers
[0m18:01:44.677372 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:45.010357 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:408521f9-c08a-469e-be52-80950f6b08ae&page=queryresults
[0m18:01:45.012571 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 18:01:41.265556 => 2023-07-01 18:01:45.012510
[0m18:01:45.013319 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc4515de0>]}
[0m18:01:45.013834 [info ] [Thread-4 (]: 43 of 46 OK created sql table model dev_thaina_gold.dim_cards_type ............. [[32mCREATE TABLE (30.3k rows, 3.9 MB processed)[0m in 3.75s]
[0m18:01:45.014371 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m18:01:45.644193 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m18:01:45.644943 [debug] [Thread-3 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workers of Adventure Works"""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, worker_with_sk  as (
    select
        MD5(cast(fixed_person_id as string)) as fixed_person_fk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m18:01:46.742086 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8f00635b-c5f0-4105-8921-bf9ecce8c275&page=queryresults
[0m18:01:46.744710 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 18:01:42.376896 => 2023-07-01 18:01:46.744641
[0m18:01:46.745540 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc45af910>]}
[0m18:01:46.746092 [info ] [Thread-2 (]: 45 of 46 OK created sql table model dev_thaina_gold.dim_customers .............. [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 4.37s]
[0m18:01:46.746723 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_customers
[0m18:01:48.518809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0688f077-4f73-47d6-87cf-fd96da44ad77&page=queryresults
[0m18:01:48.920372 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:25053b4a-0ca3-49fc-baca-4a72bd70779c&page=queryresults
[0m18:01:49.420722 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 18:01:41.736374 => 2023-07-01 18:01:49.420647
[0m18:01:49.421643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc456bca0>]}
[0m18:01:49.422198 [info ] [Thread-1 (]: 44 of 46 OK created sql table model dev_thaina_gold.fact_sales ................. [[32mCREATE TABLE (121.3k rows, 13.9 MB processed)[0m in 7.69s]
[0m18:01:49.422718 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m18:01:49.782526 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 18:01:44.513678 => 2023-07-01 18:01:49.782435
[0m18:01:49.783352 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72fa2306-90fe-41ab-a2f0-054b9ab75c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc45d40d0>]}
[0m18:01:49.784151 [info ] [Thread-3 (]: 46 of 46 OK created sql table model dev_thaina_gold.dim_workers ................ [[32mCREATE TABLE (496.0 rows, 38.2 MB processed)[0m in 5.28s]
[0m18:01:49.784833 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_workers
[0m18:01:49.786730 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:01:49.787487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:49.787773 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m18:01:49.788001 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m18:01:49.788219 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m18:01:49.788433 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m18:01:49.788846 [info ] [MainThread]: 
[0m18:01:49.789433 [info ] [MainThread]: Finished running 46 table models in 0 hours 0 minutes and 58.26 seconds (58.26s).
[0m18:01:49.792123 [debug] [MainThread]: Command end result
[0m18:01:49.837020 [info ] [MainThread]: 
[0m18:01:49.838878 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:01:49.839986 [info ] [MainThread]: 
[0m18:01:49.840996 [error] [MainThread]: [33mDatabase Error in model stg_purchase_order_detail (models/silver/purchasing/stg_purchase_order_detail.sql)[0m
[0m18:01:49.842721 [error] [MainThread]:   Invalid date: '2011-04-30 00:00:00.000'
[0m18:01:49.844162 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/silver/purchasing/stg_purchase_order_detail.sql
[0m18:01:49.846086 [info ] [MainThread]: 
[0m18:01:49.847248 [error] [MainThread]: [33mDatabase Error in model dim_address (models/gold/dim_address.sql)[0m
[0m18:01:49.849087 [error] [MainThread]:   Unrecognized name: fixed_address_id at [32:18]
[0m18:01:49.849948 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_address.sql
[0m18:01:49.850864 [info ] [MainThread]: 
[0m18:01:49.851731 [info ] [MainThread]: Done. PASS=44 WARN=0 ERROR=2 SKIP=0 TOTAL=46
[0m18:01:49.852829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc459ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc45afd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc45afac0>]}
[0m18:01:49.853309 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:02:59.621229 | 033a4bb1-3872-4cf8-9a2e-f83947b6c11c ==============================
[0m18:02:59.621229 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:02:59.624231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_purchase_order_detail+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:02:59.624682 [debug] [MainThread]: Tracking: tracking
[0m18:02:59.626861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc8a7bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc8a7b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc8a7bbb0>]}
[0m18:02:59.678935 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:02:59.818317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:02:59.819152 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/silver/purchasing/stg_purchase_order_detail.sql
[0m18:02:59.819634 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m18:02:59.842025 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_detail.sql
[0m18:02:59.857513 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m18:02:59.926167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '033a4bb1-3872-4cf8-9a2e-f83947b6c11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc812c0d0>]}
[0m18:02:59.950850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '033a4bb1-3872-4cf8-9a2e-f83947b6c11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc85ea800>]}
[0m18:02:59.951431 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:02:59.951933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '033a4bb1-3872-4cf8-9a2e-f83947b6c11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc85eb4c0>]}
[0m18:02:59.955747 [info ] [MainThread]: 
[0m18:02:59.959610 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:02:59.961393 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:02:59.961939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:01.027386 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:03:01.028580 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:03:01.028930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:01.029557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:01.030416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:03:01.031500 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:03:01.066243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:01.100045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:02.471478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '033a4bb1-3872-4cf8-9a2e-f83947b6c11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc874b700>]}
[0m18:03:02.472497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:03:02.473089 [info ] [MainThread]: 
[0m18:03:02.477386 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m18:03:02.477982 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_silver.stg_purchase_order_detail ....... [RUN]
[0m18:03:02.479171 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m18:03:02.479620 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m18:03:02.483300 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m18:03:02.484271 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-07-01 18:03:02.479884 => 2023-07-01 18:03:02.484092
[0m18:03:02.484840 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchase_order_detail
[0m18:03:02.540846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:03.502118 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_detail"
[0m18:03:03.503189 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchase_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , cast(purchaseorderdetailid as date) as purchase_order_detail_id
    , cast(duedate as date) as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m18:03:04.909667 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATE at [16:12]')
[0m18:03:06.372198 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9082c24f-a5b4-413b-907d-235eb9f63f11&page=queryresults
[0m18:03:06.373209 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (execute): 2023-07-01 18:03:02.485240 => 2023-07-01 18:03:06.373065
[0m18:03:06.376088 [debug] [Thread-1 (]: Database Error in model stg_purchase_order_detail (models/silver/purchasing/stg_purchase_order_detail.sql)
  Invalid cast from INT64 to DATE at [16:12]
  compiled Code at target/run/desafioaethaina/models/silver/purchasing/stg_purchase_order_detail.sql
[0m18:03:06.376602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033a4bb1-3872-4cf8-9a2e-f83947b6c11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc3d53820>]}
[0m18:03:06.377142 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_silver.stg_purchase_order_detail  [[31mERROR[0m in 3.90s]
[0m18:03:06.379342 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m18:03:06.381106 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:03:06.381800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:06.382043 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m18:03:06.382305 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m18:03:06.382540 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m18:03:06.382771 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_purchase_order_detail' was properly closed.
[0m18:03:06.383066 [info ] [MainThread]: 
[0m18:03:06.383833 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.43 seconds (6.43s).
[0m18:03:06.384787 [debug] [MainThread]: Command end result
[0m18:03:06.427818 [info ] [MainThread]: 
[0m18:03:06.429519 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:03:06.430919 [info ] [MainThread]: 
[0m18:03:06.432404 [error] [MainThread]: [33mDatabase Error in model stg_purchase_order_detail (models/silver/purchasing/stg_purchase_order_detail.sql)[0m
[0m18:03:06.433751 [error] [MainThread]:   Invalid cast from INT64 to DATE at [16:12]
[0m18:03:06.435479 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/silver/purchasing/stg_purchase_order_detail.sql
[0m18:03:06.436294 [info ] [MainThread]: 
[0m18:03:06.437049 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:03:06.438973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcbdcb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc85bbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc85bbbb0>]}
[0m18:03:06.439616 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:04:05.911430 | ce46d947-f191-4091-a99f-6f1b4ddf331f ==============================
[0m18:04:05.911430 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:04:05.913417 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_purchase_order_detail+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:04:05.913858 [debug] [MainThread]: Tracking: tracking
[0m18:04:05.916016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63c1648b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63c166590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63c166ce0>]}
[0m18:04:05.966488 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:04:06.105906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:06.107374 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/silver/purchasing/stg_purchase_order_detail.sql
[0m18:04:06.134223 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_detail.sql
[0m18:04:06.177079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce46d947-f191-4091-a99f-6f1b4ddf331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63bd47970>]}
[0m18:04:06.201207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce46d947-f191-4091-a99f-6f1b4ddf331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63be4db40>]}
[0m18:04:06.201699 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:04:06.202194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce46d947-f191-4091-a99f-6f1b4ddf331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63bcd79d0>]}
[0m18:04:06.206092 [info ] [MainThread]: 
[0m18:04:06.208501 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:04:06.209919 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:04:06.210755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:07.099478 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:04:07.100159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:07.101062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:04:07.103970 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:04:07.104364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:07.137659 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:04:07.139457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:07.140150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:08.368042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce46d947-f191-4091-a99f-6f1b4ddf331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63c1665f0>]}
[0m18:04:08.370028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:04:08.370746 [info ] [MainThread]: 
[0m18:04:08.380433 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m18:04:08.381112 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_silver.stg_purchase_order_detail ....... [RUN]
[0m18:04:08.382963 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m18:04:08.383915 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m18:04:08.389679 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m18:04:08.390866 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-07-01 18:04:08.384608 => 2023-07-01 18:04:08.390705
[0m18:04:08.391519 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchase_order_detail
[0m18:04:08.421189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:09.290122 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_detail"
[0m18:04:09.291775 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchase_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , purchase_order_detail_id
    , cast(duedate as timestamp) as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m18:04:10.657402 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: purchase_order_detail_id; Did you mean purchaseorderdetailid? at [16:7]')
[0m18:04:12.399227 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bc4f669a-f162-4d92-a294-ebef8054ac50&page=queryresults
[0m18:04:12.400155 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (execute): 2023-07-01 18:04:08.391986 => 2023-07-01 18:04:12.400039
[0m18:04:12.402928 [debug] [Thread-1 (]: Database Error in model stg_purchase_order_detail (models/silver/purchasing/stg_purchase_order_detail.sql)
  Unrecognized name: purchase_order_detail_id; Did you mean purchaseorderdetailid? at [16:7]
  compiled Code at target/run/desafioaethaina/models/silver/purchasing/stg_purchase_order_detail.sql
[0m18:04:12.403446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce46d947-f191-4091-a99f-6f1b4ddf331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63bd56a40>]}
[0m18:04:12.404004 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_silver.stg_purchase_order_detail  [[31mERROR[0m in 4.02s]
[0m18:04:12.406311 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m18:04:12.408247 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:04:12.408983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:12.409380 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m18:04:12.409698 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_purchase_order_detail' was properly closed.
[0m18:04:12.410189 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m18:04:12.410671 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m18:04:12.411212 [info ] [MainThread]: 
[0m18:04:12.412468 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m18:04:12.413690 [debug] [MainThread]: Command end result
[0m18:04:12.448023 [info ] [MainThread]: 
[0m18:04:12.449214 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:04:12.450562 [info ] [MainThread]: 
[0m18:04:12.451835 [error] [MainThread]: [33mDatabase Error in model stg_purchase_order_detail (models/silver/purchasing/stg_purchase_order_detail.sql)[0m
[0m18:04:12.453283 [error] [MainThread]:   Unrecognized name: purchase_order_detail_id; Did you mean purchaseorderdetailid? at [16:7]
[0m18:04:12.454303 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/silver/purchasing/stg_purchase_order_detail.sql
[0m18:04:12.454971 [info ] [MainThread]: 
[0m18:04:12.455659 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:04:12.456298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63f4b33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63be4dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63be4dc30>]}
[0m18:04:12.456750 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:04:27.102627 | 7b72ea03-81f7-4945-8e4d-f3a5f0ec9fc2 ==============================
[0m18:04:27.102627 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:04:27.106111 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:04:27.106584 [debug] [MainThread]: Tracking: tracking
[0m18:04:27.109177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dd4888e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dd488fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dd488820>]}
[0m18:04:27.167604 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:04:27.310261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:27.310598 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:27.323328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b72ea03-81f7-4945-8e4d-f3a5f0ec9fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dd25c0d0>]}
[0m18:04:27.346765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b72ea03-81f7-4945-8e4d-f3a5f0ec9fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dd21d0c0>]}
[0m18:04:27.347290 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:04:27.347754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b72ea03-81f7-4945-8e4d-f3a5f0ec9fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dd21d120>]}
[0m18:04:27.349486 [warn ] [MainThread]: The selection criterion 'dim' does not match any nodes
[0m18:04:27.352268 [info ] [MainThread]: 
[0m18:04:27.353068 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:04:27.353637 [debug] [MainThread]: Command end result
[0m18:04:27.382126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dd21ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dd21c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28dd21c580>]}
[0m18:04:27.382848 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:04:39.204181 | 86d59025-113a-459d-a323-31721f025835 ==============================
[0m18:04:39.204181 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:04:39.206391 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:04:39.206924 [debug] [MainThread]: Tracking: tracking
[0m18:04:39.208538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c67a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c679090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c67a620>]}
[0m18:04:39.262435 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:04:39.419181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:39.419608 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:39.432326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86d59025-113a-459d-a323-31721f025835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c2500d0>]}
[0m18:04:39.455763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86d59025-113a-459d-a323-31721f025835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c218fd0>]}
[0m18:04:39.456272 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:04:39.456710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d59025-113a-459d-a323-31721f025835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c219030>]}
[0m18:04:39.463574 [info ] [MainThread]: 
[0m18:04:39.467428 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:04:39.469122 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:04:39.469711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:40.366326 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:04:40.367121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:04:40.367638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:40.368388 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:04:40.368948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:40.369594 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:04:40.370226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:40.436905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:41.813447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d59025-113a-459d-a323-31721f025835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c679030>]}
[0m18:04:41.814777 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:04:41.815636 [info ] [MainThread]: 
[0m18:04:41.820469 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m18:04:41.821093 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m18:04:41.822265 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m18:04:41.822780 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m18:04:41.829663 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m18:04:41.830590 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 18:04:41.823221 => 2023-07-01 18:04:41.830427
[0m18:04:41.831233 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m18:04:41.898647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:42.839927 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m18:04:42.841025 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
            , worker_id 
        order by address_id) as dedup_index
    from int_address
)

, prodcut_with_sk  as (
    select
        MD5(cast(address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , contact_type_id
        , worker_id
        , contact_type_name_worker
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m18:04:46.006063 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e7775e68-6b11-4ce6-87f0-4b5e2f4bf908&page=queryresults
[0m18:04:47.122640 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 18:04:41.831740 => 2023-07-01 18:04:47.122556
[0m18:04:47.123614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d59025-113a-459d-a323-31721f025835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c67b1c0>]}
[0m18:04:47.124441 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.7k rows, 1.4 MB processed)[0m in 5.30s]
[0m18:04:47.127969 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m18:04:47.129853 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:04:47.130637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:47.131072 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m18:04:47.131330 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m18:04:47.131593 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m18:04:47.131847 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m18:04:47.132223 [info ] [MainThread]: 
[0m18:04:47.132796 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m18:04:47.133948 [debug] [MainThread]: Command end result
[0m18:04:47.155967 [info ] [MainThread]: 
[0m18:04:47.157105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:47.157852 [info ] [MainThread]: 
[0m18:04:47.158602 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:04:47.159547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c0d3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c117f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959c678df0>]}
[0m18:04:47.160592 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:06:46.210925 | 6d952c53-80d5-4f96-b123-9fc00f991937 ==============================
[0m18:06:46.210925 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:06:46.213030 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:06:46.213505 [debug] [MainThread]: Tracking: tracking
[0m18:06:46.215207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedfe86590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedfe85c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedfe86560>]}
[0m18:06:46.253417 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:06:46.402609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:46.403567 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m18:06:46.425877 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m18:06:46.517109 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m18:06:46.574651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d952c53-80d5-4f96-b123-9fc00f991937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedf5310f0>]}
[0m18:06:46.599542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d952c53-80d5-4f96-b123-9fc00f991937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedfd65270>]}
[0m18:06:46.600205 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:06:46.600626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d952c53-80d5-4f96-b123-9fc00f991937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedfbef670>]}
[0m18:06:46.604152 [info ] [MainThread]: 
[0m18:06:46.606587 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:06:46.607977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:06:46.608613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:47.760428 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:06:47.760901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:47.761984 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:06:47.762478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:47.795807 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:06:47.798516 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:06:47.831819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:47.833818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:49.007044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d952c53-80d5-4f96-b123-9fc00f991937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedfd64d00>]}
[0m18:06:49.008037 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:06:49.008564 [info ] [MainThread]: 
[0m18:06:49.012767 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m18:06:49.013427 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m18:06:49.014668 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m18:06:49.015139 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m18:06:49.026621 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m18:06:49.027880 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 18:06:49.015448 => 2023-07-01 18:06:49.027644
[0m18:06:49.028620 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m18:06:49.064520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:49.939833 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m18:06:49.941316 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , MD5(cast(customer_id as string)) as customer_fk
        , MD5(cast(sales_reason_id as string)) as sales_reason_fk
        , MD5(cast(sales_person_id as string)) as  sales_person_fk
        , MD5(cast(bill_to_address_id as string)) as bill_to_address_fk
        , MD5(cast(ship_to_address_id as string)) as ship_to_address_fk
        , MD5(cast(ship_method_id as string)) as ship_method_fk
        , MD5(cast(product_id as string)) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m18:06:51.235961 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [32:20]')
[0m18:06:53.078824 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c340ec54-1e25-4899-89a9-8b783d0cb7af&page=queryresults
[0m18:06:53.079731 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 18:06:49.029250 => 2023-07-01 18:06:53.079593
[0m18:06:53.082657 [debug] [Thread-1 (]: Database Error in model fact_sales (models/gold/fact_sales.sql)
  Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [32:20]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m18:06:53.083216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d952c53-80d5-4f96-b123-9fc00f991937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedf578eb0>]}
[0m18:06:53.083855 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_gold.fact_sales ............... [[31mERROR[0m in 4.07s]
[0m18:06:53.086537 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m18:06:53.088382 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:06:53.089054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:53.089293 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m18:06:53.089514 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m18:06:53.089730 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m18:06:53.089976 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m18:06:53.090249 [info ] [MainThread]: 
[0m18:06:53.090784 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.49 seconds (6.49s).
[0m18:06:53.091707 [debug] [MainThread]: Command end result
[0m18:06:53.137250 [info ] [MainThread]: 
[0m18:06:53.138548 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:06:53.140009 [info ] [MainThread]: 
[0m18:06:53.141199 [error] [MainThread]: [33mDatabase Error in model fact_sales (models/gold/fact_sales.sql)[0m
[0m18:06:53.142396 [error] [MainThread]:   Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [32:20]
[0m18:06:53.143626 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.sql
[0m18:06:53.144202 [info ] [MainThread]: 
[0m18:06:53.144791 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:06:53.145381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedfbef430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee41255a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedf533190>]}
[0m18:06:53.145770 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:08:25.261509 | bc52d877-0eb1-459f-8d6d-632ac03e0a1f ==============================
[0m18:08:25.261509 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:08:25.264327 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:08:25.265218 [debug] [MainThread]: Tracking: tracking
[0m18:08:25.268614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193da763b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193da76380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193da76da0>]}
[0m18:08:25.325206 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:08:25.534493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:08:25.535660 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m18:08:25.568140 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m18:08:25.629345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc52d877-0eb1-459f-8d6d-632ac03e0a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193ccdbe20>]}
[0m18:08:25.662773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc52d877-0eb1-459f-8d6d-632ac03e0a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193d747850>]}
[0m18:08:25.663513 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:08:25.664071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc52d877-0eb1-459f-8d6d-632ac03e0a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193d5e7ca0>]}
[0m18:08:25.669043 [info ] [MainThread]: 
[0m18:08:25.672972 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:08:25.675463 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:08:25.676248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:25.719983 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:08:25.721727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:27.203997 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:08:27.204581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:27.206211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:08:27.209136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:27.208155 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:08:27.215720 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:08:27.257650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:27.294694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:28.544519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc52d877-0eb1-459f-8d6d-632ac03e0a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193da74e80>]}
[0m18:08:28.546836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:08:28.547413 [info ] [MainThread]: 
[0m18:08:28.552716 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m18:08:28.553918 [info ] [Thread-1 (]: 1 of 3 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m18:08:28.555039 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m18:08:28.555474 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m18:08:28.562200 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m18:08:28.563194 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 18:08:28.555708 => 2023-07-01 18:08:28.563062
[0m18:08:28.563804 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m18:08:28.610165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:29.572020 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m18:08:29.573128 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, ship_method as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, sales_reason_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
    );
  
[0m18:08:30.877569 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [52:19]')
[0m18:08:32.353047 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c2aaf0e1-71ce-448a-9455-38af9b8c0feb&page=queryresults
[0m18:08:32.353862 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 18:08:28.564334 => 2023-07-01 18:08:32.353729
[0m18:08:32.358396 [debug] [Thread-1 (]: Database Error in model int_sales (models/intermediate/int_sales.sql)
  Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [52:19]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_sales.sql
[0m18:08:32.359257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc52d877-0eb1-459f-8d6d-632ac03e0a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193cd20970>]}
[0m18:08:32.360095 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev_thaina_intermediate.int_sales ........ [[31mERROR[0m in 3.80s]
[0m18:08:32.362693 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m18:08:32.363867 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_cards_type
[0m18:08:32.364327 [debug] [Thread-4 (]: Began running node model.desafioaethaina.fact_sales
[0m18:08:32.364908 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev_thaina_gold.dim_cards_type ............................ [[33mSKIP[0m]
[0m18:08:32.365852 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev_thaina_gold.fact_sales ................................ [[33mSKIP[0m]
[0m18:08:32.366870 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m18:08:32.368116 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.fact_sales
[0m18:08:32.370131 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:08:32.371616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:32.372401 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m18:08:32.372866 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m18:08:32.373336 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m18:08:32.373852 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m18:08:32.374559 [info ] [MainThread]: 
[0m18:08:32.375395 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m18:08:32.377295 [debug] [MainThread]: Command end result
[0m18:08:32.421096 [info ] [MainThread]: 
[0m18:08:32.421779 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:08:32.422494 [info ] [MainThread]: 
[0m18:08:32.423161 [error] [MainThread]: [33mDatabase Error in model int_sales (models/intermediate/int_sales.sql)[0m
[0m18:08:32.423901 [error] [MainThread]:   Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [52:19]
[0m18:08:32.424532 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_sales.sql
[0m18:08:32.425152 [info ] [MainThread]: 
[0m18:08:32.425766 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m18:08:32.426482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193d5fa2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1940de63b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193d7478b0>]}
[0m18:08:32.427110 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:08:43.086271 | 603b7e33-cb5c-4878-beb2-ea6d8e448680 ==============================
[0m18:08:43.086271 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:08:43.089080 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:08:43.089517 [debug] [MainThread]: Tracking: tracking
[0m18:08:43.091045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb761262740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7612622c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb761262710>]}
[0m18:08:43.162102 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:08:43.303644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:43.304018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:43.317009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '603b7e33-cb5c-4878-beb2-ea6d8e448680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb760e3c0d0>]}
[0m18:08:43.345721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '603b7e33-cb5c-4878-beb2-ea6d8e448680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb760e05120>]}
[0m18:08:43.346448 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:08:43.347153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '603b7e33-cb5c-4878-beb2-ea6d8e448680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb760e05180>]}
[0m18:08:43.351464 [info ] [MainThread]: 
[0m18:08:43.354372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:08:43.355908 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:08:43.357214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:44.404224 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:08:44.404694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:44.405791 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:08:44.406217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:44.439888 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:08:44.443188 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:08:44.444955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:44.477761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:46.179485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '603b7e33-cb5c-4878-beb2-ea6d8e448680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb760e04100>]}
[0m18:08:46.180400 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:08:46.180893 [info ] [MainThread]: 
[0m18:08:46.185437 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m18:08:46.186190 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m18:08:46.187571 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m18:08:46.188152 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m18:08:46.197031 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m18:08:46.197961 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 18:08:46.188533 => 2023-07-01 18:08:46.197796
[0m18:08:46.198676 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m18:08:46.261464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:47.186636 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m18:08:47.187799 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, ship_method as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, sales_reason_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
    );
  
[0m18:08:48.391729 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [52:19]')
[0m18:08:50.439787 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1ae75914-4fcd-4052-abf2-1f06dc0d1003&page=queryresults
[0m18:08:50.440674 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 18:08:46.199150 => 2023-07-01 18:08:50.440529
[0m18:08:50.443908 [debug] [Thread-1 (]: Database Error in model int_sales (models/intermediate/int_sales.sql)
  Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [52:19]
  compiled Code at target/run/desafioaethaina/models/intermediate/int_sales.sql
[0m18:08:50.444472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '603b7e33-cb5c-4878-beb2-ea6d8e448680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb761262f80>]}
[0m18:08:50.445105 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_thaina_intermediate.int_sales ........ [[31mERROR[0m in 4.26s]
[0m18:08:50.447612 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m18:08:50.449522 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:08:50.450332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:50.450669 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m18:08:50.451082 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m18:08:50.451614 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m18:08:50.452101 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m18:08:50.452525 [info ] [MainThread]: 
[0m18:08:50.453395 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m18:08:50.454985 [debug] [MainThread]: Command end result
[0m18:08:50.506405 [info ] [MainThread]: 
[0m18:08:50.507579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:08:50.508712 [info ] [MainThread]: 
[0m18:08:50.509986 [error] [MainThread]: [33mDatabase Error in model int_sales (models/intermediate/int_sales.sql)[0m
[0m18:08:50.511092 [error] [MainThread]:   Unrecognized name: sales_reason_id; Did you mean sales_person_id? at [52:19]
[0m18:08:50.512174 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/intermediate/int_sales.sql
[0m18:08:50.513511 [info ] [MainThread]: 
[0m18:08:50.514754 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:08:50.516936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb760cd8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb760cd8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb760cd8100>]}
[0m18:08:50.517660 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:10:28.339463 | ba5231e6-59ef-4638-9a4d-18ac958cbd3d ==============================
[0m18:10:28.339463 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:10:28.343345 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_reasons'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:10:28.344257 [debug] [MainThread]: Tracking: tracking
[0m18:10:28.349356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657585240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657584610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657585150>]}
[0m18:10:28.429870 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:10:28.696284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:10:28.697731 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_reasons.sql
[0m18:10:28.770056 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_reasons.sql
[0m18:10:28.881550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba5231e6-59ef-4638-9a4d-18ac958cbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657377550>]}
[0m18:10:28.951299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba5231e6-59ef-4638-9a4d-18ac958cbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657468400>]}
[0m18:10:28.954345 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:10:28.956680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba5231e6-59ef-4638-9a4d-18ac958cbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657468460>]}
[0m18:10:28.964830 [info ] [MainThread]: 
[0m18:10:28.968837 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:10:28.973526 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:10:28.975932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:29.986321 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:10:29.986972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:29.987882 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:10:30.024740 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:10:30.026517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:30.028106 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:10:30.028762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:30.031001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:31.388252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba5231e6-59ef-4638-9a4d-18ac958cbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657375270>]}
[0m18:10:31.389648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:10:31.390401 [info ] [MainThread]: 
[0m18:10:31.404145 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_reasons
[0m18:10:31.405190 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_reasons ....................... [RUN]
[0m18:10:31.407564 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_reasons'
[0m18:10:31.408680 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_reasons
[0m18:10:31.416891 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_reasons"
[0m18:10:31.418317 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (compile): 2023-07-01 18:10:31.409630 => 2023-07-01 18:10:31.418118
[0m18:10:31.419302 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_reasons
[0m18:10:31.460638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:32.403552 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_reasons"
[0m18:10:32.405103 [debug] [Thread-1 (]: On model.desafioaethaina.dim_reasons: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_reasons"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_reasons`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_reason`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_reason_id order by sales_reason_id) as dedup_index
    from int_sales
)

, reason_with_sk  as (
    select
        MD5(cast(sales_reason_id as string)) as sales_reason_fk
        , sales_order_id
        , name_reason
        , reason_type
      from deduplication_data
    where dedup_index = 1
)

select *
from reason_with_sk
    );
  
[0m18:10:35.505292 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d3414a8a-3238-4996-9c80-5bd2ac2292db&page=queryresults
[0m18:10:35.525635 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (execute): 2023-07-01 18:10:31.421213 => 2023-07-01 18:10:35.525564
[0m18:10:35.526491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5231e6-59ef-4638-9a4d-18ac958cbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb656a20a90>]}
[0m18:10:35.527040 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_reasons .................. [[32mCREATE TABLE (7.0 rows, 880.8 KB processed)[0m in 4.12s]
[0m18:10:35.529454 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_reasons
[0m18:10:35.531724 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:10:35.532874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:35.533373 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m18:10:35.533812 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m18:10:35.534279 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_reasons' was properly closed.
[0m18:10:35.534735 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m18:10:35.535244 [info ] [MainThread]: 
[0m18:10:35.536080 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m18:10:35.537122 [debug] [MainThread]: Command end result
[0m18:10:35.577372 [info ] [MainThread]: 
[0m18:10:35.578297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:35.579187 [info ] [MainThread]: 
[0m18:10:35.580155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:10:35.581420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65b8ad600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6574684f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657468430>]}
[0m18:10:35.582151 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:10:58.591618 | 9eefe3c9-2440-4adb-96e3-fe8eb8598f7c ==============================
[0m18:10:58.591618 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:10:58.594354 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_sales+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:10:58.594819 [debug] [MainThread]: Tracking: tracking
[0m18:10:58.596450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb2362680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb2361090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb2362620>]}
[0m18:10:58.637161 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:10:58.819766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m18:10:58.821498 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m18:10:58.821938 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.sql
[0m18:10:58.822354 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_sales.sql
[0m18:10:58.845449 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m18:10:58.863574 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m18:10:58.978079 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m18:10:59.021748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eefe3c9-2440-4adb-96e3-fe8eb8598f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb180e200>]}
[0m18:10:59.059965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eefe3c9-2440-4adb-96e3-fe8eb8598f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb1ee7e80>]}
[0m18:10:59.060550 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:10:59.061091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eefe3c9-2440-4adb-96e3-fe8eb8598f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb1ed3c10>]}
[0m18:10:59.065704 [info ] [MainThread]: 
[0m18:10:59.068547 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:10:59.070780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:10:59.071456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:59.072760 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:10:59.113833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:00.515212 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:11:00.516231 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:11:00.516597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:00.517153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:00.518010 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:11:00.519400 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:11:00.588127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:00.591693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:02.172133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eefe3c9-2440-4adb-96e3-fe8eb8598f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb1825960>]}
[0m18:11:02.178054 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:11:02.179796 [info ] [MainThread]: 
[0m18:11:02.192986 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_sales
[0m18:11:02.197248 [info ] [Thread-1 (]: 1 of 3 START sql table model dev_thaina_intermediate.int_sales ................. [RUN]
[0m18:11:02.200497 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m18:11:02.201765 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_sales
[0m18:11:02.210901 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m18:11:02.211930 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 18:11:02.202664 => 2023-07-01 18:11:02.211729
[0m18:11:02.212962 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_sales
[0m18:11:02.247881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:03.388605 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m18:11:03.389867 [debug] [Thread-1 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, ship_method as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
    );
  
[0m18:11:08.481689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ae418e58-d71c-4e51-9b31-252a6546719d&page=queryresults
[0m18:11:08.503096 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 18:11:02.213428 => 2023-07-01 18:11:08.502967
[0m18:11:08.504807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eefe3c9-2440-4adb-96e3-fe8eb8598f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb1f04460>]}
[0m18:11:08.505938 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev_thaina_intermediate.int_sales ............ [[32mCREATE TABLE (121.3k rows, 12.6 MB processed)[0m in 6.31s]
[0m18:11:08.510755 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_sales
[0m18:11:08.512492 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_cards_type
[0m18:11:08.513168 [debug] [Thread-4 (]: Began running node model.desafioaethaina.fact_sales
[0m18:11:08.513866 [info ] [Thread-3 (]: 2 of 3 START sql table model dev_thaina_gold.dim_cards_type .................... [RUN]
[0m18:11:08.515129 [info ] [Thread-4 (]: 3 of 3 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m18:11:08.517006 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m18:11:08.518174 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m18:11:08.518750 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m18:11:08.519404 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.fact_sales
[0m18:11:08.528854 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m18:11:08.538834 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m18:11:08.540077 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 18:11:08.519771 => 2023-07-01 18:11:08.539889
[0m18:11:08.540838 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m18:11:08.541294 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 18:11:08.529666 => 2023-07-01 18:11:08.541213
[0m18:11:08.551701 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:11:08.552435 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.fact_sales
[0m18:11:08.597659 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:11:09.715230 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m18:11:09.718766 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m18:11:09.719803 [debug] [Thread-4 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , MD5(cast(customer_id as string)) as customer_fk
        , MD5(cast(sales_person_id as string)) as sales_person_fk
        , MD5(cast(bill_to_address_id as string)) as bill_to_address_fk
        , MD5(cast(ship_to_address_id as string)) as ship_to_address_fk
        , MD5(cast(ship_method_id as string)) as ship_method_fk
        , MD5(cast(product_id as string)) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m18:11:09.720537 [debug] [Thread-3 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
	select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            credit_card_id
            , credit_card_approval_code 
        order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        MD5(cast(credit_card_id as string)) credit_card_sk
        , card_type
        , credit_card_approval_code
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m18:11:12.917603 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0a6b2f2f-26d9-4f52-ac5f-514dc35b8f49&page=queryresults
[0m18:11:12.920882 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 18:11:08.541585 => 2023-07-01 18:11:12.920806
[0m18:11:12.921823 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eefe3c9-2440-4adb-96e3-fe8eb8598f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb17171c0>]}
[0m18:11:12.922331 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev_thaina_gold.dim_cards_type ............... [[32mCREATE TABLE (30.3k rows, 3.9 MB processed)[0m in 4.41s]
[0m18:11:12.922902 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m18:11:13.609722 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:919ad952-caf4-485d-b7f0-32fb1f97a4ad&page=queryresults
[0m18:11:14.504984 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 18:11:08.594043 => 2023-07-01 18:11:14.504899
[0m18:11:14.505983 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eefe3c9-2440-4adb-96e3-fe8eb8598f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb168e500>]}
[0m18:11:14.506545 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 14.3 MB processed)[0m in 5.99s]
[0m18:11:14.507221 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.fact_sales
[0m18:11:14.509334 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:11:14.510164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:14.510477 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m18:11:14.510764 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m18:11:14.511033 [debug] [MainThread]: Connection 'model.desafioaethaina.int_sales' was properly closed.
[0m18:11:14.511292 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m18:11:14.511659 [info ] [MainThread]: 
[0m18:11:14.512114 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 15.45 seconds (15.45s).
[0m18:11:14.513006 [debug] [MainThread]: Command end result
[0m18:11:14.553985 [info ] [MainThread]: 
[0m18:11:14.554923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:14.556014 [info ] [MainThread]: 
[0m18:11:14.557006 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:11:14.558768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb1ea39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb1697880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeb16967a0>]}
[0m18:11:14.559802 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:11:24.775039 | 199be970-e00d-458c-a726-969dcbed6879 ==============================
[0m18:11:24.775039 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:11:24.777298 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:11:24.777809 [debug] [MainThread]: Tracking: tracking
[0m18:11:24.779391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44b77a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44b779390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44b77a470>]}
[0m18:11:24.829707 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:11:24.972706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:24.973078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:24.986146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '199be970-e00d-458c-a726-969dcbed6879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44b3540d0>]}
[0m18:11:25.010810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '199be970-e00d-458c-a726-969dcbed6879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44b315030>]}
[0m18:11:25.011313 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:11:25.011776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '199be970-e00d-458c-a726-969dcbed6879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44b3151e0>]}
[0m18:11:25.018509 [info ] [MainThread]: 
[0m18:11:25.022524 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:11:25.039242 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:11:25.042171 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:11:25.042756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:25.043600 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:11:25.044177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:25.045145 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:11:25.046226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:25.085400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:26.524426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '199be970-e00d-458c-a726-969dcbed6879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44b77a470>]}
[0m18:11:26.525489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:11:26.526101 [info ] [MainThread]: 
[0m18:11:26.530099 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:11:26.530461 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:11:26.531138 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m18:11:26.531795 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:11:26.532156 [info ] [Thread-1 (]: 1 of 14 START test not_null_dim_address_address_sk ............................. [RUN]
[0m18:11:26.532837 [info ] [Thread-2 (]: 2 of 14 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m18:11:26.533614 [info ] [Thread-3 (]: 3 of 14 START test not_null_dim_product_product_sk ............................. [RUN]
[0m18:11:26.534300 [info ] [Thread-4 (]: 4 of 14 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m18:11:26.535394 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m18:11:26.536074 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m18:11:26.536742 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_product_product_sk.271feb5417'
[0m18:11:26.537719 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m18:11:26.538445 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:11:26.539563 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:11:26.540858 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m18:11:26.541616 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:11:26.604623 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m18:11:26.601689 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:11:26.620831 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:11:26.628356 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:11:26.629240 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (compile): 2023-07-01 18:11:26.570438 => 2023-07-01 18:11:26.629134
[0m18:11:26.629687 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 18:11:26.542115 => 2023-07-01 18:11:26.629620
[0m18:11:26.630180 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m18:11:26.630538 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 18:11:26.609572 => 2023-07-01 18:11:26.630444
[0m18:11:26.631162 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:11:26.631587 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 18:11:26.553485 => 2023-07-01 18:11:26.631502
[0m18:11:26.652751 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:11:26.656784 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m18:11:26.660095 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:11:26.660579 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:11:26.663774 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:11:26.667633 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:11:26.668131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:26.668461 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:11:26.669267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:11:26.671319 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m18:11:26.671634 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:11:26.673235 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_product_product_sk.271feb5417: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_product`
where product_sk is null



      
    ) dbt_internal_test
[0m18:11:26.674761 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m18:11:26.709369 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m18:11:28.144387 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:7]')
[0m18:11:28.196203 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: product_sk; Did you mean product_fk? at [15:7]')
[0m18:11:28.909894 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e68c4ced-997e-49c4-b68f-16a417bc1908&page=queryresults
[0m18:11:28.910808 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (execute): 2023-07-01 18:11:26.631974 => 2023-07-01 18:11:28.910647
[0m18:11:28.914102 [debug] [Thread-3 (]: Database Error in test not_null_dim_product_product_sk (models/gold/dim_products.yml)
  Unrecognized name: product_sk; Did you mean product_fk? at [15:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_products.yml/not_null_dim_product_product_sk.sql
[0m18:11:28.914750 [error] [Thread-3 (]: 3 of 14 ERROR not_null_dim_product_product_sk .................................. [[31mERROR[0m in 2.38s]
[0m18:11:28.917248 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m18:11:28.917992 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:11:28.919033 [info ] [Thread-3 (]: 5 of 14 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m18:11:28.921323 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m18:11:28.922153 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:11:28.949640 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:11:28.959555 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 18:11:28.922984 => 2023-07-01 18:11:28.959408
[0m18:11:28.960422 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:11:28.966506 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:11:28.967355 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:11:28.970506 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m18:11:29.166604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d239d59e-171c-4257-89e8-213e18852691&page=queryresults
[0m18:11:29.168423 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 18:11:26.657135 => 2023-07-01 18:11:29.168348
[0m18:11:29.169216 [info ] [Thread-1 (]: 1 of 14 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.63s]
[0m18:11:29.169790 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:11:29.170305 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:11:29.170846 [info ] [Thread-1 (]: 6 of 14 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:11:29.171979 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de'
[0m18:11:29.172400 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:11:29.186076 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:11:29.187005 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (compile): 2023-07-01 18:11:29.172647 => 2023-07-01 18:11:29.186796
[0m18:11:29.188007 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:11:29.194986 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:11:29.196282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:29.199756 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:11:29.243501 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cca510c7-85f5-47c5-90a0-bf99cb34a313&page=queryresults
[0m18:11:29.245772 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 18:11:26.664472 => 2023-07-01 18:11:29.245653
[0m18:11:29.246988 [info ] [Thread-2 (]: 2 of 14 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.71s]
[0m18:11:29.248279 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:11:29.248847 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:11:29.249204 [info ] [Thread-2 (]: 7 of 14 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m18:11:29.250736 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m18:11:29.251370 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:11:29.262995 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:11:29.263860 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 18:11:29.251674 => 2023-07-01 18:11:29.263749
[0m18:11:29.264423 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:11:29.270127 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:11:29.271166 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:11:29.275060 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:11:29.380477 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:91dc7d1a-a90e-4ae2-bb51-16cf3c889af7&page=queryresults
[0m18:11:29.381495 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 18:11:26.660875 => 2023-07-01 18:11:29.381382
[0m18:11:29.383840 [debug] [Thread-4 (]: Database Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:11:29.384726 [error] [Thread-4 (]: 4 of 14 ERROR not_null_dim_workers_worker_sk ................................... [[31mERROR[0m in 2.85s]
[0m18:11:29.385480 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:11:29.386133 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:11:29.386721 [info ] [Thread-4 (]: 8 of 14 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m18:11:29.388147 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m18:11:29.388790 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:11:29.412713 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:11:29.414942 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 18:11:29.389963 => 2023-07-01 18:11:29.414801
[0m18:11:29.419233 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:11:29.426993 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:11:29.430250 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:11:29.433590 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:11:30.572793 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [18:12]')
[0m18:11:31.249330 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1d4c0f87-cf16-486a-9461-eb8f73d2c178&page=queryresults
[0m18:11:31.250160 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 18:11:29.419798 => 2023-07-01 18:11:31.250027
[0m18:11:31.251348 [debug] [Thread-4 (]: Database Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)
  Unrecognized name: worker_sk at [18:12]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:11:31.251852 [error] [Thread-4 (]: 8 of 14 ERROR relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[31mERROR[0m in 1.86s]
[0m18:11:31.252383 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:11:31.252969 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:11:31.253461 [info ] [Thread-4 (]: 9 of 14 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:11:31.254424 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310'
[0m18:11:31.254876 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:11:31.263985 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:11:31.264550 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (compile): 2023-07-01 18:11:31.255328 => 2023-07-01 18:11:31.264450
[0m18:11:31.265067 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:11:31.270751 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:11:31.271688 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:11:31.275230 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:11:31.401858 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e3a03ddb-428c-48b2-9fae-5f0a4f8f546d&page=queryresults
[0m18:11:31.403079 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 18:11:28.961257 => 2023-07-01 18:11:31.402942
[0m18:11:31.404486 [info ] [Thread-3 (]: 5 of 14 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.48s]
[0m18:11:31.405333 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:11:31.406022 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:11:31.406532 [info ] [Thread-3 (]: 10 of 14 START test unique_dim_address_address_sk .............................. [RUN]
[0m18:11:31.407842 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m18:11:31.408369 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:11:31.418844 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:11:31.419474 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 18:11:31.408638 => 2023-07-01 18:11:31.419350
[0m18:11:31.420083 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:11:31.427083 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:11:31.428023 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:11:31.431518 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:11:31.653251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3c53e2af-62ce-4d03-a602-92cd038520af&page=queryresults
[0m18:11:31.654083 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (execute): 2023-07-01 18:11:29.188877 => 2023-07-01 18:11:31.654000
[0m18:11:31.654932 [info ] [Thread-1 (]: 6 of 14 PASS relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.48s]
[0m18:11:31.655653 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:11:31.656364 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:11:31.656967 [info ] [Thread-1 (]: 11 of 14 START test unique_dim_dates_metric_date ............................... [RUN]
[0m18:11:31.658253 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m18:11:31.658781 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:11:31.675708 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:11:31.676821 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 18:11:31.659900 => 2023-07-01 18:11:31.676682
[0m18:11:31.677621 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:11:31.685155 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:11:31.686412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:31.692524 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:11:32.251516 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9db63c38-6ed1-4c3a-b649-4877d6c4f0e9&page=queryresults
[0m18:11:32.252407 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 18:11:29.264796 => 2023-07-01 18:11:32.252319
[0m18:11:32.253390 [info ] [Thread-2 (]: 7 of 14 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 3.00s]
[0m18:11:32.254121 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:11:32.254607 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m18:11:32.255086 [info ] [Thread-2 (]: 12 of 14 START test unique_dim_product_product_sk .............................. [RUN]
[0m18:11:32.256174 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c'
[0m18:11:32.256568 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m18:11:32.262195 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m18:11:32.263469 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (compile): 2023-07-01 18:11:32.256784 => 2023-07-01 18:11:32.263218
[0m18:11:32.263968 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m18:11:32.267525 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m18:11:32.268372 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:11:32.270629 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_product_product_sk.2248c4335c: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_product`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:11:33.267322 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: product_sk; Did you mean product_fk? at [15:9]')
[0m18:11:33.882696 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b32b44e0-00c3-476f-b57d-7db7bd07a7ab&page=queryresults
[0m18:11:33.883644 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (execute): 2023-07-01 18:11:32.264232 => 2023-07-01 18:11:33.883509
[0m18:11:33.885199 [debug] [Thread-2 (]: Database Error in test unique_dim_product_product_sk (models/gold/dim_products.yml)
  Unrecognized name: product_sk; Did you mean product_fk? at [15:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_products.yml/unique_dim_product_product_sk.sql
[0m18:11:33.885826 [error] [Thread-2 (]: 12 of 14 ERROR unique_dim_product_product_sk ................................... [[31mERROR[0m in 1.63s]
[0m18:11:33.886498 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m18:11:33.887141 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:11:33.887647 [info ] [Thread-2 (]: 13 of 14 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m18:11:33.888617 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m18:11:33.889022 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:11:33.896093 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:11:33.896904 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 18:11:33.889241 => 2023-07-01 18:11:33.896780
[0m18:11:33.897449 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:11:33.903314 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:11:33.904899 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:11:33.908605 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:11:33.949271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6b49ba19-f538-4d2d-912f-c2abddc4d263&page=queryresults
[0m18:11:33.953707 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 18:11:31.677892 => 2023-07-01 18:11:33.953603
[0m18:11:33.955502 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a21e81de-a4ef-42a6-a1db-5d7e78b9af33&page=queryresults
[0m18:11:33.956677 [info ] [Thread-1 (]: 11 of 14 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.30s]
[0m18:11:33.957800 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 18:11:31.421530 => 2023-07-01 18:11:33.957682
[0m18:11:33.958276 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:11:33.959620 [error] [Thread-3 (]: 10 of 14 FAIL 83 unique_dim_address_address_sk ................................. [[31mFAIL 83[0m in 2.55s]
[0m18:11:33.960646 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:11:33.961285 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:11:33.961848 [info ] [Thread-1 (]: 14 of 14 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m18:11:33.963046 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m18:11:33.963661 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:11:33.985841 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:11:33.986648 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 18:11:33.964408 => 2023-07-01 18:11:33.986540
[0m18:11:33.987254 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:11:33.994484 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:11:33.996082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:34.003899 [debug] [Thread-1 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:11:34.330555 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a4a2dfa3-7a70-44a6-ac49-fa49c8f8a02a&page=queryresults
[0m18:11:34.331493 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (execute): 2023-07-01 18:11:31.265538 => 2023-07-01 18:11:34.331399
[0m18:11:34.332516 [info ] [Thread-4 (]: 9 of 14 PASS relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 3.08s]
[0m18:11:34.333332 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:11:35.106075 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:9]')
[0m18:11:35.928513 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0380b61f-b316-4bca-9ec0-6cfb9a892e1a&page=queryresults
[0m18:11:35.931432 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 18:11:33.897829 => 2023-07-01 18:11:35.931270
[0m18:11:35.933857 [debug] [Thread-2 (]: Database Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:11:35.934798 [error] [Thread-2 (]: 13 of 14 ERROR unique_dim_workers_worker_sk .................................... [[31mERROR[0m in 2.05s]
[0m18:11:35.936364 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:11:36.609945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3dac8120-5199-4d0c-a4ba-42cfedafcb45&page=queryresults
[0m18:11:36.610780 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 18:11:33.987734 => 2023-07-01 18:11:36.610702
[0m18:11:36.611953 [info ] [Thread-1 (]: 14 of 14 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.65s]
[0m18:11:36.612903 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:11:36.615160 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:11:36.615941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:36.616243 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m18:11:36.616514 [debug] [MainThread]: Connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310' was properly closed.
[0m18:11:36.616780 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m18:11:36.617038 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728' was properly closed.
[0m18:11:36.617395 [info ] [MainThread]: 
[0m18:11:36.617953 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 11.60 seconds (11.60s).
[0m18:11:36.619250 [debug] [MainThread]: Command end result
[0m18:11:36.644502 [info ] [MainThread]: 
[0m18:11:36.645196 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m18:11:36.646192 [info ] [MainThread]: 
[0m18:11:36.647121 [error] [MainThread]: [33mDatabase Error in test not_null_dim_product_product_sk (models/gold/dim_products.yml)[0m
[0m18:11:36.648091 [error] [MainThread]:   Unrecognized name: product_sk; Did you mean product_fk? at [15:7]
[0m18:11:36.649027 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_products.yml/not_null_dim_product_product_sk.sql
[0m18:11:36.650685 [info ] [MainThread]: 
[0m18:11:36.651982 [error] [MainThread]: [33mDatabase Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:11:36.652795 [error] [MainThread]:   Unrecognized name: worker_sk at [15:7]
[0m18:11:36.653844 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:11:36.654670 [info ] [MainThread]: 
[0m18:11:36.656011 [error] [MainThread]: [33mDatabase Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)[0m
[0m18:11:36.657605 [error] [MainThread]:   Unrecognized name: worker_sk at [18:12]
[0m18:11:36.658860 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:11:36.660032 [info ] [MainThread]: 
[0m18:11:36.661583 [error] [MainThread]: [33mDatabase Error in test unique_dim_product_product_sk (models/gold/dim_products.yml)[0m
[0m18:11:36.662503 [error] [MainThread]:   Unrecognized name: product_sk; Did you mean product_fk? at [15:9]
[0m18:11:36.663492 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_products.yml/unique_dim_product_product_sk.sql
[0m18:11:36.665027 [info ] [MainThread]: 
[0m18:11:36.666008 [error] [MainThread]: [31mFailure in test unique_dim_address_address_sk (models/gold/dim_address.yml)[0m
[0m18:11:36.666837 [error] [MainThread]:   Got 83 results, configured to fail if != 0
[0m18:11:36.667632 [info ] [MainThread]: 
[0m18:11:36.668356 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/dim_address.yml/unique_dim_address_address_sk.sql
[0m18:11:36.669154 [info ] [MainThread]: 
[0m18:11:36.669908 [error] [MainThread]: [33mDatabase Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:11:36.670639 [error] [MainThread]:   Unrecognized name: worker_sk at [15:9]
[0m18:11:36.671334 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:11:36.672252 [info ] [MainThread]: 
[0m18:11:36.673093 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=6 SKIP=0 TOTAL=14
[0m18:11:36.674009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44b2fe830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44b314e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44b314df0>]}
[0m18:11:36.674597 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:13:08.428064 | f7e23c9f-9f6f-46c5-b825-572c18fc7489 ==============================
[0m18:13:08.428064 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:13:08.429943 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:13:08.430374 [debug] [MainThread]: Tracking: tracking
[0m18:13:08.432327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819f86d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819f87af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819f86440>]}
[0m18:13:08.476246 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:13:08.617945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:13:08.618804 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.sql
[0m18:13:08.619205 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_product.sql
[0m18:13:08.641796 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m18:13:08.657057 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_product.sql
[0m18:13:08.739767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7e23c9f-9f6f-46c5-b825-572c18fc7489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819625ab0>]}
[0m18:13:08.764023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7e23c9f-9f6f-46c5-b825-572c18fc7489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819e68730>]}
[0m18:13:08.764542 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:13:08.765029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e23c9f-9f6f-46c5-b825-572c18fc7489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819cfbe50>]}
[0m18:13:08.770858 [info ] [MainThread]: 
[0m18:13:08.773453 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:13:08.784050 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:13:08.786882 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:13:08.787633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:08.790300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:13:08.791746 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:13:08.792424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:08.835005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:08.836899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:11.390318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e23c9f-9f6f-46c5-b825-572c18fc7489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819cfb0a0>]}
[0m18:13:11.391253 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:13:11.391806 [info ] [MainThread]: 
[0m18:13:11.395937 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:13:11.396291 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:13:11.396765 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m18:13:11.397389 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:13:11.397700 [info ] [Thread-1 (]: 1 of 14 START test not_null_dim_address_address_sk ............................. [RUN]
[0m18:13:11.398432 [info ] [Thread-2 (]: 2 of 14 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m18:13:11.399265 [info ] [Thread-3 (]: 3 of 14 START test not_null_dim_product_product_sk ............................. [RUN]
[0m18:13:11.400181 [info ] [Thread-4 (]: 4 of 14 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m18:13:11.401991 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m18:13:11.403967 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m18:13:11.405535 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_product_product_sk.271feb5417'
[0m18:13:11.406847 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m18:13:11.407858 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:13:11.408510 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:13:11.409069 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m18:13:11.409630 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:13:11.502031 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:13:11.504977 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:13:11.506683 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:13:11.509046 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m18:13:11.509849 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 18:13:11.410134 => 2023-07-01 18:13:11.509718
[0m18:13:11.510694 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (compile): 2023-07-01 18:13:11.436008 => 2023-07-01 18:13:11.510556
[0m18:13:11.511451 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:13:11.511921 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 18:13:11.423051 => 2023-07-01 18:13:11.511797
[0m18:13:11.512205 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m18:13:11.512573 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 18:13:11.442515 => 2023-07-01 18:13:11.512457
[0m18:13:11.534768 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:13:11.535180 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:13:11.538380 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"
[0m18:13:11.538800 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:13:11.541966 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:13:11.542392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:11.545410 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:13:11.545995 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:11.546596 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:11.548815 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m18:13:11.549375 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:11.550885 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_product_product_sk.271feb5417: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_product_product_sk.271feb5417"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_product`
where product_sk is null



      
    ) dbt_internal_test
[0m18:13:11.584326 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m18:13:11.587603 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m18:13:13.010452 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:7]')
[0m18:13:13.015208 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: product_sk; Did you mean product_fk? at [15:7]')
[0m18:13:13.739578 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a366aea1-df9c-47c8-ac39-f852b37f8b45&page=queryresults
[0m18:13:13.740513 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_product_product_sk.271feb5417 (execute): 2023-07-01 18:13:11.535480 => 2023-07-01 18:13:13.740355
[0m18:13:13.746269 [debug] [Thread-3 (]: Database Error in test not_null_dim_product_product_sk (models/gold/dim_products.yml)
  Unrecognized name: product_sk; Did you mean product_fk? at [15:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_products.yml/not_null_dim_product_product_sk.sql
[0m18:13:13.746939 [error] [Thread-3 (]: 3 of 14 ERROR not_null_dim_product_product_sk .................................. [[31mERROR[0m in 2.34s]
[0m18:13:13.749352 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_product_product_sk.271feb5417
[0m18:13:13.750358 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:13:13.751397 [info ] [Thread-3 (]: 5 of 14 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m18:13:13.753461 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m18:13:13.754232 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:13:13.770135 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:13:13.770991 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 18:13:13.754721 => 2023-07-01 18:13:13.770852
[0m18:13:13.771677 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:13:13.779815 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:13:13.781130 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:13.785935 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m18:13:13.890188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f51691b2-de7a-4795-a8fa-2b1da02bcf60&page=queryresults
[0m18:13:13.892192 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 18:13:11.512750 => 2023-07-01 18:13:13.892104
[0m18:13:13.893195 [info ] [Thread-1 (]: 1 of 14 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.49s]
[0m18:13:13.894055 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:13:13.894979 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:13:13.895855 [info ] [Thread-1 (]: 6 of 14 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:13:13.897320 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de'
[0m18:13:13.897895 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:13:13.919961 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:13:13.921165 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (compile): 2023-07-01 18:13:13.898407 => 2023-07-01 18:13:13.920933
[0m18:13:13.922090 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:13:13.935519 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:13:13.936463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:13.939732 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:13:14.116791 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:22b8bb53-cde7-4799-b1dd-3c80d480af27&page=queryresults
[0m18:13:14.117910 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 18:13:11.539248 => 2023-07-01 18:13:14.117806
[0m18:13:14.119056 [info ] [Thread-2 (]: 2 of 14 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.72s]
[0m18:13:14.119733 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:13:14.120263 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:13:14.120794 [info ] [Thread-2 (]: 7 of 14 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m18:13:14.121797 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m18:13:14.122209 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:13:14.132211 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:13:14.133918 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 18:13:14.122427 => 2023-07-01 18:13:14.133543
[0m18:13:14.134849 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:13:14.144010 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:13:14.145201 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:14.152697 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:13:14.330159 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4ad02026-2ba4-4ae8-a1c6-d9383e7debaf&page=queryresults
[0m18:13:14.331234 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 18:13:11.542800 => 2023-07-01 18:13:14.331074
[0m18:13:14.333187 [debug] [Thread-4 (]: Database Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:13:14.333954 [error] [Thread-4 (]: 4 of 14 ERROR not_null_dim_workers_worker_sk ................................... [[31mERROR[0m in 2.93s]
[0m18:13:14.334773 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:13:14.335506 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:13:14.336640 [info ] [Thread-4 (]: 8 of 14 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m18:13:14.337924 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m18:13:14.338510 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:13:14.352251 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:13:14.353812 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 18:13:14.339303 => 2023-07-01 18:13:14.353601
[0m18:13:14.354971 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:13:14.370282 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:13:14.372502 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:14.375418 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:13:15.470989 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [18:12]')
[0m18:13:16.082847 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:42d1c496-9172-4e66-9fc6-00d4451b8727&page=queryresults
[0m18:13:16.083758 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 18:13:13.772153 => 2023-07-01 18:13:16.083672
[0m18:13:16.084685 [info ] [Thread-3 (]: 5 of 14 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.33s]
[0m18:13:16.085426 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:13:16.086221 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:13:16.086978 [info ] [Thread-3 (]: 9 of 14 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:13:16.088397 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310'
[0m18:13:16.089012 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:13:16.102018 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:13:16.103151 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (compile): 2023-07-01 18:13:16.089382 => 2023-07-01 18:13:16.103006
[0m18:13:16.103845 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:13:16.111900 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:13:16.113061 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:16.118759 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:13:16.219784 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:192bc8c9-98db-4930-8027-9daab44df66f&page=queryresults
[0m18:13:16.220638 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (execute): 2023-07-01 18:13:13.922849 => 2023-07-01 18:13:16.220551
[0m18:13:16.221579 [info ] [Thread-1 (]: 6 of 14 PASS relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.32s]
[0m18:13:16.222280 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:13:16.222993 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:13:16.223522 [info ] [Thread-1 (]: 10 of 14 START test unique_dim_address_address_sk .............................. [RUN]
[0m18:13:16.224739 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m18:13:16.225148 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:13:16.234842 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:13:16.235890 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 18:13:16.225364 => 2023-07-01 18:13:16.235751
[0m18:13:16.236738 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:13:16.244347 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:13:16.246233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:16.250705 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:16.453084 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3e349e55-31c3-4a65-ab1f-b8d318bbab5e&page=queryresults
[0m18:13:16.453969 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 18:13:14.135210 => 2023-07-01 18:13:16.453875
[0m18:13:16.454888 [info ] [Thread-2 (]: 7 of 14 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.33s]
[0m18:13:16.455681 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:13:16.456377 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:13:16.456899 [info ] [Thread-2 (]: 11 of 14 START test unique_dim_dates_metric_date ............................... [RUN]
[0m18:13:16.458097 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m18:13:16.458522 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:13:16.465791 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:13:16.466829 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 18:13:16.458779 => 2023-07-01 18:13:16.466689
[0m18:13:16.467521 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:13:16.474405 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:13:16.475469 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:16.478162 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:16.759874 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:af47401e-f377-421a-88e9-5f4f7cefce76&page=queryresults
[0m18:13:16.760759 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 18:13:14.356162 => 2023-07-01 18:13:16.760527
[0m18:13:16.762629 [debug] [Thread-4 (]: Database Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)
  Unrecognized name: worker_sk at [18:12]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:13:16.763428 [error] [Thread-4 (]: 8 of 14 ERROR relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[31mERROR[0m in 2.43s]
[0m18:13:16.764653 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:13:16.765357 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m18:13:16.766053 [info ] [Thread-4 (]: 12 of 14 START test unique_dim_product_product_sk .............................. [RUN]
[0m18:13:16.767814 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c'
[0m18:13:16.768510 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m18:13:16.780498 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m18:13:16.782347 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (compile): 2023-07-01 18:13:16.768971 => 2023-07-01 18:13:16.782165
[0m18:13:16.783012 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m18:13:16.789611 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"
[0m18:13:16.791632 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:16.795920 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_product_product_sk.2248c4335c: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_product_product_sk.2248c4335c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_product`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:17.833313 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: product_sk; Did you mean product_fk? at [15:9]')
[0m18:13:18.333262 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c0a58a76-49b2-4f8b-8d31-50daecdfc9bf&page=queryresults
[0m18:13:18.334124 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 18:13:16.237447 => 2023-07-01 18:13:18.334045
[0m18:13:18.334573 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:34c526dd-1504-4c26-88fd-4fb2edc31602&page=queryresults
[0m18:13:18.335516 [error] [Thread-1 (]: 10 of 14 FAIL 83 unique_dim_address_address_sk ................................. [[31mFAIL 83[0m in 2.11s]
[0m18:13:18.336661 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (execute): 2023-07-01 18:13:16.104478 => 2023-07-01 18:13:18.336560
[0m18:13:18.337336 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:13:18.338497 [info ] [Thread-3 (]: 9 of 14 PASS relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.25s]
[0m18:13:18.339409 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:13:18.340079 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:13:18.340472 [info ] [Thread-1 (]: 13 of 14 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m18:13:18.341436 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:13:18.342567 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m18:13:18.343277 [info ] [Thread-3 (]: 14 of 14 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m18:13:18.344243 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:13:18.345439 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m18:13:18.354819 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:13:18.355793 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:13:18.363333 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 18:13:18.345754 => 2023-07-01 18:13:18.362837
[0m18:13:18.364698 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:13:18.374722 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:13:18.390626 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:13:18.392615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:18.391634 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 18:13:18.356593 => 2023-07-01 18:13:18.391491
[0m18:13:18.394825 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:18.395450 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:13:18.440121 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:13:18.443844 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:18.445583 [debug] [Thread-3 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:18.655628 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d173ffa5-dec5-450e-85bd-bb36e3479d26&page=queryresults
[0m18:13:18.656340 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 18:13:16.468197 => 2023-07-01 18:13:18.656266
[0m18:13:18.657159 [info ] [Thread-2 (]: 11 of 14 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.20s]
[0m18:13:18.657869 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:13:18.902614 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:37cdd507-33fd-4050-aa8e-597acead55a5&page=queryresults
[0m18:13:18.903553 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_product_product_sk.2248c4335c (execute): 2023-07-01 18:13:16.783331 => 2023-07-01 18:13:18.903450
[0m18:13:18.905124 [debug] [Thread-4 (]: Database Error in test unique_dim_product_product_sk (models/gold/dim_products.yml)
  Unrecognized name: product_sk; Did you mean product_fk? at [15:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_products.yml/unique_dim_product_product_sk.sql
[0m18:13:18.905812 [error] [Thread-4 (]: 12 of 14 ERROR unique_dim_product_product_sk ................................... [[31mERROR[0m in 2.14s]
[0m18:13:18.906531 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_product_product_sk.2248c4335c
[0m18:13:19.559656 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:9]')
[0m18:13:20.685495 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e2885415-c06e-41f5-b3a6-96879cad2bbd&page=queryresults
[0m18:13:20.686970 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 18:13:18.434471 => 2023-07-01 18:13:20.686774
[0m18:13:20.689218 [info ] [Thread-3 (]: 14 of 14 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.34s]
[0m18:13:20.691004 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:13:20.993062 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a0fd2865-be76-488b-9edc-0833f8a2b0f0&page=queryresults
[0m18:13:20.994037 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 18:13:18.378506 => 2023-07-01 18:13:20.993884
[0m18:13:20.995833 [debug] [Thread-1 (]: Database Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:13:20.996572 [error] [Thread-1 (]: 13 of 14 ERROR unique_dim_workers_worker_sk .................................... [[31mERROR[0m in 2.65s]
[0m18:13:20.997493 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:13:20.999686 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:13:21.000829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:21.001333 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m18:13:21.001760 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m18:13:21.002153 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed' was properly closed.
[0m18:13:21.002555 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_product_product_sk.2248c4335c' was properly closed.
[0m18:13:21.003106 [info ] [MainThread]: 
[0m18:13:21.003904 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 12.23 seconds (12.23s).
[0m18:13:21.005768 [debug] [MainThread]: Command end result
[0m18:13:21.143702 [info ] [MainThread]: 
[0m18:13:21.144264 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m18:13:21.144839 [info ] [MainThread]: 
[0m18:13:21.145658 [error] [MainThread]: [33mDatabase Error in test not_null_dim_product_product_sk (models/gold/dim_products.yml)[0m
[0m18:13:21.146394 [error] [MainThread]:   Unrecognized name: product_sk; Did you mean product_fk? at [15:7]
[0m18:13:21.147030 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_products.yml/not_null_dim_product_product_sk.sql
[0m18:13:21.147760 [info ] [MainThread]: 
[0m18:13:21.148466 [error] [MainThread]: [33mDatabase Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:13:21.149149 [error] [MainThread]:   Unrecognized name: worker_sk at [15:7]
[0m18:13:21.149861 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:13:21.150573 [info ] [MainThread]: 
[0m18:13:21.151294 [error] [MainThread]: [33mDatabase Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)[0m
[0m18:13:21.152074 [error] [MainThread]:   Unrecognized name: worker_sk at [18:12]
[0m18:13:21.152770 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:13:21.153506 [info ] [MainThread]: 
[0m18:13:21.154307 [error] [MainThread]: [31mFailure in test unique_dim_address_address_sk (models/gold/dim_address.yml)[0m
[0m18:13:21.155096 [error] [MainThread]:   Got 83 results, configured to fail if != 0
[0m18:13:21.155923 [info ] [MainThread]: 
[0m18:13:21.156697 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/dim_address.yml/unique_dim_address_address_sk.sql
[0m18:13:21.157452 [info ] [MainThread]: 
[0m18:13:21.158190 [error] [MainThread]: [33mDatabase Error in test unique_dim_product_product_sk (models/gold/dim_products.yml)[0m
[0m18:13:21.158893 [error] [MainThread]:   Unrecognized name: product_sk; Did you mean product_fk? at [15:9]
[0m18:13:21.159651 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_products.yml/unique_dim_product_product_sk.sql
[0m18:13:21.160567 [info ] [MainThread]: 
[0m18:13:21.161523 [error] [MainThread]: [33mDatabase Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:13:21.162717 [error] [MainThread]:   Unrecognized name: worker_sk at [15:9]
[0m18:13:21.164094 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:13:21.165512 [info ] [MainThread]: 
[0m18:13:21.167823 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=6 SKIP=0 TOTAL=14
[0m18:13:21.169265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981d4cf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819d35de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9819d34a30>]}
[0m18:13:21.170538 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:14:43.963974 | 9c584811-d596-4716-8809-f8c1a1c529ce ==============================
[0m18:14:43.963974 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:14:43.967646 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:14:43.968262 [debug] [MainThread]: Tracking: tracking
[0m18:14:43.972020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20af576770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20af575180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20af576740>]}
[0m18:14:44.030602 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:14:44.217189 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m18:14:44.218212 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_products.sql
[0m18:14:44.218812 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_products.yml
[0m18:14:44.219314 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_product.sql
[0m18:14:44.255180 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m18:14:44.401442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c584811-d596-4716-8809-f8c1a1c529ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ae81c400>]}
[0m18:14:44.431879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c584811-d596-4716-8809-f8c1a1c529ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20af1196c0>]}
[0m18:14:44.432485 [info ] [MainThread]: Found 46 models, 14 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:14:44.433118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c584811-d596-4716-8809-f8c1a1c529ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20af0ebcd0>]}
[0m18:14:44.440134 [info ] [MainThread]: 
[0m18:14:44.444395 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:14:44.446751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:14:44.447688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:46.308583 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:14:46.310820 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:14:46.313490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:14:46.316196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:14:46.317635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:46.318510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:46.319751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:46.320646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:47.803255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c584811-d596-4716-8809-f8c1a1c529ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20af1180a0>]}
[0m18:14:47.804345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:14:47.805047 [info ] [MainThread]: 
[0m18:14:47.810255 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_products
[0m18:14:47.810972 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m18:14:47.812451 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m18:14:47.813323 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_products
[0m18:14:47.820344 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m18:14:47.821549 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-07-01 18:14:47.813783 => 2023-07-01 18:14:47.821381
[0m18:14:47.822379 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_products
[0m18:14:47.930421 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m18:14:47.931402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:47.935318 [debug] [Thread-1 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m18:14:51.418133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:15ac3c12-ff62-4fd0-9810-64bea97326e4&page=queryresults
[0m18:14:52.240831 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-07-01 18:14:47.823625 => 2023-07-01 18:14:52.240751
[0m18:14:52.241865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c584811-d596-4716-8809-f8c1a1c529ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ae6a3640>]}
[0m18:14:52.242454 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_products ................. [[32mCREATE TABLE (224.0 rows, 70.9 KB processed)[0m in 4.43s]
[0m18:14:52.245032 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_products
[0m18:14:52.247178 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:14:52.248364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:52.248842 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m18:14:52.249270 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_products' was properly closed.
[0m18:14:52.249735 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m18:14:52.250186 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m18:14:52.250690 [info ] [MainThread]: 
[0m18:14:52.251570 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m18:14:52.252579 [debug] [MainThread]: Command end result
[0m18:14:52.296702 [info ] [MainThread]: 
[0m18:14:52.297742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:52.298603 [info ] [MainThread]: 
[0m18:14:52.299492 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:14:52.300425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20b28ce3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20b3651540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20af392230>]}
[0m18:14:52.301069 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:15:47.616086 | 66227e58-81c3-4cfa-9568-5a73b26ef4f7 ==============================
[0m18:15:47.616086 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:15:47.619566 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fact_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:15:47.620280 [debug] [MainThread]: Tracking: tracking
[0m18:15:47.622874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa998766e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa99875120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa998766b0>]}
[0m18:15:47.677869 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:15:47.828306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:15:47.829366 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m18:15:47.852539 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m18:15:47.962928 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m18:15:48.002643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66227e58-81c3-4cfa-9568-5a73b26ef4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa98d3a0e0>]}
[0m18:15:48.032226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66227e58-81c3-4cfa-9568-5a73b26ef4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9941d750>]}
[0m18:15:48.032781 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:15:48.033297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66227e58-81c3-4cfa-9568-5a73b26ef4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa993ebd60>]}
[0m18:15:48.037418 [info ] [MainThread]: 
[0m18:15:48.040213 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:15:48.041609 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:15:48.042070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:48.978069 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:15:48.978649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:48.979387 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:15:48.980361 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:15:48.980909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:49.014147 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:15:49.016396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:49.017013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:50.505972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66227e58-81c3-4cfa-9568-5a73b26ef4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9941c0d0>]}
[0m18:15:50.506901 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:50.507375 [info ] [MainThread]: 
[0m18:15:50.511221 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m18:15:50.511856 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m18:15:50.512883 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m18:15:50.513262 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m18:15:50.516627 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m18:15:50.517161 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 18:15:50.513471 => 2023-07-01 18:15:50.517084
[0m18:15:50.517495 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m18:15:50.536348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:51.395796 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m18:15:51.396914 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , MD5(cast(customer_id as string)) as customer_fk
        , MD5(cast(sales_person_id as string)) as sales_person_fk
        , MD5(cast(bill_to_address_id as string)) as bill_to_address_fk
        , MD5(cast(ship_to_address_id as string)) as ship_to_address_fk
        , MD5(cast(ship_method_id as string)) as ship_method_fk
        , MD5(cast(product_id as string)) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m18:15:56.182336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ce62924a-0752-469f-898b-78b928471ed5&page=queryresults
[0m18:15:56.956539 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 18:15:50.517700 => 2023-07-01 18:15:56.956423
[0m18:15:56.957421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66227e58-81c3-4cfa-9568-5a73b26ef4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa98b858a0>]}
[0m18:15:56.957940 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 14.3 MB processed)[0m in 6.45s]
[0m18:15:56.961514 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m18:15:56.964385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:15:56.965699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:56.966339 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m18:15:56.966938 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m18:15:56.967592 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m18:15:56.967990 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m18:15:56.968411 [info ] [MainThread]: 
[0m18:15:56.968940 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.93 seconds (8.93s).
[0m18:15:56.969904 [debug] [MainThread]: Command end result
[0m18:15:57.012632 [info ] [MainThread]: 
[0m18:15:57.014490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:57.016461 [info ] [MainThread]: 
[0m18:15:57.017213 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:15:57.018024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9d9f95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa993febc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa993fe410>]}
[0m18:15:57.019688 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:16:16.194668 | 888f72db-93cb-4a8d-84c6-d79a064322a2 ==============================
[0m18:16:16.194668 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:16:16.196904 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:16:16.197280 [debug] [MainThread]: Tracking: tracking
[0m18:16:16.199004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a586e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a586680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a586e30>]}
[0m18:16:16.245219 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:16:16.400410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:16.401293 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.sql
[0m18:16:16.424187 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m18:16:16.505732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '888f72db-93cb-4a8d-84c6-d79a064322a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb059c2cb20>]}
[0m18:16:16.530221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '888f72db-93cb-4a8d-84c6-d79a064322a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a474d60>]}
[0m18:16:16.530728 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:16:16.531210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888f72db-93cb-4a8d-84c6-d79a064322a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a2fff10>]}
[0m18:16:16.536862 [info ] [MainThread]: 
[0m18:16:16.540509 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:16:16.553035 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:16:16.555414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:16.595696 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:16:16.602637 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:16:16.603731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:16.605191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:16:16.606552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:16.644281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:17.940453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888f72db-93cb-4a8d-84c6-d79a064322a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a350190>]}
[0m18:16:17.941418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:16:17.941910 [info ] [MainThread]: 
[0m18:16:17.947681 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:16:17.948289 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:16:17.948795 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:16:17.949266 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:16:17.949645 [info ] [Thread-1 (]: 1 of 15 START test not_null_dim_address_address_sk ............................. [RUN]
[0m18:16:17.950668 [info ] [Thread-2 (]: 2 of 15 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m18:16:17.951735 [info ] [Thread-3 (]: 3 of 15 START test not_null_dim_products_product_sk ............................ [RUN]
[0m18:16:17.953578 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m18:16:17.952213 [info ] [Thread-4 (]: 4 of 15 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m18:16:17.955122 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m18:16:17.956120 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m18:16:17.957011 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:16:17.958117 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m18:16:17.958789 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:16:17.959278 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:16:17.967759 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:16:18.018461 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:16:18.022454 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m18:16:18.030009 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:16:18.038196 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:16:18.038967 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 18:16:17.959848 => 2023-07-01 18:16:18.038876
[0m18:16:18.039494 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 18:16:18.023471 => 2023-07-01 18:16:18.039424
[0m18:16:18.039803 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 18:16:17.995472 => 2023-07-01 18:16:18.039752
[0m18:16:18.040085 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 18:16:17.973414 => 2023-07-01 18:16:18.039997
[0m18:16:18.040380 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:16:18.040701 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:16:18.041014 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:16:18.041403 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:16:18.064497 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:16:18.067519 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:16:18.070427 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m18:16:18.073436 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:16:18.074366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:18.074878 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:16:18.075186 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:16:18.077457 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m18:16:18.077742 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:16:18.079386 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m18:16:18.113344 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m18:16:18.152555 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m18:16:19.689645 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:7]')
[0m18:16:20.815496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7da4f0de-76f1-4259-accc-67a161adc73f&page=queryresults
[0m18:16:20.817595 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 18:16:18.041654 => 2023-07-01 18:16:20.817508
[0m18:16:20.818073 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2baf4d1d-3d69-4fdd-9430-c77e3935d3b6&page=queryresults
[0m18:16:20.819140 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.87s]
[0m18:16:20.820363 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 18:16:18.070773 => 2023-07-01 18:16:20.820253
[0m18:16:20.822487 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:16:20.823489 [info ] [Thread-2 (]: 2 of 15 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.87s]
[0m18:16:20.824374 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:16:20.825209 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:16:20.825630 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m18:16:20.826570 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:16:20.827756 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m18:16:20.828321 [info ] [Thread-2 (]: 6 of 15 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:16:20.829285 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:16:20.830500 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de'
[0m18:16:20.843336 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:16:20.843899 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:16:20.845220 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 18:16:20.831137 => 2023-07-01 18:16:20.844975
[0m18:16:20.867807 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:16:20.878383 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:16:20.879139 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:16:20.880727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:20.881688 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (compile): 2023-07-01 18:16:20.846051 => 2023-07-01 18:16:20.881548
[0m18:16:20.883969 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m18:16:20.884340 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:16:20.920406 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3f8aafcb-3d87-4448-bc5f-93418ad28147&page=queryresults
[0m18:16:20.923485 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:16:20.924348 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 18:16:18.067828 => 2023-07-01 18:16:20.924274
[0m18:16:20.925520 [error] [Thread-3 (]: 3 of 15 FAIL 1 not_null_dim_products_product_sk ................................ [[31mFAIL 1[0m in 2.97s]
[0m18:16:20.926255 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:16:20.926621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:16:20.927319 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:16:20.928175 [info ] [Thread-3 (]: 7 of 15 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m18:16:20.930298 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:16:20.931257 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m18:16:20.967818 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:16:20.976179 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:16:20.977785 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 18:16:20.968363 => 2023-07-01 18:16:20.977539
[0m18:16:20.978527 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:16:20.990802 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:16:20.992244 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:16:20.996286 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:16:21.061796 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:26a699be-237e-422f-82f1-775d67628704&page=queryresults
[0m18:16:21.062997 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 18:16:18.064752 => 2023-07-01 18:16:21.062852
[0m18:16:21.067616 [debug] [Thread-4 (]: Database Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:16:21.068511 [error] [Thread-4 (]: 4 of 15 ERROR not_null_dim_workers_worker_sk ................................... [[31mERROR[0m in 3.11s]
[0m18:16:21.069531 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:16:21.070370 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:16:21.071204 [info ] [Thread-4 (]: 8 of 15 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m18:16:21.072904 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m18:16:21.073645 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:16:21.089842 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m18:16:21.092800 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 18:16:21.074169 => 2023-07-01 18:16:21.092589
[0m18:16:21.093635 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:16:21.098777 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m18:16:21.100562 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:16:21.104461 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:16:23.479330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:07c4a8d5-6de5-4715-af91-043a3eef4f77&page=queryresults
[0m18:16:23.487556 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 18:16:20.874431 => 2023-07-01 18:16:23.487454
[0m18:16:23.489434 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.66s]
[0m18:16:23.491173 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:16:23.491864 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:16:23.492449 [info ] [Thread-1 (]: 9 of 15 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m18:16:23.494359 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m18:16:23.496044 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:16:23.506795 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:16:23.507335 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 18:16:23.496787 => 2023-07-01 18:16:23.507260
[0m18:16:23.507763 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:16:23.511512 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:16:23.512088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:23.513900 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:16:23.766225 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c15d6a2e-7bfb-4289-9d46-fe252b4c652e&page=queryresults
[0m18:16:23.767143 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (execute): 2023-07-01 18:16:20.920664 => 2023-07-01 18:16:23.767054
[0m18:16:23.768137 [info ] [Thread-2 (]: 6 of 15 PASS relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.94s]
[0m18:16:23.768820 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:16:23.769406 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:16:23.769982 [info ] [Thread-2 (]: 10 of 15 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:16:23.771281 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310'
[0m18:16:23.771740 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:16:23.781731 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:16:23.783965 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e52257f0-2a74-4c68-a524-b1f847daa958&page=queryresults
[0m18:16:23.786217 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 18:16:20.978922 => 2023-07-01 18:16:23.786017
[0m18:16:23.787705 [info ] [Thread-3 (]: 7 of 15 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.86s]
[0m18:16:23.788453 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (compile): 2023-07-01 18:16:23.772004 => 2023-07-01 18:16:23.788306
[0m18:16:23.789179 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:16:23.789701 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:16:23.790581 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:16:23.798883 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:16:23.800390 [info ] [Thread-3 (]: 11 of 15 START test unique_dim_address_address_sk .............................. [RUN]
[0m18:16:23.804190 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e55a6acf-437b-4c2e-829a-ea87114466b3&page=queryresults
[0m18:16:23.805316 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m18:16:23.806443 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 18:16:21.094140 => 2023-07-01 18:16:23.806325
[0m18:16:23.806794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:16:23.807253 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:16:23.808315 [error] [Thread-4 (]: 8 of 15 FAIL 9081 relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[31mFAIL 9081[0m in 2.74s]
[0m18:16:23.815982 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:16:23.827731 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:16:23.828304 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:16:23.873522 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:16:23.875441 [info ] [Thread-4 (]: 12 of 15 START test unique_dim_dates_metric_date ............................... [RUN]
[0m18:16:23.878337 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 18:16:23.809154 => 2023-07-01 18:16:23.877815
[0m18:16:23.880841 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m18:16:23.883009 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:16:23.884816 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:16:23.888776 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:16:23.895585 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:16:23.902755 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:16:23.905109 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:16:23.943138 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 18:16:23.889139 => 2023-07-01 18:16:23.943001
[0m18:16:23.944029 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:16:23.950531 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:16:23.951706 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:16:23.954841 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:16:24.857114 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [18:12]')
[0m18:16:25.431689 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:037e98b3-1e65-4dba-aaf5-2632f9795c46&page=queryresults
[0m18:16:25.436733 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 18:16:23.507989 => 2023-07-01 18:16:25.436594
[0m18:16:25.442177 [debug] [Thread-1 (]: Database Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)
  Unrecognized name: worker_sk at [18:12]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:16:25.443138 [error] [Thread-1 (]: 9 of 15 ERROR relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[31mERROR[0m in 1.95s]
[0m18:16:25.444337 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:16:25.445140 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:16:25.446080 [info ] [Thread-1 (]: 13 of 15 START test unique_dim_products_product_sk ............................. [RUN]
[0m18:16:25.448426 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m18:16:25.449647 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:16:25.460920 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m18:16:25.461575 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 18:16:25.450721 => 2023-07-01 18:16:25.461464
[0m18:16:25.462102 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:16:25.468240 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m18:16:25.470027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:25.474880 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:16:26.448016 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ce598153-ca03-4151-aa67-0b85349e8c21&page=queryresults
[0m18:16:26.448672 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cb1a99e1-bf9b-4375-a811-df01641bc7b6&page=queryresults
[0m18:16:26.449358 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 18:16:23.944410 => 2023-07-01 18:16:26.449284
[0m18:16:26.449930 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 18:16:23.885594 => 2023-07-01 18:16:26.449877
[0m18:16:26.450693 [info ] [Thread-4 (]: 12 of 15 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.57s]
[0m18:16:26.451866 [error] [Thread-3 (]: 11 of 15 FAIL 83 unique_dim_address_address_sk ................................. [[31mFAIL 83[0m in 2.65s]
[0m18:16:26.452652 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:16:26.453150 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:16:26.453687 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:16:26.454300 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:16:26.454752 [info ] [Thread-4 (]: 14 of 15 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m18:16:26.455396 [info ] [Thread-3 (]: 15 of 15 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m18:16:26.456724 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m18:16:26.457504 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m18:16:26.457881 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:16:26.458218 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:16:26.463829 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:16:26.473168 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:16:26.474657 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1f14fb9b-a6dd-4085-a05d-2a06a451d45c&page=queryresults
[0m18:16:26.475416 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 18:16:26.464325 => 2023-07-01 18:16:26.475252
[0m18:16:26.477031 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (execute): 2023-07-01 18:16:23.791232 => 2023-07-01 18:16:26.476869
[0m18:16:26.477773 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 18:16:26.458465 => 2023-07-01 18:16:26.477577
[0m18:16:26.478538 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:16:26.479835 [info ] [Thread-2 (]: 10 of 15 PASS relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.71s]
[0m18:16:26.481115 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:16:26.490534 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:16:26.492550 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:16:26.499085 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:16:26.501129 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:16:26.506493 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:16:26.507260 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:16:26.549164 [debug] [Thread-3 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:16:27.883818 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2c0c49cf-4a5c-4331-bc45-06a429822822&page=queryresults
[0m18:16:27.885085 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 18:16:25.462531 => 2023-07-01 18:16:27.884950
[0m18:16:27.886535 [info ] [Thread-1 (]: 13 of 15 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 2.44s]
[0m18:16:27.887537 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:16:27.939601 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:9]')
[0m18:16:28.467503 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6ccd0a82-42d2-46ce-acef-c9f4d83a8c01&page=queryresults
[0m18:16:28.469088 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 18:16:26.493122 => 2023-07-01 18:16:28.468780
[0m18:16:28.470879 [debug] [Thread-4 (]: Database Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:16:28.471401 [error] [Thread-4 (]: 14 of 15 ERROR unique_dim_workers_worker_sk .................................... [[31mERROR[0m in 2.02s]
[0m18:16:28.471999 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:16:29.417904 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:37f99414-4cec-490d-9776-3745360b7e46&page=queryresults
[0m18:16:29.419310 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 18:16:26.481807 => 2023-07-01 18:16:29.419165
[0m18:16:29.420869 [info ] [Thread-3 (]: 15 of 15 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.96s]
[0m18:16:29.422325 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:16:29.425703 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:16:29.427245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:29.427755 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m18:16:29.428142 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m18:16:29.428487 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m18:16:29.428820 [debug] [MainThread]: Connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310' was properly closed.
[0m18:16:29.429240 [info ] [MainThread]: 
[0m18:16:29.429973 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 12.89 seconds (12.89s).
[0m18:16:29.431627 [debug] [MainThread]: Command end result
[0m18:16:29.590095 [info ] [MainThread]: 
[0m18:16:29.590927 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m18:16:29.591583 [info ] [MainThread]: 
[0m18:16:29.592121 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_sk (models/gold/dim_products.yml)[0m
[0m18:16:29.592798 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:16:29.593361 [info ] [MainThread]: 
[0m18:16:29.593905 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/dim_products.yml/not_null_dim_products_product_sk.sql
[0m18:16:29.594418 [info ] [MainThread]: 
[0m18:16:29.594959 [error] [MainThread]: [33mDatabase Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:16:29.595472 [error] [MainThread]:   Unrecognized name: worker_sk at [15:7]
[0m18:16:29.595972 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:16:29.596617 [info ] [MainThread]: 
[0m18:16:29.597178 [error] [MainThread]: [31mFailure in test relationships_fact_sales_product_fk__product_sk__ref_dim_products_ (models/gold/fact_sales.yml)[0m
[0m18:16:29.597727 [error] [MainThread]:   Got 9081 results, configured to fail if != 0
[0m18:16:29.598276 [info ] [MainThread]: 
[0m18:16:29.598909 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_f765900a1937b39c2370e1a1d08c08f5.sql
[0m18:16:29.599427 [info ] [MainThread]: 
[0m18:16:29.599970 [error] [MainThread]: [33mDatabase Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)[0m
[0m18:16:29.600544 [error] [MainThread]:   Unrecognized name: worker_sk at [18:12]
[0m18:16:29.601189 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:16:29.602147 [info ] [MainThread]: 
[0m18:16:29.603064 [error] [MainThread]: [31mFailure in test unique_dim_address_address_sk (models/gold/dim_address.yml)[0m
[0m18:16:29.604339 [error] [MainThread]:   Got 83 results, configured to fail if != 0
[0m18:16:29.605408 [info ] [MainThread]: 
[0m18:16:29.607251 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/dim_address.yml/unique_dim_address_address_sk.sql
[0m18:16:29.608681 [info ] [MainThread]: 
[0m18:16:29.609697 [error] [MainThread]: [33mDatabase Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:16:29.610951 [error] [MainThread]:   Unrecognized name: worker_sk at [15:9]
[0m18:16:29.612098 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:16:29.614503 [info ] [MainThread]: 
[0m18:16:29.615428 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=6 SKIP=0 TOTAL=15
[0m18:16:29.616400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a5866e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a2ffeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a68d0c0>]}
[0m18:16:29.617132 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:18:10.092847 | 6fdbce6a-fff6-48ac-a491-a49672806f45 ==============================
[0m18:18:10.092847 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:18:10.095170 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:18:10.096047 [debug] [MainThread]: Tracking: tracking
[0m18:18:10.097763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b557a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b5579150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b557a6e0>]}
[0m18:18:10.140305 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:18:10.275331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:18:10.276325 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_products.sql
[0m18:18:10.300166 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m18:18:10.384957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fdbce6a-fff6-48ac-a491-a49672806f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b4a28df0>]}
[0m18:18:10.409340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fdbce6a-fff6-48ac-a491-a49672806f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b5269030>]}
[0m18:18:10.409833 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:18:10.410326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fdbce6a-fff6-48ac-a491-a49672806f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b50f7df0>]}
[0m18:18:10.415496 [info ] [MainThread]: 
[0m18:18:10.418564 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:18:10.428312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:18:10.429625 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:18:10.430405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:10.431401 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:18:10.431772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:10.432741 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:18:10.468552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:10.469922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:11.957935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fdbce6a-fff6-48ac-a491-a49672806f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b5153610>]}
[0m18:18:11.958901 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:18:11.959352 [info ] [MainThread]: 
[0m18:18:11.963476 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:18:11.963856 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:18:11.964531 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:18:11.965002 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:18:11.965273 [info ] [Thread-1 (]: 1 of 15 START test not_null_dim_address_address_sk ............................. [RUN]
[0m18:18:11.966064 [info ] [Thread-2 (]: 2 of 15 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m18:18:11.967512 [info ] [Thread-3 (]: 3 of 15 START test not_null_dim_products_product_sk ............................ [RUN]
[0m18:18:11.969089 [info ] [Thread-4 (]: 4 of 15 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m18:18:11.971539 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m18:18:11.972770 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m18:18:11.975449 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m18:18:11.977433 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m18:18:11.978177 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:18:11.978678 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:18:11.979206 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:18:11.979630 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:18:12.008068 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:18:12.014966 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m18:18:12.024652 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:18:12.032156 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:18:12.032986 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 18:18:11.980079 => 2023-07-01 18:18:12.032897
[0m18:18:12.033304 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 18:18:12.009685 => 2023-07-01 18:18:12.033221
[0m18:18:12.033850 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 18:18:12.019002 => 2023-07-01 18:18:12.033767
[0m18:18:12.034432 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:18:12.034861 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 18:18:11.991444 => 2023-07-01 18:18:12.034770
[0m18:18:12.035306 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:18:12.035682 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:18:12.057837 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:18:12.058338 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:18:12.061700 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m18:18:12.064463 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:18:12.067267 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:18:12.068034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:12.068357 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:18:12.069013 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:18:12.069558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:18:12.071532 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m18:18:12.073158 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m18:18:12.074767 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m18:18:12.108190 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m18:18:13.766741 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:7]')
[0m18:18:14.386016 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:51792917-b86f-4e94-ad74-d27f456f3646&page=queryresults
[0m18:18:14.391615 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 18:18:12.062013 => 2023-07-01 18:18:14.391491
[0m18:18:14.396051 [debug] [Thread-4 (]: Database Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:18:14.397298 [error] [Thread-4 (]: 4 of 15 ERROR not_null_dim_workers_worker_sk ................................... [[31mERROR[0m in 2.42s]
[0m18:18:14.400299 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:18:14.400881 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:18:14.401597 [info ] [Thread-4 (]: 5 of 15 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m18:18:14.403570 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m18:18:14.404485 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:18:14.413372 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:18:14.414144 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 18:18:14.405156 => 2023-07-01 18:18:14.414013
[0m18:18:14.414928 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:18:14.418449 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:18:14.419085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:18:14.421755 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m18:18:15.024409 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:192e4af0-5576-4ab1-bd6d-aa1d63eb382a&page=queryresults
[0m18:18:15.026435 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 18:18:12.058701 => 2023-07-01 18:18:15.026351
[0m18:18:15.027326 [error] [Thread-3 (]: 3 of 15 FAIL 1 not_null_dim_products_product_sk ................................ [[31mFAIL 1[0m in 3.05s]
[0m18:18:15.028031 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:18:15.028809 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:18:15.029341 [info ] [Thread-3 (]: 6 of 15 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:18:15.030534 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de'
[0m18:18:15.031091 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:18:15.049362 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:18:15.050066 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6dbf9a82-d746-4495-b0da-7484d7c0e9ae&page=queryresults
[0m18:18:15.051247 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 18:18:12.064766 => 2023-07-01 18:18:15.051140
[0m18:18:15.052598 [info ] [Thread-2 (]: 2 of 15 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 3.08s]
[0m18:18:15.053381 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (compile): 2023-07-01 18:18:15.031391 => 2023-07-01 18:18:15.053253
[0m18:18:15.053996 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:18:15.054687 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:18:15.055601 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:18:15.061255 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:18:15.062365 [info ] [Thread-2 (]: 7 of 15 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m18:18:15.064139 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:18:15.065545 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m18:18:15.069273 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:18:15.069819 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:18:15.116785 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:18:15.117319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3bbb9444-c04e-48b7-beb6-66bac85156f1&page=queryresults
[0m18:18:15.118934 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 18:18:12.035943 => 2023-07-01 18:18:15.118791
[0m18:18:15.120069 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 3.15s]
[0m18:18:15.120722 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 18:18:15.108839 => 2023-07-01 18:18:15.120598
[0m18:18:15.121380 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:18:15.121865 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:18:15.122527 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:18:15.128611 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:18:15.129300 [info ] [Thread-1 (]: 8 of 15 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m18:18:15.131186 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:18:15.132655 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m18:18:15.134393 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:18:15.153745 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:18:15.156299 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m18:18:15.191627 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 18:18:15.141807 => 2023-07-01 18:18:15.191492
[0m18:18:15.192228 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:18:15.195649 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m18:18:15.196300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:15.198177 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:18:16.500729 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:97354b65-de39-42af-9248-b12dad153342&page=queryresults
[0m18:18:16.501812 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 18:18:14.415197 => 2023-07-01 18:18:16.501714
[0m18:18:16.502717 [info ] [Thread-4 (]: 5 of 15 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.10s]
[0m18:18:16.503476 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:18:16.504051 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:18:16.504649 [info ] [Thread-4 (]: 9 of 15 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m18:18:16.505956 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m18:18:16.506503 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:18:16.521739 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:18:16.522663 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 18:18:16.506930 => 2023-07-01 18:18:16.522521
[0m18:18:16.523235 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:18:16.529924 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:18:16.530650 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:18:16.532901 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:18:17.242448 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:efab4326-6c71-46fd-ad57-305070083af2&page=queryresults
[0m18:18:17.243388 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (execute): 2023-07-01 18:18:15.056147 => 2023-07-01 18:18:17.243278
[0m18:18:17.244354 [info ] [Thread-3 (]: 6 of 15 PASS relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.21s]
[0m18:18:17.244960 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:18:17.245577 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:18:17.246173 [info ] [Thread-3 (]: 10 of 15 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:18:17.247386 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310'
[0m18:18:17.247945 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:18:17.260648 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:18:17.262416 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (compile): 2023-07-01 18:18:17.248235 => 2023-07-01 18:18:17.262068
[0m18:18:17.264662 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:18:17.268556 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:18:17.269237 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:18:17.273474 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:18:17.413430 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2ca871bf-0271-482d-ba80-1a173519a8eb&page=queryresults
[0m18:18:17.414434 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 18:18:15.123010 => 2023-07-01 18:18:17.414337
[0m18:18:17.415640 [info ] [Thread-2 (]: 7 of 15 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.35s]
[0m18:18:17.416453 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:18:17.417144 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:18:17.417826 [info ] [Thread-2 (]: 11 of 15 START test unique_dim_address_address_sk .............................. [RUN]
[0m18:18:17.419131 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m18:18:17.419725 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:18:17.435482 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:18:17.436689 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 18:18:17.420091 => 2023-07-01 18:18:17.436510
[0m18:18:17.437407 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:18:17.443868 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:18:17.446461 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cccf0a87-997d-464d-82e3-b2702a97d99f&page=queryresults
[0m18:18:17.448245 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 18:18:15.192637 => 2023-07-01 18:18:17.448081
[0m18:18:17.451398 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:18:17.449884 [error] [Thread-1 (]: 8 of 15 FAIL 9081 relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[31mFAIL 9081[0m in 2.32s]
[0m18:18:17.455214 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:18:17.458960 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:18:17.459455 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:18:17.460195 [info ] [Thread-1 (]: 12 of 15 START test unique_dim_dates_metric_date ............................... [RUN]
[0m18:18:17.496734 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m18:18:17.497141 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:18:17.503591 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:18:17.504228 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 18:18:17.497373 => 2023-07-01 18:18:17.504099
[0m18:18:17.504586 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:18:17.507568 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:18:17.508118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:17.509703 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:18:17.617668 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [18:12]')
[0m18:18:19.074450 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3f5fba82-eefc-42ce-801d-8bf61b9fe55c&page=queryresults
[0m18:18:19.075404 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 18:18:16.523554 => 2023-07-01 18:18:19.075236
[0m18:18:19.077299 [debug] [Thread-4 (]: Database Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)
  Unrecognized name: worker_sk at [18:12]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:18:19.077917 [error] [Thread-4 (]: 9 of 15 ERROR relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[31mERROR[0m in 2.57s]
[0m18:18:19.078726 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:18:19.079343 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:18:19.079898 [info ] [Thread-4 (]: 13 of 15 START test unique_dim_products_product_sk ............................. [RUN]
[0m18:18:19.081080 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m18:18:19.082108 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:18:19.095432 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m18:18:19.096452 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 18:18:19.082582 => 2023-07-01 18:18:19.096279
[0m18:18:19.097273 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:18:19.105174 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m18:18:19.106454 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:18:19.109767 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:18:19.520354 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2cdf377f-3b4a-4e8a-926d-dff2fb84f18b&page=queryresults
[0m18:18:19.521668 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (execute): 2023-07-01 18:18:17.265343 => 2023-07-01 18:18:19.521525
[0m18:18:19.523068 [info ] [Thread-3 (]: 10 of 15 PASS relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.28s]
[0m18:18:19.524067 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:18:19.524710 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:18:19.525288 [info ] [Thread-3 (]: 14 of 15 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m18:18:19.526790 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m18:18:19.527525 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:18:19.540777 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:18:19.542298 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 18:18:19.528114 => 2023-07-01 18:18:19.542091
[0m18:18:19.543204 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:18:19.551887 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:18:19.553510 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:18:19.558393 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:18:19.612252 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7c7fc036-bc7d-48a8-aa8a-8e9fcf0db00c&page=queryresults
[0m18:18:19.615671 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 18:18:17.438009 => 2023-07-01 18:18:19.615199
[0m18:18:19.619683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b251bf40-9771-4065-9407-3bcb99f2dd56&page=queryresults
[0m18:18:19.621963 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 18:18:17.504789 => 2023-07-01 18:18:19.621793
[0m18:18:19.617706 [error] [Thread-2 (]: 11 of 15 FAIL 83 unique_dim_address_address_sk ................................. [[31mFAIL 83[0m in 2.20s]
[0m18:18:19.625881 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:18:19.628052 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:18:19.624260 [info ] [Thread-1 (]: 12 of 15 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.13s]
[0m18:18:19.633717 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:18:19.630808 [info ] [Thread-2 (]: 15 of 15 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m18:18:19.637577 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m18:18:19.638570 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:18:19.653203 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:18:19.654090 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 18:18:19.639092 => 2023-07-01 18:18:19.653941
[0m18:18:19.654857 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:18:19.667286 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:18:19.668325 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:18:19.671520 [debug] [Thread-2 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:18:20.735739 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:9]')
[0m18:18:21.448772 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5f769f44-00a1-49e5-9f85-a09c8eae55b9&page=queryresults
[0m18:18:21.449684 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 18:18:19.097652 => 2023-07-01 18:18:21.449607
[0m18:18:21.450454 [info ] [Thread-4 (]: 13 of 15 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 2.37s]
[0m18:18:21.451039 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:18:21.963250 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6e4b47f5-915e-4047-ac0d-d434537f3b67&page=queryresults
[0m18:18:21.964872 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 18:18:19.655549 => 2023-07-01 18:18:21.964648
[0m18:18:21.966829 [info ] [Thread-2 (]: 15 of 15 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.33s]
[0m18:18:21.968667 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:18:22.169950 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c168dd37-18d0-4336-826c-e5ffe2576341&page=queryresults
[0m18:18:22.171039 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 18:18:19.543949 => 2023-07-01 18:18:22.170899
[0m18:18:22.172986 [debug] [Thread-3 (]: Database Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:18:22.173752 [error] [Thread-3 (]: 14 of 15 ERROR unique_dim_workers_worker_sk .................................... [[31mERROR[0m in 2.65s]
[0m18:18:22.174636 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:18:22.177393 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:18:22.178979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:22.179800 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m18:18:22.180495 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed' was properly closed.
[0m18:18:22.181077 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m18:18:22.181656 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m18:18:22.182588 [info ] [MainThread]: 
[0m18:18:22.183430 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 11.77 seconds (11.77s).
[0m18:18:22.185361 [debug] [MainThread]: Command end result
[0m18:18:22.413384 [info ] [MainThread]: 
[0m18:18:22.414455 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m18:18:22.415411 [info ] [MainThread]: 
[0m18:18:22.416360 [error] [MainThread]: [33mDatabase Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:18:22.417244 [error] [MainThread]:   Unrecognized name: worker_sk at [15:7]
[0m18:18:22.418013 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:18:22.418742 [info ] [MainThread]: 
[0m18:18:22.419621 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_sk (models/gold/dim_products.yml)[0m
[0m18:18:22.420448 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:18:22.421284 [info ] [MainThread]: 
[0m18:18:22.422132 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/dim_products.yml/not_null_dim_products_product_sk.sql
[0m18:18:22.422936 [info ] [MainThread]: 
[0m18:18:22.423868 [error] [MainThread]: [31mFailure in test relationships_fact_sales_product_fk__product_sk__ref_dim_products_ (models/gold/fact_sales.yml)[0m
[0m18:18:22.424776 [error] [MainThread]:   Got 9081 results, configured to fail if != 0
[0m18:18:22.425583 [info ] [MainThread]: 
[0m18:18:22.426352 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_f765900a1937b39c2370e1a1d08c08f5.sql
[0m18:18:22.427130 [info ] [MainThread]: 
[0m18:18:22.427931 [error] [MainThread]: [33mDatabase Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)[0m
[0m18:18:22.428695 [error] [MainThread]:   Unrecognized name: worker_sk at [18:12]
[0m18:18:22.429468 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:18:22.430205 [info ] [MainThread]: 
[0m18:18:22.430961 [error] [MainThread]: [31mFailure in test unique_dim_address_address_sk (models/gold/dim_address.yml)[0m
[0m18:18:22.431579 [error] [MainThread]:   Got 83 results, configured to fail if != 0
[0m18:18:22.432026 [info ] [MainThread]: 
[0m18:18:22.432456 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/dim_address.yml/unique_dim_address_address_sk.sql
[0m18:18:22.432881 [info ] [MainThread]: 
[0m18:18:22.433329 [error] [MainThread]: [33mDatabase Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:18:22.433767 [error] [MainThread]:   Unrecognized name: worker_sk at [15:9]
[0m18:18:22.434140 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:18:22.434595 [info ] [MainThread]: 
[0m18:18:22.435002 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=6 SKIP=0 TOTAL=15
[0m18:18:22.435674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b5578f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b88c6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b50f7d60>]}
[0m18:18:22.436373 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:18:51.986035 | df14eeda-79ca-4c4e-b4af-5c9f0fb74f1a ==============================
[0m18:18:51.986035 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:18:51.988019 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:18:51.988539 [debug] [MainThread]: Tracking: tracking
[0m18:18:51.990274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce663b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce662620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce662b90>]}
[0m18:18:52.033205 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:18:52.177724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:18:52.178089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:18:52.191640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df14eeda-79ca-4c4e-b4af-5c9f0fb74f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce2440d0>]}
[0m18:18:52.216238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df14eeda-79ca-4c4e-b4af-5c9f0fb74f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce209720>]}
[0m18:18:52.216784 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:18:52.217361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df14eeda-79ca-4c4e-b4af-5c9f0fb74f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce209780>]}
[0m18:18:52.221231 [info ] [MainThread]: 
[0m18:18:52.223661 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:18:52.224969 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:18:52.225405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:53.082387 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:18:53.083442 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:18:53.083768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:53.084561 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:18:53.085104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:53.086405 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:18:53.087453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:53.124944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:54.536027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df14eeda-79ca-4c4e-b4af-5c9f0fb74f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce2083d0>]}
[0m18:18:54.537063 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:18:54.537632 [info ] [MainThread]: 
[0m18:18:54.542760 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_products
[0m18:18:54.543283 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m18:18:54.544690 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m18:18:54.545198 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_products
[0m18:18:54.551318 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m18:18:54.552126 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-07-01 18:18:54.545501 => 2023-07-01 18:18:54.551975
[0m18:18:54.552928 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_products
[0m18:18:54.595315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:55.518957 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m18:18:55.519992 [debug] [Thread-1 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    where product_id is not null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
 
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m18:18:58.711071 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:df7612c8-416c-47c0-8c5d-11a30f862bd5&page=queryresults
[0m18:18:59.643177 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-07-01 18:18:54.553629 => 2023-07-01 18:18:59.643101
[0m18:18:59.644064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df14eeda-79ca-4c4e-b4af-5c9f0fb74f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce208130>]}
[0m18:18:59.644571 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_products ................. [[32mCREATE TABLE (223.0 rows, 70.9 KB processed)[0m in 5.10s]
[0m18:18:59.647799 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_products
[0m18:18:59.650024 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:18:59.651253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:59.651925 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m18:18:59.652518 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m18:18:59.653251 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m18:18:59.653852 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_products' was properly closed.
[0m18:18:59.654322 [info ] [MainThread]: 
[0m18:18:59.655087 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m18:18:59.656077 [debug] [MainThread]: Command end result
[0m18:18:59.711723 [info ] [MainThread]: 
[0m18:18:59.712562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:59.713735 [info ] [MainThread]: 
[0m18:18:59.715648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:18:59.717457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce0bc370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce2091b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ce209660>]}
[0m18:18:59.718959 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:19:28.280882 | 55a13f43-4a91-458a-be36-f3ea7061538d ==============================
[0m18:19:28.280882 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:19:28.284545 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:19:28.284957 [debug] [MainThread]: Tracking: tracking
[0m18:19:28.286876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dea1723b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dea172260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dea172770>]}
[0m18:19:28.369655 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:19:28.570495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:28.570858 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:28.586938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55a13f43-4a91-458a-be36-f3ea7061538d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de9d54220>]}
[0m18:19:28.619276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55a13f43-4a91-458a-be36-f3ea7061538d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de9d198a0>]}
[0m18:19:28.619991 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:19:28.620569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a13f43-4a91-458a-be36-f3ea7061538d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de9d19a50>]}
[0m18:19:28.626427 [info ] [MainThread]: 
[0m18:19:28.630019 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:19:28.638511 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:19:28.639876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:28.641395 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:19:28.688286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:19:28.688805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:28.690995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:19:28.691808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:28.692516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:30.168547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a13f43-4a91-458a-be36-f3ea7061538d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de9d194e0>]}
[0m18:19:30.169387 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:30.169807 [info ] [MainThread]: 
[0m18:19:30.174013 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:19:30.174613 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:19:30.175131 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:19:30.175832 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:19:30.176293 [info ] [Thread-1 (]: 1 of 15 START test not_null_dim_address_address_sk ............................. [RUN]
[0m18:19:30.176893 [info ] [Thread-2 (]: 2 of 15 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m18:19:30.177600 [info ] [Thread-3 (]: 3 of 15 START test not_null_dim_products_product_sk ............................ [RUN]
[0m18:19:30.179703 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m18:19:30.181206 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m18:19:30.178355 [info ] [Thread-4 (]: 4 of 15 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m18:19:30.183184 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m18:19:30.184274 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:19:30.185300 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:19:30.187514 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m18:19:30.188241 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:19:30.216232 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:19:30.231040 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:19:30.241826 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m18:19:30.250972 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:19:30.260829 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:19:30.261412 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 18:19:30.188608 => 2023-07-01 18:19:30.261302
[0m18:19:30.262126 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 18:19:30.243123 => 2023-07-01 18:19:30.262049
[0m18:19:30.262406 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 18:19:30.231614 => 2023-07-01 18:19:30.262343
[0m18:19:30.262849 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:19:30.263196 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:19:30.263453 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 18:19:30.205079 => 2023-07-01 18:19:30.263388
[0m18:19:30.263857 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:19:30.287277 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:19:30.290220 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:19:30.290666 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:19:30.293833 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m18:19:30.297441 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:19:30.297956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:30.298306 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:19:30.298803 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:19:30.299109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:19:30.301393 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m18:19:30.303004 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m18:19:30.304688 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m18:19:30.306118 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m18:19:31.794456 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:7]')
[0m18:19:32.299657 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8d265923-dce6-41ad-8760-1103ab827ecc&page=queryresults
[0m18:19:32.300573 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 18:19:30.287578 => 2023-07-01 18:19:32.300412
[0m18:19:32.304952 [debug] [Thread-4 (]: Database Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:19:32.305841 [error] [Thread-4 (]: 4 of 15 ERROR not_null_dim_workers_worker_sk ................................... [[31mERROR[0m in 2.12s]
[0m18:19:32.309615 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:19:32.310497 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:19:32.315003 [info ] [Thread-4 (]: 5 of 15 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m18:19:32.318495 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m18:19:32.319906 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:19:32.338629 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:19:32.340248 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 18:19:32.320940 => 2023-07-01 18:19:32.340091
[0m18:19:32.341276 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:19:32.351257 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:19:32.352887 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:19:32.357188 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m18:19:32.861927 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3d90b8c4-aae6-4ec5-81ed-5af60fe60f98&page=queryresults
[0m18:19:32.864936 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 18:19:30.294449 => 2023-07-01 18:19:32.864833
[0m18:19:32.865891 [info ] [Thread-2 (]: 2 of 15 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.69s]
[0m18:19:32.866533 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:19:32.867094 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:19:32.867695 [info ] [Thread-2 (]: 6 of 15 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:19:32.868931 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de'
[0m18:19:32.869358 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:19:32.885520 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:19:32.886429 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (compile): 2023-07-01 18:19:32.869625 => 2023-07-01 18:19:32.886291
[0m18:19:32.886990 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:19:32.894077 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:19:32.895666 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:19:32.899445 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:19:32.939484 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c7c87284-6d69-4e12-87dd-78d3a5ae1815&page=queryresults
[0m18:19:32.941015 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 18:19:30.264144 => 2023-07-01 18:19:32.940920
[0m18:19:32.942046 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.76s]
[0m18:19:32.942896 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:19:32.943456 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:19:32.943885 [info ] [Thread-1 (]: 7 of 15 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m18:19:32.944868 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m18:19:32.945276 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:19:32.957182 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:19:32.958033 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 18:19:32.945518 => 2023-07-01 18:19:32.957929
[0m18:19:32.958599 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:19:32.963269 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:19:32.964437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:32.967649 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:19:33.084765 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4434b144-94ae-4052-b3ba-75a864d0c6b2&page=queryresults
[0m18:19:33.085775 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 18:19:30.290960 => 2023-07-01 18:19:33.085668
[0m18:19:33.086927 [info ] [Thread-3 (]: 3 of 15 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 2.90s]
[0m18:19:33.087850 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:19:33.088652 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:19:33.089304 [info ] [Thread-3 (]: 8 of 15 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m18:19:33.090735 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m18:19:33.091418 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:19:33.103141 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m18:19:33.104891 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 18:19:33.091873 => 2023-07-01 18:19:33.104741
[0m18:19:33.105582 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:19:33.116402 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m18:19:33.118199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:19:33.120845 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:19:35.289605 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:00b10749-401f-4d4e-bfce-7202783cd7ec&page=queryresults
[0m18:19:35.290512 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (execute): 2023-07-01 18:19:32.887243 => 2023-07-01 18:19:35.290417
[0m18:19:35.291494 [info ] [Thread-2 (]: 6 of 15 PASS relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.42s]
[0m18:19:35.292081 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:19:35.292776 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:19:35.293342 [info ] [Thread-2 (]: 9 of 15 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m18:19:35.294542 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m18:19:35.294993 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:19:35.311736 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:19:35.312625 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 18:19:35.295257 => 2023-07-01 18:19:35.312480
[0m18:19:35.313410 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:19:35.318653 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:19:35.319863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:19:35.322872 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:19:35.568614 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d27b61f9-7746-431c-84bd-7d90a4e964eb&page=queryresults
[0m18:19:35.569428 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 18:19:32.342036 => 2023-07-01 18:19:35.569344
[0m18:19:35.570309 [info ] [Thread-4 (]: 5 of 15 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 3.25s]
[0m18:19:35.570954 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:19:35.571716 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:19:35.572210 [info ] [Thread-4 (]: 10 of 15 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:19:35.573431 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310'
[0m18:19:35.574447 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:19:35.574899 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3e28e2a7-acbb-4aaf-b0be-00c9689e1e0d&page=queryresults
[0m18:19:35.589994 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:19:35.592224 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 18:19:33.106180 => 2023-07-01 18:19:35.591873
[0m18:19:35.595739 [error] [Thread-3 (]: 8 of 15 FAIL 9081 relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[31mFAIL 9081[0m in 2.51s]
[0m18:19:35.598149 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (compile): 2023-07-01 18:19:35.575252 => 2023-07-01 18:19:35.597467
[0m18:19:35.599632 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:19:35.600912 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:19:35.602282 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:19:35.610447 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:19:35.611786 [info ] [Thread-3 (]: 11 of 15 START test unique_dim_address_address_sk .............................. [RUN]
[0m18:19:35.615028 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m18:19:35.616721 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:19:35.617955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:19:35.636987 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:19:35.652464 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:19:35.695104 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 18:19:35.620272 => 2023-07-01 18:19:35.694986
[0m18:19:35.695735 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:19:35.698972 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:19:35.699625 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:19:35.701353 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:19:35.954410 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:53c8c3e0-e998-45f5-94f6-187f7f9ffcc3&page=queryresults
[0m18:19:35.955237 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 18:19:32.958985 => 2023-07-01 18:19:35.955155
[0m18:19:35.956053 [info ] [Thread-1 (]: 7 of 15 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 3.01s]
[0m18:19:35.956688 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:19:35.957351 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:19:35.957883 [info ] [Thread-1 (]: 12 of 15 START test unique_dim_dates_metric_date ............................... [RUN]
[0m18:19:35.959025 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m18:19:35.959430 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:19:35.969223 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:19:35.970188 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 18:19:35.959653 => 2023-07-01 18:19:35.970028
[0m18:19:35.971117 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:19:35.976371 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:19:35.977186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:35.980006 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:19:36.511783 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [18:12]')
[0m18:19:37.183991 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5a7cd583-baa9-4dc5-bd9b-670c8c45a5e0&page=queryresults
[0m18:19:37.185006 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 18:19:35.313711 => 2023-07-01 18:19:37.184849
[0m18:19:37.186604 [debug] [Thread-2 (]: Database Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)
  Unrecognized name: worker_sk at [18:12]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:19:37.187168 [error] [Thread-2 (]: 9 of 15 ERROR relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[31mERROR[0m in 1.89s]
[0m18:19:37.187806 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:19:37.188328 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:19:37.188783 [info ] [Thread-2 (]: 13 of 15 START test unique_dim_products_product_sk ............................. [RUN]
[0m18:19:37.190081 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m18:19:37.190513 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:19:37.198305 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m18:19:37.199587 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 18:19:37.190754 => 2023-07-01 18:19:37.199251
[0m18:19:37.200433 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:19:37.206516 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m18:19:37.207666 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:19:37.210166 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:19:37.895823 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0ce7768d-c0ba-429d-b2fd-f7ce6366ed8b&page=queryresults
[0m18:19:37.896729 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 18:19:35.696012 => 2023-07-01 18:19:37.896648
[0m18:19:37.906907 [error] [Thread-3 (]: 11 of 15 FAIL 83 unique_dim_address_address_sk ................................. [[31mFAIL 83[0m in 2.29s]
[0m18:19:37.907847 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7e0b1ac8-8cc6-485b-bb6f-f62da153ab5e&page=queryresults
[0m18:19:37.908514 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:19:37.909518 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (execute): 2023-07-01 18:19:35.603638 => 2023-07-01 18:19:37.909422
[0m18:19:37.910246 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:19:37.911378 [info ] [Thread-4 (]: 10 of 15 PASS relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.34s]
[0m18:19:37.912037 [info ] [Thread-3 (]: 14 of 15 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m18:19:37.912753 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:19:37.913629 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m18:19:37.914351 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:19:37.914978 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:19:37.915374 [info ] [Thread-4 (]: 15 of 15 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m18:19:37.927382 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m18:19:37.934268 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:19:37.935585 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:19:37.936770 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:dca63bf1-6cc9-4231-95e7-5ef5fe780676&page=queryresults
[0m18:19:37.948246 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:19:37.950061 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 18:19:35.971604 => 2023-07-01 18:19:37.949907
[0m18:19:37.950590 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 18:19:37.916080 => 2023-07-01 18:19:37.950441
[0m18:19:37.951816 [info ] [Thread-1 (]: 12 of 15 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 1.99s]
[0m18:19:37.952617 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:19:37.953439 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 18:19:37.937196 => 2023-07-01 18:19:37.953245
[0m18:19:37.954154 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:19:37.960814 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:19:37.961728 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:19:37.966121 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:19:37.967087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:19:37.970487 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:19:37.971023 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:19:38.009543 [debug] [Thread-4 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:19:38.994623 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:9]')
[0m18:19:39.375500 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9ca94200-6c35-45a7-90c0-47f24f1e953e&page=queryresults
[0m18:19:39.376407 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 18:19:37.201336 => 2023-07-01 18:19:39.376320
[0m18:19:39.377270 [info ] [Thread-2 (]: 13 of 15 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 2.19s]
[0m18:19:39.377907 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:19:39.682862 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ee26f476-e7e2-4d60-80b3-3b19767d3bca&page=queryresults
[0m18:19:39.683777 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 18:19:37.954513 => 2023-07-01 18:19:39.683637
[0m18:19:39.685792 [debug] [Thread-3 (]: Database Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:19:39.686573 [error] [Thread-3 (]: 14 of 15 ERROR unique_dim_workers_worker_sk .................................... [[31mERROR[0m in 1.77s]
[0m18:19:39.687450 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:19:40.606806 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e4d397ff-a4ea-4733-8456-e68eba0c81f5&page=queryresults
[0m18:19:40.607805 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 18:19:37.962685 => 2023-07-01 18:19:40.607718
[0m18:19:40.608740 [info ] [Thread-4 (]: 15 of 15 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.68s]
[0m18:19:40.609345 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:19:40.611482 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:19:40.612351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:40.612672 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m18:19:40.612963 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m18:19:40.613377 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed' was properly closed.
[0m18:19:40.613816 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m18:19:40.614389 [info ] [MainThread]: 
[0m18:19:40.615199 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 11.99 seconds (11.99s).
[0m18:19:40.616669 [debug] [MainThread]: Command end result
[0m18:19:40.665256 [info ] [MainThread]: 
[0m18:19:40.665813 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m18:19:40.666575 [info ] [MainThread]: 
[0m18:19:40.667120 [error] [MainThread]: [33mDatabase Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:19:40.667793 [error] [MainThread]:   Unrecognized name: worker_sk at [15:7]
[0m18:19:40.668313 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:19:40.668890 [info ] [MainThread]: 
[0m18:19:40.669515 [error] [MainThread]: [31mFailure in test relationships_fact_sales_product_fk__product_sk__ref_dim_products_ (models/gold/fact_sales.yml)[0m
[0m18:19:40.670165 [error] [MainThread]:   Got 9081 results, configured to fail if != 0
[0m18:19:40.670987 [info ] [MainThread]: 
[0m18:19:40.671774 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_f765900a1937b39c2370e1a1d08c08f5.sql
[0m18:19:40.672525 [info ] [MainThread]: 
[0m18:19:40.673433 [error] [MainThread]: [33mDatabase Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)[0m
[0m18:19:40.674384 [error] [MainThread]:   Unrecognized name: worker_sk at [18:12]
[0m18:19:40.675456 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:19:40.677039 [info ] [MainThread]: 
[0m18:19:40.679341 [error] [MainThread]: [31mFailure in test unique_dim_address_address_sk (models/gold/dim_address.yml)[0m
[0m18:19:40.681334 [error] [MainThread]:   Got 83 results, configured to fail if != 0
[0m18:19:40.682759 [info ] [MainThread]: 
[0m18:19:40.685258 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/dim_address.yml/unique_dim_address_address_sk.sql
[0m18:19:40.686063 [info ] [MainThread]: 
[0m18:19:40.686662 [error] [MainThread]: [33mDatabase Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:19:40.687164 [error] [MainThread]:   Unrecognized name: worker_sk at [15:9]
[0m18:19:40.687833 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:19:40.688453 [info ] [MainThread]: 
[0m18:19:40.689053 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=5 SKIP=0 TOTAL=15
[0m18:19:40.689898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de9d197b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de9d186d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de9d19900>]}
[0m18:19:40.690648 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:21:31.972880 | f56d566a-2db7-49b1-ae09-0096d58681a4 ==============================
[0m18:21:31.972880 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:21:31.974985 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:21:31.975737 [debug] [MainThread]: Tracking: tracking
[0m18:21:31.977491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0c9794b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0c978970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0c979300>]}
[0m18:21:32.020809 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:21:32.162675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:21:32.163808 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_products.sql
[0m18:21:32.186828 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m18:21:32.268091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f56d566a-2db7-49b1-ae09-0096d58681a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab07ba9120>]}
[0m18:21:32.292516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f56d566a-2db7-49b1-ae09-0096d58681a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0c666c20>]}
[0m18:21:32.293055 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:21:32.293558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f56d566a-2db7-49b1-ae09-0096d58681a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0c666bf0>]}
[0m18:21:32.297673 [info ] [MainThread]: 
[0m18:21:32.300126 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:21:32.301490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:21:32.301963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:24.935724 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
list dataset
[0m18:31:24.937450 [debug] [ThreadPool]: BigQuery adapter: Deadline of 600.0s exceeded while calling target function, last exception: HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Max retries exceeded with url: /token (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fab07b9c580>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution'))
[0m18:31:24.939985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:24.940723 [debug] [MainThread]: Connection 'list_desafiothaina' was properly closed.
[0m18:31:24.941294 [info ] [MainThread]: 
[0m18:31:24.941847 [info ] [MainThread]: Finished running  in 0 hours 9 minutes and 52.64 seconds (592.64s).
[0m18:31:24.942851 [debug] [MainThread]: Flushing usage events
[0m18:31:24.946170 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:31:24.946618 [info ] [MainThread]: ctrl-c


============================== 2023-07-01 18:44:08.013476 | 584926ae-dd87-4f4f-82f8-5a23ddf4b22e ==============================
[0m18:44:08.013476 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:44:08.017324 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:44:08.017938 [debug] [MainThread]: Tracking: tracking
[0m18:44:08.019609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129e625f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129e61030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129e625c0>]}
[0m18:44:08.073447 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:44:08.226903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:08.227342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:08.241593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '584926ae-dd87-4f4f-82f8-5a23ddf4b22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129a44340>]}
[0m18:44:08.269411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '584926ae-dd87-4f4f-82f8-5a23ddf4b22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129a0d9c0>]}
[0m18:44:08.269946 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:44:08.270463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584926ae-dd87-4f4f-82f8-5a23ddf4b22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129a0da20>]}
[0m18:44:08.274805 [info ] [MainThread]: 
[0m18:44:08.277322 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:44:08.278955 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:44:08.279456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:09.283156 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:44:09.283869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:09.284750 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:44:09.322119 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:44:09.324927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:09.326010 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:44:09.369167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:09.326656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:10.949586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584926ae-dd87-4f4f-82f8-5a23ddf4b22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129a0c1c0>]}
[0m18:44:10.950600 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:44:10.951186 [info ] [MainThread]: 
[0m18:44:10.954882 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_products
[0m18:44:10.955421 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m18:44:10.956483 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m18:44:10.956895 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_products
[0m18:44:10.961881 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m18:44:10.963121 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-07-01 18:44:10.957138 => 2023-07-01 18:44:10.962976
[0m18:44:10.963746 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_products
[0m18:44:11.014301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:11.971686 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m18:44:11.972813 [debug] [Thread-1 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
   
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
 
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1  
)

, select_not_null as (
    select *
    from prodcut_with_sk
    where product_sk is not null
)

select *
from select_not_null
    );
  
[0m18:44:15.112640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b09068e6-1fd5-42cb-ae00-92bb63ed1ec2&page=queryresults
[0m18:44:16.238828 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-07-01 18:44:10.964870 => 2023-07-01 18:44:16.238753
[0m18:44:16.239772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584926ae-dd87-4f4f-82f8-5a23ddf4b22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129d2bbe0>]}
[0m18:44:16.240516 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_products ................. [[32mCREATE TABLE (223.0 rows, 70.9 KB processed)[0m in 5.28s]
[0m18:44:16.243573 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_products
[0m18:44:16.245632 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:44:16.246546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:16.246883 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m18:44:16.247241 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m18:44:16.247630 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m18:44:16.247924 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_products' was properly closed.
[0m18:44:16.248320 [info ] [MainThread]: 
[0m18:44:16.248907 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m18:44:16.249725 [debug] [MainThread]: Command end result
[0m18:44:16.286495 [info ] [MainThread]: 
[0m18:44:16.288938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:16.289841 [info ] [MainThread]: 
[0m18:44:16.290587 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:44:16.291689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129d2a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129d2bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc129d2b610>]}
[0m18:44:16.292367 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:46:32.500109 | 3ecee1ca-5c08-42b2-ac00-a8386d1ae294 ==============================
[0m18:46:32.500109 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:46:32.502079 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:46:32.502641 [debug] [MainThread]: Tracking: tracking
[0m18:46:32.504834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f7c76410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f7c76530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f7c76c80>]}
[0m18:46:32.552862 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:46:32.700374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:46:32.701262 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_products.sql
[0m18:46:32.723588 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m18:46:32.804114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ecee1ca-5c08-42b2-ac00-a8386d1ae294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f7120d90>]}
[0m18:46:32.827694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ecee1ca-5c08-42b2-ac00-a8386d1ae294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f79667d0>]}
[0m18:46:32.828165 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:46:32.828595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ecee1ca-5c08-42b2-ac00-a8386d1ae294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f77ebe80>]}
[0m18:46:32.835434 [info ] [MainThread]: 
[0m18:46:32.839264 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:46:32.841030 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m18:46:32.841967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:33.775013 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:46:33.775932 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:46:33.777413 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:46:33.778050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:33.779102 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:46:33.779881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:33.780476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:33.825637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:35.386357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ecee1ca-5c08-42b2-ac00-a8386d1ae294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f79662c0>]}
[0m18:46:35.387475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:46:35.388078 [info ] [MainThread]: 
[0m18:46:35.394155 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_products
[0m18:46:35.394959 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m18:46:35.396388 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m18:46:35.397024 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_products
[0m18:46:35.404546 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m18:46:35.405493 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-07-01 18:46:35.397508 => 2023-07-01 18:46:35.405345
[0m18:46:35.406202 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_products
[0m18:46:35.468842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:36.396327 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m18:46:36.397427 [debug] [Thread-1 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    where product_id is not null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
 
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1  
)

-- , select_not_null as (
--     select *
--     from prodcut_with_sk
--     where product_sk is not null
-- )

select *
from prodcut_with_sk
    );
  
[0m18:46:39.499333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:83648cf4-0239-4bf4-bb41-348f9429fc34&page=queryresults
[0m18:46:40.523665 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-07-01 18:46:35.406650 => 2023-07-01 18:46:40.523586
[0m18:46:40.524537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ecee1ca-5c08-42b2-ac00-a8386d1ae294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f6fc2890>]}
[0m18:46:40.525096 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_products ................. [[32mCREATE TABLE (223.0 rows, 70.9 KB processed)[0m in 5.13s]
[0m18:46:40.527437 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_products
[0m18:46:40.529079 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:46:40.529883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:40.530157 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m18:46:40.530517 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_products' was properly closed.
[0m18:46:40.530856 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m18:46:40.531165 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m18:46:40.531606 [info ] [MainThread]: 
[0m18:46:40.532218 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.70 seconds (7.70s).
[0m18:46:40.532943 [debug] [MainThread]: Command end result
[0m18:46:40.578265 [info ] [MainThread]: 
[0m18:46:40.579307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:40.580246 [info ] [MainThread]: 
[0m18:46:40.581189 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:46:40.583097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f7a92890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f77ebd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f78215d0>]}
[0m18:46:40.584500 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 18:46:51.558927 | 475f4cfd-c846-411a-8a13-5f69268c8517 ==============================
[0m18:46:51.558927 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:46:51.560968 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:46:51.561572 [debug] [MainThread]: Tracking: tracking
[0m18:46:51.563417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a776ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a7748e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a776d10>]}
[0m18:46:51.609341 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:46:51.755543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:46:51.755887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:46:51.768616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '475f4cfd-c846-411a-8a13-5f69268c8517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a358100>]}
[0m18:46:51.793776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '475f4cfd-c846-411a-8a13-5f69268c8517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a31d780>]}
[0m18:46:51.794338 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m18:46:51.794922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '475f4cfd-c846-411a-8a13-5f69268c8517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a31d7e0>]}
[0m18:46:51.800487 [info ] [MainThread]: 
[0m18:46:51.803442 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:46:51.814235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m18:46:51.815893 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m18:46:51.816469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:51.819742 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m18:46:51.822008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:51.823341 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m18:46:51.865353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:51.901765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:53.341251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '475f4cfd-c846-411a-8a13-5f69268c8517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a7747f0>]}
[0m18:46:53.342118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:46:53.342695 [info ] [MainThread]: 
[0m18:46:53.348566 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:46:53.349363 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:46:53.349799 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:46:53.350296 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:46:53.350700 [info ] [Thread-1 (]: 1 of 15 START test not_null_dim_address_address_sk ............................. [RUN]
[0m18:46:53.355058 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m18:46:53.352518 [info ] [Thread-3 (]: 3 of 15 START test not_null_dim_products_product_sk ............................ [RUN]
[0m18:46:53.351643 [info ] [Thread-2 (]: 2 of 15 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m18:46:53.359746 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m18:46:53.353436 [info ] [Thread-4 (]: 4 of 15 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m18:46:53.356723 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:46:53.357797 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m18:46:53.361000 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:46:53.363395 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m18:46:53.386194 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:46:53.391523 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:46:53.395909 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:46:53.408475 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m18:46:53.420357 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:46:53.428548 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:46:53.429128 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 18:46:53.364435 => 2023-07-01 18:46:53.429033
[0m18:46:53.429731 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 18:46:53.397541 => 2023-07-01 18:46:53.429652
[0m18:46:53.430222 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:46:53.430591 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 18:46:53.391955 => 2023-07-01 18:46:53.430501
[0m18:46:53.431045 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:46:53.431449 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 18:46:53.420993 => 2023-07-01 18:46:53.431316
[0m18:46:53.452393 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:46:53.455278 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m18:46:53.458575 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m18:46:53.458998 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:46:53.462308 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m18:46:53.463056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:53.466253 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m18:46:53.466893 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:46:53.469039 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m18:46:53.469580 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:46:53.470882 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:46:53.504210 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m18:46:53.506111 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m18:46:53.507479 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m18:46:54.810402 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:7]')
[0m18:46:55.799343 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2f18ec20-1231-41b0-963e-a3a116f35bd2&page=queryresults
[0m18:46:55.800209 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 18:46:53.463289 => 2023-07-01 18:46:55.800066
[0m18:46:55.803304 [debug] [Thread-4 (]: Database Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:7]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:46:55.803902 [error] [Thread-4 (]: 4 of 15 ERROR not_null_dim_workers_worker_sk ................................... [[31mERROR[0m in 2.44s]
[0m18:46:55.806996 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m18:46:55.807671 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:46:55.808153 [info ] [Thread-4 (]: 5 of 15 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m18:46:55.809308 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m18:46:55.810062 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:46:55.820336 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:46:55.821287 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 18:46:55.810577 => 2023-07-01 18:46:55.821156
[0m18:46:55.821815 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:46:55.829252 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m18:46:55.829940 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:46:55.832903 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m18:46:56.055744 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e6848a07-c1de-4347-b9ff-ea76197c2efd&page=queryresults
[0m18:46:56.057634 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 18:46:53.455696 => 2023-07-01 18:46:56.057561
[0m18:46:56.058411 [info ] [Thread-3 (]: 3 of 15 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 2.70s]
[0m18:46:56.059045 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m18:46:56.059816 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:46:56.060506 [info ] [Thread-3 (]: 6 of 15 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:46:56.062129 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de'
[0m18:46:56.062737 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:46:56.085380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b7f6877b-1b06-4c1f-967b-42080e3a9af9&page=queryresults
[0m18:46:56.087449 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:da4e1306-32f0-4243-9cfb-db0b7b6dde11&page=queryresults
[0m18:46:56.097759 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:46:56.099860 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 18:46:53.431684 => 2023-07-01 18:46:56.099586
[0m18:46:56.101354 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 18:46:53.459277 => 2023-07-01 18:46:56.101263
[0m18:46:56.103276 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.75s]
[0m18:46:56.105563 [info ] [Thread-2 (]: 2 of 15 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.75s]
[0m18:46:56.109803 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m18:46:56.108106 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m18:46:56.110442 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (compile): 2023-07-01 18:46:56.063114 => 2023-07-01 18:46:56.110230
[0m18:46:56.112545 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:46:56.116002 [info ] [Thread-2 (]: 7 of 15 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m18:46:56.115215 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:46:56.113987 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:46:56.118643 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m18:46:56.125669 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m18:46:56.126603 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:46:56.126162 [info ] [Thread-1 (]: 8 of 15 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m18:46:56.141364 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:46:56.142373 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m18:46:56.143412 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:46:56.143982 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:46:56.144562 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 18:46:56.127464 => 2023-07-01 18:46:56.144474
[0m18:46:56.154308 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:56.162441 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m18:46:56.163343 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:46:56.203077 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 18:46:56.146643 => 2023-07-01 18:46:56.202905
[0m18:46:56.207224 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m18:46:56.209321 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:46:56.212760 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m18:46:56.213114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:46:56.215750 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:56.247825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:56.251799 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:58.285566 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bba433dd-fa28-48f0-aa0a-639e63bab3df&page=queryresults
[0m18:46:58.286500 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 18:46:55.822096 => 2023-07-01 18:46:58.286425
[0m18:46:58.287296 [info ] [Thread-4 (]: 5 of 15 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.48s]
[0m18:46:58.288086 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m18:46:58.289670 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:46:58.291115 [info ] [Thread-4 (]: 9 of 15 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m18:46:58.293880 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m18:46:58.294559 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:46:58.308317 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:46:58.309286 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 18:46:58.295003 => 2023-07-01 18:46:58.309151
[0m18:46:58.310373 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:46:58.318015 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m18:46:58.319277 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:46:58.323752 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:58.446790 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:95594bd5-5eac-438c-ab5b-a4c104cb83ff&page=queryresults
[0m18:46:58.447649 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (execute): 2023-07-01 18:46:56.119729 => 2023-07-01 18:46:58.447568
[0m18:46:58.448482 [info ] [Thread-3 (]: 6 of 15 PASS relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.39s]
[0m18:46:58.449138 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m18:46:58.449902 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:46:58.450529 [info ] [Thread-3 (]: 10 of 15 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m18:46:58.452372 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310'
[0m18:46:58.452986 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:46:58.466055 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:46:58.466905 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (compile): 2023-07-01 18:46:58.453395 => 2023-07-01 18:46:58.466775
[0m18:46:58.467530 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:46:58.487036 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m18:46:58.488385 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:46:58.491272 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:46:58.534712 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7cda8b1c-e6ac-4af9-aebf-3951c6441e1c&page=queryresults
[0m18:46:58.536237 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 18:46:56.203742 => 2023-07-01 18:46:58.536008
[0m18:46:58.537801 [info ] [Thread-2 (]: 7 of 15 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.42s]
[0m18:46:58.538503 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m18:46:58.539298 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:46:58.539803 [info ] [Thread-2 (]: 11 of 15 START test unique_dim_address_address_sk .............................. [RUN]
[0m18:46:58.541727 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m18:46:58.542632 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:46:58.558304 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:46:58.559164 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 18:46:58.543031 => 2023-07-01 18:46:58.559024
[0m18:46:58.559991 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:46:58.567548 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m18:46:58.568710 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:46:58.571515 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:46:58.720450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:459412a1-5a97-453f-aacd-c2c1dcc5bffc&page=queryresults
[0m18:46:58.721186 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 18:46:56.209961 => 2023-07-01 18:46:58.721110
[0m18:46:58.722000 [error] [Thread-1 (]: 8 of 15 FAIL 9081 relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[31mFAIL 9081[0m in 2.58s]
[0m18:46:58.722556 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m18:46:58.723275 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:46:58.723780 [info ] [Thread-1 (]: 12 of 15 START test unique_dim_dates_metric_date ............................... [RUN]
[0m18:46:58.724616 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m18:46:58.725123 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:46:58.731412 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:46:58.731978 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 18:46:58.725517 => 2023-07-01 18:46:58.731893
[0m18:46:58.732296 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:46:58.735567 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m18:46:58.736204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:58.738353 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:46:59.409920 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [18:12]')
[0m18:47:00.204817 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:02f8a657-a74e-45e6-92ca-a766e255aa77&page=queryresults
[0m18:47:00.205711 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 18:46:58.311118 => 2023-07-01 18:47:00.205562
[0m18:47:00.206974 [debug] [Thread-4 (]: Database Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)
  Unrecognized name: worker_sk at [18:12]
  compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:47:00.207528 [error] [Thread-4 (]: 9 of 15 ERROR relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[31mERROR[0m in 1.91s]
[0m18:47:00.208249 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m18:47:00.208768 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:47:00.209239 [info ] [Thread-4 (]: 13 of 15 START test unique_dim_products_product_sk ............................. [RUN]
[0m18:47:00.210368 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m18:47:00.210921 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:47:00.219855 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m18:47:00.221255 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 18:47:00.211247 => 2023-07-01 18:47:00.221063
[0m18:47:00.221970 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:47:00.227253 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m18:47:00.228194 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:47:00.234966 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:47:00.665792 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c4a50316-0649-4c86-b42d-908a605758c2&page=queryresults
[0m18:47:00.666573 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 18:46:58.560750 => 2023-07-01 18:47:00.666493
[0m18:47:00.667436 [error] [Thread-2 (]: 11 of 15 FAIL 83 unique_dim_address_address_sk ................................. [[31mFAIL 83[0m in 2.13s]
[0m18:47:00.668128 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m18:47:00.668746 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:47:00.669427 [info ] [Thread-2 (]: 14 of 15 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m18:47:00.670796 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m18:47:00.671432 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:47:00.683292 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:47:00.684446 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5675a8ff-8263-4201-b26e-e183973e11a5&page=queryresults
[0m18:47:00.686042 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (execute): 2023-07-01 18:46:58.467938 => 2023-07-01 18:47:00.685924
[0m18:47:00.688936 [info ] [Thread-3 (]: 10 of 15 PASS relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.24s]
[0m18:47:00.690456 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m18:47:00.691842 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 18:47:00.671821 => 2023-07-01 18:47:00.691446
[0m18:47:00.694320 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:47:00.695906 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:47:00.696674 [info ] [Thread-3 (]: 15 of 15 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m18:47:00.707197 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m18:47:00.709748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:47:00.708456 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m18:47:00.713490 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:47:00.712257 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:47:00.728554 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:47:00.768924 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 18:47:00.714287 => 2023-07-01 18:47:00.768746
[0m18:47:00.769427 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:47:00.773725 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m18:47:00.774575 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:47:00.776870 [debug] [Thread-3 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:47:00.811729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:afc1d562-60b2-4cb2-bc53-fb62aba512d2&page=queryresults
[0m18:47:00.812959 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 18:46:58.732498 => 2023-07-01 18:47:00.812850
[0m18:47:00.814142 [info ] [Thread-1 (]: 12 of 15 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.09s]
[0m18:47:00.814952 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m18:47:01.853800 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: worker_sk at [15:9]')
[0m18:47:02.402441 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d20d8b60-2c88-4915-ae15-9b14dd9dd430&page=queryresults
[0m18:47:02.403450 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 18:47:00.222424 => 2023-07-01 18:47:02.403343
[0m18:47:02.404540 [info ] [Thread-4 (]: 13 of 15 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 2.19s]
[0m18:47:02.405278 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m18:47:02.783558 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:84957861-3a63-40c4-8614-22a05e1265d1&page=queryresults
[0m18:47:02.784598 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 18:47:00.698340 => 2023-07-01 18:47:02.784408
[0m18:47:02.787684 [debug] [Thread-2 (]: Database Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)
  Unrecognized name: worker_sk at [15:9]
  compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:47:02.788941 [error] [Thread-2 (]: 14 of 15 ERROR unique_dim_workers_worker_sk .................................... [[31mERROR[0m in 2.12s]
[0m18:47:02.790440 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m18:47:03.359755 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:43fee6c1-9b36-4c8e-b904-157d92cbf3dd&page=queryresults
[0m18:47:03.360862 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 18:47:00.769836 => 2023-07-01 18:47:03.360750
[0m18:47:03.361726 [info ] [Thread-3 (]: 15 of 15 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.65s]
[0m18:47:03.362260 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m18:47:03.364132 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:47:03.364981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:03.365287 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m18:47:03.365552 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m18:47:03.365797 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m18:47:03.366035 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed' was properly closed.
[0m18:47:03.366345 [info ] [MainThread]: 
[0m18:47:03.366774 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 11.57 seconds (11.57s).
[0m18:47:03.368175 [debug] [MainThread]: Command end result
[0m18:47:03.401344 [info ] [MainThread]: 
[0m18:47:03.402361 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m18:47:03.403641 [info ] [MainThread]: 
[0m18:47:03.404547 [error] [MainThread]: [33mDatabase Error in test not_null_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:47:03.405296 [error] [MainThread]:   Unrecognized name: worker_sk at [15:7]
[0m18:47:03.406033 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/not_null_dim_workers_worker_sk.sql
[0m18:47:03.407017 [info ] [MainThread]: 
[0m18:47:03.408598 [error] [MainThread]: [31mFailure in test relationships_fact_sales_product_fk__product_sk__ref_dim_products_ (models/gold/fact_sales.yml)[0m
[0m18:47:03.410081 [error] [MainThread]:   Got 9081 results, configured to fail if != 0
[0m18:47:03.411179 [info ] [MainThread]: 
[0m18:47:03.412399 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_f765900a1937b39c2370e1a1d08c08f5.sql
[0m18:47:03.413742 [info ] [MainThread]: 
[0m18:47:03.415266 [error] [MainThread]: [33mDatabase Error in test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_ (models/gold/fact_sales.yml)[0m
[0m18:47:03.416456 [error] [MainThread]:   Unrecognized name: worker_sk at [18:12]
[0m18:47:03.417226 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_b8677dd6192deba9b7be01f48d8115fe.sql
[0m18:47:03.417934 [info ] [MainThread]: 
[0m18:47:03.418661 [error] [MainThread]: [31mFailure in test unique_dim_address_address_sk (models/gold/dim_address.yml)[0m
[0m18:47:03.419374 [error] [MainThread]:   Got 83 results, configured to fail if != 0
[0m18:47:03.420287 [info ] [MainThread]: 
[0m18:47:03.421245 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/dim_address.yml/unique_dim_address_address_sk.sql
[0m18:47:03.422130 [info ] [MainThread]: 
[0m18:47:03.423043 [error] [MainThread]: [33mDatabase Error in test unique_dim_workers_worker_sk (models/gold/dim_workers.yml)[0m
[0m18:47:03.424022 [error] [MainThread]:   Unrecognized name: worker_sk at [15:9]
[0m18:47:03.424893 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/gold/dim_workers.yml/unique_dim_workers_worker_sk.sql
[0m18:47:03.425531 [info ] [MainThread]: 
[0m18:47:03.426194 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=5 SKIP=0 TOTAL=15
[0m18:47:03.426991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a269030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a1fbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9a1fbb20>]}
[0m18:47:03.427410 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:01:02.230917 | 700b8487-35ab-40ec-af4c-b21e929fb5f4 ==============================
[0m19:01:02.230917 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:01:02.233096 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_workers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:01:02.233532 [debug] [MainThread]: Tracking: tracking
[0m19:01:02.236328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98d36e680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98d36ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98d36e620>]}
[0m19:01:02.292114 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:01:02.439610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:01:02.440572 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.yml
[0m19:01:02.463519 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m19:01:02.521055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '700b8487-35ab-40ec-af4c-b21e929fb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98c81c0d0>]}
[0m19:01:02.544857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '700b8487-35ab-40ec-af4c-b21e929fb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98cf11540>]}
[0m19:01:02.545344 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:01:02.545771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '700b8487-35ab-40ec-af4c-b21e929fb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98cee3940>]}
[0m19:01:02.549359 [info ] [MainThread]: 
[0m19:01:02.551814 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:01:02.553242 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:01:02.553779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:03.476776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:01:03.477443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:03.478876 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:01:03.480512 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:01:03.516803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:03.519633 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:01:03.520391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:03.556375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:04.691869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '700b8487-35ab-40ec-af4c-b21e929fb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98cf10040>]}
[0m19:01:04.692817 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:01:04.693608 [info ] [MainThread]: 
[0m19:01:04.698989 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_workers
[0m19:01:04.699539 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_workers ....................... [RUN]
[0m19:01:04.700646 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m19:01:04.701153 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_workers
[0m19:01:04.706500 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m19:01:04.707244 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 19:01:04.701456 => 2023-07-01 19:01:04.707116
[0m19:01:04.707908 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_workers
[0m19:01:04.733876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:05.747882 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m19:01:05.749006 [debug] [Thread-1 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workers of Adventure Works"""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, worker_with_sk  as (
    select
        MD5(cast(fixed_person_id as string)) as worker_sk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m19:01:08.993874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a0a1ea72-3e9d-4a5c-9ef4-18c5d1d4b7f8&page=queryresults
[0m19:01:09.813268 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 19:01:04.708672 => 2023-07-01 19:01:09.813195
[0m19:01:09.814172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700b8487-35ab-40ec-af4c-b21e929fb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98c691660>]}
[0m19:01:09.814697 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_workers .................. [[32mCREATE TABLE (496.0 rows, 38.2 MB processed)[0m in 5.11s]
[0m19:01:09.817164 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_workers
[0m19:01:09.818924 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:01:09.819611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:09.819863 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m19:01:09.820090 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m19:01:09.820311 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m19:01:09.820569 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m19:01:09.820908 [info ] [MainThread]: 
[0m19:01:09.821418 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.27 seconds (7.27s).
[0m19:01:09.822271 [debug] [MainThread]: Command end result
[0m19:01:09.857056 [info ] [MainThread]: 
[0m19:01:09.859034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:09.861029 [info ] [MainThread]: 
[0m19:01:09.863288 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:01:09.865245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9905370a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98c693e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98c691420>]}
[0m19:01:09.866743 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:02:13.217162 | 01b56f2f-61d5-4a2a-82b9-bc89d651f16a ==============================
[0m19:02:13.217162 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:02:13.221560 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:02:13.222321 [debug] [MainThread]: Tracking: tracking
[0m19:02:13.225748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bd7586470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bd7586860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bd7586410>]}
[0m19:02:13.291697 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:02:13.488718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:13.489155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:13.503679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01b56f2f-61d5-4a2a-82b9-bc89d651f16a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bd73640d0>]}
[0m19:02:13.533119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01b56f2f-61d5-4a2a-82b9-bc89d651f16a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bd7329480>]}
[0m19:02:13.533723 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:02:13.534276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01b56f2f-61d5-4a2a-82b9-bc89d651f16a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bd73294e0>]}
[0m19:02:13.544934 [info ] [MainThread]: 
[0m19:02:13.549643 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:02:13.563150 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:02:13.564157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:13.566769 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:02:13.568446 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:02:13.570030 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:02:13.570441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:13.616841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:13.619174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:15.057032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01b56f2f-61d5-4a2a-82b9-bc89d651f16a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bd7329090>]}
[0m19:02:15.058221 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:02:15.058950 [info ] [MainThread]: 
[0m19:02:15.063946 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:02:15.064569 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:02:15.065706 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:02:15.066578 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:02:15.066149 [info ] [Thread-1 (]: 1 of 13 START test not_null_dim_address_address_sk ............................. [RUN]
[0m19:02:15.067388 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m19:02:15.068305 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_products_product_sk ............................ [RUN]
[0m19:02:15.069074 [info ] [Thread-4 (]: 4 of 13 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m19:02:15.070275 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m19:02:15.071069 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m19:02:15.071870 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m19:02:15.072662 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m19:02:15.073091 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:02:15.073516 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:02:15.073878 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:02:15.074217 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:02:15.101391 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m19:02:15.118051 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m19:02:15.139315 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m19:02:15.147018 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m19:02:15.147853 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 19:02:15.105589 => 2023-07-01 19:02:15.147738
[0m19:02:15.148268 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 19:02:15.074470 => 2023-07-01 19:02:15.148199
[0m19:02:15.148790 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 19:02:15.122822 => 2023-07-01 19:02:15.148732
[0m19:02:15.149094 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:02:15.149369 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 19:02:15.095460 => 2023-07-01 19:02:15.149287
[0m19:02:15.149759 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:02:15.150087 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:02:15.160770 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:02:15.173050 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m19:02:15.176535 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m19:02:15.179255 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m19:02:15.182404 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m19:02:15.183195 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:02:15.183680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:15.184071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:02:15.184640 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:15.186598 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m19:02:15.188105 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m19:02:15.189868 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m19:02:15.191217 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m19:02:15.643900 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m19:02:17.346136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:17.346669 [debug] [MainThread]: Connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e' was left open.
[0m19:02:17.347138 [debug] [MainThread]: Connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40' was left open.
[0m19:02:17.347506 [debug] [MainThread]: Connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9' was left open.
[0m19:02:17.347733 [debug] [MainThread]: Connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe' was left open.
[0m19:02:17.348000 [info ] [MainThread]: 
[0m19:02:17.348393 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m19:02:17.348994 [debug] [MainThread]: Flushing usage events
[0m19:02:17.605708 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 19:02:15.150338 => 2023-07-01 19:02:17.605612
[0m19:02:17.608010 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 19:02:15.179629 => 2023-07-01 19:02:17.607926
[0m19:02:17.610614 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 19:02:15.176826 => 2023-07-01 19:02:17.610533
[0m19:02:17.616660 [debug] [Thread-4 (]: Runtime Error in test not_null_fact_sales_sale_identifier_sk (models/gold/fact_sales.yml)
  connection never acquired for thread {self.thread_id}, have {self.known}
[0m19:02:17.617181 [debug] [Thread-2 (]: Runtime Error in test not_null_dim_dates_metric_date (models/gold/dim_dates.yml)
  connection never acquired for thread {self.thread_id}, have {self.known}
[0m19:02:17.617550 [debug] [Thread-3 (]: Runtime Error in test not_null_dim_products_product_sk (models/gold/dim_products.yml)
  connection never acquired for thread {self.thread_id}, have {self.known}
[0m19:02:17.618079 [error] [Thread-4 (]: 4 of 13 ERROR not_null_fact_sales_sale_identifier_sk ........................... [[31mERROR[0m in 2.55s]
[0m19:02:17.619020 [error] [Thread-2 (]: 2 of 13 ERROR not_null_dim_dates_metric_date ................................... [[31mERROR[0m in 2.55s]
[0m19:02:17.622602 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:02:17.620172 [error] [Thread-3 (]: 3 of 13 ERROR not_null_dim_products_product_sk ................................. [[31mERROR[0m in 2.55s]
[0m19:02:17.623334 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:02:17.623979 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:02:17.912037 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 19:02:15.173421 => 2023-07-01 19:02:17.911945
[0m19:02:17.913046 [debug] [Thread-1 (]: Runtime Error in test not_null_dim_address_address_sk (models/gold/dim_address.yml)
  connection never acquired for thread {self.thread_id}, have {self.known}
[0m19:02:17.913516 [error] [Thread-1 (]: 1 of 13 ERROR not_null_dim_address_address_sk .................................. [[31mERROR[0m in 2.84s]
[0m19:02:17.914189 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:02:18.322065 [info ] [MainThread]: ctrl-c


============================== 2023-07-01 19:02:26.918753 | 6290459a-e6c2-4a78-8b76-d682b648e713 ==============================
[0m19:02:26.918753 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:02:26.921319 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:02:26.921822 [debug] [MainThread]: Tracking: tracking
[0m19:02:26.923618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bde8e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bde8dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bde8e380>]}
[0m19:02:26.970353 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:02:27.153783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:02:27.155658 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.yml
[0m19:02:27.184513 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m19:02:27.265171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6290459a-e6c2-4a78-8b76-d682b648e713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bd32c130>]}
[0m19:02:27.289397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6290459a-e6c2-4a78-8b76-d682b648e713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bdc2d420>]}
[0m19:02:27.289867 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:02:27.290298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6290459a-e6c2-4a78-8b76-d682b648e713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bdbff820>]}
[0m19:02:27.295680 [info ] [MainThread]: 
[0m19:02:27.298042 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:02:27.308514 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:02:27.310280 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:02:27.311182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:27.312294 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:02:27.315253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:27.314210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:27.313611 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:02:27.432266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:28.701389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6290459a-e6c2-4a78-8b76-d682b648e713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bdc59db0>]}
[0m19:02:28.702800 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:02:28.703617 [info ] [MainThread]: 
[0m19:02:28.709079 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:02:28.709944 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:02:28.710720 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:02:28.711278 [info ] [Thread-1 (]: 1 of 15 START test not_null_dim_address_address_sk ............................. [RUN]
[0m19:02:28.712568 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:02:28.715743 [info ] [Thread-4 (]: 4 of 15 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m19:02:28.714782 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m19:02:28.718299 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:02:28.712977 [info ] [Thread-2 (]: 2 of 15 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m19:02:28.717585 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m19:02:28.713406 [info ] [Thread-3 (]: 3 of 15 START test not_null_dim_products_product_sk ............................ [RUN]
[0m19:02:28.729847 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m19:02:28.738622 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:02:28.754114 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m19:02:28.768922 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:02:28.758946 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:02:28.758040 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m19:02:28.792951 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m19:02:28.804593 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m19:02:28.809710 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m19:02:28.811443 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 19:02:28.718782 => 2023-07-01 19:02:28.811264
[0m19:02:28.811905 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 19:02:28.782769 => 2023-07-01 19:02:28.811798
[0m19:02:28.812635 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:02:28.813606 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 19:02:28.770010 => 2023-07-01 19:02:28.813352
[0m19:02:28.814186 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 19:02:28.759641 => 2023-07-01 19:02:28.814085
[0m19:02:28.814579 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:02:28.841007 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:02:28.844329 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m19:02:28.844778 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:02:28.848502 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m19:02:28.851679 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m19:02:28.855284 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m19:02:28.856145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:28.856861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:28.857534 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:02:28.859741 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m19:02:28.860035 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:02:28.861802 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m19:02:28.863712 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m19:02:28.898831 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m19:02:31.428558 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5d037686-5b51-4aad-9799-f692ca2e101d&page=queryresults
[0m19:02:31.430472 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 19:02:28.848957 => 2023-07-01 19:02:31.430390
[0m19:02:31.433626 [info ] [Thread-3 (]: 3 of 15 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 2.68s]
[0m19:02:31.438009 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:02:31.438850 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:02:31.439545 [info ] [Thread-3 (]: 5 of 15 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m19:02:31.441230 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m19:02:31.441910 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:02:31.461657 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m19:02:31.462591 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 19:02:31.442393 => 2023-07-01 19:02:31.462438
[0m19:02:31.463141 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:02:31.469386 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m19:02:31.470952 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:02:31.473379 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m19:02:31.514250 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:23232621-3a85-4975-89a2-708fd0f2b31e&page=queryresults
[0m19:02:31.514843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:216dfbee-47cb-46d3-99d5-5957069bac7c&page=queryresults
[0m19:02:31.516237 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 19:02:28.852160 => 2023-07-01 19:02:31.516055
[0m19:02:31.518550 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 19:02:28.814949 => 2023-07-01 19:02:31.518424
[0m19:02:31.520564 [info ] [Thread-4 (]: 4 of 15 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 2.80s]
[0m19:02:31.521808 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.81s]
[0m19:02:31.522540 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:02:31.523034 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:02:31.523505 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m19:02:31.523993 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:02:31.524349 [info ] [Thread-4 (]: 6 of 15 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m19:02:31.524841 [info ] [Thread-1 (]: 7 of 15 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m19:02:31.526269 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de'
[0m19:02:31.527447 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m19:02:31.527930 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m19:02:31.528406 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:02:31.564350 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m19:02:31.565718 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m19:02:31.567446 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (compile): 2023-07-01 19:02:31.528650 => 2023-07-01 19:02:31.567269
[0m19:02:31.568064 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m19:02:31.569276 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 19:02:31.534304 => 2023-07-01 19:02:31.568980
[0m19:02:31.577975 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:02:31.579008 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m19:02:31.583242 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m19:02:31.584743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:31.584078 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:02:31.587404 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:02:31.590567 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:02:31.708831 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c0038b34-9437-41d9-8a5d-237c386fa504&page=queryresults
[0m19:02:31.709623 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 19:02:28.845064 => 2023-07-01 19:02:31.709542
[0m19:02:31.710451 [info ] [Thread-2 (]: 2 of 15 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.98s]
[0m19:02:31.711078 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:02:31.711805 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:02:31.712300 [info ] [Thread-2 (]: 8 of 15 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m19:02:31.713387 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m19:02:31.713858 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:02:31.723788 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m19:02:31.724862 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 19:02:31.714103 => 2023-07-01 19:02:31.724715
[0m19:02:31.725675 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:02:31.731346 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m19:02:31.733498 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:31.735598 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:02:33.994789 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7a291b08-a2ca-4d54-af54-03adec0f7e40&page=queryresults
[0m19:02:33.995473 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6bdecfc6-0d5b-4c4d-99cb-28bd5338a881&page=queryresults
[0m19:02:33.996056 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:34c949e4-fee9-4045-acd2-04a158cd1a8e&page=queryresults
[0m19:02:33.996450 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6727e948-3956-4651-8a72-2c420f3dfacb&page=queryresults
[0m19:02:33.997420 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (execute): 2023-07-01 19:02:31.571105 => 2023-07-01 19:02:33.997326
[0m19:02:33.998264 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 19:02:31.579980 => 2023-07-01 19:02:33.998153
[0m19:02:33.999163 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 19:02:31.463462 => 2023-07-01 19:02:33.999051
[0m19:02:33.999910 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 19:02:31.726441 => 2023-07-01 19:02:33.999842
[0m19:02:34.001119 [info ] [Thread-4 (]: 6 of 15 PASS relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.48s]
[0m19:02:34.002477 [info ] [Thread-1 (]: 7 of 15 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.48s]
[0m19:02:34.003947 [info ] [Thread-3 (]: 5 of 15 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.56s]
[0m19:02:34.005460 [error] [Thread-2 (]: 8 of 15 FAIL 9081 relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[31mFAIL 9081[0m in 2.29s]
[0m19:02:34.006265 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m19:02:34.006862 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:02:34.007586 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:02:34.008228 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:02:34.009046 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:02:34.009927 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m19:02:34.010621 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m19:02:34.011437 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:02:34.011905 [info ] [Thread-4 (]: 9 of 15 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m19:02:34.012299 [info ] [Thread-1 (]: 10 of 15 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m19:02:34.013402 [info ] [Thread-3 (]: 11 of 15 START test unique_dim_address_address_sk .............................. [RUN]
[0m19:02:34.015984 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m19:02:34.014388 [info ] [Thread-2 (]: 12 of 15 START test unique_dim_dates_metric_date ............................... [RUN]
[0m19:02:34.017649 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310'
[0m19:02:34.021647 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m19:02:34.020743 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m19:02:34.018690 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m19:02:34.019335 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:02:34.029563 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:02:34.036470 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m19:02:34.037468 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m19:02:34.059849 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (compile): 2023-07-01 19:02:34.022202 => 2023-07-01 19:02:34.059692
[0m19:02:34.073500 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m19:02:34.074293 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m19:02:34.088764 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m19:02:34.089665 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m19:02:34.090514 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 19:02:34.038376 => 2023-07-01 19:02:34.090389
[0m19:02:34.091251 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 19:02:34.043768 => 2023-07-01 19:02:34.091151
[0m19:02:34.095570 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m19:02:34.096089 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 19:02:34.074658 => 2023-07-01 19:02:34.095978
[0m19:02:34.096430 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:02:34.096943 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:02:34.097599 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m19:02:34.097983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:34.109054 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m19:02:34.110516 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m19:02:34.114202 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m19:02:34.116255 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:02:34.117137 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:34.154423 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:02:34.154933 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:02:34.157231 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:02:34.159009 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:02:34.196205 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:02:36.447489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3f0212a1-740f-428f-8367-84494d44ccb3&page=queryresults
[0m19:02:36.452769 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (execute): 2023-07-01 19:02:34.091605 => 2023-07-01 19:02:36.452640
[0m19:02:36.457945 [info ] [Thread-1 (]: 10 of 15 PASS relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.44s]
[0m19:02:36.458799 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m19:02:36.459395 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:02:36.459970 [info ] [Thread-1 (]: 13 of 15 START test unique_dim_products_product_sk ............................. [RUN]
[0m19:02:36.461282 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m19:02:36.461732 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:02:36.468410 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m19:02:36.469721 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 19:02:36.462003 => 2023-07-01 19:02:36.469390
[0m19:02:36.470660 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:02:36.477410 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m19:02:36.478426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:36.481175 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:02:36.719019 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b706c319-23b7-4eb6-b51b-33cd089cbdbd&page=queryresults
[0m19:02:36.719975 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 19:02:34.110883 => 2023-07-01 19:02:36.719892
[0m19:02:36.720906 [error] [Thread-3 (]: 11 of 15 FAIL 83 unique_dim_address_address_sk ................................. [[31mFAIL 83[0m in 2.70s]
[0m19:02:36.721596 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m19:02:36.722393 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:02:36.723174 [info ] [Thread-3 (]: 14 of 15 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m19:02:36.724877 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m19:02:36.725577 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:02:36.749003 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m19:02:36.750466 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 19:02:36.726024 => 2023-07-01 19:02:36.750350
[0m19:02:36.750921 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:02:36.757012 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m19:02:36.758880 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:02:36.763723 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:02:36.803982 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2811bcc5-5dc0-4ca4-be0f-1b637317d931&page=queryresults
[0m19:02:36.805158 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 19:02:34.105343 => 2023-07-01 19:02:36.805031
[0m19:02:36.806204 [info ] [Thread-2 (]: 12 of 15 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.79s]
[0m19:02:36.806876 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:02:36.807472 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:02:36.807983 [info ] [Thread-2 (]: 15 of 15 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m19:02:36.809113 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m19:02:36.809552 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:02:36.816388 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m19:02:36.817550 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 19:02:36.809812 => 2023-07-01 19:02:36.817410
[0m19:02:36.818663 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:02:36.825470 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m19:02:36.826608 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:36.829927 [debug] [Thread-2 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:02:37.530632 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:01c9322a-e6ca-4964-b30d-2351e09d1c17&page=queryresults
[0m19:02:37.531810 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 19:02:34.098191 => 2023-07-01 19:02:37.531711
[0m19:02:37.532809 [info ] [Thread-4 (]: 9 of 15 PASS relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[32mPASS[0m in 3.52s]
[0m19:02:37.533480 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:02:38.904413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:afb795c9-333c-4af0-b87f-c37414b83c36&page=queryresults
[0m19:02:38.908173 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 19:02:36.471124 => 2023-07-01 19:02:38.908086
[0m19:02:38.914212 [info ] [Thread-1 (]: 13 of 15 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 2.45s]
[0m19:02:38.915379 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:02:39.315740 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:79e29fee-cef8-442b-8724-2db984d239bc&page=queryresults
[0m19:02:39.316236 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3b1c530c-30ef-4c0b-9b79-77f50cb9876c&page=queryresults
[0m19:02:39.317014 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 19:02:36.819099 => 2023-07-01 19:02:39.316932
[0m19:02:39.317941 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 19:02:36.751221 => 2023-07-01 19:02:39.317845
[0m19:02:39.319040 [info ] [Thread-2 (]: 15 of 15 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.51s]
[0m19:02:39.321091 [info ] [Thread-3 (]: 14 of 15 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 2.60s]
[0m19:02:39.322626 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:02:39.323278 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:02:39.325353 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:02:39.326100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:39.326377 [debug] [MainThread]: Connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269' was properly closed.
[0m19:02:39.326637 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m19:02:39.326878 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m19:02:39.327108 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m19:02:39.327425 [info ] [MainThread]: 
[0m19:02:39.327914 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 12.03 seconds (12.03s).
[0m19:02:39.329953 [debug] [MainThread]: Command end result
[0m19:02:39.484703 [info ] [MainThread]: 
[0m19:02:39.485250 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:02:39.485825 [info ] [MainThread]: 
[0m19:02:39.486606 [error] [MainThread]: [31mFailure in test relationships_fact_sales_product_fk__product_sk__ref_dim_products_ (models/gold/fact_sales.yml)[0m
[0m19:02:39.487209 [error] [MainThread]:   Got 9081 results, configured to fail if != 0
[0m19:02:39.487984 [info ] [MainThread]: 
[0m19:02:39.488674 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_f765900a1937b39c2370e1a1d08c08f5.sql
[0m19:02:39.489270 [info ] [MainThread]: 
[0m19:02:39.489886 [error] [MainThread]: [31mFailure in test unique_dim_address_address_sk (models/gold/dim_address.yml)[0m
[0m19:02:39.490563 [error] [MainThread]:   Got 83 results, configured to fail if != 0
[0m19:02:39.491140 [info ] [MainThread]: 
[0m19:02:39.491807 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/dim_address.yml/unique_dim_address_address_sk.sql
[0m19:02:39.492518 [info ] [MainThread]: 
[0m19:02:39.493112 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=2 SKIP=0 TOTAL=15
[0m19:02:39.493938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8be017820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bdc56bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bdc54490>]}
[0m19:02:39.494375 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:02:55.001327 | 8558b7d3-d4ab-492f-b202-7ae6854678a5 ==============================
[0m19:02:55.001327 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:02:55.003459 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_products'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:02:55.014751 [debug] [MainThread]: Tracking: tracking
[0m19:02:55.016499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d638e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d638d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d638e350>]}
[0m19:02:55.069269 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:02:55.205860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:55.206234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:55.218843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8558b7d3-d4ab-492f-b202-7ae6854678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d61680d0>]}
[0m19:02:55.242904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8558b7d3-d4ab-492f-b202-7ae6854678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d612d630>]}
[0m19:02:55.243451 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:02:55.243954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8558b7d3-d4ab-492f-b202-7ae6854678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d612d690>]}
[0m19:02:55.250862 [info ] [MainThread]: 
[0m19:02:55.254651 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:02:55.256507 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:02:55.257068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:56.318900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:02:56.320169 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:02:56.320575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:56.321628 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:02:56.322003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:56.322960 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:02:56.323646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:56.359405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:57.723254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8558b7d3-d4ab-492f-b202-7ae6854678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d612c1f0>]}
[0m19:02:57.724194 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:02:57.724782 [info ] [MainThread]: 
[0m19:02:57.730257 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_products
[0m19:02:57.731072 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m19:02:57.732689 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m19:02:57.733345 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_products
[0m19:02:57.741231 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m19:02:57.742322 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-07-01 19:02:57.733823 => 2023-07-01 19:02:57.742152
[0m19:02:57.743197 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_products
[0m19:02:57.797544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:58.794880 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m19:02:58.796011 [debug] [Thread-1 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    where product_id is not null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
 
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1  
)

-- , select_not_null as (
--     select *
--     from prodcut_with_sk
--     where product_sk is not null
-- )

select *
from prodcut_with_sk
    );
  
[0m19:03:01.840720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f079979b-346c-410c-a8ea-c0abbfccdcfa&page=queryresults
[0m19:03:02.865463 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-07-01 19:02:57.743745 => 2023-07-01 19:03:02.865379
[0m19:03:02.866537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8558b7d3-d4ab-492f-b202-7ae6854678a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d612c130>]}
[0m19:03:02.867102 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_products ................. [[32mCREATE TABLE (223.0 rows, 70.9 KB processed)[0m in 5.13s]
[0m19:03:02.871943 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_products
[0m19:03:02.874621 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:02.875796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:02.876282 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m19:03:02.876723 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m19:03:02.877164 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m19:03:02.877625 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_products' was properly closed.
[0m19:03:02.878207 [info ] [MainThread]: 
[0m19:03:02.879009 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m19:03:02.880102 [debug] [MainThread]: Command end result
[0m19:03:02.935091 [info ] [MainThread]: 
[0m19:03:02.935772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:02.936494 [info ] [MainThread]: 
[0m19:03:02.937456 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:03:02.938867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d612d3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d612d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d612d0c0>]}
[0m19:03:02.939620 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:03:10.566252 | 07009f2c-5535-4820-a151-d918bd19732c ==============================
[0m19:03:10.566252 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:03:10.569510 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:03:10.569963 [debug] [MainThread]: Tracking: tracking
[0m19:03:10.572038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b52d76c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b52d76260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b52d76770>]}
[0m19:03:10.628354 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:03:10.763743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:10.764090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:10.776989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07009f2c-5535-4820-a151-d918bd19732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b52958280>]}
[0m19:03:10.801291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07009f2c-5535-4820-a151-d918bd19732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5291d900>]}
[0m19:03:10.801808 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:03:10.802310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07009f2c-5535-4820-a151-d918bd19732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5291dab0>]}
[0m19:03:10.806078 [info ] [MainThread]: 
[0m19:03:10.808541 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:10.810003 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:03:10.810533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:11.678536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:03:11.678935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:11.679928 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:03:11.680606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:11.681425 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:03:11.716782 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:03:11.749845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:11.751621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:12.809933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07009f2c-5535-4820-a151-d918bd19732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5291c340>]}
[0m19:03:12.810804 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:03:12.811241 [info ] [MainThread]: 
[0m19:03:12.814958 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m19:03:12.815440 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m19:03:12.816435 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m19:03:12.816931 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m19:03:12.821071 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m19:03:12.821824 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 19:03:12.817414 => 2023-07-01 19:03:12.821676
[0m19:03:12.822520 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m19:03:12.869501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:13.746021 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m19:03:13.747061 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
            , worker_id 
        order by address_id) as dedup_index
    from int_address
)

, prodcut_with_sk  as (
    select
        MD5(cast(address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , contact_type_id
        , worker_id
        , contact_type_name_worker
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m19:03:16.813620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4839a82e-96af-4cc9-8d5c-d66852225267&page=queryresults
[0m19:03:17.816201 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 19:03:12.822977 => 2023-07-01 19:03:17.816119
[0m19:03:17.817240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07009f2c-5535-4820-a151-d918bd19732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b527f0b20>]}
[0m19:03:17.817842 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.7k rows, 1.4 MB processed)[0m in 5.00s]
[0m19:03:17.820055 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m19:03:17.822013 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:17.822916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:17.823235 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m19:03:17.823541 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m19:03:17.823833 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m19:03:17.824126 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m19:03:17.824461 [info ] [MainThread]: 
[0m19:03:17.824899 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.02 seconds (7.02s).
[0m19:03:17.825648 [debug] [MainThread]: Command end result
[0m19:03:17.857977 [info ] [MainThread]: 
[0m19:03:17.859539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:17.860978 [info ] [MainThread]: 
[0m19:03:17.862369 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:03:17.864470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b528efee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b52b91360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b52b927a0>]}
[0m19:03:17.865651 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:03:28.115463 | 227c8fe9-9da8-44f8-9a5e-9cd3a2d96d27 ==============================
[0m19:03:28.115463 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:03:28.119982 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:03:28.120577 [debug] [MainThread]: Tracking: tracking
[0m19:03:28.126613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f298eb76b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f298eb765f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f298eb74880>]}
[0m19:03:28.201165 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:03:28.450110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:28.450825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:28.468679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '227c8fe9-9da8-44f8-9a5e-9cd3a2d96d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f298e7540d0>]}
[0m19:03:28.496706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '227c8fe9-9da8-44f8-9a5e-9cd3a2d96d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f298e719750>]}
[0m19:03:28.497265 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:03:28.497856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '227c8fe9-9da8-44f8-9a5e-9cd3a2d96d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f298e7197b0>]}
[0m19:03:28.503754 [info ] [MainThread]: 
[0m19:03:28.506492 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:28.517439 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:03:28.518240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:28.519004 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:03:28.566845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:28.521270 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:03:28.618555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:28.613312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:03:28.625851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:30.123871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '227c8fe9-9da8-44f8-9a5e-9cd3a2d96d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f298eb745b0>]}
[0m19:03:30.124943 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:03:30.125413 [info ] [MainThread]: 
[0m19:03:30.130516 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:03:30.131015 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:03:30.131424 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:03:30.131792 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:03:30.132223 [info ] [Thread-1 (]: 1 of 15 START test not_null_dim_address_address_sk ............................. [RUN]
[0m19:03:30.133278 [info ] [Thread-2 (]: 2 of 15 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m19:03:30.134492 [info ] [Thread-3 (]: 3 of 15 START test not_null_dim_products_product_sk ............................ [RUN]
[0m19:03:30.135315 [info ] [Thread-4 (]: 4 of 15 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m19:03:30.136496 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m19:03:30.138129 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m19:03:30.139841 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m19:03:30.141012 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m19:03:30.141547 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:03:30.142056 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:03:30.142880 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:03:30.143553 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:03:30.220227 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m19:03:30.223768 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m19:03:30.234062 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m19:03:30.237060 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m19:03:30.237571 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 19:03:30.144588 => 2023-07-01 19:03:30.237463
[0m19:03:30.237923 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 19:03:30.157773 => 2023-07-01 19:03:30.237853
[0m19:03:30.238698 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 19:03:30.189222 => 2023-07-01 19:03:30.238604
[0m19:03:30.239063 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:03:30.239453 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 19:03:30.150851 => 2023-07-01 19:03:30.239376
[0m19:03:30.239710 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:03:30.240064 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:03:30.256417 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:03:30.280256 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m19:03:30.281155 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m19:03:30.284852 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m19:03:30.288287 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m19:03:30.289242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:30.289797 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:30.290331 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:30.291097 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:30.293668 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m19:03:30.295677 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m19:03:30.297544 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m19:03:30.299173 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m19:03:32.871037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:43c48fbd-b5c3-4fb5-a93a-9d5fcd8b8c0e&page=queryresults
[0m19:03:32.871685 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6331e5f7-121a-4ae9-a76f-f0e625cd1035&page=queryresults
[0m19:03:32.873689 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 19:03:30.240681 => 2023-07-01 19:03:32.873600
[0m19:03:32.874200 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0632e04b-7442-460d-90f3-892eb6fbb447&page=queryresults
[0m19:03:32.874877 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 19:03:30.261926 => 2023-07-01 19:03:32.874809
[0m19:03:32.875862 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.74s]
[0m19:03:32.878015 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 19:03:30.281422 => 2023-07-01 19:03:32.877771
[0m19:03:32.880328 [info ] [Thread-3 (]: 3 of 15 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 2.74s]
[0m19:03:32.882998 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m19:03:32.884183 [info ] [Thread-4 (]: 4 of 15 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 2.74s]
[0m19:03:32.885101 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:03:32.885877 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:03:32.886689 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:03:32.887511 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m19:03:32.888116 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m19:03:32.888925 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:03:32.891096 [info ] [Thread-4 (]: 7 of 15 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m19:03:32.889381 [info ] [Thread-3 (]: 6 of 15 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m19:03:32.890494 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m19:03:32.893150 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m19:03:32.894895 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de'
[0m19:03:32.895691 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:03:32.896269 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:03:32.896716 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m19:03:32.941579 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m19:03:32.976646 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9cdb81e7-4fc0-47bc-a965-65dc88316ae4&page=queryresults
[0m19:03:32.979651 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m19:03:32.975346 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m19:03:32.981595 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 19:03:30.285236 => 2023-07-01 19:03:32.981448
[0m19:03:32.981935 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 19:03:32.901918 => 2023-07-01 19:03:32.981857
[0m19:03:32.983518 [info ] [Thread-2 (]: 2 of 15 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.85s]
[0m19:03:32.984293 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (compile): 2023-07-01 19:03:32.921814 => 2023-07-01 19:03:32.984161
[0m19:03:32.984824 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:03:32.985534 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 19:03:32.897031 => 2023-07-01 19:03:32.985368
[0m19:03:32.986156 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:03:32.987049 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m19:03:32.995204 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m19:03:32.995881 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:03:32.996830 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:03:33.006116 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m19:03:33.021437 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:33.007947 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:33.017325 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m19:03:33.025069 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:03:33.019119 [info ] [Thread-2 (]: 8 of 15 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m19:03:33.030660 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:03:33.071954 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m19:03:33.074583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:33.109991 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:03:33.118148 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m19:03:33.120210 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m19:03:33.154515 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 19:03:33.110684 => 2023-07-01 19:03:33.154309
[0m19:03:33.155108 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:03:33.160056 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m19:03:33.160924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:33.163761 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:03:35.710599 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d7642284-f15e-4d82-ac6a-9671d81598dc&page=queryresults
[0m19:03:35.711494 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (execute): 2023-07-01 19:03:32.997980 => 2023-07-01 19:03:35.711407
[0m19:03:35.712358 [info ] [Thread-3 (]: 6 of 15 PASS relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.82s]
[0m19:03:35.712940 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m19:03:35.713609 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:03:35.714154 [info ] [Thread-3 (]: 9 of 15 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m19:03:35.715441 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m19:03:35.715867 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:03:35.725578 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7f2f46b4-a98b-4928-a978-711e49fd593f&page=queryresults
[0m19:03:35.727286 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 19:03:32.987525 => 2023-07-01 19:03:35.727157
[0m19:03:35.739322 [info ] [Thread-4 (]: 7 of 15 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.85s]
[0m19:03:35.737842 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m19:03:35.740758 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:03:35.742694 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m19:03:35.744242 [info ] [Thread-4 (]: 10 of 15 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m19:03:35.745756 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 19:03:35.716128 => 2023-07-01 19:03:35.745369
[0m19:03:35.748446 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310'
[0m19:03:35.750574 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:03:35.753118 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m19:03:35.757664 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m19:03:35.774385 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:35.785579 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m19:03:35.786301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1228c90a-a0f6-4b8b-81f0-42e4f691b5ec&page=queryresults
[0m19:03:35.790418 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 19:03:33.009033 => 2023-07-01 19:03:35.790203
[0m19:03:35.788767 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:03:35.792113 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.90s]
[0m19:03:35.795914 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (compile): 2023-07-01 19:03:35.758073 => 2023-07-01 19:03:35.795456
[0m19:03:35.797227 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:03:35.837492 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m19:03:35.840200 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m19:03:35.843922 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m19:03:35.845108 [info ] [Thread-1 (]: 11 of 15 START test unique_dim_address_address_sk .............................. [RUN]
[0m19:03:35.847221 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m19:03:35.848970 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m19:03:35.860085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:35.860368 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m19:03:35.863309 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:03:35.903955 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 19:03:35.849697 => 2023-07-01 19:03:35.903707
[0m19:03:35.904636 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m19:03:35.916313 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m19:03:35.916987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:35.918947 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:03:36.036120 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a6240b11-5762-46d4-87e9-22ff9fa236d0&page=queryresults
[0m19:03:36.037287 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 19:03:33.155583 => 2023-07-01 19:03:36.037172
[0m19:03:36.038637 [error] [Thread-2 (]: 8 of 15 FAIL 9081 relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[31mFAIL 9081[0m in 2.97s]
[0m19:03:36.039548 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:03:36.040350 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:03:36.041024 [info ] [Thread-2 (]: 12 of 15 START test unique_dim_dates_metric_date ............................... [RUN]
[0m19:03:36.042531 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m19:03:36.043124 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:03:36.055264 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m19:03:36.056151 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 19:03:36.043551 => 2023-07-01 19:03:36.056014
[0m19:03:36.064433 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:03:36.071547 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m19:03:36.072534 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:36.077192 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:03:38.098894 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4f2b20a3-1013-4943-8601-e48f8409306a&page=queryresults
[0m19:03:38.110250 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 19:03:35.754100 => 2023-07-01 19:03:38.110149
[0m19:03:38.111767 [info ] [Thread-3 (]: 9 of 15 PASS relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[32mPASS[0m in 2.40s]
[0m19:03:38.114163 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:03:38.114908 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:03:38.115413 [info ] [Thread-3 (]: 13 of 15 START test unique_dim_products_product_sk ............................. [RUN]
[0m19:03:38.117294 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m19:03:38.117682 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:03:38.124920 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m19:03:38.126190 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 19:03:38.117902 => 2023-07-01 19:03:38.126053
[0m19:03:38.126773 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:03:38.133906 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m19:03:38.135309 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:38.139411 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:03:38.377815 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1a99ffe9-8311-4831-8a1f-97008a0de6e2&page=queryresults
[0m19:03:38.379217 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 19:03:36.065073 => 2023-07-01 19:03:38.379059
[0m19:03:38.380532 [info ] [Thread-2 (]: 12 of 15 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.34s]
[0m19:03:38.381358 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:03:38.381985 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:03:38.382569 [info ] [Thread-2 (]: 14 of 15 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m19:03:38.383783 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m19:03:38.385116 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7c2ebf16-b3e6-4f81-8ec6-65c805496235&page=queryresults
[0m19:03:38.385463 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:03:38.386196 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 19:03:35.905219 => 2023-07-01 19:03:38.386093
[0m19:03:38.392742 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m19:03:38.393846 [error] [Thread-1 (]: 11 of 15 FAIL 83 unique_dim_address_address_sk ................................. [[31mFAIL 83[0m in 2.55s]
[0m19:03:38.395186 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m19:03:38.396228 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:03:38.396950 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 19:03:38.386630 => 2023-07-01 19:03:38.396824
[0m19:03:38.397498 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m19:03:38.398615 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:03:38.400770 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m19:03:38.401485 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:931b350f-5de8-4ff4-a1a8-ee4aeafe5fa7&page=queryresults
[0m19:03:38.407494 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m19:03:38.408058 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:03:38.409592 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (execute): 2023-07-01 19:03:35.840847 => 2023-07-01 19:03:38.409423
[0m19:03:38.411004 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:38.430859 [info ] [Thread-4 (]: 10 of 15 PASS relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.68s]
[0m19:03:38.433782 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m19:03:38.437873 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:03:38.438613 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m19:03:38.480910 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 19:03:38.411997 => 2023-07-01 19:03:38.480528
[0m19:03:38.483325 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:03:38.491343 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m19:03:38.492991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:38.496257 [debug] [Thread-1 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:03:40.856136 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:772cc632-335c-4b1a-8ab8-d78228bcb1c8&page=queryresults
[0m19:03:40.857190 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 19:03:38.401824 => 2023-07-01 19:03:40.857104
[0m19:03:40.858076 [info ] [Thread-2 (]: 14 of 15 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 2.47s]
[0m19:03:40.858838 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:03:40.880221 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:67886deb-f220-4097-804b-397bcc255180&page=queryresults
[0m19:03:40.881674 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 19:03:38.485597 => 2023-07-01 19:03:40.881538
[0m19:03:40.883809 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.48s]
[0m19:03:40.884984 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:03:40.934581 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1e378827-3dbb-48b9-a597-4848f0578f71&page=queryresults
[0m19:03:40.935903 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 19:03:38.127349 => 2023-07-01 19:03:40.935767
[0m19:03:40.937526 [info ] [Thread-3 (]: 13 of 15 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 2.82s]
[0m19:03:40.938613 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:03:40.941200 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:40.942474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:40.943037 [debug] [MainThread]: Connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310' was properly closed.
[0m19:03:40.943708 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m19:03:40.944222 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m19:03:40.945121 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m19:03:40.946606 [info ] [MainThread]: 
[0m19:03:40.948052 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 12.44 seconds (12.44s).
[0m19:03:40.951054 [debug] [MainThread]: Command end result
[0m19:03:41.002036 [info ] [MainThread]: 
[0m19:03:41.003002 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:03:41.003828 [info ] [MainThread]: 
[0m19:03:41.004638 [error] [MainThread]: [31mFailure in test relationships_fact_sales_product_fk__product_sk__ref_dim_products_ (models/gold/fact_sales.yml)[0m
[0m19:03:41.005442 [error] [MainThread]:   Got 9081 results, configured to fail if != 0
[0m19:03:41.006236 [info ] [MainThread]: 
[0m19:03:41.007030 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_f765900a1937b39c2370e1a1d08c08f5.sql
[0m19:03:41.007833 [info ] [MainThread]: 
[0m19:03:41.008663 [error] [MainThread]: [31mFailure in test unique_dim_address_address_sk (models/gold/dim_address.yml)[0m
[0m19:03:41.009454 [error] [MainThread]:   Got 83 results, configured to fail if != 0
[0m19:03:41.010458 [info ] [MainThread]: 
[0m19:03:41.011530 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/dim_address.yml/unique_dim_address_address_sk.sql
[0m19:03:41.012440 [info ] [MainThread]: 
[0m19:03:41.013638 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=2 SKIP=0 TOTAL=15
[0m19:03:41.014658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f298e66ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f298e4a8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f298e510190>]}
[0m19:03:41.015489 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:04:50.454386 | 2fe734f4-e0b1-4be1-a55a-97ff2bb8c046 ==============================
[0m19:04:50.454386 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:04:50.456320 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:04:50.456754 [debug] [MainThread]: Tracking: tracking
[0m19:04:50.459148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4695a747f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4695a74f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4695a747c0>]}
[0m19:04:50.507946 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:04:50.684055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:04:50.685065 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m19:04:50.710434 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m19:04:50.790293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fe734f4-e0b1-4be1-a55a-97ff2bb8c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4694d20eb0>]}
[0m19:04:50.817280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fe734f4-e0b1-4be1-a55a-97ff2bb8c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46957642e0>]}
[0m19:04:50.817797 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:04:50.818288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fe734f4-e0b1-4be1-a55a-97ff2bb8c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46955ef310>]}
[0m19:04:50.822057 [info ] [MainThread]: 
[0m19:04:50.824826 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:04:50.826218 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:04:50.826731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:51.733102 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:04:51.733670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:51.734511 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:04:51.735436 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:04:51.774040 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:04:51.776697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:51.777650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:51.778181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:53.169488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fe734f4-e0b1-4be1-a55a-97ff2bb8c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469574be20>]}
[0m19:04:53.171698 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:04:53.172782 [info ] [MainThread]: 
[0m19:04:53.191843 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m19:04:53.192806 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m19:04:53.194360 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m19:04:53.195026 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m19:04:53.213153 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m19:04:53.214050 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 19:04:53.195544 => 2023-07-01 19:04:53.213901
[0m19:04:53.215760 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m19:04:53.284678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:54.411643 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m19:04:54.412756 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
            , worker_id 
        order by address_id) as dedup_index
    from int_address
)

, prodcut_with_sk  as (
    select
        MD5(cast(business_entity_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , contact_type_id
        , worker_id
        , contact_type_name_worker
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m19:04:57.456900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c877471f-81c1-4aea-958d-98e1ce23b752&page=queryresults
[0m19:04:58.476395 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 19:04:53.216680 => 2023-07-01 19:04:58.476320
[0m19:04:58.477654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe734f4-e0b1-4be1-a55a-97ff2bb8c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4694bab670>]}
[0m19:04:58.478308 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.7k rows, 1.4 MB processed)[0m in 5.28s]
[0m19:04:58.482479 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m19:04:58.484871 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:04:58.485635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:58.485950 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m19:04:58.486206 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m19:04:58.486432 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m19:04:58.486648 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m19:04:58.486930 [info ] [MainThread]: 
[0m19:04:58.487345 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m19:04:58.488188 [debug] [MainThread]: Command end result
[0m19:04:58.528226 [info ] [MainThread]: 
[0m19:04:58.529713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:58.531463 [info ] [MainThread]: 
[0m19:04:58.533804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:04:58.535842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46955ef370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4695619510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4695619390>]}
[0m19:04:58.537322 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:05:58.851236 | a6571ad4-eb0d-47cc-9e8c-7573bdc3ae17 ==============================
[0m19:05:58.851236 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:05:58.853445 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:05:58.853929 [debug] [MainThread]: Tracking: tracking
[0m19:05:58.855550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee74c77340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee74c766e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee74c76e90>]}
[0m19:05:58.912254 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:05:59.073315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:05:59.074164 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address.sql
[0m19:05:59.101089 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m19:05:59.188319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6571ad4-eb0d-47cc-9e8c-7573bdc3ae17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee7411ca30>]}
[0m19:05:59.216390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6571ad4-eb0d-47cc-9e8c-7573bdc3ae17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee749665c0>]}
[0m19:05:59.216872 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:05:59.217466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6571ad4-eb0d-47cc-9e8c-7573bdc3ae17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee747efc70>]}
[0m19:05:59.221329 [info ] [MainThread]: 
[0m19:05:59.223916 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:05:59.225276 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:05:59.225885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:00.125189 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:06:00.125805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:00.126640 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:06:00.127603 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:06:00.128138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:00.128840 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:06:00.162168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:00.164128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:01.378743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6571ad4-eb0d-47cc-9e8c-7573bdc3ae17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee749660b0>]}
[0m19:06:01.380284 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:06:01.380971 [info ] [MainThread]: 
[0m19:06:01.390289 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m19:06:01.391274 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m19:06:01.393202 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m19:06:01.393869 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m19:06:01.400514 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m19:06:01.401490 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 19:06:01.394127 => 2023-07-01 19:06:01.401332
[0m19:06:01.402571 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m19:06:01.445929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:02.440866 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m19:06:02.442889 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
        order by address_id) as dedup_index
    from int_address
)

, prodcut_with_sk  as (
    select
        MD5(cast(address_type_name as string)) address_sk
        , business_entity_id
        , address_type_id
        , contact_type_id
        , contact_type_name_worker
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from prodcut_with_sk
    );
  
[0m19:06:05.853246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b80453ee-7a3d-43bd-98b7-8fa86008a449&page=queryresults
[0m19:06:06.876558 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 19:06:01.403177 => 2023-07-01 19:06:06.876465
[0m19:06:06.877580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6571ad4-eb0d-47cc-9e8c-7573bdc3ae17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6ff65930>]}
[0m19:06:06.878167 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.6k rows, 1.4 MB processed)[0m in 5.49s]
[0m19:06:06.882230 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m19:06:06.884859 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:06:06.886043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:06.886533 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m19:06:06.886922 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m19:06:06.887312 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m19:06:06.887692 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m19:06:06.888197 [info ] [MainThread]: 
[0m19:06:06.888946 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m19:06:06.889817 [debug] [MainThread]: Command end result
[0m19:06:06.926668 [info ] [MainThread]: 
[0m19:06:06.928064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:06.930386 [info ] [MainThread]: 
[0m19:06:06.932412 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:06:06.935674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee747eeef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee74108040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee74163c40>]}
[0m19:06:06.937580 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:20:06.312490 | 567e9083-b357-4726-8518-d3419fffc201 ==============================
[0m19:20:06.312490 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:20:06.315161 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:20:06.315753 [debug] [MainThread]: Tracking: tracking
[0m19:20:06.318194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07eb47a740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07eb47a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07eb47a710>]}
[0m19:20:06.371972 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:20:06.560986 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m19:20:06.561944 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address_customer.sql
[0m19:20:06.562624 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m19:20:06.562925 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_address.sql
[0m19:20:06.563332 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.sql
[0m19:20:06.589691 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address_customer.sql
[0m19:20:06.609620 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m19:20:06.615220 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m19:20:06.739785 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_address' in the 'models' section of file 'models/gold/dim_address.yml'
[0m19:20:06.795301 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m19:20:06.797674 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40' (models/gold/dim_address.yml) depends on a node named 'dim_address' in package '' which was not found
[0m19:20:06.798503 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728' (models/gold/dim_address.yml) depends on a node named 'dim_address' in package '' which was not found
[0m19:20:06.838941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '567e9083-b357-4726-8518-d3419fffc201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ea93fe50>]}
[0m19:20:06.886624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '567e9083-b357-4726-8518-d3419fffc201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07eb343f10>]}
[0m19:20:06.887114 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:20:06.888577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '567e9083-b357-4726-8518-d3419fffc201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07eb343e20>]}
[0m19:20:06.896756 [info ] [MainThread]: 
[0m19:20:06.900604 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:20:06.902269 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:20:06.902773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:08.087921 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:20:08.088636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:08.089427 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:20:08.090543 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:20:08.126888 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:20:08.127378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:08.128015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:08.128456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:09.529289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '567e9083-b357-4726-8518-d3419fffc201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07eb003c10>]}
[0m19:20:09.530237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:09.530759 [info ] [MainThread]: 
[0m19:20:09.535493 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address_customer
[0m19:20:09.536264 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address_customer .............. [RUN]
[0m19:20:09.537699 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address_customer'
[0m19:20:09.538247 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address_customer
[0m19:20:09.544365 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address_customer"
[0m19:20:09.545689 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address_customer (compile): 2023-07-01 19:20:09.538655 => 2023-07-01 19:20:09.545503
[0m19:20:09.546491 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address_customer
[0m19:20:09.621561 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address_customer"
[0m19:20:09.622189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:09.624316 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    where worker_id is null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
        order by address_id) as dedup_index
    from int_address
)

, address_with_sk  as (
    select
        MD5(cast(address_type_name as string)) address_sk
        , business_entity_id
        , address_type_id
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from address_with_sk
    );
  
[0m19:20:13.200458 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9fd8aab1-dcad-4d0e-a1ac-68a6dfc785e8&page=queryresults
[0m19:20:13.220595 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address_customer (execute): 2023-07-01 19:20:09.547175 => 2023-07-01 19:20:13.220525
[0m19:20:13.221541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '567e9083-b357-4726-8518-d3419fffc201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ea94b700>]}
[0m19:20:13.222325 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address_customer ......... [[32mCREATE TABLE (18.8k rows, 1.4 MB processed)[0m in 3.68s]
[0m19:20:13.225461 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address_customer
[0m19:20:13.227870 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:20:13.229149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:13.229495 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m19:20:13.230110 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address_customer' was properly closed.
[0m19:20:13.230652 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m19:20:13.231010 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m19:20:13.231354 [info ] [MainThread]: 
[0m19:20:13.231939 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m19:20:13.232724 [debug] [MainThread]: Command end result
[0m19:20:13.310425 [info ] [MainThread]: 
[0m19:20:13.312352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:13.314288 [info ] [MainThread]: 
[0m19:20:13.315439 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:20:13.316486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ea7b2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ea7b39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ea7b3400>]}
[0m19:20:13.317727 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:20:44.667011 | 277de491-0df8-46f6-aa0d-bf5872bea813 ==============================
[0m19:20:44.667011 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:20:44.669017 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:20:44.669536 [debug] [MainThread]: Tracking: tracking
[0m19:20:44.671702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5276ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f52748e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5276d10>]}
[0m19:20:44.730023 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:20:44.887082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:20:44.887934 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address_customer.sql
[0m19:20:44.914563 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address_customer.sql
[0m19:20:44.959832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '277de491-0df8-46f6-aa0d-bf5872bea813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f46f9420>]}
[0m19:20:44.987999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '277de491-0df8-46f6-aa0d-bf5872bea813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f4f6c970>]}
[0m19:20:44.988541 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:20:44.988994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '277de491-0df8-46f6-aa0d-bf5872bea813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f4defdf0>]}
[0m19:20:44.992996 [info ] [MainThread]: 
[0m19:20:44.997067 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:20:44.998803 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:20:44.999310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:45.976338 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:20:45.977331 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:20:45.977973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:45.979137 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:20:45.980288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:20:45.980815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:45.981346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:46.015726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:47.229026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '277de491-0df8-46f6-aa0d-bf5872bea813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5276ce0>]}
[0m19:20:47.229891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:47.230357 [info ] [MainThread]: 
[0m19:20:47.236075 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address_customer
[0m19:20:47.236884 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address_customer .............. [RUN]
[0m19:20:47.238732 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address_customer'
[0m19:20:47.239503 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address_customer
[0m19:20:47.246150 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address_customer"
[0m19:20:47.247481 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address_customer (compile): 2023-07-01 19:20:47.239950 => 2023-07-01 19:20:47.247292
[0m19:20:47.248212 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address_customer
[0m19:20:47.306208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:48.246367 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address_customer"
[0m19:20:48.247470 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    where worker_id is null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
        order by address_id) as dedup_index
    from int_address
)

, address_with_sk  as (
    select
        MD5(cast(address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from address_with_sk
    );
  
[0m19:20:51.600240 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a543e59d-82df-44aa-95a4-a7aadff832d4&page=queryresults
[0m19:20:51.619705 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address_customer (execute): 2023-07-01 19:20:47.248802 => 2023-07-01 19:20:51.619633
[0m19:20:51.621083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277de491-0df8-46f6-aa0d-bf5872bea813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f4721570>]}
[0m19:20:51.622149 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address_customer ......... [[32mCREATE TABLE (18.8k rows, 1.4 MB processed)[0m in 4.38s]
[0m19:20:51.626705 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address_customer
[0m19:20:51.629492 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:20:51.630631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:51.631303 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m19:20:51.631934 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m19:20:51.632516 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m19:20:51.633130 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address_customer' was properly closed.
[0m19:20:51.633765 [info ] [MainThread]: 
[0m19:20:51.634829 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.64 seconds (6.64s).
[0m19:20:51.636176 [debug] [MainThread]: Command end result
[0m19:20:51.672314 [info ] [MainThread]: 
[0m19:20:51.673219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:51.673973 [info ] [MainThread]: 
[0m19:20:51.674640 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:20:51.675797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f4e1c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f4defca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5274640>]}
[0m19:20:51.676708 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:22:07.643899 | a4241d78-e3a8-4520-97a2-c6c7d2aba09b ==============================
[0m19:22:07.643899 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:22:07.645994 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:22:07.646621 [debug] [MainThread]: Tracking: tracking
[0m19:22:07.648275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92b733a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92b72770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92b73370>]}
[0m19:22:07.697999 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:22:07.844781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:22:07.845690 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_workers.sql
[0m19:22:07.868019 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m19:22:07.945971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9201ce50>]}
[0m19:22:07.974120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92869e40>]}
[0m19:22:07.974648 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:22:07.975081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf926f3700>]}
[0m19:22:07.981390 [info ] [MainThread]: 
[0m19:22:07.984239 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:22:07.991562 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:22:07.995276 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:22:07.997757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:08.001646 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:22:08.002333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:08.048541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:09.436279 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:22:09.437339 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:22:09.437744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:09.438638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:22:09.439988 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:22:09.440864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:09.444444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:09.450935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:11.378865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf926f3700>]}
[0m19:22:11.380136 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:22:11.380990 [info ] [MainThread]: 
[0m19:22:11.394038 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m19:22:11.394918 [info ] [Thread-1 (]: 1 of 46 START sql table model dev_thaina_gold.dim_dates ........................ [RUN]
[0m19:22:11.396836 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m19:22:11.398180 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m19:22:11.397506 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_address
[0m19:22:11.403352 [info ] [Thread-2 (]: 2 of 46 START sql table model dev_thaina_silver.stg_person_address ............. [RUN]
[0m19:22:11.407047 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address'
[0m19:22:11.408187 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_address
[0m19:22:11.416217 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address"
[0m19:22:11.416796 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_address_type
[0m19:22:11.419428 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_address
[0m19:22:11.435641 [info ] [Thread-3 (]: 3 of 46 START sql table model dev_thaina_silver.stg_person_address_type ........ [RUN]
[0m19:22:11.446469 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address_type'
[0m19:22:11.436779 [info ] [Thread-4 (]: 4 of 46 START sql table model dev_thaina_silver.stg_person_business_entity_address  [RUN]
[0m19:22:11.456715 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_address'
[0m19:22:11.458316 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_address
[0m19:22:11.448574 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_address_type
[0m19:22:11.460578 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (compile): 2023-07-01 19:22:11.408805 => 2023-07-01 19:22:11.460036
[0m19:22:11.488382 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_address
[0m19:22:11.487481 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address_type"
[0m19:22:11.511947 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_address"
[0m19:22:11.526200 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (compile): 2023-07-01 19:22:11.461270 => 2023-07-01 19:22:11.525973
[0m19:22:11.527235 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_business_entity_address
[0m19:22:11.583079 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (compile): 2023-07-01 19:22:11.478974 => 2023-07-01 19:22:11.582372
[0m19:22:11.591421 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_address_type
[0m19:22:11.601214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:11.621427 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:11.713426 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:11.768060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:11.821206 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m19:22:13.062935 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address"
[0m19:22:13.063670 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
    );
  
[0m19:22:13.317541 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_address"
[0m19:22:13.319415 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address_type"
[0m19:22:13.320244 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_business_entity_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , addressid as address_id
    , addresstypeid as address_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentityaddress`
)

select *
from source_data
    );
  
[0m19:22:13.320567 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_address_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addresstypeid as address_type_id
    , name as address_type_name 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`addresstype`
)

select *
from source_data
    );
  
[0m19:22:14.590553 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1ff01b12-50fb-4bbe-8cb6-60e0d6b0632a&page=queryresults
[0m19:22:14.611265 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m19:22:14.611989 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-07-01 19:22:11.399112 => 2023-07-01 19:22:14.611896
[0m19:22:14.612373 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m19:22:14.907451 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m19:22:14.908161 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      /* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m19:22:16.183876 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:dc22ddfc-7bd4-41a3-a671-966f2367ac98&page=queryresults
[0m19:22:16.210498 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (execute): 2023-07-01 19:22:11.533604 => 2023-07-01 19:22:16.210435
[0m19:22:16.211284 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9201e4d0>]}
[0m19:22:16.211816 [info ] [Thread-4 (]: 4 of 46 OK created sql table model dev_thaina_silver.stg_person_business_entity_address  [[32mCREATE TABLE (19.6k rows, 1.2 MB processed)[0m in 4.76s]
[0m19:22:16.214630 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_address
[0m19:22:16.215450 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_contact
[0m19:22:16.216224 [info ] [Thread-4 (]: 5 of 46 START sql table model dev_thaina_silver.stg_person_business_entity_contact  [RUN]
[0m19:22:16.217558 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_contact'
[0m19:22:16.218141 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_contact
[0m19:22:16.224265 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m19:22:16.225101 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (compile): 2023-07-01 19:22:16.218557 => 2023-07-01 19:22:16.224975
[0m19:22:16.225643 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_business_entity_contact
[0m19:22:16.231546 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:16.482687 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d46de7de-56f4-400a-894c-6750d47a4ae7&page=queryresults
[0m19:22:16.483169 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:903b8a2d-23f5-4d33-baec-ef4939ac6496&page=queryresults
[0m19:22:16.485745 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (execute): 2023-07-01 19:22:11.488924 => 2023-07-01 19:22:16.485643
[0m19:22:16.488162 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (execute): 2023-07-01 19:22:11.592841 => 2023-07-01 19:22:16.488102
[0m19:22:16.489003 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91e845b0>]}
[0m19:22:16.489786 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91e847c0>]}
[0m19:22:16.490337 [info ] [Thread-2 (]: 2 of 46 OK created sql table model dev_thaina_silver.stg_person_address ........ [[32mCREATE TABLE (19.6k rows, 1.7 MB processed)[0m in 5.08s]
[0m19:22:16.491221 [info ] [Thread-3 (]: 3 of 46 OK created sql table model dev_thaina_silver.stg_person_address_type ... [[32mCREATE TABLE (6.0 rows, 332.0 Bytes processed)[0m in 5.04s]
[0m19:22:16.492229 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_address
[0m19:22:16.492874 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_address_type
[0m19:22:16.493619 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_contact_type
[0m19:22:16.494344 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_country_region
[0m19:22:16.494961 [info ] [Thread-2 (]: 6 of 46 START sql table model dev_thaina_silver.stg_person_contact_type ........ [RUN]
[0m19:22:16.495960 [info ] [Thread-3 (]: 7 of 46 START sql table model dev_thaina_silver.stg_person_country_region ...... [RUN]
[0m19:22:16.497418 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_contact_type'
[0m19:22:16.498412 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_country_region'
[0m19:22:16.498933 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_contact_type
[0m19:22:16.499456 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_country_region
[0m19:22:16.517750 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_country_region"
[0m19:22:16.525269 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_contact_type"
[0m19:22:16.526182 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_country_region (compile): 2023-07-01 19:22:16.507592 => 2023-07-01 19:22:16.526027
[0m19:22:16.527385 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_contact_type (compile): 2023-07-01 19:22:16.499722 => 2023-07-01 19:22:16.527069
[0m19:22:16.529294 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_country_region
[0m19:22:16.530773 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_contact_type
[0m19:22:16.536177 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:16.541199 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:17.233937 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m19:22:17.234637 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_business_entity_contact: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_contact"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , personid as person_id
    , contacttypeid as contact_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentitycontact`
)

select *
from source_data
    );
  
[0m19:22:17.618100 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_contact_type"
[0m19:22:17.620002 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_country_region"
[0m19:22:17.620602 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_contact_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_contact_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    contacttypeid as contact_type_id
    , name as contact_type_name 
  from  `desafiothaina`.`dev_thaina`.`contacttype`
)

select *
from source_data
    );
  
[0m19:22:17.621494 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_country_region: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_country_region"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
    );
  
[0m19:22:18.435353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:845a11ec-735d-46db-83be-ed48fc738674&page=queryresults
[0m19:22:19.254970 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-07-01 19:22:14.612630 => 2023-07-01 19:22:19.254895
[0m19:22:19.255921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92063f10>]}
[0m19:22:19.256450 [info ] [Thread-1 (]: 1 of 46 OK created sql table model dev_thaina_gold.dim_dates ................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 7.86s]
[0m19:22:19.257095 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m19:22:19.257653 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_person_person
[0m19:22:19.258395 [info ] [Thread-1 (]: 8 of 46 START sql table model dev_thaina_silver.stg_person_person .............. [RUN]
[0m19:22:19.259673 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_person'
[0m19:22:19.260117 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_person_person
[0m19:22:19.265064 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_person"
[0m19:22:19.265738 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_person_person (compile): 2023-07-01 19:22:19.260385 => 2023-07-01 19:22:19.265622
[0m19:22:19.266217 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_person_person
[0m19:22:19.271492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:20.088256 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_person"
[0m19:22:20.088889 [debug] [Thread-1 (]: On model.desafioaethaina.stg_person_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
    );
  
[0m19:22:20.484555 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:51245681-29bb-4319-a540-3256c038ab93&page=queryresults
[0m19:22:20.485356 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9ce62f24-88f6-47e7-9a84-60bee65c1af0&page=queryresults
[0m19:22:20.492185 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (execute): 2023-07-01 19:22:16.226085 => 2023-07-01 19:22:20.492113
[0m19:22:20.495002 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_contact_type (execute): 2023-07-01 19:22:16.536565 => 2023-07-01 19:22:20.494934
[0m19:22:20.495913 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9201e4d0>]}
[0m19:22:20.496689 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eec4c0>]}
[0m19:22:20.497268 [info ] [Thread-4 (]: 5 of 46 OK created sql table model dev_thaina_silver.stg_person_business_entity_contact  [[32mCREATE TABLE (909.0 rows, 55.0 KB processed)[0m in 4.28s]
[0m19:22:20.498059 [info ] [Thread-2 (]: 6 of 46 OK created sql table model dev_thaina_silver.stg_person_contact_type ... [[32mCREATE TABLE (20.0 rows, 595.0 Bytes processed)[0m in 4.00s]
[0m19:22:20.499003 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_contact
[0m19:22:20.499635 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_contact_type
[0m19:22:20.500291 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_state_province
[0m19:22:20.501042 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product
[0m19:22:20.501833 [info ] [Thread-4 (]: 9 of 46 START sql table model dev_thaina_silver.stg_person_state_province ...... [RUN]
[0m19:22:20.502875 [info ] [Thread-2 (]: 10 of 46 START sql table model dev_thaina_silver.stg_product ................... [RUN]
[0m19:22:20.504394 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_state_province'
[0m19:22:20.505371 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product'
[0m19:22:20.505868 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_state_province
[0m19:22:20.506463 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product
[0m19:22:20.514392 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_state_province"
[0m19:22:20.525026 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_state_province (compile): 2023-07-01 19:22:20.506781 => 2023-07-01 19:22:20.524728
[0m19:22:20.526717 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_state_province
[0m19:22:20.538382 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product"
[0m19:22:20.542653 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:20.543489 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product (compile): 2023-07-01 19:22:20.515282 => 2023-07-01 19:22:20.543314
[0m19:22:20.545869 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product
[0m19:22:20.592130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:21.714805 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_state_province"
[0m19:22:21.716545 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product"
[0m19:22:21.717281 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_state_province: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_state_province"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
    );
  
[0m19:22:21.718889 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , productmodelid as product_model_id
    , productsubcategoryid as product_subcategory_id
    , name as product_name
    , productnumber as product_number
    , makeflag
    , finishedgoodsflag as finished_goods_flag
    , color
    , safetystocklevel as safety_stock_level
    , standardcost as stand_cost
    , listprice as list_price
    , size as size_product
    , style as style_product
    , weight as weight_product 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`product`
)

select * from source_data
    );
  
[0m19:22:23.289317 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f65ab242-9879-4949-a43b-a554f624b8ef&page=queryresults
[0m19:22:23.292396 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_person_person (execute): 2023-07-01 19:22:19.266518 => 2023-07-01 19:22:23.292327
[0m19:22:23.293704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92063dc0>]}
[0m19:22:23.294549 [info ] [Thread-1 (]: 8 of 46 OK created sql table model dev_thaina_silver.stg_person_person ......... [[32mCREATE TABLE (20.0k rows, 1.5 MB processed)[0m in 4.03s]
[0m19:22:23.295317 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_person_person
[0m19:22:23.296122 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_category
[0m19:22:23.296964 [info ] [Thread-1 (]: 11 of 46 START sql table model dev_thaina_silver.stg_product_category .......... [RUN]
[0m19:22:23.298414 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_category'
[0m19:22:23.299144 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_category
[0m19:22:23.306769 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_category"
[0m19:22:23.307618 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_category (compile): 2023-07-01 19:22:23.299663 => 2023-07-01 19:22:23.307511
[0m19:22:23.308184 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_category
[0m19:22:23.314633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:23.792040 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:49601ac1-6a7f-4b7d-a0c8-61154c4bc8b7&page=queryresults
[0m19:22:23.795500 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_country_region (execute): 2023-07-01 19:22:16.531288 => 2023-07-01 19:22:23.795326
[0m19:22:23.796703 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eae3e0>]}
[0m19:22:23.797560 [info ] [Thread-3 (]: 7 of 46 OK created sql table model dev_thaina_silver.stg_person_country_region . [[32mCREATE TABLE (238.0 rows, 3.7 KB processed)[0m in 7.30s]
[0m19:22:23.798931 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_country_region
[0m19:22:23.799669 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_description
[0m19:22:23.800586 [info ] [Thread-3 (]: 12 of 46 START sql table model dev_thaina_silver.stg_product_description ....... [RUN]
[0m19:22:23.802261 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_description'
[0m19:22:23.802923 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_description
[0m19:22:23.811302 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_description"
[0m19:22:23.812455 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_description (compile): 2023-07-01 19:22:23.803380 => 2023-07-01 19:22:23.812179
[0m19:22:23.814130 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_description
[0m19:22:23.822740 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:24.176207 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f763068b-4ff7-4363-956e-d83e76ad679a&page=queryresults
[0m19:22:24.178427 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product (execute): 2023-07-01 19:22:20.546340 => 2023-07-01 19:22:24.178367
[0m19:22:24.179185 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91e84550>]}
[0m19:22:24.179708 [info ] [Thread-2 (]: 10 of 46 OK created sql table model dev_thaina_silver.stg_product .............. [[32mCREATE TABLE (504.0 rows, 60.1 KB processed)[0m in 3.67s]
[0m19:22:24.180256 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product
[0m19:22:24.180863 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_inventory
[0m19:22:24.181536 [info ] [Thread-2 (]: 13 of 46 START sql table model dev_thaina_silver.stg_product_inventory ......... [RUN]
[0m19:22:24.182685 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_inventory'
[0m19:22:24.183229 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_inventory
[0m19:22:24.187090 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_inventory"
[0m19:22:24.187684 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_inventory (compile): 2023-07-01 19:22:24.183484 => 2023-07-01 19:22:24.187594
[0m19:22:24.188019 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product_inventory
[0m19:22:24.192065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:24.242500 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_category"
[0m19:22:24.247496 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_category: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_category"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productcategoryid as category_id
    , name as category_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productcategory`
)

select *
from source_data
    );
  
[0m19:22:24.530542 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:027b053e-cd95-4330-b225-a8fda2659967&page=queryresults
[0m19:22:24.533092 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_state_province (execute): 2023-07-01 19:22:20.539109 => 2023-07-01 19:22:24.533010
[0m19:22:24.534148 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eafaf0>]}
[0m19:22:24.534868 [info ] [Thread-4 (]: 9 of 46 OK created sql table model dev_thaina_silver.stg_person_state_province . [[32mCREATE TABLE (181.0 rows, 13.4 KB processed)[0m in 4.03s]
[0m19:22:24.535613 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_state_province
[0m19:22:24.536314 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_location
[0m19:22:24.536989 [info ] [Thread-4 (]: 14 of 46 START sql table model dev_thaina_silver.stg_product_location .......... [RUN]
[0m19:22:24.538224 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_location'
[0m19:22:24.538666 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_location
[0m19:22:24.542662 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_location"
[0m19:22:24.543263 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_location (compile): 2023-07-01 19:22:24.538932 => 2023-07-01 19:22:24.543166
[0m19:22:24.543714 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product_location
[0m19:22:24.548424 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:24.803403 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_description"
[0m19:22:24.804288 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_description: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_description"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_description`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productdescriptionid as product_description_id
    , description as product_description
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productdescription`
)

select *
from source_data
    );
  
[0m19:22:25.194861 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_inventory"
[0m19:22:25.196394 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product_inventory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_inventory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , locationid as location_id
    , shelf
    , bin
    , quantity as quantity_inventory
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productinventory`
)

select *
from source_data
    );
  
[0m19:22:25.503915 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_location"
[0m19:22:25.504499 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product_location: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_location"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    locationid as location_id
    , name as location_name
    -- Standard hourly cost of the manufacturing location.
    , costrate as cost_rate
    -- Work capacity (in hours) of the manufacturing location.
    , availability 
  from  `desafiothaina`.`dev_thaina`.`location`
)

select *
from source_data
    );
  
[0m19:22:27.448077 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:95bcb229-0314-46b0-bebc-2e0b2fc1960d&page=queryresults
[0m19:22:27.456553 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_category (execute): 2023-07-01 19:22:23.308555 => 2023-07-01 19:22:27.456454
[0m19:22:27.458022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91f526e0>]}
[0m19:22:27.458867 [info ] [Thread-1 (]: 11 of 46 OK created sql table model dev_thaina_silver.stg_product_category ..... [[32mCREATE TABLE (4.0 rows, 226.0 Bytes processed)[0m in 4.16s]
[0m19:22:27.459864 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_category
[0m19:22:27.460669 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_model
[0m19:22:27.461588 [info ] [Thread-1 (]: 15 of 46 START sql table model dev_thaina_silver.stg_product_model ............. [RUN]
[0m19:22:27.463060 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_model'
[0m19:22:27.463446 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_model
[0m19:22:27.467160 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_model"
[0m19:22:27.467876 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_model (compile): 2023-07-01 19:22:27.463682 => 2023-07-01 19:22:27.467747
[0m19:22:27.468519 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_model
[0m19:22:27.479727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:27.738001 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:354f2ce4-235a-4258-8a5b-d4d56039cf2c&page=queryresults
[0m19:22:27.740305 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_description (execute): 2023-07-01 19:22:23.814660 => 2023-07-01 19:22:27.740238
[0m19:22:27.741136 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91ea0100>]}
[0m19:22:27.741917 [info ] [Thread-3 (]: 12 of 46 OK created sql table model dev_thaina_silver.stg_product_description .. [[32mCREATE TABLE (762.0 rows, 125.4 KB processed)[0m in 3.94s]
[0m19:22:27.743115 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_description
[0m19:22:27.743913 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_subcategory
[0m19:22:27.744731 [info ] [Thread-3 (]: 16 of 46 START sql table model dev_thaina_silver.stg_product_subcategory ....... [RUN]
[0m19:22:27.746162 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_subcategory'
[0m19:22:27.746757 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_subcategory
[0m19:22:27.912435 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_subcategory"
[0m19:22:27.913056 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_subcategory (compile): 2023-07-01 19:22:27.747145 => 2023-07-01 19:22:27.912962
[0m19:22:27.913511 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_subcategory
[0m19:22:27.918351 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:28.204134 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f2bf7aa1-cd96-40d3-8e10-81e889e5162f&page=queryresults
[0m19:22:28.206341 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_inventory (execute): 2023-07-01 19:22:24.188219 => 2023-07-01 19:22:28.206281
[0m19:22:28.207064 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92868d30>]}
[0m19:22:28.207581 [info ] [Thread-2 (]: 13 of 46 OK created sql table model dev_thaina_silver.stg_product_inventory .... [[32mCREATE TABLE (1.1k rows, 76.8 KB processed)[0m in 4.02s]
[0m19:22:28.208114 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_inventory
[0m19:22:28.208734 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m19:22:28.209364 [info ] [Thread-2 (]: 17 of 46 START sql table model dev_thaina_silver.stg_purchase_order_detail ..... [RUN]
[0m19:22:28.210736 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m19:22:28.211281 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m19:22:28.215106 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m19:22:28.215835 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-07-01 19:22:28.211675 => 2023-07-01 19:22:28.215716
[0m19:22:28.216349 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_purchase_order_detail
[0m19:22:28.223755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:28.473869 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3e5a7bab-cce8-4351-ad4a-c19f28c1a32e&page=queryresults
[0m19:22:28.476858 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_location (execute): 2023-07-01 19:22:24.543924 => 2023-07-01 19:22:28.476793
[0m19:22:28.478037 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eafa30>]}
[0m19:22:28.478835 [info ] [Thread-4 (]: 14 of 46 OK created sql table model dev_thaina_silver.stg_product_location ..... [[32mCREATE TABLE (14.0 rows, 670.0 Bytes processed)[0m in 3.94s]
[0m19:22:28.479822 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_location
[0m19:22:28.480882 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchase_order_header
[0m19:22:28.481704 [info ] [Thread-4 (]: 18 of 46 START sql table model dev_thaina_silver.stg_purchase_order_header ..... [RUN]
[0m19:22:28.483413 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_header'
[0m19:22:28.484071 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchase_order_header
[0m19:22:28.491221 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_header"
[0m19:22:28.492284 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (compile): 2023-07-01 19:22:28.484623 => 2023-07-01 19:22:28.492083
[0m19:22:28.493004 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_purchase_order_header
[0m19:22:28.499883 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:28.558020 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_model"
[0m19:22:28.559562 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_model: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_model"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productmodelid as model_id
    , name as model_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productmodel`
)

select *
from source_data
    );
  
[0m19:22:28.863217 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_subcategory"
[0m19:22:28.863854 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_subcategory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_subcategory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productsubcategoryid as subcategory_id
    , productcategoryid as category_id
    , name as subcategory_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productsubcategory`
)

select *
from source_data
    );
  
[0m19:22:29.185465 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_detail"
[0m19:22:29.186114 [debug] [Thread-2 (]: On model.desafioaethaina.stg_purchase_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , purchase_order_detail_id
    , cast(duedate as timestamp) as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m19:22:29.394382 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_header"
[0m19:22:29.397242 [debug] [Thread-4 (]: On model.desafioaethaina.stg_purchase_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    purchaseorderid as purchase_order_id
    , revisionnumber as revision_number
    , status as status_order
    , employeeid as employee_id
    , vendorid as vendor_id
    , shipmethodid as ship_method_id
    , shipdate as ship_date
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight  
    /* Total due to vendor. Computed as Subtotal + TaxAmt + Freight.
Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0))  */
  from
    `desafiothaina`.`dev_thaina`.`purchaseorderheader`
)

select * 
  from source_data
    );
  
[0m19:22:30.318989 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: purchase_order_detail_id; Did you mean purchaseorderdetailid? at [16:7]')
[0m19:22:31.229646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a789ee6a-a4a5-4e9b-a2b0-41c7c52b6d28&page=queryresults
[0m19:22:31.232844 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_model (execute): 2023-07-01 19:22:27.469148 => 2023-07-01 19:22:31.232757
[0m19:22:31.233783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92868d00>]}
[0m19:22:31.234936 [info ] [Thread-1 (]: 15 of 46 OK created sql table model dev_thaina_silver.stg_product_model ........ [[32mCREATE TABLE (128.0 rows, 8.0 KB processed)[0m in 3.77s]
[0m19:22:31.236005 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_model
[0m19:22:31.240839 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchasing_product_vendor
[0m19:22:31.241638 [info ] [Thread-1 (]: 19 of 46 START sql table model dev_thaina_silver.stg_purchasing_product_vendor . [RUN]
[0m19:22:31.243043 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_product_vendor'
[0m19:22:31.243704 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchasing_product_vendor
[0m19:22:31.251401 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m19:22:31.252829 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (compile): 2023-07-01 19:22:31.244638 => 2023-07-01 19:22:31.252618
[0m19:22:31.253866 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchasing_product_vendor
[0m19:22:31.262823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:31.328869 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:924814ad-f829-43e1-b73b-ad4103f87e29&page=queryresults
[0m19:22:31.330477 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (execute): 2023-07-01 19:22:28.216615 => 2023-07-01 19:22:31.330155
[0m19:22:31.333394 [debug] [Thread-2 (]: Database Error in model stg_purchase_order_detail (models/silver/purchasing/stg_purchase_order_detail.sql)
  Unrecognized name: purchase_order_detail_id; Did you mean purchaseorderdetailid? at [16:7]
  compiled Code at target/run/desafioaethaina/models/silver/purchasing/stg_purchase_order_detail.sql
[0m19:22:31.333929 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf90543910>]}
[0m19:22:31.334419 [error] [Thread-2 (]: 17 of 46 ERROR creating sql table model dev_thaina_silver.stg_purchase_order_detail  [[31mERROR[0m in 3.12s]
[0m19:22:31.334910 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m19:22:31.335598 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_purchasing_ship_method
[0m19:22:31.336321 [info ] [Thread-2 (]: 20 of 46 START sql table model dev_thaina_silver.stg_purchasing_ship_method .... [RUN]
[0m19:22:31.337611 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_ship_method'
[0m19:22:31.337977 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_purchasing_ship_method
[0m19:22:31.345535 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m19:22:31.346532 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (compile): 2023-07-01 19:22:31.338217 => 2023-07-01 19:22:31.346375
[0m19:22:31.346931 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_purchasing_ship_method
[0m19:22:31.354168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:31.522044 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:94f8aae7-4c64-4964-adb5-f9d1940ba3e0&page=queryresults
[0m19:22:31.524666 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_subcategory (execute): 2023-07-01 19:22:27.913729 => 2023-07-01 19:22:31.524597
[0m19:22:31.525520 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91ddfac0>]}
[0m19:22:31.526096 [info ] [Thread-3 (]: 16 of 46 OK created sql table model dev_thaina_silver.stg_product_subcategory .. [[32mCREATE TABLE (37.0 rows, 2.3 KB processed)[0m in 3.78s]
[0m19:22:31.526790 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_subcategory
[0m19:22:31.527371 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchasing_vendor
[0m19:22:31.528264 [info ] [Thread-3 (]: 21 of 46 START sql table model dev_thaina_silver.stg_purchasing_vendor ......... [RUN]
[0m19:22:31.529505 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_vendor'
[0m19:22:31.529932 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchasing_vendor
[0m19:22:31.533901 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_vendor"
[0m19:22:31.534515 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (compile): 2023-07-01 19:22:31.530190 => 2023-07-01 19:22:31.534415
[0m19:22:31.534979 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchasing_vendor
[0m19:22:31.540039 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:31.991924 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9ac05ec1-6b2f-4e7e-b267-819a48e86cd7&page=queryresults
[0m19:22:31.994287 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (execute): 2023-07-01 19:22:28.493531 => 2023-07-01 19:22:31.994222
[0m19:22:31.995053 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91e75750>]}
[0m19:22:31.995574 [info ] [Thread-4 (]: 18 of 46 OK created sql table model dev_thaina_silver.stg_purchase_order_header  [[32mCREATE TABLE (4.0k rows, 380.0 KB processed)[0m in 3.51s]
[0m19:22:31.996164 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchase_order_header
[0m19:22:31.996860 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_country_region_currency
[0m19:22:31.997801 [info ] [Thread-4 (]: 22 of 46 START sql table model dev_thaina_silver.stg_sales_country_region_currency  [RUN]
[0m19:22:31.999314 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_country_region_currency'
[0m19:22:32.000025 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_country_region_currency
[0m19:22:32.007074 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m19:22:32.007974 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (compile): 2023-07-01 19:22:32.000471 => 2023-07-01 19:22:32.007857
[0m19:22:32.008591 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_country_region_currency
[0m19:22:32.017580 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:32.207093 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m19:22:32.207805 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchasing_product_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_product_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_product_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , productid as product_id
    , standardprice as standard_price
    , minorderqty as min_order_qty
    , maxorderqty as max_order_qty
    , onorderqty as on_order_qty
    , unitmeasurecode as unit_measure_code
  from  `desafiothaina`.`dev_thaina`.`productvendor`
)

select *
from source_data
    );
  
[0m19:22:32.241090 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m19:22:32.241795 [debug] [Thread-2 (]: On model.desafioaethaina.stg_purchasing_ship_method: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_ship_method"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
    );
  
[0m19:22:32.431948 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_vendor"
[0m19:22:32.432761 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchasing_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , accountnumber as account_number
    , name as company_name
    -- 1 = Superior, 2 = Excellent, 3 = Above average, 4 = Average, 5 = Below
    , creditrating as credit_rate
    , activeflag as active_flag
  from  `desafiothaina`.`dev_thaina`.`vendor`
)

select *
from source_data
    );
  
[0m19:22:32.876450 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m19:22:32.878840 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_country_region_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_country_region_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_country_region_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
      countryregioncode as country_region_code
      , currencycode as currency_code
    from `desafiothaina`.`dev_thaina`.`countryregioncurrency`
  )
select  *
from source_data
    );
  
[0m19:22:34.922113 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e9832761-d923-40c7-abc4-f1aa3bccffc0&page=queryresults
[0m19:22:34.924640 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (execute): 2023-07-01 19:22:31.347178 => 2023-07-01 19:22:34.924572
[0m19:22:34.925526 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92744520>]}
[0m19:22:34.926088 [info ] [Thread-2 (]: 20 of 46 OK created sql table model dev_thaina_silver.stg_purchasing_ship_method  [[32mCREATE TABLE (5.0 rows, 400.0 Bytes processed)[0m in 3.59s]
[0m19:22:34.926733 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_purchasing_ship_method
[0m19:22:34.927506 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_creditcard
[0m19:22:34.928167 [info ] [Thread-2 (]: 23 of 46 START sql table model dev_thaina_silver.stg_sales_creditcard .......... [RUN]
[0m19:22:34.929379 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_creditcard'
[0m19:22:34.929801 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_creditcard
[0m19:22:34.933657 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_creditcard"
[0m19:22:34.936907 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (compile): 2023-07-01 19:22:34.930058 => 2023-07-01 19:22:34.936738
[0m19:22:34.937761 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_creditcard
[0m19:22:34.935695 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f7b54914-aa78-4100-8ea3-6ba17174a0b0&page=queryresults
[0m19:22:34.945374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:34.948446 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (execute): 2023-07-01 19:22:31.254666 => 2023-07-01 19:22:34.948346
[0m19:22:34.954325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91e867d0>]}
[0m19:22:34.955591 [info ] [Thread-1 (]: 19 of 46 OK created sql table model dev_thaina_silver.stg_purchasing_product_vendor  [[32mCREATE TABLE (460.0 rows, 21.4 KB processed)[0m in 3.71s]
[0m19:22:34.957001 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchasing_product_vendor
[0m19:22:35.011973 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3cf67898-9492-4d99-ad6c-0af1bc7fa618&page=queryresults
[0m19:22:35.014407 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_currency
[0m19:22:35.022626 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (execute): 2023-07-01 19:22:31.535241 => 2023-07-01 19:22:35.020313
[0m19:22:35.026168 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eae3e0>]}
[0m19:22:35.021868 [info ] [Thread-1 (]: 24 of 46 START sql table model dev_thaina_silver.stg_sales_currency ............ [RUN]
[0m19:22:35.027312 [info ] [Thread-3 (]: 21 of 46 OK created sql table model dev_thaina_silver.stg_purchasing_vendor .... [[32mCREATE TABLE (104.0 rows, 5.1 KB processed)[0m in 3.50s]
[0m19:22:35.028431 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency'
[0m19:22:35.028922 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchasing_vendor
[0m19:22:35.029279 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_currency
[0m19:22:35.029793 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_currency_rate
[0m19:22:35.033963 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency"
[0m19:22:35.036301 [info ] [Thread-3 (]: 25 of 46 START sql table model dev_thaina_silver.stg_sales_currency_rate ....... [RUN]
[0m19:22:35.039983 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency_rate'
[0m19:22:35.040475 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_currency_rate
[0m19:22:35.040803 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_currency (compile): 2023-07-01 19:22:35.030206 => 2023-07-01 19:22:35.040683
[0m19:22:35.047050 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency_rate"
[0m19:22:35.047984 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_currency
[0m19:22:35.054542 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (compile): 2023-07-01 19:22:35.041213 => 2023-07-01 19:22:35.054362
[0m19:22:35.055784 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_currency_rate
[0m19:22:35.063697 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:35.112242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:35.511579 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:59392d50-1cef-4f95-9d12-5babe9da6977&page=queryresults
[0m19:22:35.513929 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (execute): 2023-07-01 19:22:32.009027 => 2023-07-01 19:22:35.513847
[0m19:22:35.514685 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91ec9b70>]}
[0m19:22:35.515171 [info ] [Thread-4 (]: 22 of 46 OK created sql table model dev_thaina_silver.stg_sales_country_region_currency  [[32mCREATE TABLE (109.0 rows, 981.0 Bytes processed)[0m in 3.52s]
[0m19:22:35.515913 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_country_region_currency
[0m19:22:35.516890 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_customer
[0m19:22:35.518015 [info ] [Thread-4 (]: 26 of 46 START sql table model dev_thaina_silver.stg_sales_customer ............ [RUN]
[0m19:22:35.519562 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_customer'
[0m19:22:35.520273 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_customer
[0m19:22:35.525292 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_customer"
[0m19:22:35.525874 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_customer (compile): 2023-07-01 19:22:35.520738 => 2023-07-01 19:22:35.525797
[0m19:22:35.526177 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_customer
[0m19:22:35.530533 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:35.883740 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_creditcard"
[0m19:22:35.884939 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_creditcard: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_creditcard"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    creditcardid as credit_card_id
    , cardtype as card_type
  from  `desafiothaina`.`dev_thaina`.`creditcard`
)
select *
from source_data
    );
  
[0m19:22:36.161088 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency"
[0m19:22:36.161740 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    currencycode as currency_code
    , name as currency_name
  from  `desafiothaina`.`dev_thaina`.`currency`
)

select *
from source_data
    );
  
[0m19:22:36.171915 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency_rate"
[0m19:22:36.172586 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      currencyrateid as currency_rate_id
      , currencyratedate as currency_rate_date
      , fromcurrencycode as from_currency_code
      , tocurrencycode as to_currency_code
      , averagerate as avg_rate
      , endofdayrate as end_of_day_rate
    from `desafiothaina`.`dev_thaina`.`currencyrate`
  )
select  *
from source_data
    );
  
[0m19:22:36.463585 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_customer"
[0m19:22:36.464291 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
    );
  
[0m19:22:38.660463 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:92087e6b-f772-4107-aeb5-fef30d5a428c&page=queryresults
[0m19:22:38.664705 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (execute): 2023-07-01 19:22:34.938643 => 2023-07-01 19:22:38.664583
[0m19:22:38.666252 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92760100>]}
[0m19:22:38.667294 [info ] [Thread-2 (]: 23 of 46 OK created sql table model dev_thaina_silver.stg_sales_creditcard ..... [[32mCREATE TABLE (19.1k rows, 378.8 KB processed)[0m in 3.74s]
[0m19:22:38.668339 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_creditcard
[0m19:22:38.669164 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_order_detail
[0m19:22:38.670103 [info ] [Thread-2 (]: 27 of 46 START sql table model dev_thaina_silver.stg_sales_order_detail ........ [RUN]
[0m19:22:38.673220 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_detail'
[0m19:22:38.676268 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_order_detail
[0m19:22:38.685178 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_detail"
[0m19:22:38.686093 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (compile): 2023-07-01 19:22:38.677732 => 2023-07-01 19:22:38.685961
[0m19:22:38.686722 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_order_detail
[0m19:22:38.697094 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:38.751338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:fa238204-f8ab-4d63-a0b4-34b414056448&page=queryresults
[0m19:22:38.757159 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_currency (execute): 2023-07-01 19:22:35.048639 => 2023-07-01 19:22:38.757046
[0m19:22:38.760768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91e86bf0>]}
[0m19:22:38.761903 [info ] [Thread-1 (]: 24 of 46 OK created sql table model dev_thaina_silver.stg_sales_currency ....... [[32mCREATE TABLE (105.0 rows, 2.0 KB processed)[0m in 3.73s]
[0m19:22:38.762910 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_currency
[0m19:22:38.763786 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m19:22:38.766735 [info ] [Thread-1 (]: 28 of 46 START sql table model dev_thaina_silver.stg_sales_order_header ........ [RUN]
[0m19:22:38.768187 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m19:22:38.768820 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m19:22:38.776704 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m19:22:38.777563 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-07-01 19:22:38.769903 => 2023-07-01 19:22:38.777438
[0m19:22:38.778196 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m19:22:38.784821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:38.857354 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:15d7745a-754b-4119-bef2-66a2e929817b&page=queryresults
[0m19:22:38.867965 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (execute): 2023-07-01 19:22:35.056492 => 2023-07-01 19:22:38.867850
[0m19:22:38.869697 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91e1b8e0>]}
[0m19:22:39.214829 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:24e50917-c8e5-42d6-99f9-020a40feaffd&page=queryresults
[0m19:22:39.219210 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_customer (execute): 2023-07-01 19:22:35.526375 => 2023-07-01 19:22:39.219048
[0m19:22:39.220719 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eafac0>]}
[0m19:22:39.776153 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_detail"
[0m19:22:39.776806 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
    );
  
[0m19:22:39.806712 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m19:22:39.807303 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(cast(orderdate as timestamp) as date) as order_date
    , cast(cast(duedate as timestamp) as date) as due_date
    , cast(cast(shipdate as timestamp) as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m19:22:39.907978 [info ] [Thread-3 (]: 25 of 46 OK created sql table model dev_thaina_silver.stg_sales_currency_rate .. [[32mCREATE TABLE (13.5k rows, 779.7 KB processed)[0m in 3.83s]
[0m19:22:39.909147 [info ] [Thread-4 (]: 26 of 46 OK created sql table model dev_thaina_silver.stg_sales_customer ....... [[32mCREATE TABLE (19.8k rows, 1.2 MB processed)[0m in 3.70s]
[0m19:22:39.910282 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_currency_rate
[0m19:22:39.911066 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_customer
[0m19:22:39.911951 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_order_header_reason
[0m19:22:39.912930 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_person
[0m19:22:39.915055 [info ] [Thread-4 (]: 30 of 46 START sql table model dev_thaina_silver.stg_sales_person .............. [RUN]
[0m19:22:39.916705 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person'
[0m19:22:39.917417 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_person
[0m19:22:39.913852 [info ] [Thread-3 (]: 29 of 46 START sql table model dev_thaina_silver.stg_sales_order_header_reason . [RUN]
[0m19:22:39.927414 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header_reason'
[0m19:22:39.928148 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_order_header_reason
[0m19:22:39.925716 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person"
[0m19:22:39.939656 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person (compile): 2023-07-01 19:22:39.917975 => 2023-07-01 19:22:39.939299
[0m19:22:39.940523 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_person
[0m19:22:39.948826 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:39.937923 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m19:22:39.952598 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (compile): 2023-07-01 19:22:39.928849 => 2023-07-01 19:22:39.952435
[0m19:22:39.953237 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_order_header_reason
[0m19:22:39.959966 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:41.122446 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m19:22:41.123475 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_order_header_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
    );
  
[0m19:22:41.175000 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person"
[0m19:22:41.176454 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , territoryid as territory_id
      , salesquota as sales_quota
      , bonus
      , commissionpct as commission_pct
      , salesytd as sales_total
      , saleslastyear as sales_last_year
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salesperson`
  )

select  *
from source_data
    );
  
[0m19:22:43.314254 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:13b0e535-bafb-42d4-8e26-eebc1536cb5c&page=queryresults
[0m19:22:43.318816 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-07-01 19:22:38.778635 => 2023-07-01 19:22:43.318698
[0m19:22:43.320350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91e1bfd0>]}
[0m19:22:43.321815 [info ] [Thread-1 (]: 28 of 46 OK created sql table model dev_thaina_silver.stg_sales_order_header ... [[32mCREATE TABLE (31.5k rows, 7.4 MB processed)[0m in 4.55s]
[0m19:22:43.322975 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m19:22:43.324264 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_person_quota_history
[0m19:22:43.325167 [info ] [Thread-1 (]: 31 of 46 START sql table model dev_thaina_silver.stg_sales_person_quota_history  [RUN]
[0m19:22:43.326652 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person_quota_history'
[0m19:22:43.327278 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_person_quota_history
[0m19:22:43.334963 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m19:22:43.335888 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (compile): 2023-07-01 19:22:43.327752 => 2023-07-01 19:22:43.335758
[0m19:22:43.336578 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_person_quota_history
[0m19:22:43.344183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:43.518149 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9742e44e-fd98-4385-a617-dd33966e19b9&page=queryresults
[0m19:22:43.522021 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (execute): 2023-07-01 19:22:38.687173 => 2023-07-01 19:22:43.521925
[0m19:22:43.523389 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91e127d0>]}
[0m19:22:43.524306 [info ] [Thread-2 (]: 27 of 46 OK created sql table model dev_thaina_silver.stg_sales_order_detail ... [[32mCREATE TABLE (121.3k rows, 10.8 MB processed)[0m in 4.85s]
[0m19:22:43.525230 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_order_detail
[0m19:22:43.528187 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_reason
[0m19:22:43.528991 [info ] [Thread-2 (]: 32 of 46 START sql table model dev_thaina_silver.stg_sales_reason .............. [RUN]
[0m19:22:43.530358 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_reason'
[0m19:22:43.530904 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_reason
[0m19:22:43.543617 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_reason"
[0m19:22:43.544549 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_reason (compile): 2023-07-01 19:22:43.531262 => 2023-07-01 19:22:43.544409
[0m19:22:43.545316 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_reason
[0m19:22:43.561007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:43.694077 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b3860f71-829b-4ab6-bc26-3f9c47538637&page=queryresults
[0m19:22:43.698049 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (execute): 2023-07-01 19:22:39.953694 => 2023-07-01 19:22:43.697952
[0m19:22:43.702149 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eae350>]}
[0m19:22:43.703251 [info ] [Thread-3 (]: 29 of 46 OK created sql table model dev_thaina_silver.stg_sales_order_header_reason  [[32mCREATE TABLE (27.6k rows, 432.0 KB processed)[0m in 3.78s]
[0m19:22:43.704430 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_order_header_reason
[0m19:22:43.705433 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_tax_rate
[0m19:22:43.706900 [info ] [Thread-3 (]: 33 of 46 START sql table model dev_thaina_silver.stg_sales_tax_rate ............ [RUN]
[0m19:22:43.709093 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_tax_rate'
[0m19:22:43.709844 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_tax_rate
[0m19:22:43.717230 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_tax_rate"
[0m19:22:43.719207 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (compile): 2023-07-01 19:22:43.710313 => 2023-07-01 19:22:43.719055
[0m19:22:43.719911 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_tax_rate
[0m19:22:43.729201 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:43.808838 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:fdeb258a-ea94-49f0-a790-1291c060774d&page=queryresults
[0m19:22:43.817268 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person (execute): 2023-07-01 19:22:39.941163 => 2023-07-01 19:22:43.817163
[0m19:22:43.824567 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91df7d00>]}
[0m19:22:43.825902 [info ] [Thread-4 (]: 30 of 46 OK created sql table model dev_thaina_silver.stg_sales_person ......... [[32mCREATE TABLE (17.0 rows, 1.5 KB processed)[0m in 3.91s]
[0m19:22:43.828241 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_person
[0m19:22:43.830565 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_territory
[0m19:22:43.831966 [info ] [Thread-4 (]: 34 of 46 START sql table model dev_thaina_silver.stg_sales_territory ........... [RUN]
[0m19:22:43.846416 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_territory'
[0m19:22:43.847304 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_territory
[0m19:22:43.854015 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_territory"
[0m19:22:43.854838 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_territory (compile): 2023-07-01 19:22:43.847979 => 2023-07-01 19:22:43.854707
[0m19:22:43.867572 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_territory
[0m19:22:43.872967 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:44.731758 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m19:22:44.732750 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_person_quota_history: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person_quota_history"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person_quota_history`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , quotadate as quota_date
      , salesquota as sales_quota
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salespersonquotahistory`
  )

select  *
from source_data
    );
  
[0m19:22:44.962971 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_reason"
[0m19:22:44.964058 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salesreasonid as sales_reason_id
      , name as name_reason
      , reasontype as reason_type
    from `desafiothaina`.`dev_thaina`.`salesreason`
  )

select  *
from source_data
    );
  
[0m19:22:45.034489 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_tax_rate"
[0m19:22:45.035613 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_tax_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_tax_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_tax_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salestaxrateid as sales_tax_rate_id
      , stateprovinceid as state_province_id
      , taxtype as tax_type
      , taxrate as tax_rate
      , name as name_tax_rate_desciption
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salestaxrate`
  )

select  *
from source_data
    );
  
[0m19:22:45.320104 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_territory"
[0m19:22:45.321097 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_territory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_territory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
    );
  
[0m19:22:47.115827 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:41449523-64c6-412e-b9a3-cf97a417e057&page=queryresults
[0m19:22:47.121507 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (execute): 2023-07-01 19:22:43.337047 => 2023-07-01 19:22:47.121426
[0m19:22:47.124949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf927506d0>]}
[0m19:22:47.126653 [info ] [Thread-1 (]: 31 of 46 OK created sql table model dev_thaina_silver.stg_sales_person_quota_history  [[32mCREATE TABLE (163.0 rows, 12.6 KB processed)[0m in 3.80s]
[0m19:22:47.127953 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_person_quota_history
[0m19:22:47.129910 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m19:22:47.130491 [info ] [Thread-1 (]: 35 of 46 START sql table model dev_thaina_intermediate.int_address ............. [RUN]
[0m19:22:47.131970 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m19:22:47.132535 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m19:22:47.138993 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m19:22:47.140580 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-07-01 19:22:47.133068 => 2023-07-01 19:22:47.140415
[0m19:22:47.144516 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m19:22:47.148979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:47.623293 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:58e4c4dc-f51c-463b-81c5-a38aefbea360&page=queryresults
[0m19:22:47.627252 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_reason (execute): 2023-07-01 19:22:43.545890 => 2023-07-01 19:22:47.627156
[0m19:22:47.628511 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9055aef0>]}
[0m19:22:47.629395 [info ] [Thread-2 (]: 32 of 46 OK created sql table model dev_thaina_silver.stg_sales_reason ......... [[32mCREATE TABLE (10.0 rows, 305.0 Bytes processed)[0m in 4.10s]
[0m19:22:47.632690 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_reason
[0m19:22:47.633838 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_product
[0m19:22:47.634901 [info ] [Thread-2 (]: 36 of 46 START sql table model dev_thaina_intermediate.int_product ............. [RUN]
[0m19:22:47.636964 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m19:22:47.637817 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_product
[0m19:22:47.643840 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m19:22:47.644385 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-07-01 19:22:47.638219 => 2023-07-01 19:22:47.644308
[0m19:22:47.644694 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.int_product
[0m19:22:47.653914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:47.703481 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e0b0d131-9dba-470d-b024-9723236cb1a1&page=queryresults
[0m19:22:47.707449 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (execute): 2023-07-01 19:22:43.720344 => 2023-07-01 19:22:47.707341
[0m19:22:47.708543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf904956c0>]}
[0m19:22:47.709221 [info ] [Thread-3 (]: 33 of 46 OK created sql table model dev_thaina_silver.stg_sales_tax_rate ....... [[32mCREATE TABLE (29.0 rows, 2.6 KB processed)[0m in 4.00s]
[0m19:22:47.709978 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_tax_rate
[0m19:22:47.710523 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_sales
[0m19:22:47.711070 [info ] [Thread-3 (]: 37 of 46 START sql table model dev_thaina_intermediate.int_sales ............... [RUN]
[0m19:22:47.712320 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m19:22:47.712959 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_sales
[0m19:22:47.718002 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m19:22:47.718727 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 19:22:47.713338 => 2023-07-01 19:22:47.718595
[0m19:22:47.719162 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.int_sales
[0m19:22:47.722394 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:47.879197 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9e594b50-e06c-4608-8788-3cab17aaee74&page=queryresults
[0m19:22:47.882890 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_territory (execute): 2023-07-01 19:22:43.868107 => 2023-07-01 19:22:47.882802
[0m19:22:47.885954 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eafa30>]}
[0m19:22:47.887666 [info ] [Thread-4 (]: 34 of 46 OK created sql table model dev_thaina_silver.stg_sales_territory ...... [[32mCREATE TABLE (10.0 rows, 925.0 Bytes processed)[0m in 4.05s]
[0m19:22:47.889685 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_territory
[0m19:22:47.890521 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_reason
[0m19:22:47.891788 [info ] [Thread-4 (]: 38 of 46 START sql table model dev_thaina_intermediate.int_reason .............. [RUN]
[0m19:22:47.894397 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_reason'
[0m19:22:47.894959 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_reason
[0m19:22:47.899450 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_reason"
[0m19:22:47.900169 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_reason (compile): 2023-07-01 19:22:47.895515 => 2023-07-01 19:22:47.900063
[0m19:22:47.900662 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.int_reason
[0m19:22:47.910502 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:48.091906 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m19:22:48.092782 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, contact_type_worker as (
	select  * 
    from  `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type` 
)

, union_person_addres as (
    select
        business_entity_address.address_id
        , business_entity_id
        , business_entity_address.address_type_id
        , concat(address_line1, ' ', ifnull('',address_line2), ' ', postal_code) as address
        , city
        , state_province_id
        , address_type_name
    from business_entity_address
    left join address
    on address.address_id = business_entity_address.address_id
   	left join address_type
   	on address_type.address_type_id = business_entity_address.address_type_id
)

, union_contact_type as (
	select 
		union_person_addres.*
		, person_id as worker_id
		, contact_type_worker.contact_type_id 
		, contact_type_name as contact_type_name_worker
	from union_person_addres
	left join business_entity_contact
	on business_entity_contact.business_entity_id = union_person_addres.business_entity_id 
	left join contact_type_worker
	on contact_type_worker.contact_type_id = business_entity_contact.contact_type_id
)

select * 
from union_contact_type
    );
  
[0m19:22:48.713811 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m19:22:48.714451 [debug] [Thread-2 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from subcategory
    left join product
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from category
	left join union_product_subcategory
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from model
	left join union_product_category
    on union_product_category.product_model_id = model.model_id
)

, union_product_inventory as (
    select 
        union_product_model.*
        , quantity_inventory
        , shelf
        , bin
    from inventory
    left join union_product_model
    on union_product_model.product_id = inventory.product_id
)

select * 
from union_product_inventory
    );
  
[0m19:22:48.735541 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m19:22:48.736226 [debug] [Thread-3 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, ship_method as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
    );
  
[0m19:22:48.802807 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.int_reason"
[0m19:22:48.803463 [debug] [Thread-4 (]: On model.desafioaethaina.int_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

select *
from union_reason
    );
  
[0m19:22:51.109009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:96089efb-a672-48fc-a914-6303677411b7&page=queryresults
[0m19:22:51.111572 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-07-01 19:22:47.144898 => 2023-07-01 19:22:51.111500
[0m19:22:51.112388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92750760>]}
[0m19:22:51.112891 [info ] [Thread-1 (]: 35 of 46 OK created sql table model dev_thaina_intermediate.int_address ........ [[32mCREATE TABLE (19.7k rows, 1.5 MB processed)[0m in 3.98s]
[0m19:22:51.113547 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m19:22:51.114328 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_person
[0m19:22:51.115276 [info ] [Thread-1 (]: 39 of 46 START sql table model dev_thaina_intermediate.int_person .............. [RUN]
[0m19:22:51.117305 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m19:22:51.117909 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_person
[0m19:22:51.126985 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m19:22:51.127848 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 19:22:51.118315 => 2023-07-01 19:22:51.127736
[0m19:22:51.128432 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_person
[0m19:22:51.135293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:51.487310 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:794ec1fb-18c7-485a-81b4-4843e91fc902&page=queryresults
[0m19:22:51.490902 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_reason (execute): 2023-07-01 19:22:47.901051 => 2023-07-01 19:22:51.490804
[0m19:22:51.493505 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eaf9d0>]}
[0m19:22:51.494604 [info ] [Thread-4 (]: 38 of 46 OK created sql table model dev_thaina_intermediate.int_reason ......... [[32mCREATE TABLE (27.6k rows, 432.3 KB processed)[0m in 3.60s]
[0m19:22:51.503101 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_reason
[0m19:22:51.506183 [debug] [Thread-4 (]: Began running node model.desafioaethaina.dim_address_customer
[0m19:22:51.508180 [info ] [Thread-4 (]: 40 of 46 START sql table model dev_thaina_gold.dim_address_customer ............ [RUN]
[0m19:22:51.511349 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address_customer'
[0m19:22:51.512586 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.dim_address_customer
[0m19:22:51.527043 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.dim_address_customer"
[0m19:22:51.528898 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_address_customer (compile): 2023-07-01 19:22:51.513569 => 2023-07-01 19:22:51.528650
[0m19:22:51.530587 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.dim_address_customer
[0m19:22:51.536357 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:51.768777 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:161852db-b662-4ad7-80e9-4d5703f86b57&page=queryresults
[0m19:22:51.771917 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-07-01 19:22:47.644892 => 2023-07-01 19:22:51.771833
[0m19:22:51.773276 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92744520>]}
[0m19:22:51.774598 [info ] [Thread-2 (]: 36 of 46 OK created sql table model dev_thaina_intermediate.int_product ........ [[32mCREATE TABLE (1.1k rows, 93.1 KB processed)[0m in 4.14s]
[0m19:22:51.777147 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_product
[0m19:22:51.778615 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_reasons
[0m19:22:51.782921 [info ] [Thread-2 (]: 41 of 46 START sql table model dev_thaina_gold.dim_reasons ..................... [RUN]
[0m19:22:51.787005 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_reasons'
[0m19:22:51.788458 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.dim_reasons
[0m19:22:51.799823 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.dim_reasons"
[0m19:22:51.801339 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_reasons (compile): 2023-07-01 19:22:51.789749 => 2023-07-01 19:22:51.800988
[0m19:22:51.802193 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.dim_reasons
[0m19:22:51.811515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:52.239057 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_person"
[0m19:22:52.239783 [debug] [Thread-1 (]: On model.desafioaethaina.int_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , sales_territory_year
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixed_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, sales_territory_year
		, country_region_name
		, state_province_id
		, state_province_code
		, state_province_name
	from union_customer_state_province
	where customer_id is not null

)

select * 
from change_columns_name
    );
  
[0m19:22:52.575700 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.dim_address_customer"
[0m19:22:52.576610 [debug] [Thread-4 (]: On model.desafioaethaina.dim_address_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    where worker_id is null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            address_id
            , business_entity_id
            , address_type_name
        order by address_id) as dedup_index
    from int_address
)

, address_with_sk  as (
    select
        MD5(cast(address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from address_with_sk
    );
  
[0m19:22:52.829242 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.dim_reasons"
[0m19:22:52.829843 [debug] [Thread-2 (]: On model.desafioaethaina.dim_reasons: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_reasons"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_reasons`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_reason`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_reason_id order by sales_reason_id) as dedup_index
    from int_sales
)

, reason_with_sk  as (
    select
        MD5(cast(sales_reason_id as string)) as sales_reason_fk
        , sales_order_id
        , name_reason
        , reason_type
      from deduplication_data
    where dedup_index = 1
)

select *
from reason_with_sk
    );
  
[0m19:22:54.481418 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bdbf9ca6-6299-4898-85e1-4e99391f9a81&page=queryresults
[0m19:22:54.486484 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 19:22:47.719466 => 2023-07-01 19:22:54.486347
[0m19:22:54.488288 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eaead0>]}
[0m19:22:54.489489 [info ] [Thread-3 (]: 37 of 46 OK created sql table model dev_thaina_intermediate.int_sales .......... [[32mCREATE TABLE (121.3k rows, 12.6 MB processed)[0m in 6.78s]
[0m19:22:54.490555 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_sales
[0m19:22:54.491441 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_products
[0m19:22:54.494796 [info ] [Thread-3 (]: 42 of 46 START sql table model dev_thaina_gold.dim_products .................... [RUN]
[0m19:22:54.496437 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m19:22:54.497081 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_products
[0m19:22:54.503833 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m19:22:54.504696 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-07-01 19:22:54.497528 => 2023-07-01 19:22:54.504560
[0m19:22:54.505162 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_products
[0m19:22:54.512961 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:55.511609 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5f593c50-fcd1-4c20-a045-59158315173a&page=queryresults
[0m19:22:55.516536 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_address_customer (execute): 2023-07-01 19:22:51.531324 => 2023-07-01 19:22:55.516438
[0m19:22:55.517842 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf902c44f0>]}
[0m19:22:55.518768 [info ] [Thread-4 (]: 40 of 46 OK created sql table model dev_thaina_gold.dim_address_customer ....... [[32mCREATE TABLE (18.8k rows, 1.4 MB processed)[0m in 4.01s]
[0m19:22:55.520361 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.dim_address_customer
[0m19:22:55.521145 [debug] [Thread-4 (]: Began running node model.desafioaethaina.dim_cards_type
[0m19:22:55.527118 [info ] [Thread-4 (]: 43 of 46 START sql table model dev_thaina_gold.dim_cards_type .................. [RUN]
[0m19:22:55.528536 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m19:22:55.529148 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m19:22:55.526347 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m19:22:55.536873 [debug] [Thread-3 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    where product_id is not null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
 
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1  
)

-- , select_not_null as (
--     select *
--     from prodcut_with_sk
--     where product_sk is not null
-- )

select *
from prodcut_with_sk
    );
  
[0m19:22:55.535820 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m19:22:55.541868 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 19:22:55.529547 => 2023-07-01 19:22:55.541710
[0m19:22:55.542657 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m19:22:55.552382 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:22:55.775275 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:792b272b-4a95-4b0f-a017-7399f1df239d&page=queryresults
[0m19:22:55.777851 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_reasons (execute): 2023-07-01 19:22:51.802942 => 2023-07-01 19:22:55.777789
[0m19:22:55.778595 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9055aef0>]}
[0m19:22:55.779090 [info ] [Thread-2 (]: 41 of 46 OK created sql table model dev_thaina_gold.dim_reasons ................ [[32mCREATE TABLE (7.0 rows, 880.8 KB processed)[0m in 3.99s]
[0m19:22:55.779657 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_reasons
[0m19:22:55.780272 [debug] [Thread-2 (]: Began running node model.desafioaethaina.fact_sales
[0m19:22:55.780878 [info ] [Thread-2 (]: 44 of 46 START sql table model dev_thaina_gold.fact_sales ...................... [RUN]
[0m19:22:55.781981 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m19:22:55.782381 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.fact_sales
[0m19:22:55.786166 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m19:22:55.786777 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 19:22:55.782599 => 2023-07-01 19:22:55.786680
[0m19:22:55.787155 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.fact_sales
[0m19:22:55.791011 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:56.423420 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m19:22:56.424672 [debug] [Thread-4 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
	select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            credit_card_id
            , credit_card_approval_code 
        order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        MD5(cast(credit_card_id as string)) credit_card_sk
        , card_type
        , credit_card_approval_code
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m19:22:56.674224 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m19:22:56.674905 [debug] [Thread-2 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , MD5(cast(customer_id as string)) as customer_fk
        , MD5(cast(sales_person_id as string)) as sales_person_fk
        , MD5(cast(bill_to_address_id as string)) as bill_to_address_fk
        , MD5(cast(ship_to_address_id as string)) as ship_to_address_fk
        , MD5(cast(ship_method_id as string)) as ship_method_fk
        , MD5(cast(product_id as string)) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m19:22:57.318321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6d9f125d-44f3-4d52-a47b-fbf4b2cc4f8f&page=queryresults
[0m19:22:57.322271 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (execute): 2023-07-01 19:22:51.128809 => 2023-07-01 19:22:57.322174
[0m19:22:57.323642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9043c1c0>]}
[0m19:22:57.324512 [info ] [Thread-1 (]: 39 of 46 OK created sql table model dev_thaina_intermediate.int_person ......... [[32mCREATE TABLE (358.6k rows, 1.2 MB processed)[0m in 6.21s]
[0m19:22:57.325436 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_person
[0m19:22:57.326474 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_customers
[0m19:22:57.327171 [info ] [Thread-1 (]: 45 of 46 START sql table model dev_thaina_gold.dim_customers ................... [RUN]
[0m19:22:57.330652 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m19:22:57.331286 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_customers
[0m19:22:57.339918 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m19:22:57.340796 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 19:22:57.331722 => 2023-07-01 19:22:57.340654
[0m19:22:57.341403 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_customers
[0m19:22:57.351622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:58.211540 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m19:22:58.212242 [debug] [Thread-1 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        MD5(cast(fixed_customer_id as string)) as customer_sk
        , full_name 
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m19:22:58.576823 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:83c738cd-d262-41b0-9d50-6ee87b7cf9eb&page=queryresults
[0m19:22:59.412166 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-07-01 19:22:54.505451 => 2023-07-01 19:22:59.412086
[0m19:22:59.413238 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91ea0100>]}
[0m19:22:59.413805 [info ] [Thread-3 (]: 42 of 46 OK created sql table model dev_thaina_gold.dim_products ............... [[32mCREATE TABLE (223.0 rows, 70.9 KB processed)[0m in 4.92s]
[0m19:22:59.414382 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_products
[0m19:22:59.414976 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_workers
[0m19:22:59.415729 [info ] [Thread-3 (]: 46 of 46 START sql table model dev_thaina_gold.dim_workers ..................... [RUN]
[0m19:22:59.417034 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m19:22:59.417454 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_workers
[0m19:22:59.421144 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m19:22:59.421796 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 19:22:59.417713 => 2023-07-01 19:22:59.421706
[0m19:22:59.422118 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_workers
[0m19:22:59.425641 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:59.638457 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3de93e6a-f4dd-4f32-8e2f-38aff52dec82&page=queryresults
[0m19:22:59.640849 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 19:22:55.543389 => 2023-07-01 19:22:59.640785
[0m19:22:59.641651 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91df7940>]}
[0m19:22:59.642191 [info ] [Thread-4 (]: 43 of 46 OK created sql table model dev_thaina_gold.dim_cards_type ............. [[32mCREATE TABLE (30.3k rows, 3.9 MB processed)[0m in 4.11s]
[0m19:22:59.642868 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m19:23:00.306238 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m19:23:00.306982 [debug] [Thread-3 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workers of Adventure Works"""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, worker_with_sk  as (
    select
        MD5(cast(fixed_person_id as string)) as worker_sk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m19:23:00.833237 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c6ccdd5d-b74d-4c99-a70d-e942bebad7a2&page=queryresults
[0m19:23:01.648874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c10d05d4-6fe3-4421-b668-11cbabb89f09&page=queryresults
[0m19:23:01.651102 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 19:22:57.342080 => 2023-07-01 19:23:01.651041
[0m19:23:01.651932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf90352740>]}
[0m19:23:01.652442 [info ] [Thread-1 (]: 45 of 46 OK created sql table model dev_thaina_gold.dim_customers .............. [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 4.32s]
[0m19:23:01.653058 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_customers
[0m19:23:01.682181 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 19:22:55.787385 => 2023-07-01 19:23:01.682109
[0m19:23:01.683417 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf92744520>]}
[0m19:23:01.684191 [info ] [Thread-2 (]: 44 of 46 OK created sql table model dev_thaina_gold.fact_sales ................. [[32mCREATE TABLE (121.3k rows, 14.3 MB processed)[0m in 5.90s]
[0m19:23:01.685215 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.fact_sales
[0m19:23:03.697671 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a3b1605a-02e0-4d82-b0d8-44c80bf0367f&page=queryresults
[0m19:23:04.573751 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 19:22:59.422331 => 2023-07-01 19:23:04.573676
[0m19:23:04.575134 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4241d78-e3a8-4520-97a2-c6c7d2aba09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf91eae470>]}
[0m19:23:04.575794 [info ] [Thread-3 (]: 46 of 46 OK created sql table model dev_thaina_gold.dim_workers ................ [[32mCREATE TABLE (496.0 rows, 38.2 MB processed)[0m in 5.16s]
[0m19:23:04.576629 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_workers
[0m19:23:04.579065 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:23:04.579870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:04.580285 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m19:23:04.580596 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m19:23:04.580879 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m19:23:04.581316 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m19:23:04.582090 [info ] [MainThread]: 
[0m19:23:04.582932 [info ] [MainThread]: Finished running 46 table models in 0 hours 0 minutes and 56.60 seconds (56.60s).
[0m19:23:04.586309 [debug] [MainThread]: Command end result
[0m19:23:04.856263 [info ] [MainThread]: 
[0m19:23:04.856854 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:23:04.857500 [info ] [MainThread]: 
[0m19:23:04.858273 [error] [MainThread]: [33mDatabase Error in model stg_purchase_order_detail (models/silver/purchasing/stg_purchase_order_detail.sql)[0m
[0m19:23:04.858981 [error] [MainThread]:   Unrecognized name: purchase_order_detail_id; Did you mean purchaseorderdetailid? at [16:7]
[0m19:23:04.859671 [error] [MainThread]:   compiled Code at target/run/desafioaethaina/models/silver/purchasing/stg_purchase_order_detail.sql
[0m19:23:04.860474 [info ] [MainThread]: 
[0m19:23:04.861240 [info ] [MainThread]: Done. PASS=45 WARN=0 ERROR=1 SKIP=0 TOTAL=46
[0m19:23:04.862206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf901c5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf901c7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf901c4d30>]}
[0m19:23:04.862855 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:24:05.868417 | 6466f020-6bfa-4b99-9803-fd5c1c98900c ==============================
[0m19:24:05.868417 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:24:05.870302 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_purchase_order_detail'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:24:05.870898 [debug] [MainThread]: Tracking: tracking
[0m19:24:05.872660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5368c894b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5368c88970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5368c89300>]}
[0m19:24:05.928624 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:24:06.074341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:24:06.075182 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/silver/purchasing/stg_purchase_order_detail.sql
[0m19:24:06.097927 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_detail.sql
[0m19:24:06.137991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6466f020-6bfa-4b99-9803-fd5c1c98900c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536810d8d0>]}
[0m19:24:06.161985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6466f020-6bfa-4b99-9803-fd5c1c98900c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5368b5ff10>]}
[0m19:24:06.162491 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:24:06.162934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6466f020-6bfa-4b99-9803-fd5c1c98900c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5368a03ca0>]}
[0m19:24:06.166658 [info ] [MainThread]: 
[0m19:24:06.169042 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:24:06.170747 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:24:06.171544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:07.210370 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:24:07.211063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:07.212061 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:24:07.213086 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:24:07.214102 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:24:07.214445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:07.249291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:07.249919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:08.269977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6466f020-6bfa-4b99-9803-fd5c1c98900c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5368c894b0>]}
[0m19:24:08.270952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:24:08.271559 [info ] [MainThread]: 
[0m19:24:08.276997 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m19:24:08.277590 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_silver.stg_purchase_order_detail ....... [RUN]
[0m19:24:08.278691 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m19:24:08.279275 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m19:24:08.283562 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m19:24:08.284945 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-07-01 19:24:08.279582 => 2023-07-01 19:24:08.284757
[0m19:24:08.285903 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchase_order_detail
[0m19:24:08.326432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:09.258343 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_detail"
[0m19:24:09.259604 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchase_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , purchaseorderdetailid as purchase_order_detail_id
    , cast(duedate as timestamp) as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m19:24:12.719320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:08cd2522-e314-4d48-bd9e-18169e6e5810&page=queryresults
[0m19:24:12.739022 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (execute): 2023-07-01 19:24:08.286476 => 2023-07-01 19:24:12.738950
[0m19:24:12.739954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6466f020-6bfa-4b99-9803-fd5c1c98900c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536812d8a0>]}
[0m19:24:12.740532 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_silver.stg_purchase_order_detail .. [[32mCREATE TABLE (8.8k rows, 837.9 KB processed)[0m in 4.46s]
[0m19:24:12.742859 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m19:24:12.745024 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:24:12.746194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:12.746703 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m19:24:12.747149 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m19:24:12.747596 [debug] [MainThread]: Connection 'model.desafioaethaina.stg_purchase_order_detail' was properly closed.
[0m19:24:12.748015 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m19:24:12.748526 [info ] [MainThread]: 
[0m19:24:12.749391 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m19:24:12.750364 [debug] [MainThread]: Command end result
[0m19:24:12.793533 [info ] [MainThread]: 
[0m19:24:12.794978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:12.796637 [info ] [MainThread]: 
[0m19:24:12.799147 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:24:12.800950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536cfc95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5368b18400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5368a128f0>]}
[0m19:24:12.803146 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:24:19.848552 | b835942d-12d1-4912-907a-ca22f65b0036 ==============================
[0m19:24:19.848552 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:24:19.850605 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:24:19.851139 [debug] [MainThread]: Tracking: tracking
[0m19:24:19.853401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84eb8ece0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84eb8c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84eb8ed10>]}
[0m19:24:19.909055 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:24:20.071578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:20.071955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:20.087180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b835942d-12d1-4912-907a-ca22f65b0036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84e96c190>]}
[0m19:24:20.112216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b835942d-12d1-4912-907a-ca22f65b0036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84e92d810>]}
[0m19:24:20.112744 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:24:20.113214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b835942d-12d1-4912-907a-ca22f65b0036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84e92d870>]}
[0m19:24:20.122819 [info ] [MainThread]: 
[0m19:24:20.126894 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:24:20.137769 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:24:20.139173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:24:20.140122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:20.141319 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:24:20.142902 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:24:20.143475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:20.144726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:20.188000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:21.463010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b835942d-12d1-4912-907a-ca22f65b0036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84eb8e140>]}
[0m19:24:21.463897 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:24:21.464419 [info ] [MainThread]: 
[0m19:24:21.469697 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:24:21.470589 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:24:21.470948 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:24:21.471837 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:24:21.471286 [info ] [Thread-1 (]: 1 of 13 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m19:24:21.472692 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_products_product_sk ............................ [RUN]
[0m19:24:21.475626 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m19:24:21.473108 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m19:24:21.474399 [info ] [Thread-4 (]: 4 of 13 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m19:24:21.477638 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m19:24:21.478576 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:24:21.480256 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m19:24:21.495308 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:24:21.481653 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m19:24:21.482273 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:24:21.514031 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:24:21.529826 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m19:24:21.559030 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m19:24:21.576589 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m19:24:21.580880 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m19:24:21.581865 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 19:24:21.482844 => 2023-07-01 19:24:21.581770
[0m19:24:21.582202 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 19:24:21.533244 => 2023-07-01 19:24:21.582132
[0m19:24:21.582580 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:24:21.582917 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 19:24:21.549690 => 2023-07-01 19:24:21.582842
[0m19:24:21.583337 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:24:21.583766 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 19:24:21.496475 => 2023-07-01 19:24:21.583695
[0m19:24:21.599818 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:24:21.613840 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m19:24:21.617441 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m19:24:21.617916 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:24:21.622611 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m19:24:21.628396 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m19:24:21.629461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:21.629823 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:24:21.630883 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:24:21.630530 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:24:21.634339 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m19:24:21.638155 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m19:24:21.640471 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m19:24:21.642384 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m19:24:24.240508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:91338308-1992-491f-8663-f5c6fb6ab14f&page=queryresults
[0m19:24:24.242476 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 19:24:21.583958 => 2023-07-01 19:24:24.242387
[0m19:24:24.243405 [info ] [Thread-1 (]: 1 of 13 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.77s]
[0m19:24:24.246994 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:24:24.247877 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m19:24:24.248534 [info ] [Thread-1 (]: 5 of 13 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_  [RUN]
[0m19:24:24.249960 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57'
[0m19:24:24.250541 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m19:24:24.267513 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5dd596da-2f55-4b53-bcc1-c68ad9aa9286&page=queryresults
[0m19:24:24.269505 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 19:24:21.623623 => 2023-07-01 19:24:24.269303
[0m19:24:24.282636 [info ] [Thread-3 (]: 3 of 13 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 2.80s]
[0m19:24:24.280444 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:26a56f9f-5955-4149-9c98-86d979c95bc3&page=queryresults
[0m19:24:24.278992 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57"
[0m19:24:24.283951 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:24:24.285445 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 19:24:21.614228 => 2023-07-01 19:24:24.285314
[0m19:24:24.288026 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:24:24.295750 [info ] [Thread-3 (]: 6 of 13 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m19:24:24.294911 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57 (compile): 2023-07-01 19:24:24.250954 => 2023-07-01 19:24:24.294660
[0m19:24:24.298607 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m19:24:24.292985 [info ] [Thread-2 (]: 2 of 13 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 2.82s]
[0m19:24:24.299919 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m19:24:24.301321 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:24:24.302798 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:24:24.312689 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57"
[0m19:24:24.335559 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:24:24.338706 [info ] [Thread-2 (]: 7 of 13 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m19:24:24.337884 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m19:24:24.339627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:24.340885 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m19:24:24.344780 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:24.345352 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 19:24:24.313516 => 2023-07-01 19:24:24.345258
[0m19:24:24.345745 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:24:24.390242 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:24:24.403804 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m19:24:24.410954 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m19:24:24.412927 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:24:24.413495 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 19:24:24.393015 => 2023-07-01 19:24:24.413354
[0m19:24:24.416654 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:24.417188 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:24:24.472622 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:35eaf031-b02e-4f83-905f-582b0eff091a&page=queryresults
[0m19:24:24.479457 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 19:24:21.618187 => 2023-07-01 19:24:24.478984
[0m19:24:24.481886 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 3.00s]
[0m19:24:24.483790 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:24:24.486565 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:24:24.477801 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m19:24:24.492089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:24:24.495312 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:24.490544 [info ] [Thread-4 (]: 8 of 13 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m19:24:24.537937 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m19:24:24.538615 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:24:24.564829 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m19:24:24.565966 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 19:24:24.539168 => 2023-07-01 19:24:24.565821
[0m19:24:24.566739 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:24:24.575111 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m19:24:24.576214 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:24:24.578481 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:27.257528 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9edabc31-2565-4da7-bac3-da537d215f9a&page=queryresults
[0m19:24:27.258754 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4c270b1c-9d02-4cac-9ef1-8ae1001eee42&page=queryresults
[0m19:24:27.259440 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d01bfe84-ceff-4a4e-967f-7d78cc269fea&page=queryresults
[0m19:24:27.260229 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 19:24:24.404283 => 2023-07-01 19:24:27.260142
[0m19:24:27.260921 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e5389d80-c3e6-4c40-ba6f-bb1b8586868e&page=queryresults
[0m19:24:27.261756 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 19:24:24.461985 => 2023-07-01 19:24:27.261661
[0m19:24:27.262833 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57 (execute): 2023-07-01 19:24:24.303317 => 2023-07-01 19:24:27.262659
[0m19:24:27.264123 [info ] [Thread-3 (]: 6 of 13 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.97s]
[0m19:24:27.266374 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 19:24:24.567327 => 2023-07-01 19:24:27.266185
[0m19:24:27.267916 [error] [Thread-2 (]: 7 of 13 FAIL 9081 relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[31mFAIL 9081[0m in 2.93s]
[0m19:24:27.269475 [error] [Thread-1 (]: 5 of 13 FAIL 60919 relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_  [[31mFAIL 60919[0m in 3.02s]
[0m19:24:27.270968 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:24:27.273274 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:24:27.272235 [info ] [Thread-4 (]: 8 of 13 PASS relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[32mPASS[0m in 2.73s]
[0m19:24:27.275532 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m19:24:27.276287 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m19:24:27.277112 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:24:27.277578 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:24:27.277973 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:24:27.278516 [info ] [Thread-3 (]: 9 of 13 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_  [RUN]
[0m19:24:27.279709 [info ] [Thread-2 (]: 10 of 13 START test unique_dim_dates_metric_date ............................... [RUN]
[0m19:24:27.281130 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:24:27.281912 [info ] [Thread-1 (]: 11 of 13 START test unique_dim_products_product_sk ............................. [RUN]
[0m19:24:27.283330 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b'
[0m19:24:27.284183 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m19:24:27.284654 [info ] [Thread-4 (]: 12 of 13 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m19:24:27.286410 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m19:24:27.287210 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m19:24:27.287837 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:24:27.288999 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m19:24:27.289622 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:24:27.303735 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b"
[0m19:24:27.316129 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:24:27.345098 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m19:24:27.348789 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m19:24:27.359853 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 19:24:27.304152 => 2023-07-01 19:24:27.359694
[0m19:24:27.361512 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b (compile): 2023-07-01 19:24:27.289949 => 2023-07-01 19:24:27.361398
[0m19:24:27.365347 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:24:27.369576 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 19:24:27.317205 => 2023-07-01 19:24:27.369221
[0m19:24:27.386313 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m19:24:27.385211 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m19:24:27.394419 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m19:24:27.395187 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:24:27.401994 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b"
[0m19:24:27.403249 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 19:24:27.349385 => 2023-07-01 19:24:27.403013
[0m19:24:27.405008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:24:27.413031 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m19:24:27.420478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:27.418969 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:24:27.414554 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:24:27.421546 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:24:27.425321 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:24:27.427674 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:27.434700 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m19:24:27.550892 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:24:27.553379 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:24:30.599338 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5d510914-5867-4312-b11e-fa53e9ed5131&page=queryresults
[0m19:24:30.600219 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 19:24:27.388159 => 2023-07-01 19:24:30.600135
[0m19:24:30.601027 [info ] [Thread-2 (]: 10 of 13 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 3.32s]
[0m19:24:30.601597 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:24:30.602218 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:24:30.602840 [info ] [Thread-2 (]: 13 of 13 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m19:24:30.604645 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m19:24:30.605316 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:24:30.616677 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9c3800b4-cc6a-49d6-8960-e05ca62b2236&page=queryresults
[0m19:24:30.618311 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m19:24:30.619819 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 19:24:27.428154 => 2023-07-01 19:24:30.619669
[0m19:24:30.625668 [info ] [Thread-4 (]: 12 of 13 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 3.34s]
[0m19:24:30.626685 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:24:30.627770 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 19:24:30.605742 => 2023-07-01 19:24:30.627595
[0m19:24:30.628618 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:24:30.643613 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m19:24:30.644924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:24:30.648144 [debug] [Thread-2 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:24:30.698821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:deb7a9a3-1201-4910-acef-07798ad46b67&page=queryresults
[0m19:24:30.708906 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 19:24:27.405973 => 2023-07-01 19:24:30.708751
[0m19:24:30.710953 [info ] [Thread-1 (]: 11 of 13 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 3.43s]
[0m19:24:30.711982 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:24:30.977068 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bb429951-23dc-40e9-9308-6a5075d11127&page=queryresults
[0m19:24:30.978180 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b (execute): 2023-07-01 19:24:27.395718 => 2023-07-01 19:24:30.978068
[0m19:24:30.980489 [error] [Thread-3 (]: 9 of 13 FAIL 60919 relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_  [[31mFAIL 60919[0m in 3.70s]
[0m19:24:30.981240 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m19:24:33.194373 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e79a70a8-83dc-480d-a660-7971979b36e0&page=queryresults
[0m19:24:33.195296 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 19:24:30.629161 => 2023-07-01 19:24:33.195213
[0m19:24:33.196163 [info ] [Thread-2 (]: 13 of 13 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.59s]
[0m19:24:33.197365 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:24:33.201882 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:24:33.202835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:33.203175 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m19:24:33.203466 [debug] [MainThread]: Connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b' was properly closed.
[0m19:24:33.203775 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m19:24:33.204056 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m19:24:33.204404 [info ] [MainThread]: 
[0m19:24:33.204872 [info ] [MainThread]: Finished running 13 tests in 0 hours 0 minutes and 13.08 seconds (13.08s).
[0m19:24:33.206192 [debug] [MainThread]: Command end result
[0m19:24:33.245081 [info ] [MainThread]: 
[0m19:24:33.246661 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:24:33.247858 [info ] [MainThread]: 
[0m19:24:33.248409 [error] [MainThread]: [31mFailure in test relationships_fact_sales_product_fk__product_sk__ref_dim_products_ (models/gold/fact_sales.yml)[0m
[0m19:24:33.248842 [error] [MainThread]:   Got 9081 results, configured to fail if != 0
[0m19:24:33.249416 [info ] [MainThread]: 
[0m19:24:33.249987 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_f765900a1937b39c2370e1a1d08c08f5.sql
[0m19:24:33.250629 [info ] [MainThread]: 
[0m19:24:33.251722 [error] [MainThread]: [31mFailure in test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_ (models/gold/fact_sales.yml)[0m
[0m19:24:33.252540 [error] [MainThread]:   Got 60919 results, configured to fail if != 0
[0m19:24:33.253081 [info ] [MainThread]: 
[0m19:24:33.253687 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_287401818be50308bcec300fd657896a.sql
[0m19:24:33.254617 [info ] [MainThread]: 
[0m19:24:33.256163 [error] [MainThread]: [31mFailure in test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_ (models/gold/fact_sales.yml)[0m
[0m19:24:33.257445 [error] [MainThread]:   Got 60919 results, configured to fail if != 0
[0m19:24:33.258371 [info ] [MainThread]: 
[0m19:24:33.259759 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_05eedbb9d22f0bc41e92866ce765589c.sql
[0m19:24:33.261384 [info ] [MainThread]: 
[0m19:24:33.262497 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=3 SKIP=0 TOTAL=13
[0m19:24:33.264270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84e6cb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84eb8e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84e6b78e0>]}
[0m19:24:33.265332 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:46:38.024002 | 8c730092-aab2-456c-addd-9226193c8f6b ==============================
[0m19:46:38.024002 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:46:38.027536 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_product+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:46:38.028073 [debug] [MainThread]: Tracking: tracking
[0m19:46:38.030834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80b470820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80b470f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80b4707f0>]}
[0m19:46:38.103261 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:46:38.259849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:46:38.260701 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/intermediate/int_product.sql
[0m19:46:38.284516 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m19:46:38.327038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c730092-aab2-456c-addd-9226193c8f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80a8f5750>]}
[0m19:46:38.353073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c730092-aab2-456c-addd-9226193c8f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80affe9e0>]}
[0m19:46:38.353587 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:46:38.353981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c730092-aab2-456c-addd-9226193c8f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80afebb50>]}
[0m19:46:38.359319 [info ] [MainThread]: 
[0m19:46:38.361860 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:38.363509 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:46:38.364463 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m19:46:38.364795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:38.365290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:39.600891 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:46:39.601564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:39.602660 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:46:39.603244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:39.604054 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:46:39.639169 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:46:39.677158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:39.641589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:41.066792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c730092-aab2-456c-addd-9226193c8f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80b4704c0>]}
[0m19:46:41.068323 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:46:41.068795 [info ] [MainThread]: 
[0m19:46:41.073577 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_product
[0m19:46:41.074314 [info ] [Thread-1 (]: 1 of 2 START sql table model dev_thaina_intermediate.int_product ............... [RUN]
[0m19:46:41.075749 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m19:46:41.076138 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_product
[0m19:46:41.083311 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m19:46:41.084335 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-07-01 19:46:41.076360 => 2023-07-01 19:46:41.084196
[0m19:46:41.085114 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_product
[0m19:46:41.125868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:42.061599 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m19:46:42.062638 [debug] [Thread-1 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from product
    left join subcategory
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from union_product_subcategory
	left join category
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from union_product_category
	left join model
    on union_product_category.product_model_id = model.model_id
)

, union_product_inventory as (
    select 
        union_product_model.*
        , quantity_inventory
        , shelf
        , bin
    from union_product_model
    left join inventory
    on union_product_model.product_id = inventory.product_id
)

select * 
from union_product_inventory
    );
  
[0m19:46:46.390295 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1726f1c8-7233-4f67-ac6d-0315692ab15a&page=queryresults
[0m19:46:46.409744 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-07-01 19:46:41.085950 => 2023-07-01 19:46:46.409676
[0m19:46:46.410533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c730092-aab2-456c-addd-9226193c8f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80a921420>]}
[0m19:46:46.411039 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev_thaina_intermediate.int_product .......... [[32mCREATE TABLE (1.1k rows, 93.1 KB processed)[0m in 5.34s]
[0m19:46:46.413230 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_product
[0m19:46:46.414246 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_products
[0m19:46:46.414690 [info ] [Thread-3 (]: 2 of 2 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m19:46:46.415698 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m19:46:46.416134 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_products
[0m19:46:46.420549 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m19:46:46.421553 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-07-01 19:46:46.416374 => 2023-07-01 19:46:46.421432
[0m19:46:46.421964 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_products
[0m19:46:46.427136 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:46:47.279058 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m19:46:47.279746 [debug] [Thread-3 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    where product_id is not null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
 
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1  
)

-- , select_not_null as (
--     select *
--     from prodcut_with_sk
--     where product_sk is not null
-- )

select *
from prodcut_with_sk
    );
  
[0m19:46:50.025326 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:fe204b27-c44c-4772-84a0-3cf5bbbdbfbd&page=queryresults
[0m19:46:50.890345 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-07-01 19:46:46.422188 => 2023-07-01 19:46:50.890260
[0m19:46:50.891350 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c730092-aab2-456c-addd-9226193c8f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80a77e5c0>]}
[0m19:46:50.891939 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev_thaina_gold.dim_products ................. [[32mCREATE TABLE (504.0 rows, 111.1 KB processed)[0m in 4.48s]
[0m19:46:50.892658 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_products
[0m19:46:50.894791 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:50.895775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:50.896084 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m19:46:50.896344 [debug] [MainThread]: Connection 'model.desafioaethaina.int_product' was properly closed.
[0m19:46:50.896585 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_products' was properly closed.
[0m19:46:50.897010 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m19:46:50.897513 [info ] [MainThread]: 
[0m19:46:50.898367 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m19:46:50.899625 [debug] [MainThread]: Command end result
[0m19:46:50.932688 [info ] [MainThread]: 
[0m19:46:50.933673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:46:50.934713 [info ] [MainThread]: 
[0m19:46:50.935698 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:46:50.937359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80afbfa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80b473130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80b28e4a0>]}
[0m19:46:50.938396 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 19:47:09.748386 | 828ef252-bf66-47f5-a5bf-cbdcc37b99c6 ==============================
[0m19:47:09.748386 [info ] [MainThread]: Running with dbt=1.4.6
[0m19:47:09.750605 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:47:09.751389 [debug] [MainThread]: Tracking: tracking
[0m19:47:09.753680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe354a773a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe354a766e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe354a76e30>]}
[0m19:47:09.807506 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m19:47:09.983894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:09.984382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:10.001285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '828ef252-bf66-47f5-a5bf-cbdcc37b99c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3546580d0>]}
[0m19:47:10.032852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '828ef252-bf66-47f5-a5bf-cbdcc37b99c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe354619750>]}
[0m19:47:10.033356 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m19:47:10.033900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828ef252-bf66-47f5-a5bf-cbdcc37b99c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3546197b0>]}
[0m19:47:10.038462 [info ] [MainThread]: 
[0m19:47:10.040769 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:47:10.048109 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m19:47:10.049451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m19:47:10.050253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:10.052039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m19:47:10.052834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:10.054372 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m19:47:10.055441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:10.062218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:11.412736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828ef252-bf66-47f5-a5bf-cbdcc37b99c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe354a76530>]}
[0m19:47:11.413758 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:47:11.414494 [info ] [MainThread]: 
[0m19:47:11.419353 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:47:11.419742 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:47:11.420290 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:47:11.420650 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:47:11.420962 [info ] [Thread-1 (]: 1 of 13 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m19:47:11.421687 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_products_product_sk ............................ [RUN]
[0m19:47:11.422673 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m19:47:11.423454 [info ] [Thread-4 (]: 4 of 13 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m19:47:11.424797 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m19:47:11.425614 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m19:47:11.426253 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m19:47:11.426859 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m19:47:11.427245 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:47:11.427682 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:47:11.428009 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:47:11.428321 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:47:11.456119 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m19:47:11.482018 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m19:47:11.493484 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m19:47:11.506141 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m19:47:11.506910 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 19:47:11.428589 => 2023-07-01 19:47:11.506746
[0m19:47:11.508219 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 19:47:11.460633 => 2023-07-01 19:47:11.508025
[0m19:47:11.508825 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 19:47:11.482617 => 2023-07-01 19:47:11.508720
[0m19:47:11.510004 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:47:11.510911 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:47:11.511469 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 19:47:11.450409 => 2023-07-01 19:47:11.511285
[0m19:47:11.512198 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:47:11.552943 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m19:47:11.554834 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m19:47:11.555247 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:47:11.558928 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m19:47:11.562610 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m19:47:11.563136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:11.563742 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:47:11.564817 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:47:11.565334 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:11.568059 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m19:47:11.569962 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m19:47:11.571640 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m19:47:11.573216 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m19:47:13.909973 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c0fc5209-844f-4ce7-8d5a-7e6aa1e5ab52&page=queryresults
[0m19:47:13.912040 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 19:47:11.512587 => 2023-07-01 19:47:13.911953
[0m19:47:13.912976 [info ] [Thread-1 (]: 1 of 13 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.49s]
[0m19:47:13.915415 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m19:47:13.916031 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m19:47:13.916569 [info ] [Thread-1 (]: 5 of 13 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_  [RUN]
[0m19:47:13.917879 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57'
[0m19:47:13.918357 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m19:47:13.935780 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57"
[0m19:47:13.937443 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57 (compile): 2023-07-01 19:47:13.918703 => 2023-07-01 19:47:13.937127
[0m19:47:13.938502 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m19:47:13.946178 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57"
[0m19:47:13.955708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:13.962036 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:47:14.225346 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:fe0978d0-04f2-43c7-af85-867877909c25&page=queryresults
[0m19:47:14.226320 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 19:47:11.533366 => 2023-07-01 19:47:14.226222
[0m19:47:14.227262 [info ] [Thread-3 (]: 3 of 13 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 2.80s]
[0m19:47:14.228168 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m19:47:14.228967 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:47:14.229689 [info ] [Thread-3 (]: 6 of 13 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m19:47:14.231478 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m19:47:14.232083 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:47:14.248222 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m19:47:14.249093 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:278e7aad-8467-4c7d-a735-4077ace76597&page=queryresults
[0m19:47:14.250288 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 19:47:11.555632 => 2023-07-01 19:47:14.250190
[0m19:47:14.253105 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 19:47:14.232497 => 2023-07-01 19:47:14.252855
[0m19:47:14.254239 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:47:14.252432 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.83s]
[0m19:47:14.264436 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m19:47:14.265408 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m19:47:14.266476 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:47:14.268654 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:47:14.272604 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:47:14.267621 [info ] [Thread-4 (]: 7 of 13 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m19:47:14.312306 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m19:47:14.313942 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:47:14.332421 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m19:47:14.336794 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 19:47:14.314603 => 2023-07-01 19:47:14.336609
[0m19:47:14.337546 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:47:14.343033 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m19:47:14.343704 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:47:14.345511 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:47:14.448108 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5af09ce3-0725-4f2a-944a-b68adb73ac89&page=queryresults
[0m19:47:14.449521 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 19:47:11.559798 => 2023-07-01 19:47:14.449381
[0m19:47:14.451065 [info ] [Thread-2 (]: 2 of 13 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 3.03s]
[0m19:47:14.454159 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m19:47:14.459951 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:47:14.460886 [info ] [Thread-2 (]: 8 of 13 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m19:47:14.463431 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m19:47:14.464057 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:47:14.505847 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m19:47:14.506807 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 19:47:14.464487 => 2023-07-01 19:47:14.506668
[0m19:47:14.507576 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:47:14.513457 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m19:47:14.514917 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:14.518481 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:47:16.509326 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e0f68143-1b4e-46bc-8981-147336a3a05d&page=queryresults
[0m19:47:16.510706 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57 (execute): 2023-07-01 19:47:13.938939 => 2023-07-01 19:47:16.510528
[0m19:47:16.511747 [error] [Thread-1 (]: 5 of 13 FAIL 60919 relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_  [[31mFAIL 60919[0m in 2.59s]
[0m19:47:16.512487 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m19:47:16.513329 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m19:47:16.514060 [info ] [Thread-1 (]: 9 of 13 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_  [RUN]
[0m19:47:16.515758 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b'
[0m19:47:16.516387 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m19:47:16.529878 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b"
[0m19:47:16.530978 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b (compile): 2023-07-01 19:47:16.516697 => 2023-07-01 19:47:16.530818
[0m19:47:16.532148 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m19:47:16.539997 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b"
[0m19:47:16.540989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:16.544872 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:47:16.871132 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:139035f3-2bc3-43c9-aa64-0316c4cd29ea&page=queryresults
[0m19:47:16.871958 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 19:47:14.508017 => 2023-07-01 19:47:16.871872
[0m19:47:16.872740 [info ] [Thread-2 (]: 8 of 13 PASS relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[32mPASS[0m in 2.41s]
[0m19:47:16.873261 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m19:47:16.873887 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:47:16.874437 [info ] [Thread-2 (]: 10 of 13 START test unique_dim_dates_metric_date ............................... [RUN]
[0m19:47:16.875558 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m19:47:16.875933 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:47:16.888350 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m19:47:16.889555 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 19:47:16.876163 => 2023-07-01 19:47:16.889422
[0m19:47:16.890102 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:47:16.893703 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m19:47:16.896683 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:16.901925 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:47:16.954986 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b784da1b-f363-4009-9135-75c3d685a429&page=queryresults
[0m19:47:16.957000 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 19:47:14.255985 => 2023-07-01 19:47:16.956700
[0m19:47:16.959280 [info ] [Thread-3 (]: 6 of 13 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.73s]
[0m19:47:16.961254 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m19:47:16.962180 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:47:16.963585 [info ] [Thread-3 (]: 11 of 13 START test unique_dim_products_product_sk ............................. [RUN]
[0m19:47:16.965330 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m19:47:16.966058 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:47:16.979088 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m19:47:16.980515 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 19:47:16.966545 => 2023-07-01 19:47:16.980287
[0m19:47:16.981338 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:47:16.991491 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m19:47:16.993481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:47:16.998909 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:47:17.072600 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:09fc3162-7c26-4c99-a55c-c4352c8fe506&page=queryresults
[0m19:47:17.073976 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 19:47:14.337964 => 2023-07-01 19:47:17.073826
[0m19:47:17.075866 [info ] [Thread-4 (]: 7 of 13 PASS relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[32mPASS[0m in 2.76s]
[0m19:47:17.077463 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m19:47:17.084964 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:47:17.085802 [info ] [Thread-4 (]: 12 of 13 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m19:47:17.095518 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m19:47:17.096328 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:47:17.133625 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m19:47:17.135321 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 19:47:17.096934 => 2023-07-01 19:47:17.135045
[0m19:47:17.136428 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:47:17.146191 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m19:47:17.147921 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:47:17.151961 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:47:18.741147 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7dc36bdc-a340-4e85-8807-01822e0dbfa5&page=queryresults
[0m19:47:18.742144 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b (execute): 2023-07-01 19:47:16.533041 => 2023-07-01 19:47:18.742058
[0m19:47:18.743044 [error] [Thread-1 (]: 9 of 13 FAIL 60919 relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_  [[31mFAIL 60919[0m in 2.23s]
[0m19:47:18.743703 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m19:47:18.744545 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:47:18.745049 [info ] [Thread-1 (]: 13 of 13 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m19:47:18.746429 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m19:47:18.746883 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:47:18.753056 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m19:47:18.753712 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 19:47:18.747147 => 2023-07-01 19:47:18.753600
[0m19:47:18.754203 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:47:18.757577 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m19:47:18.758206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:18.760379 [debug] [Thread-1 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:47:19.306274 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3f447502-73e3-44eb-9a94-4fa92a467593&page=queryresults
[0m19:47:19.307518 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 19:47:16.890343 => 2023-07-01 19:47:19.307351
[0m19:47:19.308866 [info ] [Thread-2 (]: 10 of 13 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.43s]
[0m19:47:19.310467 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m19:47:19.336882 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:345aca1f-feaf-4326-95a2-c9588863365c&page=queryresults
[0m19:47:19.339193 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 19:47:17.137046 => 2023-07-01 19:47:19.339079
[0m19:47:19.340505 [info ] [Thread-4 (]: 12 of 13 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 2.25s]
[0m19:47:19.341401 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m19:47:19.714252 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:16e1fbf5-2f89-4d36-b93d-21fe54d6a20f&page=queryresults
[0m19:47:19.715068 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 19:47:16.981828 => 2023-07-01 19:47:19.714988
[0m19:47:19.715965 [info ] [Thread-3 (]: 11 of 13 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 2.75s]
[0m19:47:19.716573 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m19:47:20.805178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:098595f9-aa13-4c2a-9026-7d7b4ab2cec7&page=queryresults
[0m19:47:20.806087 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 19:47:18.754455 => 2023-07-01 19:47:20.805999
[0m19:47:20.806990 [info ] [Thread-1 (]: 13 of 13 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.06s]
[0m19:47:20.807623 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m19:47:20.809612 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:47:20.810384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:20.810727 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m19:47:20.811023 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m19:47:20.811384 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed' was properly closed.
[0m19:47:20.811957 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m19:47:20.812365 [info ] [MainThread]: 
[0m19:47:20.813074 [info ] [MainThread]: Finished running 13 tests in 0 hours 0 minutes and 10.77 seconds (10.77s).
[0m19:47:20.814691 [debug] [MainThread]: Command end result
[0m19:47:20.881139 [info ] [MainThread]: 
[0m19:47:20.884399 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:47:20.887437 [info ] [MainThread]: 
[0m19:47:20.888633 [error] [MainThread]: [31mFailure in test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_ (models/gold/fact_sales.yml)[0m
[0m19:47:20.889552 [error] [MainThread]:   Got 60919 results, configured to fail if != 0
[0m19:47:20.890383 [info ] [MainThread]: 
[0m19:47:20.891102 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_287401818be50308bcec300fd657896a.sql
[0m19:47:20.891625 [info ] [MainThread]: 
[0m19:47:20.892167 [error] [MainThread]: [31mFailure in test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_ (models/gold/fact_sales.yml)[0m
[0m19:47:20.892632 [error] [MainThread]:   Got 60919 results, configured to fail if != 0
[0m19:47:20.893243 [info ] [MainThread]: 
[0m19:47:20.893864 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_05eedbb9d22f0bc41e92866ce765589c.sql
[0m19:47:20.894475 [info ] [MainThread]: 
[0m19:47:20.895001 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=0 TOTAL=13
[0m19:47:20.895839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe354a746a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe354a764d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3546182e0>]}
[0m19:47:20.896456 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:02:17.622578 | f90fc8ff-31f9-407f-b931-23277dac90a7 ==============================
[0m20:02:17.622578 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:02:17.624702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:02:17.625402 [debug] [MainThread]: Tracking: tracking
[0m20:02:17.627215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a33a7ad40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a33a787f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a33a7a560>]}
[0m20:02:17.662347 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:02:17.816198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:02:17.817248 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address_customer.sql
[0m20:02:17.840208 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address_customer.sql
[0m20:02:17.880582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f90fc8ff-31f9-407f-b931-23277dac90a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32ed5450>]}
[0m20:02:17.905643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f90fc8ff-31f9-407f-b931-23277dac90a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a33771630>]}
[0m20:02:17.906207 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:02:17.906726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90fc8ff-31f9-407f-b931-23277dac90a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a335f7880>]}
[0m20:02:17.910650 [info ] [MainThread]: 
[0m20:02:17.913480 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:02:17.914892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m20:02:17.915850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:18.889679 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m20:02:18.890291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:18.891140 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m20:02:18.924609 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m20:02:18.926314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:18.927617 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m20:02:18.928284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:18.928817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:20.015073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90fc8ff-31f9-407f-b931-23277dac90a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a338947f0>]}
[0m20:02:20.016203 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:02:20.016911 [info ] [MainThread]: 
[0m20:02:20.021901 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m20:02:20.022560 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_intermediate.int_address ............... [RUN]
[0m20:02:20.023815 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m20:02:20.024260 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m20:02:20.031557 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m20:02:20.032442 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-07-01 20:02:20.024523 => 2023-07-01 20:02:20.032282
[0m20:02:20.033127 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m20:02:20.062193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:20.958375 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m20:02:20.959806 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, contact_type_worker as (
	select  * 
    from  `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type` 
)

, union_person_addres as (
    select
        business_entity_address.address_id
        , business_entity_id
        , business_entity_address.address_type_id
        , concat(address_line1, ' ', ifnull('',address_line2), ' ', postal_code) as address
        , city
        , state_province_id
        , address_type_name
    from business_entity_address
    left join address
    on address.address_id = business_entity_address.address_id
   	left join address_type
   	on address_type.address_type_id = business_entity_address.address_type_id
)

, union_contact_type as (
	select 
		union_person_addres.*
		, person_id as worker_id
		, contact_type_worker.contact_type_id 
		, contact_type_name as contact_type_name_worker
	from union_person_addres
	left join business_entity_contact
	on business_entity_contact.business_entity_id = union_person_addres.business_entity_id 
	left join contact_type_worker
	on contact_type_worker.contact_type_id = business_entity_contact.contact_type_id
)

select * 
from union_contact_type
    );
  
[0m20:02:24.411519 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ba2c8299-cc81-4a8b-ab5a-183e3d7cdf34&page=queryresults
[0m20:02:24.436192 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-07-01 20:02:20.033555 => 2023-07-01 20:02:24.436124
[0m20:02:24.436986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90fc8ff-31f9-407f-b931-23277dac90a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32f29210>]}
[0m20:02:24.437510 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_intermediate.int_address .......... [[32mCREATE TABLE (19.7k rows, 1.5 MB processed)[0m in 4.41s]
[0m20:02:24.439813 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m20:02:24.441468 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:02:24.442213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:24.442530 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m20:02:24.442876 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m20:02:24.443176 [debug] [MainThread]: Connection 'model.desafioaethaina.int_address' was properly closed.
[0m20:02:24.443506 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m20:02:24.443850 [info ] [MainThread]: 
[0m20:02:24.444402 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m20:02:24.445169 [debug] [MainThread]: Command end result
[0m20:02:24.485061 [info ] [MainThread]: 
[0m20:02:24.486073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:24.487192 [info ] [MainThread]: 
[0m20:02:24.487948 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:02:24.489592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a37b515d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a337716f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a33771690>]}
[0m20:02:24.490695 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:02:31.367560 | 99a2b43b-a237-4447-8b45-c47b54e99f3d ==============================
[0m20:02:31.367560 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:02:31.369947 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:02:31.370670 [debug] [MainThread]: Tracking: tracking
[0m20:02:31.372440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454ab86560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454ab847c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454ab86470>]}
[0m20:02:31.417456 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:02:31.557541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:02:31.557925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:02:31.572515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99a2b43b-a237-4447-8b45-c47b54e99f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454a964190>]}
[0m20:02:31.597430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99a2b43b-a237-4447-8b45-c47b54e99f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454a925810>]}
[0m20:02:31.597998 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:02:31.598501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a2b43b-a237-4447-8b45-c47b54e99f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454a9259c0>]}
[0m20:02:31.608298 [info ] [MainThread]: 
[0m20:02:31.612523 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:02:31.624326 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m20:02:31.626389 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m20:02:31.626736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:31.627635 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m20:02:31.628648 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m20:02:31.629065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:31.670902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:31.672765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:33.336856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a2b43b-a237-4447-8b45-c47b54e99f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454ab84820>]}
[0m20:02:33.337823 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:02:33.338311 [info ] [MainThread]: 
[0m20:02:33.343061 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:02:33.343641 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:02:33.344522 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:02:33.344994 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:02:33.345467 [info ] [Thread-1 (]: 1 of 13 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m20:02:33.346267 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_products_product_sk ............................ [RUN]
[0m20:02:33.347041 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m20:02:33.348163 [info ] [Thread-4 (]: 4 of 13 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m20:02:33.350963 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m20:02:33.352551 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m20:02:33.353811 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m20:02:33.354931 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m20:02:33.356298 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:02:33.356976 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:02:33.357442 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:02:33.357861 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:02:33.392219 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m20:02:33.402565 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m20:02:33.415009 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m20:02:33.431296 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m20:02:33.432599 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 20:02:33.358142 => 2023-07-01 20:02:33.432497
[0m20:02:33.433535 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:02:33.432947 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 20:02:33.393571 => 2023-07-01 20:02:33.432867
[0m20:02:33.434172 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 20:02:33.403885 => 2023-07-01 20:02:33.434036
[0m20:02:33.445323 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 20:02:33.374120 => 2023-07-01 20:02:33.445204
[0m20:02:33.456181 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:02:33.461961 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m20:02:33.462655 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:02:33.463092 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:02:33.467597 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m20:02:33.468479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:33.472491 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m20:02:33.475883 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m20:02:33.476848 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:02:33.479148 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m20:02:33.479936 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:02:33.480701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:02:33.483493 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m20:02:33.525487 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m20:02:33.527824 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m20:02:35.957603 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:722e7ecd-d48d-4d8f-8dbb-0fdf0e1fbdbc&page=queryresults
[0m20:02:35.959692 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 20:02:33.434856 => 2023-07-01 20:02:35.959609
[0m20:02:35.960607 [info ] [Thread-1 (]: 1 of 13 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.61s]
[0m20:02:35.968189 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:02:35.969787 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m20:02:35.971189 [info ] [Thread-1 (]: 5 of 13 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_  [RUN]
[0m20:02:35.975179 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57'
[0m20:02:35.976480 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m20:02:36.005067 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57"
[0m20:02:36.006218 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57 (compile): 2023-07-01 20:02:35.977324 => 2023-07-01 20:02:36.006037
[0m20:02:36.007012 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m20:02:36.013107 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57"
[0m20:02:36.014275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:36.017140 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:02:36.339760 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c556a15c-94ad-4ebf-bd4c-0f8de5c2c679&page=queryresults
[0m20:02:36.340648 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 20:02:33.463416 => 2023-07-01 20:02:36.340574
[0m20:02:36.341490 [info ] [Thread-3 (]: 3 of 13 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 2.99s]
[0m20:02:36.342068 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:02:36.342788 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:02:36.343385 [info ] [Thread-3 (]: 6 of 13 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m20:02:36.344807 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m20:02:36.345492 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:02:36.356179 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m20:02:36.359798 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 20:02:36.345770 => 2023-07-01 20:02:36.359656
[0m20:02:36.360918 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:02:36.367921 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m20:02:36.368596 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:02:36.370363 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:02:36.475423 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:96a868ea-b2ba-43c2-84c2-c0f420f172c3&page=queryresults
[0m20:02:36.476202 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 20:02:33.468928 => 2023-07-01 20:02:36.476125
[0m20:02:36.477039 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 3.12s]
[0m20:02:36.477701 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:02:36.478368 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:02:36.479054 [info ] [Thread-4 (]: 7 of 13 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m20:02:36.480357 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m20:02:36.480888 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:02:36.497403 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m20:02:36.499025 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 20:02:36.481261 => 2023-07-01 20:02:36.498865
[0m20:02:36.500410 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:02:36.507671 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m20:02:36.508714 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:02:36.513198 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:02:36.700893 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:78f8725e-448c-42cb-9165-689f57e4ec1f&page=queryresults
[0m20:02:36.701734 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 20:02:33.472876 => 2023-07-01 20:02:36.701644
[0m20:02:36.702602 [info ] [Thread-2 (]: 2 of 13 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 3.35s]
[0m20:02:36.703242 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:02:36.703941 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:02:36.704531 [info ] [Thread-2 (]: 8 of 13 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m20:02:36.705746 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m20:02:36.706193 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:02:36.723202 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m20:02:36.724363 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 20:02:36.706445 => 2023-07-01 20:02:36.724152
[0m20:02:36.725537 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:02:36.730890 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m20:02:36.731810 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:02:36.735592 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:02:38.339437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b04545d9-9cc3-4134-a08b-b25dd9142386&page=queryresults
[0m20:02:38.347063 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57 (execute): 2023-07-01 20:02:36.007353 => 2023-07-01 20:02:38.346964
[0m20:02:38.348873 [error] [Thread-1 (]: 5 of 13 FAIL 60919 relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_  [[31mFAIL 60919[0m in 2.38s]
[0m20:02:38.350092 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57
[0m20:02:38.351155 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m20:02:38.351995 [info ] [Thread-1 (]: 9 of 13 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_  [RUN]
[0m20:02:38.353644 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b'
[0m20:02:38.354252 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m20:02:38.369390 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b"
[0m20:02:38.370913 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b (compile): 2023-07-01 20:02:38.354659 => 2023-07-01 20:02:38.370419
[0m20:02:38.372248 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m20:02:38.377631 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b"
[0m20:02:38.379202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:38.381303 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:02:38.626905 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5e2b256a-c08c-4274-99bd-ff8ad5ebde38&page=queryresults
[0m20:02:38.627827 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 20:02:36.362202 => 2023-07-01 20:02:38.627737
[0m20:02:38.628727 [info ] [Thread-3 (]: 6 of 13 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.28s]
[0m20:02:38.630238 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:02:38.631850 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:02:38.632393 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3770db5b-9f1b-433d-b29e-4f4af96d85ce&page=queryresults
[0m20:02:38.632938 [info ] [Thread-3 (]: 10 of 13 START test unique_dim_dates_metric_date ............................... [RUN]
[0m20:02:38.634164 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 20:02:36.501202 => 2023-07-01 20:02:38.634071
[0m20:02:38.635141 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m20:02:38.636114 [info ] [Thread-4 (]: 7 of 13 PASS relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[32mPASS[0m in 2.16s]
[0m20:02:38.636801 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:02:38.637282 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:02:38.652157 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m20:02:38.653344 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:02:38.654507 [info ] [Thread-4 (]: 11 of 13 START test unique_dim_products_product_sk ............................. [RUN]
[0m20:02:38.656076 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m20:02:38.656526 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 20:02:38.637563 => 2023-07-01 20:02:38.656433
[0m20:02:38.657002 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:02:38.657533 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:02:38.680598 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m20:02:38.685291 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m20:02:38.688094 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 20:02:38.657850 => 2023-07-01 20:02:38.687815
[0m20:02:38.690332 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:02:38.696823 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:02:38.697988 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m20:02:38.703349 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:02:38.741996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:02:38.744262 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:02:39.052160 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4dacbb30-fc41-4c2c-9d06-f2639ef564f8&page=queryresults
[0m20:02:39.052985 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 20:02:36.725965 => 2023-07-01 20:02:39.052904
[0m20:02:39.053877 [info ] [Thread-2 (]: 8 of 13 PASS relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[32mPASS[0m in 2.35s]
[0m20:02:39.054492 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:02:39.055327 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:02:39.056087 [info ] [Thread-2 (]: 12 of 13 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m20:02:39.057621 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m20:02:39.058241 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:02:39.072344 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m20:02:39.075866 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 20:02:39.058657 => 2023-07-01 20:02:39.075628
[0m20:02:39.076787 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:02:39.088554 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m20:02:39.089565 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:02:39.092474 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:02:40.800105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:debb51f2-9714-48d6-8dd5-adb094a2208b&page=queryresults
[0m20:02:40.801185 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b (execute): 2023-07-01 20:02:38.372604 => 2023-07-01 20:02:40.801091
[0m20:02:40.803663 [error] [Thread-1 (]: 9 of 13 FAIL 60919 relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_  [[31mFAIL 60919[0m in 2.45s]
[0m20:02:40.804563 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_.85337b1d0b
[0m20:02:40.805886 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:02:40.807185 [info ] [Thread-1 (]: 13 of 13 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m20:02:40.808604 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m20:02:40.809061 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:02:40.818461 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m20:02:40.820119 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 20:02:40.809388 => 2023-07-01 20:02:40.819936
[0m20:02:40.821014 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:02:40.828459 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m20:02:40.829728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:40.834026 [debug] [Thread-1 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:02:41.065334 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cc45e8b3-a491-45b4-a47d-0d737e3ba238&page=queryresults
[0m20:02:41.066595 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 20:02:38.668423 => 2023-07-01 20:02:41.066484
[0m20:02:41.067947 [info ] [Thread-3 (]: 10 of 13 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.43s]
[0m20:02:41.068870 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:02:41.457253 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d12376ff-e339-4b20-98aa-befe3c72d6e4&page=queryresults
[0m20:02:41.458164 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 20:02:39.077671 => 2023-07-01 20:02:41.458085
[0m20:02:41.459075 [info ] [Thread-2 (]: 12 of 13 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 2.40s]
[0m20:02:41.459737 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:02:41.819333 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b7385b8e-8de5-4f7b-9c0c-525ee3db7d39&page=queryresults
[0m20:02:41.821024 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 20:02:38.690912 => 2023-07-01 20:02:41.820795
[0m20:02:41.823644 [info ] [Thread-4 (]: 11 of 13 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 3.17s]
[0m20:02:41.825612 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:02:42.915960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9a0e0ebf-37d0-49d8-9347-eda480a3a4cf&page=queryresults
[0m20:02:42.916925 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 20:02:40.821547 => 2023-07-01 20:02:42.916839
[0m20:02:42.917835 [info ] [Thread-1 (]: 13 of 13 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.11s]
[0m20:02:42.918600 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:02:42.920688 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:02:42.921468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:42.921903 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m20:02:42.922169 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed' was properly closed.
[0m20:02:42.922423 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m20:02:42.922666 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m20:02:42.922990 [info ] [MainThread]: 
[0m20:02:42.923524 [info ] [MainThread]: Finished running 13 tests in 0 hours 0 minutes and 11.31 seconds (11.31s).
[0m20:02:42.924910 [debug] [MainThread]: Command end result
[0m20:02:42.969217 [info ] [MainThread]: 
[0m20:02:42.969895 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:02:42.970794 [info ] [MainThread]: 
[0m20:02:42.971580 [error] [MainThread]: [31mFailure in test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_ (models/gold/fact_sales.yml)[0m
[0m20:02:42.972309 [error] [MainThread]:   Got 60919 results, configured to fail if != 0
[0m20:02:42.973308 [info ] [MainThread]: 
[0m20:02:42.974307 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_287401818be50308bcec300fd657896a.sql
[0m20:02:42.975346 [info ] [MainThread]: 
[0m20:02:42.976745 [error] [MainThread]: [31mFailure in test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_customer_ (models/gold/fact_sales.yml)[0m
[0m20:02:42.977631 [error] [MainThread]:   Got 60919 results, configured to fail if != 0
[0m20:02:42.978498 [info ] [MainThread]: 
[0m20:02:42.979570 [info ] [MainThread]:   compiled Code at target/compiled/desafioaethaina/models/gold/fact_sales.yml/relationships_fact_sales_05eedbb9d22f0bc41e92866ce765589c.sql
[0m20:02:42.980968 [info ] [MainThread]: 
[0m20:02:42.981891 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=0 TOTAL=13
[0m20:02:42.982911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454a856920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454a964490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f454e0cf3d0>]}
[0m20:02:42.983409 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:07:55.808348 | 8ef942d2-2802-48c8-ab8b-dc6469c30e00 ==============================
[0m20:07:55.808348 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:07:55.811072 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['int_address_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:07:55.811678 [debug] [MainThread]: Tracking: tracking
[0m20:07:55.813736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda64c82590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda64c80fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda64c808e0>]}
[0m20:07:55.869868 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:07:56.003748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:56.004092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:56.017280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ef942d2-2802-48c8-ab8b-dc6469c30e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda64a60430>]}
[0m20:07:56.042134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ef942d2-2802-48c8-ab8b-dc6469c30e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda64a25ab0>]}
[0m20:07:56.042820 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:07:56.043412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef942d2-2802-48c8-ab8b-dc6469c30e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda64a25b10>]}
[0m20:07:56.045046 [warn ] [MainThread]: The selection criterion 'int_address_customer' does not match any nodes
[0m20:07:56.048001 [info ] [MainThread]: 
[0m20:07:56.048918 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:07:56.049758 [debug] [MainThread]: Command end result
[0m20:07:56.084644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda64a255a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda64a24fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda64a24d90>]}
[0m20:07:56.085394 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:08:15.944889 | d3f0ccd3-025b-40d0-bed2-3bb3e7ba13b2 ==============================
[0m20:08:15.944889 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:08:15.947777 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:08:15.948548 [debug] [MainThread]: Tracking: tracking
[0m20:08:15.950388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4943626e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff494361120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4943626b0>]}
[0m20:08:16.022341 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:08:16.184929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:08:16.185771 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address_customer.sql
[0m20:08:16.209500 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address_customer.sql
[0m20:08:16.272765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3f0ccd3-025b-40d0-bed2-3bb3e7ba13b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff493f155a0>]}
[0m20:08:16.329378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3f0ccd3-025b-40d0-bed2-3bb3e7ba13b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49405a320>]}
[0m20:08:16.330633 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:08:16.331656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f0ccd3-025b-40d0-bed2-3bb3e7ba13b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff493edb9d0>]}
[0m20:08:16.339966 [info ] [MainThread]: 
[0m20:08:16.344773 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:08:16.347110 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m20:08:16.347949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:17.496685 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m20:08:17.497308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:17.502119 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m20:08:17.502687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:17.578379 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m20:08:17.579066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:17.579893 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m20:08:17.618400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:18.941987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f0ccd3-025b-40d0-bed2-3bb3e7ba13b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4943626e0>]}
[0m20:08:18.942895 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:08:18.943354 [info ] [MainThread]: 
[0m20:08:18.948654 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address_customer
[0m20:08:18.949447 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address_customer .............. [RUN]
[0m20:08:18.951103 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address_customer'
[0m20:08:18.951854 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address_customer
[0m20:08:18.958269 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address_customer"
[0m20:08:18.959524 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address_customer (compile): 2023-07-01 20:08:18.952290 => 2023-07-01 20:08:18.959377
[0m20:08:18.960489 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address_customer
[0m20:08:19.011637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:19.974780 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address_customer"
[0m20:08:19.975917 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by address_id order by address_id) as dedup_index
    from int_address
)

, address_with_sk  as (
    select
        MD5(cast(address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , address_type_name
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from address_with_sk
    );
  
[0m20:08:23.425454 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:399dbcb6-5100-400b-8b1f-df9a8c7d38bc&page=queryresults
[0m20:08:23.444882 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address_customer (execute): 2023-07-01 20:08:18.960981 => 2023-07-01 20:08:23.444816
[0m20:08:23.446189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f0ccd3-025b-40d0-bed2-3bb3e7ba13b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49380d2a0>]}
[0m20:08:23.447431 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address_customer ......... [[32mCREATE TABLE (19.6k rows, 1.4 MB processed)[0m in 4.50s]
[0m20:08:23.451716 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address_customer
[0m20:08:23.454498 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:08:23.456050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:23.456681 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m20:08:23.457225 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m20:08:23.457767 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address_customer' was properly closed.
[0m20:08:23.458269 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m20:08:23.459044 [info ] [MainThread]: 
[0m20:08:23.459889 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.12 seconds (7.12s).
[0m20:08:23.461228 [debug] [MainThread]: Command end result
[0m20:08:23.502187 [info ] [MainThread]: 
[0m20:08:23.504237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:08:23.505931 [info ] [MainThread]: 
[0m20:08:23.507195 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:08:23.509438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff493f15a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff493edb880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49405a3b0>]}
[0m20:08:23.510931 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:09:32.168072 | b5e4214a-3c31-4d8b-b7b1-c6a57a3b55a3 ==============================
[0m20:09:32.168072 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:09:32.171551 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address_customer'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:09:32.172322 [debug] [MainThread]: Tracking: tracking
[0m20:09:32.174980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49977340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49976710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49976ec0>]}
[0m20:09:32.234152 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:09:32.381608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:32.382534 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/dim_address_customer.sql
[0m20:09:32.405729 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address_customer.sql
[0m20:09:32.447279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5e4214a-3c31-4d8b-b7b1-c6a57a3b55a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c48dd1330>]}
[0m20:09:32.479777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5e4214a-3c31-4d8b-b7b1-c6a57a3b55a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4966e0b0>]}
[0m20:09:32.480329 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:09:32.480820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e4214a-3c31-4d8b-b7b1-c6a57a3b55a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c494f3760>]}
[0m20:09:32.484428 [info ] [MainThread]: 
[0m20:09:32.488226 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:09:32.489959 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m20:09:32.490578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:33.578018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m20:09:33.579148 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m20:09:33.579844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:09:33.580609 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m20:09:33.581186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:33.581969 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m20:09:33.582447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:33.658529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:35.066242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e4214a-3c31-4d8b-b7b1-c6a57a3b55a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49793a00>]}
[0m20:09:35.068485 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:09:35.069326 [info ] [MainThread]: 
[0m20:09:35.078390 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address_customer
[0m20:09:35.079114 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address_customer .............. [RUN]
[0m20:09:35.080792 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address_customer'
[0m20:09:35.081296 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address_customer
[0m20:09:35.086517 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address_customer"
[0m20:09:35.088097 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address_customer (compile): 2023-07-01 20:09:35.081532 => 2023-07-01 20:09:35.087860
[0m20:09:35.089000 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address_customer
[0m20:09:35.141771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:36.259203 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address_customer"
[0m20:09:36.260304 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by address_id order by address_id) as dedup_index
    from int_address
)

, address_with_sk  as (
    select
        MD5(cast(address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , address_type_name
        , worker_id
        , contact_type_id
        , contact_type_name_worker
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from address_with_sk
    );
  
[0m20:09:39.715342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:eccc25cd-4352-4ba5-9839-43de075b05b8&page=queryresults
[0m20:09:39.734807 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address_customer (execute): 2023-07-01 20:09:35.089685 => 2023-07-01 20:09:39.734736
[0m20:09:39.735668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e4214a-3c31-4d8b-b7b1-c6a57a3b55a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c48e20fd0>]}
[0m20:09:39.736398 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address_customer ......... [[32mCREATE TABLE (19.6k rows, 1.4 MB processed)[0m in 4.66s]
[0m20:09:39.739459 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address_customer
[0m20:09:39.741005 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:09:39.741924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:39.742417 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m20:09:39.742711 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina' was properly closed.
[0m20:09:39.742970 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m20:09:39.743264 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address_customer' was properly closed.
[0m20:09:39.743672 [info ] [MainThread]: 
[0m20:09:39.744244 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m20:09:39.745140 [debug] [MainThread]: Command end result
[0m20:09:39.787185 [info ] [MainThread]: 
[0m20:09:39.789465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:09:39.790520 [info ] [MainThread]: 
[0m20:09:39.791802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:09:39.793600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4da515a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c494f3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4966e110>]}
[0m20:09:39.794477 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:09:47.250983 | 19e6b663-bdb0-4a2c-b06b-cb818b41e861 ==============================
[0m20:09:47.250983 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:09:47.255069 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:09:47.255624 [debug] [MainThread]: Tracking: tracking
[0m20:09:47.257966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9320a76620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9320a74880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9320a765c0>]}
[0m20:09:47.331998 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:09:47.560202 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:09:47.561056 [debug] [MainThread]: Partial parsing: added file: desafioaethaina://models/gold/dim_address.sql
[0m20:09:47.561359 [debug] [MainThread]: Partial parsing: deleted file: desafioaethaina://models/gold/dim_address_customer.sql
[0m20:09:47.589822 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m20:09:47.638596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19e6b663-bdb0-4a2c-b06b-cb818b41e861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9320665570>]}
[0m20:09:47.661034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9320769d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9320769d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9320769cc0>]}
[0m20:09:47.661458 [debug] [MainThread]: Flushing usage events
[0m20:09:48.730606 [error] [MainThread]: Encountered an error:
Compilation Error
  'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_customer_.84b38aee57' depends on 'model.desafioaethaina.dim_address_customer' which is not in the graph!


============================== 2023-07-01 20:10:04.355761 | 2c6fe62a-b8cd-49c0-8df6-a8001d7732f3 ==============================
[0m20:10:04.355761 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:10:04.357713 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dim_address+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:10:04.358102 [debug] [MainThread]: Tracking: tracking
[0m20:10:04.360659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2c4747c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2c474f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2c476860>]}
[0m20:10:04.417402 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:10:04.585821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:10:04.586862 [debug] [MainThread]: Partial parsing: updated file: desafioaethaina://models/gold/fact_sales.yml
[0m20:10:04.614139 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m20:10:04.738433 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m20:10:04.789198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c6fe62a-b8cd-49c0-8df6-a8001d7732f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2b9480d0>]}
[0m20:10:04.847230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c6fe62a-b8cd-49c0-8df6-a8001d7732f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2c019d50>]}
[0m20:10:04.848029 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:10:04.848854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6fe62a-b8cd-49c0-8df6-a8001d7732f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2bff3bb0>]}
[0m20:10:04.856364 [info ] [MainThread]: 
[0m20:10:04.860186 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:04.862130 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m20:10:04.862907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:05.935287 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m20:10:05.936418 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m20:10:05.936767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:05.937722 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m20:10:05.938220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:05.939221 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m20:10:05.939852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:06.014261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:07.378473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6fe62a-b8cd-49c0-8df6-a8001d7732f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2c0186a0>]}
[0m20:10:07.380495 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:07.381320 [info ] [MainThread]: 
[0m20:10:07.387232 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_address
[0m20:10:07.388022 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m20:10:07.389262 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m20:10:07.389693 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_address
[0m20:10:07.393711 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m20:10:07.394580 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 20:10:07.389942 => 2023-07-01 20:10:07.394445
[0m20:10:07.395337 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_address
[0m20:10:07.493838 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m20:10:07.494485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:07.497434 [debug] [Thread-1 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by address_id order by address_id) as dedup_index
    from int_address
)

, address_with_sk  as (
    select
        MD5(cast(address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , address_type_name
        , worker_id
        , contact_type_id
        , contact_type_name_worker
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from address_with_sk
    );
  
[0m20:10:11.258170 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c936fb03-92f3-4844-9df7-d654f32c313c&page=queryresults
[0m20:10:11.280598 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 20:10:07.395831 => 2023-07-01 20:10:11.280530
[0m20:10:11.281489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6fe62a-b8cd-49c0-8df6-a8001d7732f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2b781d20>]}
[0m20:10:11.282283 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.6k rows, 1.4 MB processed)[0m in 3.89s]
[0m20:10:11.285485 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_address
[0m20:10:11.287175 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:11.287942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:11.288217 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_silver' was properly closed.
[0m20:10:11.288548 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_address' was properly closed.
[0m20:10:11.288806 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_gold' was properly closed.
[0m20:10:11.289049 [debug] [MainThread]: Connection 'list_desafiothaina_dev_thaina_intermediate' was properly closed.
[0m20:10:11.289486 [info ] [MainThread]: 
[0m20:10:11.290286 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.43 seconds (6.43s).
[0m20:10:11.291262 [debug] [MainThread]: Command end result
[0m20:10:11.342283 [info ] [MainThread]: 
[0m20:10:11.343414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:11.344399 [info ] [MainThread]: 
[0m20:10:11.346998 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:10:11.348758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2c002b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2b79fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2b79ddb0>]}
[0m20:10:11.349948 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:10:18.559129 | 09ead292-40aa-4fee-9c00-12da47e0ff90 ==============================
[0m20:10:18.559129 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:10:18.561374 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:10:18.561956 [debug] [MainThread]: Tracking: tracking
[0m20:10:18.563664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18867a440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18867a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18867a3b0>]}
[0m20:10:18.608218 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:10:18.751842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:18.752231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:18.765162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09ead292-40aa-4fee-9c00-12da47e0ff90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd188258430>]}
[0m20:10:18.789555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09ead292-40aa-4fee-9c00-12da47e0ff90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd188219ab0>]}
[0m20:10:18.790087 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:10:18.790531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09ead292-40aa-4fee-9c00-12da47e0ff90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd188219b10>]}
[0m20:10:18.800225 [info ] [MainThread]: 
[0m20:10:18.804751 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:18.817681 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m20:10:18.819328 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m20:10:18.820164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:18.821266 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m20:10:18.823178 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m20:10:18.823685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:18.824371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:18.867830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:20.273018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09ead292-40aa-4fee-9c00-12da47e0ff90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18867a260>]}
[0m20:10:20.273964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:20.274450 [info ] [MainThread]: 
[0m20:10:20.278551 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:10:20.278945 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:10:20.279497 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:10:20.279930 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:10:20.280319 [info ] [Thread-1 (]: 1 of 13 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m20:10:20.281231 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_products_product_sk ............................ [RUN]
[0m20:10:20.281965 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m20:10:20.282737 [info ] [Thread-4 (]: 4 of 13 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m20:10:20.284011 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m20:10:20.285027 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m20:10:20.285907 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m20:10:20.286948 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m20:10:20.287583 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:10:20.288102 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:10:20.288621 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:10:20.289044 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:10:20.350077 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m20:10:20.358971 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m20:10:20.361228 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m20:10:20.369799 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m20:10:20.370359 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 20:10:20.289544 => 2023-07-01 20:10:20.370269
[0m20:10:20.371294 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 20:10:20.342530 => 2023-07-01 20:10:20.371136
[0m20:10:20.372002 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:10:20.372319 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 20:10:20.318905 => 2023-07-01 20:10:20.372250
[0m20:10:20.372572 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 20:10:20.301885 => 2023-07-01 20:10:20.372506
[0m20:10:20.373023 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:10:20.389199 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:10:20.399972 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m20:10:20.400439 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:10:20.403872 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m20:10:20.408601 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m20:10:20.412554 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m20:10:20.413209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:20.413986 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:20.414288 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:10:20.417073 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m20:10:20.417503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:20.419601 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m20:10:20.421365 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m20:10:20.492529 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m20:10:23.337281 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ffa792c6-d4fc-40ac-83a5-ffb293455237&page=queryresults
[0m20:10:23.337777 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:681cc12d-697e-4945-bcfe-0c1982925e17&page=queryresults
[0m20:10:23.338478 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:79dc10b6-36a9-4711-b021-2bdbc51537d8&page=queryresults
[0m20:10:23.341874 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 20:10:20.400700 => 2023-07-01 20:10:23.341744
[0m20:10:23.342614 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a5bb2d4f-7ea2-4502-bd93-63d729daa07a&page=queryresults
[0m20:10:23.343929 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 20:10:20.373471 => 2023-07-01 20:10:23.343820
[0m20:10:23.345209 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 20:10:20.404258 => 2023-07-01 20:10:23.345084
[0m20:10:23.347007 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 3.06s]
[0m20:10:23.348658 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 20:10:20.409250 => 2023-07-01 20:10:23.348546
[0m20:10:23.349881 [info ] [Thread-1 (]: 1 of 13 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 3.07s]
[0m20:10:23.351347 [info ] [Thread-3 (]: 3 of 13 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 3.07s]
[0m20:10:23.353750 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:10:23.354800 [info ] [Thread-2 (]: 2 of 13 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 3.07s]
[0m20:10:23.355526 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:10:23.356148 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:10:23.358855 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:10:23.357124 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:10:23.357703 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:10:23.356619 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m20:10:23.360633 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:10:23.359766 [info ] [Thread-3 (]: 7 of 13 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m20:10:23.363245 [info ] [Thread-1 (]: 6 of 13 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m20:10:23.364968 [info ] [Thread-4 (]: 5 of 13 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m20:10:23.369128 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m20:10:23.366535 [info ] [Thread-2 (]: 8 of 13 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m20:10:23.371054 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m20:10:23.372082 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de'
[0m20:10:23.372638 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:10:23.373607 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m20:10:23.374098 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:10:23.374476 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m20:10:23.378138 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:10:23.436995 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m20:10:23.444068 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m20:10:23.451719 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m20:10:23.453991 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m20:10:23.454998 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 20:10:23.380236 => 2023-07-01 20:10:23.454866
[0m20:10:23.455863 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:10:23.456285 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 20:10:23.374876 => 2023-07-01 20:10:23.456209
[0m20:10:23.456760 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 20:10:23.437610 => 2023-07-01 20:10:23.456672
[0m20:10:23.460390 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m20:10:23.460746 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (compile): 2023-07-01 20:10:23.403610 => 2023-07-01 20:10:23.460676
[0m20:10:23.461159 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:10:23.461506 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:10:23.462140 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m20:10:23.462682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:23.466434 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m20:10:23.469462 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m20:10:23.472294 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m20:10:23.474302 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:10:23.475051 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:23.507418 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:23.508149 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:10:23.511280 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:10:23.512940 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:10:23.546221 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:10:25.896428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c4c029b4-3eae-4289-af7f-a11ef9424da6&page=queryresults
[0m20:10:25.898348 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 20:10:23.457004 => 2023-07-01 20:10:25.898204
[0m20:10:25.899621 [info ] [Thread-1 (]: 6 of 13 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.53s]
[0m20:10:25.900677 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:10:25.901855 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m20:10:25.902614 [info ] [Thread-1 (]: 9 of 13 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m20:10:25.904255 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310'
[0m20:10:25.904925 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m20:10:25.915279 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m20:10:25.916331 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (compile): 2023-07-01 20:10:25.905281 => 2023-07-01 20:10:25.916197
[0m20:10:25.917029 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m20:10:25.922828 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m20:10:25.923679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:25.926013 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:10:26.268269 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e4d1678c-4ec1-4195-aa83-5fb406dc953f&page=queryresults
[0m20:10:26.270307 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 20:10:23.466783 => 2023-07-01 20:10:26.270095
[0m20:10:26.273052 [info ] [Thread-2 (]: 8 of 13 PASS relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[32mPASS[0m in 2.90s]
[0m20:10:26.274887 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:10:26.275984 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:10:26.276973 [info ] [Thread-2 (]: 10 of 13 START test unique_dim_dates_metric_date ............................... [RUN]
[0m20:10:26.279927 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m20:10:26.280604 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:10:26.297462 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m20:10:26.298386 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:fa0f0a87-46b5-44e4-a9d7-197929b3b0c1&page=queryresults
[0m20:10:26.300605 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (execute): 2023-07-01 20:10:23.469797 => 2023-07-01 20:10:26.300321
[0m20:10:26.302731 [info ] [Thread-4 (]: 5 of 13 PASS relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.93s]
[0m20:10:26.305488 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m20:10:26.306626 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:10:26.307655 [info ] [Thread-4 (]: 11 of 13 START test unique_dim_products_product_sk ............................. [RUN]
[0m20:10:26.309593 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m20:10:26.310432 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:10:26.310900 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 20:10:26.281962 => 2023-07-01 20:10:26.310726
[0m20:10:26.317327 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:10:26.329969 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m20:10:26.334478 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m20:10:26.335719 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:26.336834 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 20:10:26.311635 => 2023-07-01 20:10:26.336624
[0m20:10:26.342370 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:10:26.342910 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:10:26.388760 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2d693041-8070-4a95-9123-3336ac4e6b3c&page=queryresults
[0m20:10:26.396788 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m20:10:26.398030 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 20:10:23.463090 => 2023-07-01 20:10:26.397858
[0m20:10:26.399763 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:10:26.402773 [info ] [Thread-3 (]: 7 of 13 PASS relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[32mPASS[0m in 3.04s]
[0m20:10:26.405875 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:10:26.406403 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:10:26.407547 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:10:26.448415 [info ] [Thread-3 (]: 12 of 13 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m20:10:26.452173 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m20:10:26.453187 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:10:26.474072 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m20:10:26.475639 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 20:10:26.453611 => 2023-07-01 20:10:26.474980
[0m20:10:26.476183 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:10:26.483577 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m20:10:26.484849 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:26.489611 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:10:28.463114 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e5f933bf-87b5-4fdc-863e-0dbf5d901c26&page=queryresults
[0m20:10:28.465319 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (execute): 2023-07-01 20:10:25.917450 => 2023-07-01 20:10:28.465123
[0m20:10:28.466867 [info ] [Thread-1 (]: 9 of 13 PASS relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.56s]
[0m20:10:28.467933 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m20:10:28.469229 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:10:28.469952 [info ] [Thread-1 (]: 13 of 13 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m20:10:28.473281 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m20:10:28.474307 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:10:28.489860 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m20:10:28.491871 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 20:10:28.482289 => 2023-07-01 20:10:28.491563
[0m20:10:28.493029 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:10:28.501217 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m20:10:28.508367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:28.510692 [debug] [Thread-1 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:10:28.713305 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:afd3c961-cca8-40a2-9a8b-412f900cd320&page=queryresults
[0m20:10:28.714146 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 20:10:26.317808 => 2023-07-01 20:10:28.714057
[0m20:10:28.714946 [info ] [Thread-2 (]: 10 of 13 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.44s]
[0m20:10:28.715552 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:10:28.767775 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:867bda24-5a67-43ea-ac8d-ffb827d4d3b1&page=queryresults
[0m20:10:28.769306 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 20:10:26.390863 => 2023-07-01 20:10:28.769105
[0m20:10:28.771310 [info ] [Thread-4 (]: 11 of 13 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 2.46s]
[0m20:10:28.772793 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:10:28.782610 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:43ea2331-61b6-4519-8a71-9117fecf9817&page=queryresults
[0m20:10:28.784896 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 20:10:26.476605 => 2023-07-01 20:10:28.784788
[0m20:10:28.785975 [info ] [Thread-3 (]: 12 of 13 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 2.34s]
[0m20:10:28.786809 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:10:30.914789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9833545c-5c08-46a6-9c9e-5019355433ac&page=queryresults
[0m20:10:30.916307 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 20:10:28.493512 => 2023-07-01 20:10:30.916145
[0m20:10:30.918541 [info ] [Thread-1 (]: 13 of 13 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.45s]
[0m20:10:30.920706 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:10:30.924891 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:30.926103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:30.926667 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m20:10:30.927137 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m20:10:30.927610 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m20:10:30.928043 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed' was properly closed.
[0m20:10:30.928561 [info ] [MainThread]: 
[0m20:10:30.929763 [info ] [MainThread]: Finished running 13 tests in 0 hours 0 minutes and 12.13 seconds (12.13s).
[0m20:10:30.933030 [debug] [MainThread]: Command end result
[0m20:10:30.989559 [info ] [MainThread]: 
[0m20:10:30.990470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:30.991343 [info ] [MainThread]: 
[0m20:10:30.992652 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m20:10:30.993704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd187ff9960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd187ee74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd187ee7310>]}
[0m20:10:30.994657 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:12:56.557437 | d4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87 ==============================
[0m20:12:56.557437 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:12:56.560786 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:12:56.561236 [debug] [MainThread]: Tracking: tracking
[0m20:12:56.563504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf2823b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf282260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf2826e0>]}
[0m20:12:56.614207 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:12:56.766694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:12:56.767045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:12:56.779972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf05c490>]}
[0m20:12:56.804580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf01db10>]}
[0m20:12:56.805093 [info ] [MainThread]: Found 46 models, 13 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:12:56.805544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf01db70>]}
[0m20:12:56.816010 [info ] [MainThread]: 
[0m20:12:56.819877 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:12:56.825645 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m20:12:56.826887 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m20:12:56.827539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:56.828865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m20:12:56.829595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:56.830391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:58.168616 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_gold'
[0m20:12:58.170575 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_silver'
[0m20:12:58.171600 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_intermediate'
[0m20:12:58.172416 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_gold'
[0m20:12:58.173156 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_silver'
[0m20:12:58.174089 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_desafiothaina_dev_thaina_intermediate'
[0m20:12:58.174595 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='desafiothaina', schema='dev_thaina_gold', identifier=None)"
[0m20:12:58.175065 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='desafiothaina', schema='dev_thaina_silver', identifier=None)"
[0m20:12:58.175513 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='desafiothaina', schema='dev_thaina_intermediate', identifier=None)"
[0m20:12:58.189283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:58.192187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:58.194954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:58.198430 [debug] [ThreadPool]: On create_desafiothaina_dev_thaina_gold: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "connection_name": "create_desafiothaina_dev_thaina_gold"} */
create schema if not exists `desafiothaina`.`dev_thaina_gold`
  
[0m20:12:58.200684 [debug] [ThreadPool]: On create_desafiothaina_dev_thaina_silver: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "connection_name": "create_desafiothaina_dev_thaina_silver"} */
create schema if not exists `desafiothaina`.`dev_thaina_silver`
  
[0m20:12:58.237351 [debug] [ThreadPool]: On create_desafiothaina_dev_thaina_intermediate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "connection_name": "create_desafiothaina_dev_thaina_intermediate"} */
create schema if not exists `desafiothaina`.`dev_thaina_intermediate`
  
[0m20:13:01.035707 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8d2c9d92-edaf-47c9-b6cc-fecea3e962f2&page=queryresults
[0m20:13:01.037591 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d22a8999-23d3-4ab1-894e-85710d92621a&page=queryresults
[0m20:13:01.256721 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a75ef91e-4cab-46c2-8782-bcf77527a8fe&page=queryresults
[0m20:13:01.265067 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m20:13:01.265537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:01.266608 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m20:13:01.301415 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_silver'
[0m20:13:01.301834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:01.302843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_intermediate'
[0m20:13:01.303382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:01.305433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:02.677280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf282f20>]}
[0m20:13:02.679200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:02.680370 [info ] [MainThread]: 
[0m20:13:02.709767 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m20:13:02.711620 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_address
[0m20:13:02.713251 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_address_type
[0m20:13:02.714016 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_address
[0m20:13:02.710513 [info ] [Thread-1 (]: 1 of 46 START sql table model dev_thaina_gold.dim_dates ........................ [RUN]
[0m20:13:02.719605 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m20:13:02.720312 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m20:13:02.716742 [info ] [Thread-3 (]: 3 of 46 START sql table model dev_thaina_silver.stg_person_address_type ........ [RUN]
[0m20:13:02.712535 [info ] [Thread-2 (]: 2 of 46 START sql table model dev_thaina_silver.stg_person_address ............. [RUN]
[0m20:13:02.736697 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address_type'
[0m20:13:02.754197 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_address_type
[0m20:13:02.718137 [info ] [Thread-4 (]: 4 of 46 START sql table model dev_thaina_silver.stg_person_business_entity_address  [RUN]
[0m20:13:02.753247 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address'
[0m20:13:02.764385 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_address'
[0m20:13:02.780734 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_address
[0m20:13:02.767495 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address_type"
[0m20:13:02.780089 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_address
[0m20:13:02.796846 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_address"
[0m20:13:02.797891 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (compile): 2023-07-01 20:13:02.754754 => 2023-07-01 20:13:02.797735
[0m20:13:02.803235 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_address_type
[0m20:13:02.801413 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address"
[0m20:13:02.807690 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (compile): 2023-07-01 20:13:02.790952 => 2023-07-01 20:13:02.807535
[0m20:13:02.823812 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_address
[0m20:13:02.832748 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (compile): 2023-07-01 20:13:02.781168 => 2023-07-01 20:13:02.832570
[0m20:13:02.890191 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_business_entity_address
[0m20:13:02.852619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:02.942050 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m20:13:03.012960 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address_type"
[0m20:13:03.017125 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_address"
[0m20:13:03.020126 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_address"
[0m20:13:03.054717 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:03.055546 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:03.056138 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:03.057789 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_business_entity_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , addressid as address_id
    , addresstypeid as address_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentityaddress`
)

select *
from source_data
    );
  
[0m20:13:03.059334 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_address_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addresstypeid as address_type_id
    , name as address_type_name 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`addresstype`
)

select *
from source_data
    );
  
[0m20:13:03.061916 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
    );
  
[0m20:13:05.537370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bf540007-f126-4cc5-aaa0-7793f7f5cfd8&page=queryresults
[0m20:13:05.552461 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m20:13:05.553092 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-07-01 20:13:02.720803 => 2023-07-01 20:13:05.552990
[0m20:13:05.553495 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m20:13:05.562862 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m20:13:05.564148 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      /* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m20:13:07.218839 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:777d9645-46eb-4829-a9c0-19ceaf4abb43&page=queryresults
[0m20:13:07.235036 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (execute): 2023-07-01 20:13:02.890672 => 2023-07-01 20:13:07.234971
[0m20:13:07.236347 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf043ca0>]}
[0m20:13:07.237102 [info ] [Thread-4 (]: 4 of 46 OK created sql table model dev_thaina_silver.stg_person_business_entity_address  [[32mCREATE TABLE (19.6k rows, 1.2 MB processed)[0m in 4.47s]
[0m20:13:07.237938 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9de13a20-50d0-4faa-8e52-739b58ce594d&page=queryresults
[0m20:13:07.240354 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_address
[0m20:13:07.242717 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (execute): 2023-07-01 20:13:02.803790 => 2023-07-01 20:13:07.242649
[0m20:13:07.243349 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_contact
[0m20:13:07.244397 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf041ba0>]}
[0m20:13:07.244887 [info ] [Thread-4 (]: 5 of 46 START sql table model dev_thaina_silver.stg_person_business_entity_contact  [RUN]
[0m20:13:07.245925 [info ] [Thread-3 (]: 3 of 46 OK created sql table model dev_thaina_silver.stg_person_address_type ... [[32mCREATE TABLE (6.0 rows, 332.0 Bytes processed)[0m in 4.51s]
[0m20:13:07.247860 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_contact'
[0m20:13:07.248670 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_address_type
[0m20:13:07.249578 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_contact
[0m20:13:07.250435 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_contact_type
[0m20:13:07.256253 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m20:13:07.258510 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (compile): 2023-07-01 20:13:07.250969 => 2023-07-01 20:13:07.258276
[0m20:13:07.259929 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_person_business_entity_contact
[0m20:13:07.257326 [info ] [Thread-3 (]: 6 of 46 START sql table model dev_thaina_silver.stg_person_contact_type ........ [RUN]
[0m20:13:07.269361 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m20:13:07.270632 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_contact_type'
[0m20:13:07.271822 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_contact_type
[0m20:13:07.278466 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_contact_type"
[0m20:13:07.279467 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:07.282533 [debug] [Thread-4 (]: On model.desafioaethaina.stg_person_business_entity_contact: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_business_entity_contact"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , personid as person_id
    , contacttypeid as contact_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentitycontact`
)

select *
from source_data
    );
  
[0m20:13:07.284073 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_contact_type (compile): 2023-07-01 20:13:07.272342 => 2023-07-01 20:13:07.283925
[0m20:13:07.321172 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_contact_type
[0m20:13:07.326237 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_contact_type"
[0m20:13:07.327047 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:07.328672 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_contact_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_contact_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    contacttypeid as contact_type_id
    , name as contact_type_name 
  from  `desafiothaina`.`dev_thaina`.`contacttype`
)

select *
from source_data
    );
  
[0m20:13:07.526244 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d0c2a63c-f027-455c-ba7d-4c1b6afa5114&page=queryresults
[0m20:13:07.528335 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (execute): 2023-07-01 20:13:02.853039 => 2023-07-01 20:13:07.528269
[0m20:13:07.529110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf05ce50>]}
[0m20:13:07.529604 [info ] [Thread-2 (]: 2 of 46 OK created sql table model dev_thaina_silver.stg_person_address ........ [[32mCREATE TABLE (19.6k rows, 1.7 MB processed)[0m in 4.78s]
[0m20:13:07.530258 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_address
[0m20:13:07.531056 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_country_region
[0m20:13:07.531952 [info ] [Thread-2 (]: 7 of 46 START sql table model dev_thaina_silver.stg_person_country_region ...... [RUN]
[0m20:13:07.533089 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_country_region'
[0m20:13:07.533484 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_country_region
[0m20:13:07.537325 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_country_region"
[0m20:13:07.537964 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_country_region (compile): 2023-07-01 20:13:07.533703 => 2023-07-01 20:13:07.537851
[0m20:13:07.538571 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_country_region
[0m20:13:07.552027 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_country_region"
[0m20:13:07.553762 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:07.557309 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_country_region: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_country_region"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
    );
  
[0m20:13:10.042672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8c38fae0-5a1a-4d36-8c54-39d72b83e89a&page=queryresults
[0m20:13:10.867181 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f2f8860a-491f-4779-a8c3-be8305863646&page=queryresults
[0m20:13:10.869967 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_contact_type (execute): 2023-07-01 20:13:07.321862 => 2023-07-01 20:13:10.869882
[0m20:13:10.871074 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bee60130>]}
[0m20:13:10.871757 [info ] [Thread-3 (]: 6 of 46 OK created sql table model dev_thaina_silver.stg_person_contact_type ... [[32mCREATE TABLE (20.0 rows, 595.0 Bytes processed)[0m in 3.60s]
[0m20:13:10.872553 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_contact_type
[0m20:13:10.873224 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_person
[0m20:13:10.873962 [info ] [Thread-3 (]: 8 of 46 START sql table model dev_thaina_silver.stg_person_person .............. [RUN]
[0m20:13:10.875231 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_person'
[0m20:13:10.875772 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_person
[0m20:13:10.881245 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_person"
[0m20:13:10.881977 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_person (compile): 2023-07-01 20:13:10.876093 => 2023-07-01 20:13:10.881881
[0m20:13:10.882445 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_person_person
[0m20:13:10.889829 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_person"
[0m20:13:10.891238 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:10.893770 [debug] [Thread-3 (]: On model.desafioaethaina.stg_person_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
    );
  
[0m20:13:11.025430 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f7deba5f-a15b-401e-b35c-b78073678ca6&page=queryresults
[0m20:13:11.025970 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:930e1303-53a3-40dd-a9c1-aa8a63bbeb16&page=queryresults
[0m20:13:11.028563 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_country_region (execute): 2023-07-01 20:13:07.539052 => 2023-07-01 20:13:11.028477
[0m20:13:11.030506 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (execute): 2023-07-01 20:13:07.260631 => 2023-07-01 20:13:11.030446
[0m20:13:11.031661 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23beec5270>]}
[0m20:13:11.032615 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf043e20>]}
[0m20:13:11.033329 [info ] [Thread-2 (]: 7 of 46 OK created sql table model dev_thaina_silver.stg_person_country_region . [[32mCREATE TABLE (238.0 rows, 3.7 KB processed)[0m in 3.50s]
[0m20:13:11.035182 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_country_region
[0m20:13:11.036342 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_state_province
[0m20:13:11.037163 [info ] [Thread-2 (]: 9 of 46 START sql table model dev_thaina_silver.stg_person_state_province ...... [RUN]
[0m20:13:11.034372 [info ] [Thread-4 (]: 5 of 46 OK created sql table model dev_thaina_silver.stg_person_business_entity_contact  [[32mCREATE TABLE (909.0 rows, 55.0 KB processed)[0m in 3.79s]
[0m20:13:11.038580 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_state_province'
[0m20:13:11.039315 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_contact
[0m20:13:11.039960 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_state_province
[0m20:13:11.040649 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product
[0m20:13:11.048329 [info ] [Thread-4 (]: 10 of 46 START sql table model dev_thaina_silver.stg_product ................... [RUN]
[0m20:13:11.050594 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product'
[0m20:13:11.051508 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_state_province"
[0m20:13:11.051975 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product
[0m20:13:11.058795 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product"
[0m20:13:11.060666 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product (compile): 2023-07-01 20:13:11.052452 => 2023-07-01 20:13:11.060548
[0m20:13:11.061891 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product
[0m20:13:11.059830 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_state_province (compile): 2023-07-01 20:13:11.041347 => 2023-07-01 20:13:11.059640
[0m20:13:11.073688 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product"
[0m20:13:11.074376 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_person_state_province
[0m20:13:11.083007 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:11.091872 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_person_state_province"
[0m20:13:11.094492 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , productmodelid as product_model_id
    , productsubcategoryid as product_subcategory_id
    , name as product_name
    , productnumber as product_number
    , makeflag
    , finishedgoodsflag as finished_goods_flag
    , color
    , safetystocklevel as safety_stock_level
    , standardcost as stand_cost
    , listprice as list_price
    , size as size_product
    , style as style_product
    , weight as weight_product 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`product`
)

select * from source_data
    );
  
[0m20:13:11.135889 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:11.138060 [debug] [Thread-2 (]: On model.desafioaethaina.stg_person_state_province: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_person_state_province"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
    );
  
[0m20:13:11.173930 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-07-01 20:13:05.553797 => 2023-07-01 20:13:11.173828
[0m20:13:11.175209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23beec4100>]}
[0m20:13:11.176089 [info ] [Thread-1 (]: 1 of 46 OK created sql table model dev_thaina_gold.dim_dates ................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 8.46s]
[0m20:13:11.176784 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m20:13:11.177413 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_category
[0m20:13:11.177939 [info ] [Thread-1 (]: 11 of 46 START sql table model dev_thaina_silver.stg_product_category .......... [RUN]
[0m20:13:11.178916 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_category'
[0m20:13:11.179300 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_category
[0m20:13:11.182796 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_category"
[0m20:13:11.183487 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_category (compile): 2023-07-01 20:13:11.179595 => 2023-07-01 20:13:11.183354
[0m20:13:11.183942 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_category
[0m20:13:11.189582 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_category"
[0m20:13:11.190283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:11.192342 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_category: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_category"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productcategoryid as category_id
    , name as category_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productcategory`
)

select *
from source_data
    );
  
[0m20:13:14.960544 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0620f59b-ef05-4f52-ae8c-211f0cd9774c&page=queryresults
[0m20:13:14.963857 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_category (execute): 2023-07-01 20:13:11.184154 => 2023-07-01 20:13:14.963753
[0m20:13:14.965159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23beec4280>]}
[0m20:13:14.965779 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0ac4e7db-83d1-4498-b37b-9d38fc5ab33c&page=queryresults
[0m20:13:14.966529 [info ] [Thread-1 (]: 11 of 46 OK created sql table model dev_thaina_silver.stg_product_category ..... [[32mCREATE TABLE (4.0 rows, 226.0 Bytes processed)[0m in 3.79s]
[0m20:13:14.969767 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product (execute): 2023-07-01 20:13:11.062405 => 2023-07-01 20:13:14.969691
[0m20:13:14.970246 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_category
[0m20:13:14.971207 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf043220>]}
[0m20:13:14.971739 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_description
[0m20:13:14.972494 [info ] [Thread-4 (]: 10 of 46 OK created sql table model dev_thaina_silver.stg_product .............. [[32mCREATE TABLE (504.0 rows, 60.1 KB processed)[0m in 3.92s]
[0m20:13:14.973227 [info ] [Thread-1 (]: 12 of 46 START sql table model dev_thaina_silver.stg_product_description ....... [RUN]
[0m20:13:14.974003 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product
[0m20:13:14.974936 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_description'
[0m20:13:14.976613 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_description
[0m20:13:14.975633 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_inventory
[0m20:13:14.982004 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_description"
[0m20:13:14.983419 [info ] [Thread-4 (]: 13 of 46 START sql table model dev_thaina_silver.stg_product_inventory ......... [RUN]
[0m20:13:14.986017 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_inventory'
[0m20:13:14.986858 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_inventory
[0m20:13:14.987836 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_description (compile): 2023-07-01 20:13:14.977155 => 2023-07-01 20:13:14.987589
[0m20:13:14.993416 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_inventory"
[0m20:13:14.994327 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_description
[0m20:13:15.002616 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_description"
[0m20:13:15.003387 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_inventory (compile): 2023-07-01 20:13:14.988577 => 2023-07-01 20:13:15.003248
[0m20:13:15.004370 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_product_inventory
[0m20:13:15.015725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:15.028554 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_inventory"
[0m20:13:15.029494 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:15.032521 [debug] [Thread-4 (]: On model.desafioaethaina.stg_product_inventory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_inventory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productid as product_id
    , locationid as location_id
    , shelf
    , bin
    , quantity as quantity_inventory
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productinventory`
)

select *
from source_data
    );
  
[0m20:13:15.034248 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_description: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_description"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_description`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productdescriptionid as product_description_id
    , description as product_description
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productdescription`
)

select *
from source_data
    );
  
[0m20:13:15.337502 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:13824b4f-99c8-4bd2-801e-515ce81abcb9&page=queryresults
[0m20:13:15.339499 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_person (execute): 2023-07-01 20:13:10.882757 => 2023-07-01 20:13:15.339418
[0m20:13:15.340260 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bed767d0>]}
[0m20:13:15.340771 [info ] [Thread-3 (]: 8 of 46 OK created sql table model dev_thaina_silver.stg_person_person ......... [[32mCREATE TABLE (20.0k rows, 1.5 MB processed)[0m in 4.47s]
[0m20:13:15.341573 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_person
[0m20:13:15.342332 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_location
[0m20:13:15.343192 [info ] [Thread-3 (]: 14 of 46 START sql table model dev_thaina_silver.stg_product_location .......... [RUN]
[0m20:13:15.344893 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_location'
[0m20:13:15.345454 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_location
[0m20:13:15.351848 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_location"
[0m20:13:15.352898 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_location (compile): 2023-07-01 20:13:15.345822 => 2023-07-01 20:13:15.352752
[0m20:13:15.353771 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_product_location
[0m20:13:15.361672 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_location"
[0m20:13:15.363014 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:15.366363 [debug] [Thread-3 (]: On model.desafioaethaina.stg_product_location: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_location"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    locationid as location_id
    , name as location_name
    -- Standard hourly cost of the manufacturing location.
    , costrate as cost_rate
    -- Work capacity (in hours) of the manufacturing location.
    , availability 
  from  `desafiothaina`.`dev_thaina`.`location`
)

select *
from source_data
    );
  
[0m20:13:16.529935 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:49a8e2f2-eb94-434a-b14d-147a71ef71c0&page=queryresults
[0m20:13:16.536423 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_state_province (execute): 2023-07-01 20:13:11.075538 => 2023-07-01 20:13:16.536350
[0m20:13:16.538115 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23beec5150>]}
[0m20:13:16.538644 [info ] [Thread-2 (]: 9 of 46 OK created sql table model dev_thaina_silver.stg_person_state_province . [[32mCREATE TABLE (181.0 rows, 13.4 KB processed)[0m in 5.50s]
[0m20:13:16.539331 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_state_province
[0m20:13:16.540743 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_model
[0m20:13:16.541580 [info ] [Thread-2 (]: 15 of 46 START sql table model dev_thaina_silver.stg_product_model ............. [RUN]
[0m20:13:16.543543 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_model'
[0m20:13:16.544152 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_model
[0m20:13:16.550070 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_model"
[0m20:13:16.550913 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_model (compile): 2023-07-01 20:13:16.544531 => 2023-07-01 20:13:16.550776
[0m20:13:16.551578 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_product_model
[0m20:13:16.558582 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_model"
[0m20:13:16.560021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:16.564326 [debug] [Thread-2 (]: On model.desafioaethaina.stg_product_model: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_model"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productmodelid as model_id
    , name as model_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productmodel`
)

select *
from source_data
    );
  
[0m20:13:18.530370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:06afd342-259f-4312-a491-f12b1d9492eb&page=queryresults
[0m20:13:18.535433 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_description (execute): 2023-07-01 20:13:14.995301 => 2023-07-01 20:13:18.535268
[0m20:13:18.537667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23beed64a0>]}
[0m20:13:18.539435 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:100be5b8-adfb-4c45-8274-7d71229f4fe8&page=queryresults
[0m20:13:18.538531 [info ] [Thread-1 (]: 12 of 46 OK created sql table model dev_thaina_silver.stg_product_description .. [[32mCREATE TABLE (762.0 rows, 125.4 KB processed)[0m in 3.56s]
[0m20:13:18.542898 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_inventory (execute): 2023-07-01 20:13:15.005012 => 2023-07-01 20:13:18.542805
[0m20:13:18.543546 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_description
[0m20:13:18.544659 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23beed41f0>]}
[0m20:13:18.545367 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_product_subcategory
[0m20:13:18.546276 [info ] [Thread-4 (]: 13 of 46 OK created sql table model dev_thaina_silver.stg_product_inventory .... [[32mCREATE TABLE (1.1k rows, 76.8 KB processed)[0m in 3.56s]
[0m20:13:18.548171 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_inventory
[0m20:13:18.547291 [info ] [Thread-1 (]: 16 of 46 START sql table model dev_thaina_silver.stg_product_subcategory ....... [RUN]
[0m20:13:18.549165 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m20:13:18.550769 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_subcategory'
[0m20:13:18.552652 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_product_subcategory
[0m20:13:18.551893 [info ] [Thread-4 (]: 17 of 46 START sql table model dev_thaina_silver.stg_purchase_order_detail ..... [RUN]
[0m20:13:18.560427 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_subcategory"
[0m20:13:18.562523 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_subcategory (compile): 2023-07-01 20:13:18.553913 => 2023-07-01 20:13:18.562328
[0m20:13:18.561338 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m20:13:18.564785 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_product_subcategory
[0m20:13:18.566172 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m20:13:18.588107 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m20:13:18.600841 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_product_subcategory"
[0m20:13:18.601866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:18.602330 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-07-01 20:13:18.578557 => 2023-07-01 20:13:18.602243
[0m20:13:18.604276 [debug] [Thread-1 (]: On model.desafioaethaina.stg_product_subcategory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_product_subcategory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    productsubcategoryid as subcategory_id
    , productcategoryid as category_id
    , name as subcategory_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productsubcategory`
)

select *
from source_data
    );
  
[0m20:13:18.604659 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_purchase_order_detail
[0m20:13:18.642786 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_detail"
[0m20:13:18.643514 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:18.645099 [debug] [Thread-4 (]: On model.desafioaethaina.stg_purchase_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    purchaseorderid as purchase_order_id
    , purchaseorderdetailid as purchase_order_detail_id
    , cast(duedate as timestamp) as due_date
    , orderqty as order_qty
    , productid as product_id
    , unitprice as unit_price
    , receivedqty as received_qty
    , rejectedqty as rejected_qty
  from  `desafiothaina`.`dev_thaina`.`purchaseorderdetail`
)

select *
from source_data
    );
  
[0m20:13:18.834288 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b3faf321-bb12-4245-8238-7347d5721bff&page=queryresults
[0m20:13:18.836775 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_location (execute): 2023-07-01 20:13:15.354191 => 2023-07-01 20:13:18.836693
[0m20:13:18.837713 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23becfe500>]}
[0m20:13:18.838327 [info ] [Thread-3 (]: 14 of 46 OK created sql table model dev_thaina_silver.stg_product_location ..... [[32mCREATE TABLE (14.0 rows, 670.0 Bytes processed)[0m in 3.49s]
[0m20:13:18.839193 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_location
[0m20:13:18.840341 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchase_order_header
[0m20:13:18.841318 [info ] [Thread-3 (]: 18 of 46 START sql table model dev_thaina_silver.stg_purchase_order_header ..... [RUN]
[0m20:13:18.842915 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_header'
[0m20:13:18.843618 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchase_order_header
[0m20:13:18.849882 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_header"
[0m20:13:18.850713 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (compile): 2023-07-01 20:13:18.844002 => 2023-07-01 20:13:18.850599
[0m20:13:18.851409 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchase_order_header
[0m20:13:18.858398 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchase_order_header"
[0m20:13:18.859264 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:18.861081 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchase_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchase_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchase_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    purchaseorderid as purchase_order_id
    , revisionnumber as revision_number
    , status as status_order
    , employeeid as employee_id
    , vendorid as vendor_id
    , shipmethodid as ship_method_id
    , shipdate as ship_date
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight  
    /* Total due to vendor. Computed as Subtotal + TaxAmt + Freight.
Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0))  */
  from
    `desafiothaina`.`dev_thaina`.`purchaseorderheader`
)

select * 
  from source_data
    );
  
[0m20:13:20.281840 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:757ca545-50be-400d-b73c-04c5eaee7e03&page=queryresults
[0m20:13:20.283884 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_model (execute): 2023-07-01 20:13:16.552151 => 2023-07-01 20:13:20.283819
[0m20:13:20.284635 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23beec5150>]}
[0m20:13:20.285116 [info ] [Thread-2 (]: 15 of 46 OK created sql table model dev_thaina_silver.stg_product_model ........ [[32mCREATE TABLE (128.0 rows, 8.0 KB processed)[0m in 3.74s]
[0m20:13:20.286045 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_model
[0m20:13:20.287711 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_purchasing_product_vendor
[0m20:13:20.288990 [info ] [Thread-2 (]: 19 of 46 START sql table model dev_thaina_silver.stg_purchasing_product_vendor . [RUN]
[0m20:13:20.290156 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_product_vendor'
[0m20:13:20.290611 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_purchasing_product_vendor
[0m20:13:20.294210 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m20:13:20.294857 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (compile): 2023-07-01 20:13:20.290855 => 2023-07-01 20:13:20.294745
[0m20:13:20.295437 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_purchasing_product_vendor
[0m20:13:20.301224 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m20:13:20.302563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:20.306389 [debug] [Thread-2 (]: On model.desafioaethaina.stg_purchasing_product_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_product_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_product_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , productid as product_id
    , standardprice as standard_price
    , minorderqty as min_order_qty
    , maxorderqty as max_order_qty
    , onorderqty as on_order_qty
    , unitmeasurecode as unit_measure_code
  from  `desafiothaina`.`dev_thaina`.`productvendor`
)

select *
from source_data
    );
  
[0m20:13:22.420179 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:53257d8d-3cf4-4d73-b7e4-57835d2aced5&page=queryresults
[0m20:13:22.422187 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (execute): 2023-07-01 20:13:18.852027 => 2023-07-01 20:13:22.422124
[0m20:13:22.422982 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23becfc700>]}
[0m20:13:22.423483 [info ] [Thread-3 (]: 18 of 46 OK created sql table model dev_thaina_silver.stg_purchase_order_header  [[32mCREATE TABLE (4.0k rows, 380.0 KB processed)[0m in 3.58s]
[0m20:13:22.423988 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchase_order_header
[0m20:13:22.424668 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchasing_ship_method
[0m20:13:22.425366 [info ] [Thread-3 (]: 20 of 46 START sql table model dev_thaina_silver.stg_purchasing_ship_method .... [RUN]
[0m20:13:22.426735 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_ship_method'
[0m20:13:22.427327 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchasing_ship_method
[0m20:13:22.439312 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m20:13:22.440292 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:325f6af2-4b55-4346-ab80-73c998838fc4&page=queryresults
[0m20:13:22.443519 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_product_subcategory (execute): 2023-07-01 20:13:18.566988 => 2023-07-01 20:13:22.443314
[0m20:13:22.444091 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (compile): 2023-07-01 20:13:22.427735 => 2023-07-01 20:13:22.444002
[0m20:13:22.445391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23beec4100>]}
[0m20:13:22.446237 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_purchasing_ship_method
[0m20:13:22.447492 [info ] [Thread-1 (]: 16 of 46 OK created sql table model dev_thaina_silver.stg_product_subcategory .. [[32mCREATE TABLE (37.0 rows, 2.3 KB processed)[0m in 3.90s]
[0m20:13:22.451017 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:915ea43b-2f0a-462a-be98-961ae9ab6eba&page=queryresults
[0m20:13:22.538558 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_product_subcategory
[0m20:13:22.547122 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (execute): 2023-07-01 20:13:18.638950 => 2023-07-01 20:13:22.547059
[0m20:13:22.552026 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_purchasing_vendor
[0m20:13:22.557387 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bef5cd90>]}
[0m20:13:22.571765 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m20:13:22.569129 [info ] [Thread-1 (]: 21 of 46 START sql table model dev_thaina_silver.stg_purchasing_vendor ......... [RUN]
[0m20:13:22.572945 [info ] [Thread-4 (]: 17 of 46 OK created sql table model dev_thaina_silver.stg_purchase_order_detail  [[32mCREATE TABLE (8.8k rows, 837.9 KB processed)[0m in 4.00s]
[0m20:13:22.574476 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_vendor'
[0m20:13:22.575203 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m20:13:22.575620 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:22.576320 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_purchasing_vendor
[0m20:13:22.576817 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_country_region_currency
[0m20:13:22.583633 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_vendor"
[0m20:13:22.586594 [debug] [Thread-3 (]: On model.desafioaethaina.stg_purchasing_ship_method: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_ship_method"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
    );
  
[0m20:13:22.587670 [info ] [Thread-4 (]: 22 of 46 START sql table model dev_thaina_silver.stg_sales_country_region_currency  [RUN]
[0m20:13:22.589632 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (compile): 2023-07-01 20:13:22.577312 => 2023-07-01 20:13:22.589336
[0m20:13:22.629951 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_country_region_currency'
[0m20:13:22.630729 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_purchasing_vendor
[0m20:13:22.631184 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_country_region_currency
[0m20:13:22.635840 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_purchasing_vendor"
[0m20:13:22.640610 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m20:13:22.641494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:22.642003 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (compile): 2023-07-01 20:13:22.636177 => 2023-07-01 20:13:22.641879
[0m20:13:22.644467 [debug] [Thread-1 (]: On model.desafioaethaina.stg_purchasing_vendor: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_purchasing_vendor"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_vendor`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    businessentityid as business_entity_id
    , accountnumber as account_number
    , name as company_name
    -- 1 = Superior, 2 = Excellent, 3 = Above average, 4 = Average, 5 = Below
    , creditrating as credit_rate
    , activeflag as active_flag
  from  `desafiothaina`.`dev_thaina`.`vendor`
)

select *
from source_data
    );
  
[0m20:13:22.644872 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_country_region_currency
[0m20:13:22.682917 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m20:13:22.684221 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:22.686135 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_country_region_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_country_region_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_country_region_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
      countryregioncode as country_region_code
      , currencycode as currency_code
    from `desafiothaina`.`dev_thaina`.`countryregioncurrency`
  )
select  *
from source_data
    );
  
[0m20:13:23.558574 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8446dcbc-33c5-41cb-a91f-ee25b6c0e690&page=queryresults
[0m20:13:23.560644 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (execute): 2023-07-01 20:13:20.295749 => 2023-07-01 20:13:23.560580
[0m20:13:23.561420 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bedc7040>]}
[0m20:13:23.562083 [info ] [Thread-2 (]: 19 of 46 OK created sql table model dev_thaina_silver.stg_purchasing_product_vendor  [[32mCREATE TABLE (460.0 rows, 21.4 KB processed)[0m in 3.27s]
[0m20:13:23.562858 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_purchasing_product_vendor
[0m20:13:23.563405 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_creditcard
[0m20:13:23.564046 [info ] [Thread-2 (]: 23 of 46 START sql table model dev_thaina_silver.stg_sales_creditcard .......... [RUN]
[0m20:13:23.565098 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_creditcard'
[0m20:13:23.565476 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_creditcard
[0m20:13:23.575882 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_creditcard"
[0m20:13:23.577138 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (compile): 2023-07-01 20:13:23.565691 => 2023-07-01 20:13:23.576961
[0m20:13:23.577529 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_creditcard
[0m20:13:23.581389 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_creditcard"
[0m20:13:23.581974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:23.585406 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_creditcard: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_creditcard"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    creditcardid as credit_card_id
    , cardtype as card_type
  from  `desafiothaina`.`dev_thaina`.`creditcard`
)
select *
from source_data
    );
  
[0m20:13:26.355584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f8316428-2bf9-4adf-a642-9e27867fc9c1&page=queryresults
[0m20:13:26.355985 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b8e9733a-dbb1-481b-bba9-b73ed12effe5&page=queryresults
[0m20:13:26.357881 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (execute): 2023-07-01 20:13:22.631575 => 2023-07-01 20:13:26.357802
[0m20:13:26.358326 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2be2d5f8-d186-47c8-a9b3-8b0d663e0715&page=queryresults
[0m20:13:26.360211 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (execute): 2023-07-01 20:13:22.451732 => 2023-07-01 20:13:26.360160
[0m20:13:26.361041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bee3c820>]}
[0m20:13:26.362880 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (execute): 2023-07-01 20:13:22.679303 => 2023-07-01 20:13:26.362825
[0m20:13:26.364380 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc3929e0>]}
[0m20:13:26.365056 [info ] [Thread-1 (]: 21 of 46 OK created sql table model dev_thaina_silver.stg_purchasing_vendor .... [[32mCREATE TABLE (104.0 rows, 5.1 KB processed)[0m in 3.79s]
[0m20:13:26.368594 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bed4c9d0>]}
[0m20:13:26.369560 [info ] [Thread-3 (]: 20 of 46 OK created sql table model dev_thaina_silver.stg_purchasing_ship_method  [[32mCREATE TABLE (5.0 rows, 400.0 Bytes processed)[0m in 3.94s]
[0m20:13:26.370262 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_purchasing_vendor
[0m20:13:26.371146 [info ] [Thread-4 (]: 22 of 46 OK created sql table model dev_thaina_silver.stg_sales_country_region_currency  [[32mCREATE TABLE (109.0 rows, 981.0 Bytes processed)[0m in 3.74s]
[0m20:13:26.372147 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchasing_ship_method
[0m20:13:26.372624 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_currency
[0m20:13:26.373118 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_country_region_currency
[0m20:13:26.373666 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_currency_rate
[0m20:13:26.374525 [info ] [Thread-1 (]: 24 of 46 START sql table model dev_thaina_silver.stg_sales_currency ............ [RUN]
[0m20:13:26.376474 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_customer
[0m20:13:26.377351 [info ] [Thread-3 (]: 25 of 46 START sql table model dev_thaina_silver.stg_sales_currency_rate ....... [RUN]
[0m20:13:26.378553 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency'
[0m20:13:26.384237 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_currency
[0m20:13:26.380357 [info ] [Thread-4 (]: 26 of 46 START sql table model dev_thaina_silver.stg_sales_customer ............ [RUN]
[0m20:13:26.383171 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency_rate'
[0m20:13:26.394615 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency"
[0m20:13:26.396045 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_customer'
[0m20:13:26.397282 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_currency_rate
[0m20:13:26.398342 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_customer
[0m20:13:26.399092 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_currency (compile): 2023-07-01 20:13:26.384791 => 2023-07-01 20:13:26.398970
[0m20:13:26.406899 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency_rate"
[0m20:13:26.412114 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_customer"
[0m20:13:26.412699 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_currency
[0m20:13:26.414011 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_customer (compile): 2023-07-01 20:13:26.407527 => 2023-07-01 20:13:26.413772
[0m20:13:26.414508 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (compile): 2023-07-01 20:13:26.399334 => 2023-07-01 20:13:26.414402
[0m20:13:26.423960 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency"
[0m20:13:26.424724 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_customer
[0m20:13:26.425237 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_currency_rate
[0m20:13:26.432482 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_customer"
[0m20:13:26.433011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:26.438291 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_currency_rate"
[0m20:13:26.440383 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_currency: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    currencycode as currency_code
    , name as currency_name
  from  `desafiothaina`.`dev_thaina`.`currency`
)

select *
from source_data
    );
  
[0m20:13:26.440791 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:26.476709 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_customer: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_customer"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
    );
  
[0m20:13:26.508767 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:26.512368 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_currency_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_currency_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      currencyrateid as currency_rate_id
      , currencyratedate as currency_rate_date
      , fromcurrencycode as from_currency_code
      , tocurrencycode as to_currency_code
      , averagerate as avg_rate
      , endofdayrate as end_of_day_rate
    from `desafiothaina`.`dev_thaina`.`currencyrate`
  )
select  *
from source_data
    );
  
[0m20:13:26.926214 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c97d93df-142b-4542-8310-92b9458871d6&page=queryresults
[0m20:13:26.928434 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (execute): 2023-07-01 20:13:23.577758 => 2023-07-01 20:13:26.928372
[0m20:13:26.929175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf05f8b0>]}
[0m20:13:26.929664 [info ] [Thread-2 (]: 23 of 46 OK created sql table model dev_thaina_silver.stg_sales_creditcard ..... [[32mCREATE TABLE (19.1k rows, 378.8 KB processed)[0m in 3.36s]
[0m20:13:26.930200 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_creditcard
[0m20:13:26.930829 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_order_detail
[0m20:13:26.931481 [info ] [Thread-2 (]: 27 of 46 START sql table model dev_thaina_silver.stg_sales_order_detail ........ [RUN]
[0m20:13:26.932535 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_detail'
[0m20:13:26.932951 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_order_detail
[0m20:13:26.936469 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_detail"
[0m20:13:26.937151 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (compile): 2023-07-01 20:13:26.933208 => 2023-07-01 20:13:26.937045
[0m20:13:26.937650 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_order_detail
[0m20:13:26.944557 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_detail"
[0m20:13:26.945602 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:26.948129 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_detail"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
    );
  
[0m20:13:30.317823 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8e6cefc9-4e54-4845-b0a8-ca0db30a9cc2&page=queryresults
[0m20:13:30.318746 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:fc64c03b-4277-409c-a263-10d95c3d8b1d&page=queryresults
[0m20:13:30.321465 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (execute): 2023-07-01 20:13:26.433275 => 2023-07-01 20:13:30.321390
[0m20:13:30.327410 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_currency (execute): 2023-07-01 20:13:26.414803 => 2023-07-01 20:13:30.327308
[0m20:13:30.328448 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bef6dff0>]}
[0m20:13:30.329761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc390b20>]}
[0m20:13:30.330573 [info ] [Thread-3 (]: 25 of 46 OK created sql table model dev_thaina_silver.stg_sales_currency_rate .. [[32mCREATE TABLE (13.5k rows, 779.7 KB processed)[0m in 3.95s]
[0m20:13:30.333391 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_currency_rate
[0m20:13:30.334305 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m20:13:30.335015 [info ] [Thread-3 (]: 28 of 46 START sql table model dev_thaina_silver.stg_sales_order_header ........ [RUN]
[0m20:13:30.336157 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m20:13:30.336687 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m20:13:30.341086 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m20:13:30.341709 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-07-01 20:13:30.336933 => 2023-07-01 20:13:30.341603
[0m20:13:30.342171 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_order_header
[0m20:13:30.347165 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header"
[0m20:13:30.347903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:30.349962 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_order_header: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(cast(orderdate as timestamp) as date) as order_date
    , cast(cast(duedate as timestamp) as date) as due_date
    , cast(cast(shipdate as timestamp) as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
    );
  
[0m20:13:30.722965 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9fe56747-d3a3-4637-ba4f-fb9af42c4305&page=queryresults
[0m20:13:30.725417 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_customer (execute): 2023-07-01 20:13:26.426003 => 2023-07-01 20:13:30.725349
[0m20:13:30.726465 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc3bd210>]}
[0m20:13:31.347806 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a6b35c49-c81d-4a01-83d2-552efb4d957b&page=queryresults
[0m20:13:31.351288 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (execute): 2023-07-01 20:13:26.938089 => 2023-07-01 20:13:31.351189
[0m20:13:31.352545 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf05e950>]}
[0m20:13:31.360032 [info ] [Thread-1 (]: 24 of 46 OK created sql table model dev_thaina_silver.stg_sales_currency ....... [[32mCREATE TABLE (105.0 rows, 2.0 KB processed)[0m in 3.95s]
[0m20:13:31.363105 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_currency
[0m20:13:31.361869 [info ] [Thread-4 (]: 26 of 46 OK created sql table model dev_thaina_silver.stg_sales_customer ....... [[32mCREATE TABLE (19.8k rows, 1.2 MB processed)[0m in 4.33s]
[0m20:13:31.364079 [info ] [Thread-2 (]: 27 of 46 OK created sql table model dev_thaina_silver.stg_sales_order_detail ... [[32mCREATE TABLE (121.3k rows, 10.8 MB processed)[0m in 4.42s]
[0m20:13:31.366558 [debug] [Thread-1 (]: Began running node model.desafioaethaina.stg_sales_order_header_reason
[0m20:13:31.367603 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_customer
[0m20:13:31.368654 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_order_detail
[0m20:13:31.369419 [info ] [Thread-1 (]: 29 of 46 START sql table model dev_thaina_silver.stg_sales_order_header_reason . [RUN]
[0m20:13:31.370340 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_person
[0m20:13:31.371077 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_person_quota_history
[0m20:13:31.371975 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header_reason'
[0m20:13:31.372552 [info ] [Thread-4 (]: 30 of 46 START sql table model dev_thaina_silver.stg_sales_person .............. [RUN]
[0m20:13:31.373490 [info ] [Thread-2 (]: 31 of 46 START sql table model dev_thaina_silver.stg_sales_person_quota_history  [RUN]
[0m20:13:31.374320 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.stg_sales_order_header_reason
[0m20:13:31.375481 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person'
[0m20:13:31.376518 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person_quota_history'
[0m20:13:31.382483 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m20:13:31.383342 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_person
[0m20:13:31.384564 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_person_quota_history
[0m20:13:31.394078 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m20:13:31.398494 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (compile): 2023-07-01 20:13:31.377025 => 2023-07-01 20:13:31.398362
[0m20:13:31.405254 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.stg_sales_order_header_reason
[0m20:13:31.416396 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (compile): 2023-07-01 20:13:31.389817 => 2023-07-01 20:13:31.416267
[0m20:13:31.415980 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person"
[0m20:13:31.428199 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m20:13:31.428633 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_person_quota_history
[0m20:13:31.435705 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m20:13:31.436802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:31.437186 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person (compile): 2023-07-01 20:13:31.385444 => 2023-07-01 20:13:31.437082
[0m20:13:31.437713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:31.438069 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_person
[0m20:13:31.439960 [debug] [Thread-1 (]: On model.desafioaethaina.stg_sales_order_header_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_order_header_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
    );
  
[0m20:13:31.444314 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_person"
[0m20:13:31.446090 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_person_quota_history: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person_quota_history"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person_quota_history`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , quotadate as quota_date
      , salesquota as sales_quota
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salespersonquotahistory`
  )

select  *
from source_data
    );
  
[0m20:13:31.513209 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:31.514997 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      businessentityid as business_entity_id
      , territoryid as territory_id
      , salesquota as sales_quota
      , bonus
      , commissionpct as commission_pct
      , salesytd as sales_total
      , saleslastyear as sales_last_year
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salesperson`
  )

select  *
from source_data
    );
  
[0m20:13:34.718848 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:99dff6ee-8204-4b5f-810d-2f467b378af0&page=queryresults
[0m20:13:34.721840 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header (execute): 2023-07-01 20:13:30.342458 => 2023-07-01 20:13:34.721745
[0m20:13:34.722876 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc3a65c0>]}
[0m20:13:34.723611 [info ] [Thread-3 (]: 28 of 46 OK created sql table model dev_thaina_silver.stg_sales_order_header ... [[32mCREATE TABLE (31.5k rows, 7.4 MB processed)[0m in 4.39s]
[0m20:13:34.724402 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m20:13:34.725193 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_reason
[0m20:13:34.725838 [info ] [Thread-3 (]: 32 of 46 START sql table model dev_thaina_silver.stg_sales_reason .............. [RUN]
[0m20:13:34.726932 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_reason'
[0m20:13:34.727312 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_reason
[0m20:13:34.730897 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_reason"
[0m20:13:34.731692 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_reason (compile): 2023-07-01 20:13:34.727556 => 2023-07-01 20:13:34.731540
[0m20:13:34.732489 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.stg_sales_reason
[0m20:13:34.739852 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_reason"
[0m20:13:34.740553 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:34.745486 [debug] [Thread-3 (]: On model.desafioaethaina.stg_sales_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salesreasonid as sales_reason_id
      , name as name_reason
      , reasontype as reason_type
    from `desafiothaina`.`dev_thaina`.`salesreason`
  )

select  *
from source_data
    );
  
[0m20:13:35.032289 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:0c83c6db-ff44-4d35-ba01-05897595c8e0&page=queryresults
[0m20:13:35.034492 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person (execute): 2023-07-01 20:13:31.440448 => 2023-07-01 20:13:35.034419
[0m20:13:35.035654 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bef2ec50>]}
[0m20:13:35.036502 [info ] [Thread-4 (]: 30 of 46 OK created sql table model dev_thaina_silver.stg_sales_person ......... [[32mCREATE TABLE (17.0 rows, 1.5 KB processed)[0m in 3.66s]
[0m20:13:35.037391 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_person
[0m20:13:35.039440 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:140db3cb-4198-4a39-b5c6-68d922375454&page=queryresults
[0m20:13:35.040626 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_tax_rate
[0m20:13:35.044389 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (execute): 2023-07-01 20:13:31.429152 => 2023-07-01 20:13:35.044142
[0m20:13:35.045651 [info ] [Thread-4 (]: 33 of 46 START sql table model dev_thaina_silver.stg_sales_tax_rate ............ [RUN]
[0m20:13:35.048429 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bef46c80>]}
[0m20:13:35.050708 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_tax_rate'
[0m20:13:35.051819 [info ] [Thread-2 (]: 31 of 46 OK created sql table model dev_thaina_silver.stg_sales_person_quota_history  [[32mCREATE TABLE (163.0 rows, 12.6 KB processed)[0m in 3.67s]
[0m20:13:35.052653 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_tax_rate
[0m20:13:35.053153 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_person_quota_history
[0m20:13:35.057964 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_tax_rate"
[0m20:13:35.059989 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (compile): 2023-07-01 20:13:35.053418 => 2023-07-01 20:13:35.059848
[0m20:13:35.058818 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_territory
[0m20:13:35.060901 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.stg_sales_tax_rate
[0m20:13:35.061794 [info ] [Thread-2 (]: 34 of 46 START sql table model dev_thaina_silver.stg_sales_territory ........... [RUN]
[0m20:13:35.072901 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_tax_rate"
[0m20:13:35.074595 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_territory'
[0m20:13:35.075206 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_territory
[0m20:13:35.080931 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:35.080338 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_territory"
[0m20:13:35.084286 [debug] [Thread-4 (]: On model.desafioaethaina.stg_sales_tax_rate: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_tax_rate"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_tax_rate`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with
  source_data as (
    select
      salestaxrateid as sales_tax_rate_id
      , stateprovinceid as state_province_id
      , taxtype as tax_type
      , taxrate as tax_rate
      , name as name_tax_rate_desciption
      , rowguid
    from `desafiothaina`.`dev_thaina`.`salestaxrate`
  )

select  *
from source_data
    );
  
[0m20:13:35.131917 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_territory (compile): 2023-07-01 20:13:35.075552 => 2023-07-01 20:13:35.131545
[0m20:13:35.133199 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.stg_sales_territory
[0m20:13:35.148008 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.stg_sales_territory"
[0m20:13:35.148999 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:35.152256 [debug] [Thread-2 (]: On model.desafioaethaina.stg_sales_territory: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.stg_sales_territory"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
    );
  
[0m20:13:35.217880 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:69d598b1-171f-41ee-b9a5-3b32dc5ce158&page=queryresults
[0m20:13:35.220976 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (execute): 2023-07-01 20:13:31.417445 => 2023-07-01 20:13:35.220861
[0m20:13:35.222292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc390ca0>]}
[0m20:13:35.223153 [info ] [Thread-1 (]: 29 of 46 OK created sql table model dev_thaina_silver.stg_sales_order_header_reason  [[32mCREATE TABLE (27.6k rows, 432.0 KB processed)[0m in 3.85s]
[0m20:13:35.236157 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.stg_sales_order_header_reason
[0m20:13:35.238008 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_address
[0m20:13:35.239210 [info ] [Thread-1 (]: 35 of 46 START sql table model dev_thaina_intermediate.int_address ............. [RUN]
[0m20:13:35.248307 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m20:13:35.251446 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_address
[0m20:13:35.263703 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m20:13:35.264654 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-07-01 20:13:35.252609 => 2023-07-01 20:13:35.264524
[0m20:13:35.265505 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_address
[0m20:13:35.273430 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_address"
[0m20:13:35.274640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:35.279796 [debug] [Thread-1 (]: On model.desafioaethaina.int_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address`
)

, address_type as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_address_type`
)

, business_entity_address as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_address`
)

, business_entity_contact as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_business_entity_contact`
)

, contact_type_worker as (
	select  * 
    from  `desafiothaina`.`dev_thaina_silver`.`stg_person_contact_type` 
)

, union_person_addres as (
    select
        business_entity_address.address_id
        , business_entity_id
        , business_entity_address.address_type_id
        , concat(address_line1, ' ', ifnull('',address_line2), ' ', postal_code) as address
        , city
        , state_province_id
        , address_type_name
    from business_entity_address
    left join address
    on address.address_id = business_entity_address.address_id
   	left join address_type
   	on address_type.address_type_id = business_entity_address.address_type_id
)

, union_contact_type as (
	select 
		union_person_addres.*
		, person_id as worker_id
		, contact_type_worker.contact_type_id 
		, contact_type_name as contact_type_name_worker
	from union_person_addres
	left join business_entity_contact
	on business_entity_contact.business_entity_id = union_person_addres.business_entity_id 
	left join contact_type_worker
	on contact_type_worker.contact_type_id = business_entity_contact.contact_type_id
)

select * 
from union_contact_type
    );
  
[0m20:13:38.918306 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b4409a93-5c4c-4e64-8f50-e2ae92a0724d&page=queryresults
[0m20:13:38.919382 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9d96502f-b485-45b4-9a50-59bebbe35991&page=queryresults
[0m20:13:38.922921 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (execute): 2023-07-01 20:13:35.063120 => 2023-07-01 20:13:38.922847
[0m20:13:38.929132 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_reason (execute): 2023-07-01 20:13:34.732993 => 2023-07-01 20:13:38.929065
[0m20:13:38.930268 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc472920>]}
[0m20:13:38.931176 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bed4cd90>]}
[0m20:13:38.931821 [info ] [Thread-4 (]: 33 of 46 OK created sql table model dev_thaina_silver.stg_sales_tax_rate ....... [[32mCREATE TABLE (29.0 rows, 2.6 KB processed)[0m in 3.88s]
[0m20:13:38.932732 [info ] [Thread-3 (]: 32 of 46 OK created sql table model dev_thaina_silver.stg_sales_reason ......... [[32mCREATE TABLE (10.0 rows, 305.0 Bytes processed)[0m in 4.20s]
[0m20:13:38.933566 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_tax_rate
[0m20:13:38.934082 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_reason
[0m20:13:38.934590 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_product
[0m20:13:38.935250 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_sales
[0m20:13:38.935921 [info ] [Thread-4 (]: 36 of 46 START sql table model dev_thaina_intermediate.int_product ............. [RUN]
[0m20:13:38.936869 [info ] [Thread-3 (]: 37 of 46 START sql table model dev_thaina_intermediate.int_sales ............... [RUN]
[0m20:13:38.937909 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m20:13:38.938653 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m20:13:38.939017 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_product
[0m20:13:38.939396 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_sales
[0m20:13:38.949679 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m20:13:38.955690 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m20:13:38.956903 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-07-01 20:13:38.939772 => 2023-07-01 20:13:38.956766
[0m20:13:38.957567 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 20:13:38.950732 => 2023-07-01 20:13:38.957355
[0m20:13:38.959047 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.int_product
[0m20:13:38.959884 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.int_sales
[0m20:13:38.968769 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.int_product"
[0m20:13:38.976502 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.int_sales"
[0m20:13:38.977143 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:38.977617 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:38.980300 [debug] [Thread-4 (]: On model.desafioaethaina.int_product: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_product"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with product as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product` 
)

, subcategory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_subcategory`
)

, category as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_category`
)

, inventory as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_inventory`
)

, location as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_location`
)

, model as (
    select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_product_model`
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from product
    left join subcategory
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from union_product_subcategory
	left join category
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from union_product_category
	left join model
    on union_product_category.product_model_id = model.model_id
)

, union_product_inventory as (
    select 
        union_product_model.*
        , quantity_inventory
        , shelf
        , bin
    from union_product_model
    left join inventory
    on union_product_model.product_id = inventory.product_id
)

select * 
from union_product_inventory
    );
  
[0m20:13:39.017340 [debug] [Thread-3 (]: On model.desafioaethaina.int_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header`	
)

, order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, order_detail as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_detail`	
)

, credit_card as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_creditcard`	
)

, ship_method as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_purchasing_ship_method`
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
    );
  
[0m20:13:39.216056 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4f6eebd3-b4cd-4890-ba35-45aad5cb6490&page=queryresults
[0m20:13:39.219013 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_territory (execute): 2023-07-01 20:13:35.134029 => 2023-07-01 20:13:39.218920
[0m20:13:39.220247 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf05d6f0>]}
[0m20:13:39.221025 [info ] [Thread-2 (]: 34 of 46 OK created sql table model dev_thaina_silver.stg_sales_territory ...... [[32mCREATE TABLE (10.0 rows, 925.0 Bytes processed)[0m in 4.15s]
[0m20:13:39.222760 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_territory
[0m20:13:39.223473 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_reason
[0m20:13:39.224367 [info ] [Thread-2 (]: 38 of 46 START sql table model dev_thaina_intermediate.int_reason .............. [RUN]
[0m20:13:39.226835 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_reason'
[0m20:13:39.227399 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_reason
[0m20:13:39.236277 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_reason"
[0m20:13:39.237051 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_reason (compile): 2023-07-01 20:13:39.227904 => 2023-07-01 20:13:39.236938
[0m20:13:39.237555 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.int_reason
[0m20:13:39.251147 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.int_reason"
[0m20:13:39.252283 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:39.265256 [debug] [Thread-2 (]: On model.desafioaethaina.int_reason: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_reason"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_reason`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with order_header_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_order_header_reason`	
)

, sales_reason as (
	select * 
	from `desafiothaina`.`dev_thaina_silver`.`stg_sales_reason`	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

select *
from union_reason
    );
  
[0m20:13:39.526300 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:63dacf5f-1001-4a7f-98db-216f613ac4e4&page=queryresults
[0m20:13:39.529408 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_address (execute): 2023-07-01 20:13:35.266026 => 2023-07-01 20:13:39.529317
[0m20:13:39.530636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf2822c0>]}
[0m20:13:39.531560 [info ] [Thread-1 (]: 35 of 46 OK created sql table model dev_thaina_intermediate.int_address ........ [[32mCREATE TABLE (19.7k rows, 1.5 MB processed)[0m in 4.28s]
[0m20:13:39.532461 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_address
[0m20:13:39.533246 [debug] [Thread-1 (]: Began running node model.desafioaethaina.int_person
[0m20:13:39.534312 [info ] [Thread-1 (]: 39 of 46 START sql table model dev_thaina_intermediate.int_person .............. [RUN]
[0m20:13:39.536750 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m20:13:39.537236 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.int_person
[0m20:13:39.548676 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m20:13:39.551165 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 20:13:39.537643 => 2023-07-01 20:13:39.550905
[0m20:13:39.552060 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.int_person
[0m20:13:39.562168 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.int_person"
[0m20:13:39.563018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:39.565920 [debug] [Thread-1 (]: On model.desafioaethaina.int_person: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.int_person"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with customer as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_customer`
)

, sales_territory as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_sales_territory`
)

, person_person as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_person`
)

, person_country as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_country_region`
)

, state_province as (
	select * 
    from `desafiothaina`.`dev_thaina_silver`.`stg_person_state_province`
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , sales_territory_year
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixed_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, sales_territory_year
		, country_region_name
		, state_province_id
		, state_province_code
		, state_province_name
	from union_customer_state_province
	where customer_id is not null

)

select * 
from change_columns_name
    );
  
[0m20:13:43.426012 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1601a5df-0540-4104-9ef1-3d33dd53034b&page=queryresults
[0m20:13:43.433179 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:85d8576c-747a-4f7f-9762-be3284bef2d0&page=queryresults
[0m20:13:43.438513 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_product (execute): 2023-07-01 20:13:38.960291 => 2023-07-01 20:13:43.438404
[0m20:13:43.440014 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc470d30>]}
[0m20:13:43.440970 [info ] [Thread-4 (]: 36 of 46 OK created sql table model dev_thaina_intermediate.int_product ........ [[32mCREATE TABLE (1.1k rows, 93.1 KB processed)[0m in 4.50s]
[0m20:13:43.441994 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_product
[0m20:13:43.442830 [debug] [Thread-4 (]: Began running node model.desafioaethaina.dim_address
[0m20:13:43.445177 [info ] [Thread-4 (]: 40 of 46 START sql table model dev_thaina_gold.dim_address ..................... [RUN]
[0m20:13:43.446692 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m20:13:43.447294 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.dim_address
[0m20:13:43.444351 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_reason (execute): 2023-07-01 20:13:39.237963 => 2023-07-01 20:13:43.444248
[0m20:13:43.457350 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bef66aa0>]}
[0m20:13:43.458535 [info ] [Thread-2 (]: 38 of 46 OK created sql table model dev_thaina_intermediate.int_reason ......... [[32mCREATE TABLE (27.6k rows, 432.3 KB processed)[0m in 4.23s]
[0m20:13:43.459887 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_reason
[0m20:13:43.461072 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_products
[0m20:13:43.462146 [info ] [Thread-2 (]: 41 of 46 START sql table model dev_thaina_gold.dim_products .................... [RUN]
[0m20:13:43.463850 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m20:13:43.464462 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.dim_products
[0m20:13:43.475187 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m20:13:43.476301 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m20:13:43.477305 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 20:13:43.450141 => 2023-07-01 20:13:43.477165
[0m20:13:43.477930 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.dim_address
[0m20:13:43.486433 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m20:13:43.488035 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-07-01 20:13:43.464863 => 2023-07-01 20:13:43.487848
[0m20:13:43.489017 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.dim_products
[0m20:13:43.500272 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:43.503810 [debug] [Thread-4 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_address as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_address`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by address_id order by address_id) as dedup_index
    from int_address
)

, address_with_sk  as (
    select
        MD5(cast(address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , address_type_name
        , worker_id
        , contact_type_id
        , contact_type_name_worker
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from address_with_sk
    );
  
[0m20:13:43.552341 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m20:13:43.553190 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:43.555775 [debug] [Thread-2 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with int_product as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_product`
    where product_id is not null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
 
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1  
)

-- , select_not_null as (
--     select *
--     from prodcut_with_sk
--     where product_sk is not null
-- )

select *
from prodcut_with_sk
    );
  
[0m20:13:45.471094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:69cef446-32c3-4c19-8c0a-8559369e72cc&page=queryresults
[0m20:13:45.473781 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.int_person (execute): 2023-07-01 20:13:39.552791 => 2023-07-01 20:13:45.473710
[0m20:13:45.475199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bed4f1c0>]}
[0m20:13:45.475839 [info ] [Thread-1 (]: 39 of 46 OK created sql table model dev_thaina_intermediate.int_person ......... [[32mCREATE TABLE (358.6k rows, 1.2 MB processed)[0m in 5.94s]
[0m20:13:45.478167 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.int_person
[0m20:13:45.478949 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_reasons
[0m20:13:45.479744 [info ] [Thread-1 (]: 42 of 46 START sql table model dev_thaina_gold.dim_reasons ..................... [RUN]
[0m20:13:45.481276 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_reasons'
[0m20:13:45.481860 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_reasons
[0m20:13:45.487692 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_reasons"
[0m20:13:45.488579 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (compile): 2023-07-01 20:13:45.482243 => 2023-07-01 20:13:45.488441
[0m20:13:45.489299 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_reasons
[0m20:13:45.498794 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_reasons"
[0m20:13:45.500303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:45.505191 [debug] [Thread-1 (]: On model.desafioaethaina.dim_reasons: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_reasons"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_reasons`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
    select *
    from `desafiothaina`.`dev_thaina_intermediate`.`int_reason`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_reason_id order by sales_reason_id) as dedup_index
    from int_sales
)

, reason_with_sk  as (
    select
        MD5(cast(sales_reason_id as string)) as sales_reason_fk
        , sales_order_id
        , name_reason
        , reason_type
      from deduplication_data
    where dedup_index = 1
)

select *
from reason_with_sk
    );
  
[0m20:13:46.035286 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:341c7f1b-2bc3-4663-91e3-06e7a06a4b36&page=queryresults
[0m20:13:46.038037 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_sales (execute): 2023-07-01 20:13:38.969193 => 2023-07-01 20:13:46.037971
[0m20:13:46.039089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc470940>]}
[0m20:13:46.039999 [info ] [Thread-3 (]: 37 of 46 OK created sql table model dev_thaina_intermediate.int_sales .......... [[32mCREATE TABLE (121.3k rows, 12.6 MB processed)[0m in 7.10s]
[0m20:13:46.040637 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_sales
[0m20:13:46.041143 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_customers
[0m20:13:46.041718 [info ] [Thread-3 (]: 43 of 46 START sql table model dev_thaina_gold.dim_customers ................... [RUN]
[0m20:13:46.042614 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m20:13:46.043378 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_customers
[0m20:13:46.047803 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m20:13:46.048476 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 20:13:46.043754 => 2023-07-01 20:13:46.048359
[0m20:13:46.049003 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_customers
[0m20:13:46.053376 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m20:13:46.054206 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:13:46.056641 [debug] [Thread-3 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        MD5(cast(fixed_customer_id as string)) as customer_sk
        , full_name 
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m20:13:47.325291 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8f0f2f1a-8f21-45bb-b5da-8919369dffb9&page=queryresults
[0m20:13:47.328900 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 20:13:43.478394 => 2023-07-01 20:13:47.328820
[0m20:13:47.330681 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc471150>]}
[0m20:13:47.332160 [info ] [Thread-4 (]: 40 of 46 OK created sql table model dev_thaina_gold.dim_address ................ [[32mCREATE TABLE (19.6k rows, 1.4 MB processed)[0m in 3.88s]
[0m20:13:47.333273 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.dim_address
[0m20:13:47.334507 [debug] [Thread-4 (]: Began running node model.desafioaethaina.dim_workers
[0m20:13:47.336100 [info ] [Thread-4 (]: 44 of 46 START sql table model dev_thaina_gold.dim_workers ..................... [RUN]
[0m20:13:47.338250 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m20:13:47.339220 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.dim_workers
[0m20:13:47.347811 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m20:13:47.349344 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 20:13:47.339907 => 2023-07-01 20:13:47.349063
[0m20:13:47.350188 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.dim_workers
[0m20:13:47.365889 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m20:13:47.366767 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:13:47.369852 [debug] [Thread-4 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workers of Adventure Works"""
    )
    as (
      with int_person as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_person`
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, worker_with_sk  as (
    select
        MD5(cast(fixed_person_id as string)) as worker_sk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m20:13:47.434369 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c0ff0fa1-1248-4ce4-adb5-4e6209b173f3&page=queryresults
[0m20:13:48.749244 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-07-01 20:13:43.489709 => 2023-07-01 20:13:48.749167
[0m20:13:48.751349 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc2d2b30>]}
[0m20:13:48.753931 [info ] [Thread-2 (]: 41 of 46 OK created sql table model dev_thaina_gold.dim_products ............... [[32mCREATE TABLE (504.0 rows, 111.1 KB processed)[0m in 5.29s]
[0m20:13:48.757198 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_products
[0m20:13:48.757952 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_cards_type
[0m20:13:48.758787 [info ] [Thread-2 (]: 45 of 46 START sql table model dev_thaina_gold.dim_cards_type .................. [RUN]
[0m20:13:48.760285 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m20:13:48.760961 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m20:13:48.767200 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m20:13:48.768050 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 20:13:48.761390 => 2023-07-01 20:13:48.767938
[0m20:13:48.768655 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m20:13:48.777969 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m20:13:48.778624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:48.780885 [debug] [Thread-2 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with int_sales as (
	select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            credit_card_id
            , credit_card_approval_code 
        order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        MD5(cast(credit_card_id as string)) credit_card_sk
        , card_type
        , credit_card_approval_code
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m20:13:49.319542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4c3d97ee-07a8-4a60-98d0-4797973010e0&page=queryresults
[0m20:13:49.321595 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_reasons (execute): 2023-07-01 20:13:45.489767 => 2023-07-01 20:13:49.321528
[0m20:13:49.322640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23beed50f0>]}
[0m20:13:49.323622 [info ] [Thread-1 (]: 42 of 46 OK created sql table model dev_thaina_gold.dim_reasons ................ [[32mCREATE TABLE (7.0 rows, 880.8 KB processed)[0m in 3.84s]
[0m20:13:49.324361 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_reasons
[0m20:13:49.324916 [debug] [Thread-1 (]: Began running node model.desafioaethaina.fact_sales
[0m20:13:49.325476 [info ] [Thread-1 (]: 46 of 46 START sql table model dev_thaina_gold.fact_sales ...................... [RUN]
[0m20:13:49.327398 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m20:13:49.327843 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.fact_sales
[0m20:13:49.332228 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m20:13:49.335175 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 20:13:49.328147 => 2023-07-01 20:13:49.335013
[0m20:13:49.335675 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.fact_sales
[0m20:13:49.340937 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m20:13:49.341855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:49.344834 [debug] [Thread-1 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with int_sales as (
    select * 
    from `desafiothaina`.`dev_thaina_intermediate`.`int_sales`
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , MD5(cast(customer_id as string)) as customer_fk
        , MD5(cast(sales_person_id as string)) as sales_person_fk
        , MD5(cast(bill_to_address_id as string)) as bill_to_address_fk
        , MD5(cast(ship_to_address_id as string)) as ship_to_address_fk
        , MD5(cast(ship_method_id as string)) as ship_method_fk
        , MD5(cast(product_id as string)) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m20:13:49.919148 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:434bd88e-ac85-4f11-bea3-2e2c5c4acb86&page=queryresults
[0m20:13:49.921323 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 20:13:46.049341 => 2023-07-01 20:13:49.921255
[0m20:13:49.922125 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bc470940>]}
[0m20:13:49.922673 [info ] [Thread-3 (]: 43 of 46 OK created sql table model dev_thaina_gold.dim_customers .............. [[32mCREATE TABLE (9.8k rows, 37.9 MB processed)[0m in 3.88s]
[0m20:13:49.923262 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_customers
[0m20:13:51.205028 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1176c322-2d8c-4abe-a689-98aa4639aa89&page=queryresults
[0m20:13:52.231765 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 20:13:47.350763 => 2023-07-01 20:13:52.231702
[0m20:13:52.233166 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bed4c9d0>]}
[0m20:13:52.233863 [info ] [Thread-4 (]: 44 of 46 OK created sql table model dev_thaina_gold.dim_workers ................ [[32mCREATE TABLE (496.0 rows, 38.2 MB processed)[0m in 4.90s]
[0m20:13:52.234526 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.dim_workers
[0m20:13:52.640302 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e0eaafad-e1a1-4b4c-8f92-5e0d36ce10f4&page=queryresults
[0m20:13:52.644318 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 20:13:48.769268 => 2023-07-01 20:13:52.644215
[0m20:13:52.646021 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23becef0d0>]}
[0m20:13:52.646892 [info ] [Thread-2 (]: 45 of 46 OK created sql table model dev_thaina_gold.dim_cards_type ............. [[32mCREATE TABLE (30.3k rows, 3.9 MB processed)[0m in 3.89s]
[0m20:13:52.648694 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m20:13:54.378823 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1af44b58-e44d-434a-8f98-5bfb6b773baf&page=queryresults
[0m20:13:55.552641 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 20:13:49.335947 => 2023-07-01 20:13:55.552570
[0m20:13:55.553534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ad919c-59c3-4f91-9ea2-6e4bc1eaaa87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bed4f1c0>]}
[0m20:13:55.554143 [info ] [Thread-1 (]: 46 of 46 OK created sql table model dev_thaina_gold.fact_sales ................. [[32mCREATE TABLE (121.3k rows, 14.3 MB processed)[0m in 6.23s]
[0m20:13:55.554769 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.fact_sales
[0m20:13:55.557077 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:13:55.557872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:55.558186 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m20:13:55.558490 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m20:13:55.558776 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m20:13:55.559056 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m20:13:55.559606 [info ] [MainThread]: 
[0m20:13:55.560169 [info ] [MainThread]: Finished running 46 table models in 0 hours 0 minutes and 58.74 seconds (58.74s).
[0m20:13:55.564370 [debug] [MainThread]: Command end result
[0m20:13:55.614169 [info ] [MainThread]: 
[0m20:13:55.615685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:55.617808 [info ] [MainThread]: 
[0m20:13:55.618957 [info ] [MainThread]: Done. PASS=46 WARN=0 ERROR=0 SKIP=0 TOTAL=46
[0m20:13:55.620013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23becef0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf2810c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23bf2826e0>]}
[0m20:13:55.621099 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:14:24.300705 | b0a0101b-09d7-4d24-ad77-d26fdfa54027 ==============================
[0m20:14:24.300705 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:14:24.303151 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:14:24.303624 [debug] [MainThread]: Tracking: tracking
[0m20:14:24.305682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a666620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a665b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a6665f0>]}
[0m20:14:24.350081 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:14:24.467140 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:14:24.468083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a67ac80>]}
[0m20:14:26.122651 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_sales.sql
[0m20:14:26.137908 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_product.sql
[0m20:14:26.142679 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_reason.sql
[0m20:14:26.147438 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_address.sql
[0m20:14:26.152311 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_person.sql
[0m20:14:26.157198 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_workers.sql
[0m20:14:26.161879 [debug] [MainThread]: 1699: static parser successfully parsed gold/fact_sales.sql
[0m20:14:26.166466 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_address.sql
[0m20:14:26.171475 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_products.sql
[0m20:14:26.176096 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_cards_type.sql
[0m20:14:26.180707 [debug] [MainThread]: 1603: static parser failed on gold/dim_dates.sql
[0m20:14:26.225232 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim_dates.sql
[0m20:14:26.228294 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_reasons.sql
[0m20:14:26.233798 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim_customers.sql
[0m20:14:26.238862 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_description.sql
[0m20:14:26.243979 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_location.sql
[0m20:14:26.248887 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_inventory.sql
[0m20:14:26.254752 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_subcategory.sql
[0m20:14:26.259582 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_category.sql
[0m20:14:26.264632 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product.sql
[0m20:14:26.271974 [debug] [MainThread]: 1699: static parser successfully parsed silver/products/stg_product_model.sql
[0m20:14:26.277051 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_detail.sql
[0m20:14:26.281778 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_ship_method.sql
[0m20:14:26.287536 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_product_vendor.sql
[0m20:14:26.292906 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchase_order_header.sql
[0m20:14:26.297672 [debug] [MainThread]: 1699: static parser successfully parsed silver/purchasing/stg_purchasing_vendor.sql
[0m20:14:26.303180 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_detail.sql
[0m20:14:26.309273 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency.sql
[0m20:14:26.313986 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_territory.sql
[0m20:14:26.319340 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_currency_rate.sql
[0m20:14:26.325648 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_reason.sql
[0m20:14:26.331212 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_customer.sql
[0m20:14:26.336606 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_country_region_currency.sql
[0m20:14:26.342904 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person.sql
[0m20:14:26.348591 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_tax_rate.sql
[0m20:14:26.354923 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_person_quota_history.sql
[0m20:14:26.360993 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header_reason.sql
[0m20:14:26.366450 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_creditcard.sql
[0m20:14:26.372011 [debug] [MainThread]: 1699: static parser successfully parsed silver/sales/stg_sales_order_header.sql
[0m20:14:26.376697 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_address_type.sql
[0m20:14:26.381357 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_state_province.sql
[0m20:14:26.386161 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_person.sql
[0m20:14:26.390938 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_address.sql
[0m20:14:26.395472 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_contact_type.sql
[0m20:14:26.400326 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_business_entity_address.sql
[0m20:14:26.405176 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_country_region.sql
[0m20:14:26.409747 [debug] [MainThread]: 1699: static parser successfully parsed silver/person/stg_person_business_entity_contact.sql
[0m20:14:26.726173 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customer' in the 'models' section of file 'models/gold/dim_customers.yml'
[0m20:14:26.789250 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_reason' in the 'models' section of file 'models/gold/dim_reasons.yml'
[0m20:14:26.822413 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customer' in the 'models' section of file 'models/gold/dim_cards_type.yml'
[0m20:14:27.007848 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.not_null_dim_customer_customer_sk.69b9dd095b' (models/gold/dim_customers.yml) depends on a node named 'dim_customer' in package '' which was not found
[0m20:14:27.008806 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.unique_dim_customer_customer_sk.c225f6f263' (models/gold/dim_customers.yml) depends on a node named 'dim_customer' in package '' which was not found
[0m20:14:27.009874 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.not_null_dim_reason_reason_sk.3df7e0353d' (models/gold/dim_reasons.yml) depends on a node named 'dim_reason' in package '' which was not found
[0m20:14:27.010823 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.unique_dim_reason_reason_sk.359f0eaaf1' (models/gold/dim_reasons.yml) depends on a node named 'dim_reason' in package '' which was not found
[0m20:14:27.011751 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.desafioaethaina.relationships_fact_sales_customer_fk__customer_sk__ref_dim_costumers_.f487da3b64' (models/gold/fact_sales.yml) depends on a node named 'dim_costumers' in package '' which was not found
[0m20:14:27.101930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3069a1bdf0>]}
[0m20:14:27.178604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3069af7280>]}
[0m20:14:27.179142 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:14:27.179663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a68e770>]}
[0m20:14:27.190409 [info ] [MainThread]: 
[0m20:14:27.194628 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:14:27.199563 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m20:14:27.200948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:28.174297 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m20:14:28.174817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:28.176081 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m20:14:28.176689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:29.100789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3069986fe0>]}
[0m20:14:29.101685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:29.102157 [info ] [MainThread]: 
[0m20:14:29.106775 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m20:14:29.107316 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_address
[0m20:14:29.107839 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_address_type
[0m20:14:29.108365 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_address
[0m20:14:29.108755 [info ] [Thread-1 (]: 1 of 8 START sql table model dev_thaina_gold.dim_dates ......................... [RUN]
[0m20:14:29.109850 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address'
[0m20:14:29.111547 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address_type'
[0m20:14:29.113562 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_address'
[0m20:14:29.114500 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m20:14:29.114989 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_address
[0m20:14:29.115504 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_address_type
[0m20:14:29.115991 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_address
[0m20:14:29.116755 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m20:14:29.122732 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address"
[0m20:14:29.141671 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_address"
[0m20:14:29.173975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:29.181355 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address_type"
[0m20:14:29.182086 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (compile): 2023-07-01 20:14:29.117098 => 2023-07-01 20:14:29.181987
[0m20:14:29.182647 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (compile): 2023-07-01 20:14:29.131456 => 2023-07-01 20:14:29.182545
[0m20:14:29.184976 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m20:14:29.188761 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_address
[0m20:14:29.189323 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (compile): 2023-07-01 20:14:29.124197 => 2023-07-01 20:14:29.189231
[0m20:14:29.190179 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_address
[0m20:14:29.234306 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_business_entity_contact
[0m20:14:29.236469 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_address_type
[0m20:14:29.239065 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_country_region
[0m20:14:29.240050 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_country_region'
[0m20:14:29.240521 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_country_region
[0m20:14:29.238414 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_contact'
[0m20:14:29.237301 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_contact_type
[0m20:14:29.246018 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_country_region"
[0m20:14:29.246755 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_contact
[0m20:14:29.247483 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_contact_type'
[0m20:14:29.251784 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m20:14:29.252400 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_contact_type
[0m20:14:29.252812 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_country_region (compile): 2023-07-01 20:14:29.240826 => 2023-07-01 20:14:29.252727
[0m20:14:29.256395 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_contact_type"
[0m20:14:29.257368 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_country_region
[0m20:14:29.257636 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (compile): 2023-07-01 20:14:29.247918 => 2023-07-01 20:14:29.257572
[0m20:14:29.258244 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_person
[0m20:14:29.258758 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_contact_type (compile): 2023-07-01 20:14:29.253275 => 2023-07-01 20:14:29.258686
[0m20:14:29.259556 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_business_entity_contact
[0m20:14:29.260292 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_person'
[0m20:14:29.261141 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_contact_type
[0m20:14:29.261608 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_state_province
[0m20:14:29.262070 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_person
[0m20:14:29.262573 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product
[0m20:14:29.263539 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_state_province'
[0m20:14:29.267066 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_person"
[0m20:14:29.267881 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product'
[0m20:14:29.268310 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_state_province
[0m20:14:29.268801 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product
[0m20:14:29.272334 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_state_province"
[0m20:14:29.272749 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_person (compile): 2023-07-01 20:14:29.263861 => 2023-07-01 20:14:29.272662
[0m20:14:29.278872 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product"
[0m20:14:29.280192 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_person
[0m20:14:29.280825 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_state_province (compile): 2023-07-01 20:14:29.269106 => 2023-07-01 20:14:29.280728
[0m20:14:29.281402 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_category
[0m20:14:29.281890 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product (compile): 2023-07-01 20:14:29.272972 => 2023-07-01 20:14:29.281802
[0m20:14:29.282836 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_state_province
[0m20:14:29.283754 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_category'
[0m20:14:29.284664 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product
[0m20:14:29.285192 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_description
[0m20:14:29.285793 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_category
[0m20:14:29.286231 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_inventory
[0m20:14:29.287046 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_description'
[0m20:14:29.292296 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_category"
[0m20:14:29.293257 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_inventory'
[0m20:14:29.293695 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_description
[0m20:14:29.294303 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_inventory
[0m20:14:29.299927 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_category (compile): 2023-07-01 20:14:29.287319 => 2023-07-01 20:14:29.299844
[0m20:14:29.299566 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_description"
[0m20:14:29.303840 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_inventory"
[0m20:14:29.304800 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_category
[0m20:14:29.305534 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_inventory (compile): 2023-07-01 20:14:29.300338 => 2023-07-01 20:14:29.305433
[0m20:14:29.305935 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_description (compile): 2023-07-01 20:14:29.294742 => 2023-07-01 20:14:29.305846
[0m20:14:29.306498 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_location
[0m20:14:29.307616 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_inventory
[0m20:14:29.308868 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_description
[0m20:14:29.309715 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_location'
[0m20:14:29.310257 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_model
[0m20:14:29.310895 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_subcategory
[0m20:14:29.311395 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_location
[0m20:14:29.312219 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_model'
[0m20:14:29.313102 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_subcategory'
[0m20:14:29.316728 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_location"
[0m20:14:29.317233 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_model
[0m20:14:29.317698 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_subcategory
[0m20:14:29.321192 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_model"
[0m20:14:29.325259 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_subcategory"
[0m20:14:29.326465 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_model (compile): 2023-07-01 20:14:29.318098 => 2023-07-01 20:14:29.326376
[0m20:14:29.325645 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_location (compile): 2023-07-01 20:14:29.313465 => 2023-07-01 20:14:29.325535
[0m20:14:29.327311 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_model
[0m20:14:29.327705 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_subcategory (compile): 2023-07-01 20:14:29.321617 => 2023-07-01 20:14:29.327614
[0m20:14:29.328420 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_location
[0m20:14:29.328852 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m20:14:29.329697 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_subcategory
[0m20:14:29.330116 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchase_order_header
[0m20:14:29.330869 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m20:14:29.331309 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_purchasing_product_vendor
[0m20:14:29.332224 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_header'
[0m20:14:29.332630 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m20:14:29.333431 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_product_vendor'
[0m20:14:29.333790 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchase_order_header
[0m20:14:29.337298 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m20:14:29.337751 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_purchasing_product_vendor
[0m20:14:29.342707 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_header"
[0m20:14:29.346795 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m20:14:29.348008 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (compile): 2023-07-01 20:14:29.338004 => 2023-07-01 20:14:29.347918
[0m20:14:29.347285 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-07-01 20:14:29.334024 => 2023-07-01 20:14:29.347171
[0m20:14:29.348298 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (compile): 2023-07-01 20:14:29.343289 => 2023-07-01 20:14:29.348243
[0m20:14:29.349076 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchase_order_header
[0m20:14:29.349904 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m20:14:29.350679 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_purchasing_product_vendor
[0m20:14:29.351128 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchasing_ship_method
[0m20:14:29.351653 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchasing_vendor
[0m20:14:29.352137 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_country_region_currency
[0m20:14:29.352841 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_ship_method'
[0m20:14:29.353486 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_vendor'
[0m20:14:29.354111 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_country_region_currency'
[0m20:14:29.354450 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchasing_ship_method
[0m20:14:29.354755 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchasing_vendor
[0m20:14:29.355046 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_country_region_currency
[0m20:14:29.358377 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m20:14:29.361894 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_vendor"
[0m20:14:29.365212 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m20:14:29.365958 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (compile): 2023-07-01 20:14:29.355262 => 2023-07-01 20:14:29.365819
[0m20:14:29.366861 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (compile): 2023-07-01 20:14:29.358720 => 2023-07-01 20:14:29.366694
[0m20:14:29.368018 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchasing_ship_method
[0m20:14:29.368975 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchasing_vendor
[0m20:14:29.369257 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (compile): 2023-07-01 20:14:29.362243 => 2023-07-01 20:14:29.369189
[0m20:14:29.370081 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_creditcard
[0m20:14:29.370627 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_currency
[0m20:14:29.371606 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_country_region_currency
[0m20:14:29.372247 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_creditcard'
[0m20:14:29.372857 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency'
[0m20:14:29.373269 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_currency_rate
[0m20:14:29.373678 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_creditcard
[0m20:14:29.373980 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_currency
[0m20:14:29.374575 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency_rate'
[0m20:14:29.377785 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_creditcard"
[0m20:14:29.381013 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency"
[0m20:14:29.381407 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_currency_rate
[0m20:14:29.385139 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency_rate"
[0m20:14:29.385821 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (compile): 2023-07-01 20:14:29.374805 => 2023-07-01 20:14:29.385709
[0m20:14:29.386160 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_currency (compile): 2023-07-01 20:14:29.378113 => 2023-07-01 20:14:29.386078
[0m20:14:29.387097 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_creditcard
[0m20:14:29.387410 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (compile): 2023-07-01 20:14:29.382018 => 2023-07-01 20:14:29.387322
[0m20:14:29.388213 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_currency
[0m20:14:29.388708 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_customer
[0m20:14:29.389751 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_currency_rate
[0m20:14:29.390234 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_order_detail
[0m20:14:29.391062 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_customer'
[0m20:14:29.391507 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m20:14:29.392299 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_detail'
[0m20:14:29.392659 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_customer
[0m20:14:29.393325 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m20:14:29.393642 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_order_detail
[0m20:14:29.399393 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_customer"
[0m20:14:29.399886 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m20:14:29.403141 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_detail"
[0m20:14:29.406768 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m20:14:29.407211 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_customer (compile): 2023-07-01 20:14:29.393881 => 2023-07-01 20:14:29.407108
[0m20:14:29.408471 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_customer
[0m20:14:29.408735 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (compile): 2023-07-01 20:14:29.400158 => 2023-07-01 20:14:29.408665
[0m20:14:29.409094 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-07-01 20:14:29.403641 => 2023-07-01 20:14:29.409008
[0m20:14:29.409474 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_order_header_reason
[0m20:14:29.410371 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_order_detail
[0m20:14:29.411177 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m20:14:29.411908 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header_reason'
[0m20:14:29.412427 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_person
[0m20:14:29.412928 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_person_quota_history
[0m20:14:29.413451 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_order_header_reason
[0m20:14:29.414216 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person'
[0m20:14:29.414982 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person_quota_history'
[0m20:14:29.418638 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m20:14:29.419066 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_person
[0m20:14:29.419447 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_person_quota_history
[0m20:14:29.423003 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person"
[0m20:14:29.423476 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (compile): 2023-07-01 20:14:29.415266 => 2023-07-01 20:14:29.423356
[0m20:14:29.426785 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m20:14:29.427923 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_order_header_reason
[0m20:14:29.428427 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person (compile): 2023-07-01 20:14:29.419857 => 2023-07-01 20:14:29.428324
[0m20:14:29.428985 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_reason
[0m20:14:29.429488 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (compile): 2023-07-01 20:14:29.423744 => 2023-07-01 20:14:29.429411
[0m20:14:29.430286 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_person
[0m20:14:29.430941 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_reason'
[0m20:14:29.431674 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_person_quota_history
[0m20:14:29.432154 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_tax_rate
[0m20:14:29.432578 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_reason
[0m20:14:29.433025 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_territory
[0m20:14:29.433895 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_tax_rate'
[0m20:14:29.437461 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_reason"
[0m20:14:29.438217 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_territory'
[0m20:14:29.438639 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_tax_rate
[0m20:14:29.439112 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_territory
[0m20:14:29.444250 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_tax_rate"
[0m20:14:29.444570 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_reason (compile): 2023-07-01 20:14:29.434171 => 2023-07-01 20:14:29.444497
[0m20:14:29.447892 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_territory"
[0m20:14:29.448944 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_reason
[0m20:14:29.449428 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (compile): 2023-07-01 20:14:29.439440 => 2023-07-01 20:14:29.449312
[0m20:14:29.449985 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_address
[0m20:14:29.450672 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_territory (compile): 2023-07-01 20:14:29.444848 => 2023-07-01 20:14:29.450576
[0m20:14:29.451635 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_tax_rate
[0m20:14:29.452614 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m20:14:29.453455 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_territory
[0m20:14:29.453906 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_product
[0m20:14:29.454222 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_address
[0m20:14:29.454742 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_sales
[0m20:14:29.455482 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m20:14:29.466724 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m20:14:29.473696 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m20:14:29.474308 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_product
[0m20:14:29.474770 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_sales
[0m20:14:29.492138 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m20:14:29.492504 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-07-01 20:14:29.455961 => 2023-07-01 20:14:29.492421
[0m20:14:29.504900 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m20:14:29.506105 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_address
[0m20:14:29.506736 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-07-01 20:14:29.475373 => 2023-07-01 20:14:29.506629
[0m20:14:29.507329 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_reason
[0m20:14:29.508491 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_product
[0m20:14:29.508924 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 20:14:29.492779 => 2023-07-01 20:14:29.508854
[0m20:14:29.509813 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_reason'
[0m20:14:29.510278 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_person
[0m20:14:29.511238 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_sales
[0m20:14:29.511789 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_reason
[0m20:14:29.512600 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m20:14:29.513093 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_address
[0m20:14:29.520591 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_reason"
[0m20:14:29.521075 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_person
[0m20:14:29.521570 [info ] [Thread-2 (]: 2 of 8 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m20:14:29.540417 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m20:14:29.551707 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.dim_address
[0m20:14:29.557210 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_reason (compile): 2023-07-01 20:14:29.513665 => 2023-07-01 20:14:29.557096
[0m20:14:29.564044 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m20:14:29.575191 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m20:14:29.576172 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_reason
[0m20:14:29.579253 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_products
[0m20:14:29.580011 [info ] [Thread-3 (]: 3 of 8 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m20:14:29.580981 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 20:14:29.522222 => 2023-07-01 20:14:29.580876
[0m20:14:29.581472 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 20:14:29.564381 => 2023-07-01 20:14:29.581371
[0m20:14:29.582239 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m20:14:29.583517 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_person
[0m20:14:29.584099 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.dim_address
[0m20:14:29.584565 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_products
[0m20:14:29.585247 [debug] [Thread-4 (]: Began running node model.desafioaethaina.dim_cards_type
[0m20:14:29.630510 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:29.631166 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m20:14:29.629705 [info ] [Thread-4 (]: 4 of 8 START sql table model dev_thaina_gold.dim_cards_type .................... [RUN]
[0m20:14:29.632644 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-07-01 20:14:29.601457 => 2023-07-01 20:14:29.632523
[0m20:14:29.636951 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m20:14:29.683563 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_products
[0m20:14:29.684194 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m20:14:29.687644 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:14:29.704548 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m20:14:29.741281 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 20:14:29.688013 => 2023-07-01 20:14:29.741136
[0m20:14:29.741753 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m20:14:29.744912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:30.531537 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m20:14:30.532335 [debug] [Thread-2 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with  __dbt__cte__stg_person_address as (
with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
),  __dbt__cte__stg_person_address_type as (
with source_data as (
  select 
    addresstypeid as address_type_id
    , name as address_type_name 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`addresstype`
)

select *
from source_data
),  __dbt__cte__stg_person_business_entity_address as (
with source_data as (
  select 
    businessentityid as business_entity_id
    , addressid as address_id
    , addresstypeid as address_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentityaddress`
)

select *
from source_data
),  __dbt__cte__stg_person_business_entity_contact as (
with source_data as (
  select 
    businessentityid as business_entity_id
    , personid as person_id
    , contacttypeid as contact_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentitycontact`
)

select *
from source_data
),  __dbt__cte__stg_person_contact_type as (
with source_data as (
  select 
    contacttypeid as contact_type_id
    , name as contact_type_name 
  from  `desafiothaina`.`dev_thaina`.`contacttype`
)

select *
from source_data
),  __dbt__cte__int_address as (
with address as (
	select * 
    from __dbt__cte__stg_person_address
)

, address_type as (
	select * 
    from __dbt__cte__stg_person_address_type
)

, business_entity_address as (
	select * 
    from __dbt__cte__stg_person_business_entity_address
)

, business_entity_contact as (
	select * 
    from __dbt__cte__stg_person_business_entity_contact
)

, contact_type_worker as (
	select  * 
    from  __dbt__cte__stg_person_contact_type 
)

, union_person_addres as (
    select
        business_entity_address.address_id
        , business_entity_id
        , business_entity_address.address_type_id
        , concat(address_line1, ' ', ifnull('',address_line2), ' ', postal_code) as address
        , city
        , state_province_id
        , address_type_name
    from business_entity_address
    left join address
    on address.address_id = business_entity_address.address_id
   	left join address_type
   	on address_type.address_type_id = business_entity_address.address_type_id
)

, union_contact_type as (
	select 
		union_person_addres.*
		, person_id as worker_id
		, contact_type_worker.contact_type_id 
		, contact_type_name as contact_type_name_worker
	from union_person_addres
	left join business_entity_contact
	on business_entity_contact.business_entity_id = union_person_addres.business_entity_id 
	left join contact_type_worker
	on contact_type_worker.contact_type_id = business_entity_contact.contact_type_id
)

select * 
from union_contact_type
),int_address as (
    select *
    from __dbt__cte__int_address
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by address_id order by address_id) as dedup_index
    from int_address
)

, address_with_sk  as (
    select
        MD5(cast(address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , address_type_name
        , worker_id
        , contact_type_id
        , contact_type_name_worker
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from address_with_sk
    );
  
[0m20:14:30.640721 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m20:14:30.641381 [debug] [Thread-3 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with  __dbt__cte__stg_product as (
with source_data as (
  select 
    productid as product_id
    , productmodelid as product_model_id
    , productsubcategoryid as product_subcategory_id
    , name as product_name
    , productnumber as product_number
    , makeflag
    , finishedgoodsflag as finished_goods_flag
    , color
    , safetystocklevel as safety_stock_level
    , standardcost as stand_cost
    , listprice as list_price
    , size as size_product
    , style as style_product
    , weight as weight_product 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`product`
)

select * from source_data
),  __dbt__cte__stg_product_subcategory as (
with source_data as (
  select 
    productsubcategoryid as subcategory_id
    , productcategoryid as category_id
    , name as subcategory_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productsubcategory`
)

select *
from source_data
),  __dbt__cte__stg_product_category as (
with source_data as (
  select 
    productcategoryid as category_id
    , name as category_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productcategory`
)

select *
from source_data
),  __dbt__cte__stg_product_inventory as (
with source_data as (
  select 
    productid as product_id
    , locationid as location_id
    , shelf
    , bin
    , quantity as quantity_inventory
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productinventory`
)

select *
from source_data
),  __dbt__cte__stg_product_location as (
with source_data as (
  select 
    locationid as location_id
    , name as location_name
    -- Standard hourly cost of the manufacturing location.
    , costrate as cost_rate
    -- Work capacity (in hours) of the manufacturing location.
    , availability 
  from  `desafiothaina`.`dev_thaina`.`location`
)

select *
from source_data
),  __dbt__cte__stg_product_model as (
with source_data as (
  select 
    productmodelid as model_id
    , name as model_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productmodel`
)

select *
from source_data
),  __dbt__cte__int_product as (
with product as (
    select * 
    from __dbt__cte__stg_product 
)

, subcategory as (
    select * 
    from __dbt__cte__stg_product_subcategory
)

, category as (
    select * 
    from __dbt__cte__stg_product_category
)

, inventory as (
    select * 
    from __dbt__cte__stg_product_inventory
)

, location as (
    select * 
    from __dbt__cte__stg_product_location
)

, model as (
    select * 
    from __dbt__cte__stg_product_model
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from product
    left join subcategory
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from union_product_subcategory
	left join category
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from union_product_category
	left join model
    on union_product_category.product_model_id = model.model_id
)

, union_product_inventory as (
    select 
        union_product_model.*
        , quantity_inventory
        , shelf
        , bin
    from union_product_model
    left join inventory
    on union_product_model.product_id = inventory.product_id
)

select * 
from union_product_inventory
),int_product as (
    select *
    from __dbt__cte__int_product
    where product_id is not null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
 
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1  
)

-- , select_not_null as (
--     select *
--     from prodcut_with_sk
--     where product_sk is not null
-- )

select *
from prodcut_with_sk
    );
  
[0m20:14:30.672190 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m20:14:30.672809 [debug] [Thread-4 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with  __dbt__cte__stg_sales_order_header as (
with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(cast(orderdate as timestamp) as date) as order_date
    , cast(cast(duedate as timestamp) as date) as due_date
    , cast(cast(shipdate as timestamp) as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
),  __dbt__cte__stg_sales_order_header_reason as (
with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
),  __dbt__cte__stg_sales_order_detail as (
with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
),  __dbt__cte__stg_sales_creditcard as (
with source_data as (
  select 
    creditcardid as credit_card_id
    , cardtype as card_type
  from  `desafiothaina`.`dev_thaina`.`creditcard`
)
select *
from source_data
),  __dbt__cte__stg_purchasing_ship_method as (
with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
),  __dbt__cte__int_sales as (
with order_header as (
	select * 
	from __dbt__cte__stg_sales_order_header	
)

, order_header_reason as (
	select * 
	from __dbt__cte__stg_sales_order_header_reason	
)

, order_detail as (
	select * 
	from __dbt__cte__stg_sales_order_detail	
)

, credit_card as (
	select * 
	from __dbt__cte__stg_sales_creditcard	
)

, ship_method as (
	select * 
	from __dbt__cte__stg_purchasing_ship_method
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
),int_sales as (
	select * 
    from __dbt__cte__int_sales
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            credit_card_id
            , credit_card_approval_code 
        order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        MD5(cast(credit_card_id as string)) credit_card_sk
        , card_type
        , credit_card_approval_code
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m20:14:31.650583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:007f844c-d949-4359-8d89-7f8add353093&page=queryresults
[0m20:14:31.652819 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m20:14:31.653394 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-07-01 20:14:29.143068 => 2023-07-01 20:14:31.653308
[0m20:14:31.653783 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m20:14:32.060917 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m20:14:32.063719 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      /* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m20:14:33.824448 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:4f5fe810-a14f-47de-81d9-74848144822d&page=queryresults
[0m20:14:33.913832 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:5241c0fa-65d0-4366-b5cb-50972ff96659&page=queryresults
[0m20:14:33.922473 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 20:14:29.742168 => 2023-07-01 20:14:33.922350
[0m20:14:33.924040 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30699b7fa0>]}
[0m20:14:33.925066 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dev_thaina_gold.dim_cards_type ............... [[32mCREATE TABLE (30.3k rows, 2.4 MB processed)[0m in 4.29s]
[0m20:14:33.926334 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m20:14:33.927104 [debug] [Thread-4 (]: Began running node model.desafioaethaina.fact_sales
[0m20:14:33.927923 [info ] [Thread-4 (]: 5 of 8 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m20:14:33.929615 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m20:14:33.930252 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.fact_sales
[0m20:14:33.975467 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m20:14:33.976297 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 20:14:33.930672 => 2023-07-01 20:14:33.976161
[0m20:14:33.976918 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.fact_sales
[0m20:14:33.990809 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:34.250810 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:fa522ee7-4264-4628-aa5a-84331a35ff47&page=queryresults
[0m20:14:34.621177 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 20:14:29.585742 => 2023-07-01 20:14:34.621098
[0m20:14:34.622070 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3069aa8100>]}
[0m20:14:34.622584 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.6k rows, 1.5 MB processed)[0m in 5.08s]
[0m20:14:34.623241 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_address
[0m20:14:34.624006 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_reasons
[0m20:14:34.624750 [info ] [Thread-2 (]: 6 of 8 START sql table model dev_thaina_gold.dim_reasons ....................... [RUN]
[0m20:14:34.625649 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_reasons'
[0m20:14:34.626016 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.dim_reasons
[0m20:14:34.638319 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.dim_reasons"
[0m20:14:34.639545 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_reasons (compile): 2023-07-01 20:14:34.626234 => 2023-07-01 20:14:34.639293
[0m20:14:34.640195 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.dim_reasons
[0m20:14:34.643738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:34.839612 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m20:14:34.840289 [debug] [Thread-4 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with  __dbt__cte__stg_sales_order_header as (
with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(cast(orderdate as timestamp) as date) as order_date
    , cast(cast(duedate as timestamp) as date) as due_date
    , cast(cast(shipdate as timestamp) as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
),  __dbt__cte__stg_sales_order_header_reason as (
with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
),  __dbt__cte__stg_sales_order_detail as (
with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
),  __dbt__cte__stg_sales_creditcard as (
with source_data as (
  select 
    creditcardid as credit_card_id
    , cardtype as card_type
  from  `desafiothaina`.`dev_thaina`.`creditcard`
)
select *
from source_data
),  __dbt__cte__stg_purchasing_ship_method as (
with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
),  __dbt__cte__int_sales as (
with order_header as (
	select * 
	from __dbt__cte__stg_sales_order_header	
)

, order_header_reason as (
	select * 
	from __dbt__cte__stg_sales_order_header_reason	
)

, order_detail as (
	select * 
	from __dbt__cte__stg_sales_order_detail	
)

, credit_card as (
	select * 
	from __dbt__cte__stg_sales_creditcard	
)

, ship_method as (
	select * 
	from __dbt__cte__stg_purchasing_ship_method
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
),int_sales as (
    select * 
    from __dbt__cte__int_sales
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , MD5(cast(customer_id as string)) as customer_fk
        , MD5(cast(sales_person_id as string)) as sales_person_fk
        , MD5(cast(bill_to_address_id as string)) as bill_to_address_fk
        , MD5(cast(ship_to_address_id as string)) as ship_to_address_fk
        , MD5(cast(ship_method_id as string)) as ship_method_fk
        , MD5(cast(product_id as string)) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m20:14:34.922485 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-07-01 20:14:29.684735 => 2023-07-01 20:14:34.922407
[0m20:14:34.923392 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30698a3100>]}
[0m20:14:34.923915 [info ] [Thread-3 (]: 3 of 8 OK created sql table model dev_thaina_gold.dim_products ................. [[32mCREATE TABLE (504.0 rows, 70.5 KB processed)[0m in 5.34s]
[0m20:14:34.924514 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_products
[0m20:14:34.925264 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_customers
[0m20:14:34.926135 [info ] [Thread-3 (]: 7 of 8 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m20:14:34.927637 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m20:14:34.928221 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_customers
[0m20:14:34.953403 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m20:14:34.956873 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 20:14:34.928632 => 2023-07-01 20:14:34.956766
[0m20:14:34.957272 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_customers
[0m20:14:34.960560 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:14:35.482437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:cf5313ce-4a96-45f0-89fa-37df3934e15d&page=queryresults
[0m20:14:35.532529 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.dim_reasons"
[0m20:14:35.533208 [debug] [Thread-2 (]: On model.desafioaethaina.dim_reasons: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_reasons"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_reasons`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with  __dbt__cte__stg_sales_order_header_reason as (
with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
),  __dbt__cte__stg_sales_reason as (
with
  source_data as (
    select
      salesreasonid as sales_reason_id
      , name as name_reason
      , reasontype as reason_type
    from `desafiothaina`.`dev_thaina`.`salesreason`
  )

select  *
from source_data
),  __dbt__cte__int_reason as (
with order_header_reason as (
	select * 
	from __dbt__cte__stg_sales_order_header_reason	
)

, sales_reason as (
	select * 
	from __dbt__cte__stg_sales_reason	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

select *
from union_reason
),int_sales as (
    select *
    from __dbt__cte__int_reason
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_reason_id order by sales_reason_id) as dedup_index
    from int_sales
)

, reason_with_sk  as (
    select
        MD5(cast(sales_reason_id as string)) as sales_reason_fk
        , sales_order_id
        , name_reason
        , reason_type
      from deduplication_data
    where dedup_index = 1
)

select *
from reason_with_sk
    );
  
[0m20:14:35.890226 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m20:14:35.890963 [debug] [Thread-3 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with  __dbt__cte__stg_sales_customer as (
with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
),  __dbt__cte__stg_sales_territory as (
with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
),  __dbt__cte__stg_person_person as (
with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
),  __dbt__cte__stg_person_country_region as (
with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
),  __dbt__cte__stg_person_state_province as (
with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
),  __dbt__cte__int_person as (
with customer as (
	select * 
    from __dbt__cte__stg_sales_customer
)

, sales_territory as (
	select * 
    from __dbt__cte__stg_sales_territory
)

, person_person as (
	select * 
    from __dbt__cte__stg_person_person
)

, person_country as (
	select * 
    from __dbt__cte__stg_person_country_region
)

, state_province as (
	select * 
    from __dbt__cte__stg_person_state_province
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , sales_territory_year
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixed_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, sales_territory_year
		, country_region_name
		, state_province_id
		, state_province_code
		, state_province_name
	from union_customer_state_province
	where customer_id is not null

)

select * 
from change_columns_name
),int_person as (
    select * 
    from __dbt__cte__int_person
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        MD5(cast(fixed_customer_id as string)) as customer_sk
        , full_name 
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m20:14:36.310720 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-07-01 20:14:31.654018 => 2023-07-01 20:14:36.310634
[0m20:14:36.311666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a38b8e0>]}
[0m20:14:36.312204 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dev_thaina_gold.dim_dates .................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 7.20s]
[0m20:14:36.312744 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m20:14:36.313267 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_workers
[0m20:14:36.313809 [info ] [Thread-1 (]: 8 of 8 START sql table model dev_thaina_gold.dim_workers ....................... [RUN]
[0m20:14:36.314913 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m20:14:36.315580 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_workers
[0m20:14:36.333863 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m20:14:36.334742 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 20:14:36.315974 => 2023-07-01 20:14:36.334588
[0m20:14:36.335441 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_workers
[0m20:14:36.341109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:37.386839 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m20:14:37.387709 [debug] [Thread-1 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workers of Adventure Works"""
    )
    as (
      with  __dbt__cte__stg_sales_customer as (
with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
),  __dbt__cte__stg_sales_territory as (
with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
),  __dbt__cte__stg_person_person as (
with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
),  __dbt__cte__stg_person_country_region as (
with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
),  __dbt__cte__stg_person_state_province as (
with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
),  __dbt__cte__int_person as (
with customer as (
	select * 
    from __dbt__cte__stg_sales_customer
)

, sales_territory as (
	select * 
    from __dbt__cte__stg_sales_territory
)

, person_person as (
	select * 
    from __dbt__cte__stg_person_person
)

, person_country as (
	select * 
    from __dbt__cte__stg_person_country_region
)

, state_province as (
	select * 
    from __dbt__cte__stg_person_state_province
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , sales_territory_year
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixed_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, sales_territory_year
		, country_region_name
		, state_province_id
		, state_province_code
		, state_province_name
	from union_customer_state_province
	where customer_id is not null

)

select * 
from change_columns_name
),int_person as (
    select * 
    from __dbt__cte__int_person
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, worker_with_sk  as (
    select
        MD5(cast(fixed_person_id as string)) as worker_sk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m20:14:38.511718 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:c81c5169-b558-4df1-aa3b-c696cbb6b845&page=queryresults
[0m20:14:38.514057 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_reasons (execute): 2023-07-01 20:14:34.640567 => 2023-07-01 20:14:38.513990
[0m20:14:38.514883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a516fb0>]}
[0m20:14:38.515477 [info ] [Thread-2 (]: 6 of 8 OK created sql table model dev_thaina_gold.dim_reasons .................. [[32mCREATE TABLE (7.0 rows, 432.3 KB processed)[0m in 3.89s]
[0m20:14:38.516138 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_reasons
[0m20:14:39.076024 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:574f8eb6-9273-4516-9abf-28800f77efff&page=queryresults
[0m20:14:39.080618 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 20:14:34.957532 => 2023-07-01 20:14:39.080509
[0m20:14:39.082147 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a513310>]}
[0m20:14:39.083091 [info ] [Thread-3 (]: 7 of 8 OK created sql table model dev_thaina_gold.dim_customers ................ [[32mCREATE TABLE (9.8k rows, 1.2 MB processed)[0m in 4.16s]
[0m20:14:39.084266 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_customers
[0m20:14:39.169463 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ecc63693-7da7-4eca-b642-4fe6af74d2eb&page=queryresults
[0m20:14:40.088814 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 20:14:33.977453 => 2023-07-01 20:14:40.088732
[0m20:14:40.091088 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a28b520>]}
[0m20:14:40.092860 [info ] [Thread-4 (]: 5 of 8 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 8.9 MB processed)[0m in 6.16s]
[0m20:14:40.095069 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.fact_sales
[0m20:14:40.870633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:b27e5ef1-b4b7-48dc-92f4-633274d3269b&page=queryresults
[0m20:14:41.890123 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 20:14:36.336014 => 2023-07-01 20:14:41.890039
[0m20:14:41.891168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a0101b-09d7-4d24-ad77-d26fdfa54027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30698dffa0>]}
[0m20:14:41.891741 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dev_thaina_gold.dim_workers .................. [[32mCREATE TABLE (496.0 rows, 1.0 MB processed)[0m in 5.58s]
[0m20:14:41.893261 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_workers
[0m20:14:41.898158 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:14:41.899045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:41.899403 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m20:14:41.899697 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_reasons' was properly closed.
[0m20:14:41.899989 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m20:14:41.900351 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m20:14:41.901120 [info ] [MainThread]: 
[0m20:14:41.902103 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 14.71 seconds (14.71s).
[0m20:14:41.904345 [debug] [MainThread]: Command end result
[0m20:14:41.937305 [info ] [MainThread]: 
[0m20:14:41.938080 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:41.939063 [info ] [MainThread]: 
[0m20:14:41.940467 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:14:41.941529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3069b5dc30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a665a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306a665150>]}
[0m20:14:41.941968 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:14:49.073815 | 05eca718-aa71-4eb7-b8e3-45f5fdbd6858 ==============================
[0m20:14:49.073815 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:14:49.076540 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m20:14:49.077337 [debug] [MainThread]: Tracking: tracking
[0m20:14:49.081920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0056bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0054eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0057970>]}
[0m20:14:49.146858 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:14:49.434486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:14:49.435059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:14:49.452607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05eca718-aa71-4eb7-b8e3-45f5fdbd6858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7cfc1c0d0>]}
[0m20:14:49.490740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05eca718-aa71-4eb7-b8e3-45f5fdbd6858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7cfbe0430>]}
[0m20:14:49.491334 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:14:49.491831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05eca718-aa71-4eb7-b8e3-45f5fdbd6858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7cfbe05e0>]}
[0m20:14:49.498903 [info ] [MainThread]: 
[0m20:14:49.503622 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:14:49.510998 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m20:14:49.512625 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m20:14:49.513425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:49.514006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:50.518807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05eca718-aa71-4eb7-b8e3-45f5fdbd6858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0057790>]}
[0m20:14:50.522331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:50.523975 [info ] [MainThread]: 
[0m20:14:50.534898 [debug] [Thread-1 (]: Began running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m20:14:50.536533 [debug] [Thread-2 (]: Began running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:14:50.537920 [debug] [Thread-3 (]: Began running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:14:50.540583 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:14:50.543254 [info ] [Thread-4 (]: 4 of 15 START test not_null_dim_workers_worker_sk .............................. [RUN]
[0m20:14:50.539823 [info ] [Thread-1 (]: 1 of 15 START test not_null_dim_address_address_sk ............................. [RUN]
[0m20:14:50.542314 [info ] [Thread-3 (]: 3 of 15 START test not_null_dim_products_product_sk ............................ [RUN]
[0m20:14:50.541335 [info ] [Thread-2 (]: 2 of 15 START test not_null_dim_dates_metric_date .............................. [RUN]
[0m20:14:50.553380 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe'
[0m20:14:50.544942 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7'
[0m20:14:50.546675 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40'
[0m20:14:50.550224 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9'
[0m20:14:50.554154 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:14:50.555114 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:14:50.555794 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m20:14:50.556723 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:14:50.637824 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m20:14:50.641692 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m20:14:50.659190 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m20:14:50.660214 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m20:14:50.661032 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (compile): 2023-07-01 20:14:50.563898 => 2023-07-01 20:14:50.660856
[0m20:14:50.662505 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (compile): 2023-07-01 20:14:50.557742 => 2023-07-01 20:14:50.662109
[0m20:14:50.663463 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (compile): 2023-07-01 20:14:50.591420 => 2023-07-01 20:14:50.663196
[0m20:14:50.664980 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (compile): 2023-07-01 20:14:50.571029 => 2023-07-01 20:14:50.664747
[0m20:14:50.665505 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:14:50.665956 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:14:50.666319 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:14:50.666757 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m20:14:50.760301 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"
[0m20:14:50.762424 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:14:50.778799 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"
[0m20:14:50.768876 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"
[0m20:14:50.783052 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"
[0m20:14:50.787341 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worker_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
where worker_sk is null



      
    ) dbt_internal_test
[0m20:14:50.790443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:50.793495 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:14:50.795039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:50.835052 [debug] [Thread-3 (]: On test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_products`
where product_sk is null



      
    ) dbt_internal_test
[0m20:14:50.837034 [debug] [Thread-1 (]: On test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_sk
from `desafiothaina`.`dev_thaina_gold`.`dim_address`
where address_sk is null



      
    ) dbt_internal_test
[0m20:14:50.923578 [debug] [Thread-2 (]: On test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metric_date
from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
where metric_date is null



      
    ) dbt_internal_test
[0m20:14:53.323988 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7629dbb9-39ed-419b-b687-419345e3381a&page=queryresults
[0m20:14:53.326126 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7 (execute): 2023-07-01 20:14:50.667154 => 2023-07-01 20:14:53.326035
[0m20:14:53.327095 [info ] [Thread-4 (]: 4 of 15 PASS not_null_dim_workers_worker_sk .................................... [[32mPASS[0m in 2.78s]
[0m20:14:53.330534 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_dim_workers_worker_sk.0df98e5df7
[0m20:14:53.331274 [debug] [Thread-4 (]: Began running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:14:53.332274 [info ] [Thread-4 (]: 5 of 15 START test not_null_fact_sales_sale_identifier_sk ...................... [RUN]
[0m20:14:53.334276 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e'
[0m20:14:53.334812 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:14:53.346217 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m20:14:53.347813 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (compile): 2023-07-01 20:14:53.335133 => 2023-07-01 20:14:53.347497
[0m20:14:53.348506 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:14:53.354551 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"
[0m20:14:53.356094 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:53.359529 [debug] [Thread-4 (]: On test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_identifier_sk
from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
where sale_identifier_sk is null



      
    ) dbt_internal_test
[0m20:14:53.483936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:2f0ed83e-71fe-47c2-a171-e43cf396a119&page=queryresults
[0m20:14:53.484751 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40 (execute): 2023-07-01 20:14:50.727941 => 2023-07-01 20:14:53.484668
[0m20:14:53.485754 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dim_address_address_sk ................................... [[32mPASS[0m in 2.94s]
[0m20:14:53.486603 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.not_null_dim_address_address_sk.6b4bcead40
[0m20:14:53.487542 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m20:14:53.488354 [info ] [Thread-1 (]: 6 of 15 START test relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m20:14:53.489979 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de'
[0m20:14:53.490658 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m20:14:53.512923 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m20:14:53.514096 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (compile): 2023-07-01 20:14:53.491125 => 2023-07-01 20:14:53.513953
[0m20:14:53.514817 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m20:14:53.524704 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"
[0m20:14:53.526884 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:19a483ec-a2f0-4ecb-903e-bcf5fa0f6e54&page=queryresults
[0m20:14:53.528666 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:42a98f26-dd6c-4234-8528-27c127dce229&page=queryresults
[0m20:14:53.531028 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9 (execute): 2023-07-01 20:14:50.712417 => 2023-07-01 20:14:53.530878
[0m20:14:53.532605 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe (execute): 2023-07-01 20:14:50.677522 => 2023-07-01 20:14:53.532459
[0m20:14:53.534295 [info ] [Thread-3 (]: 3 of 15 PASS not_null_dim_products_product_sk .................................. [[32mPASS[0m in 2.99s]
[0m20:14:53.537356 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.not_null_dim_products_product_sk.2a2df3e1b9
[0m20:14:53.536389 [info ] [Thread-2 (]: 2 of 15 PASS not_null_dim_dates_metric_date .................................... [[32mPASS[0m in 2.98s]
[0m20:14:53.538051 [debug] [Thread-3 (]: Began running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:14:53.538369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:53.538941 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.not_null_dim_dates_metric_date.97f772eafe
[0m20:14:53.539415 [info ] [Thread-3 (]: 7 of 15 START test relationships_fact_sales_order_date__metric_date__ref_dim_dates_  [RUN]
[0m20:14:53.541725 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select bill_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where bill_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:14:53.542177 [debug] [Thread-2 (]: Began running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:14:53.543115 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390'
[0m20:14:53.580720 [info ] [Thread-2 (]: 8 of 15 START test relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [RUN]
[0m20:14:53.583742 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:14:53.585258 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207'
[0m20:14:53.596320 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m20:14:53.597701 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:14:53.612948 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (compile): 2023-07-01 20:14:53.585882 => 2023-07-01 20:14:53.612728
[0m20:14:53.617234 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m20:14:53.617683 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:14:53.622560 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"
[0m20:14:53.623723 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (compile): 2023-07-01 20:14:53.598967 => 2023-07-01 20:14:53.623613
[0m20:14:53.624155 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:14:53.627478 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"
[0m20:14:53.628477 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:14:53.631949 [debug] [Thread-3 (]: On test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_date as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where order_date is not null
),

parent as (
    select metric_date as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:14:53.682844 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:53.685633 [debug] [Thread-2 (]: On test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where product_fk is not null
),

parent as (
    select product_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:14:55.974281 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:9881c788-590a-43fd-84e6-a0f31ef253f4&page=queryresults
[0m20:14:55.977521 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e (execute): 2023-07-01 20:14:53.348863 => 2023-07-01 20:14:55.977149
[0m20:14:55.980067 [info ] [Thread-4 (]: 5 of 15 PASS not_null_fact_sales_sale_identifier_sk ............................ [[32mPASS[0m in 2.65s]
[0m20:14:55.981347 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.not_null_fact_sales_sale_identifier_sk.f1e7cc502e
[0m20:14:55.982455 [debug] [Thread-4 (]: Began running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:14:55.984192 [info ] [Thread-4 (]: 9 of 15 START test relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [RUN]
[0m20:14:55.989611 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269'
[0m20:14:55.991636 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:14:56.008460 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m20:14:56.009403 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (compile): 2023-07-01 20:14:55.992138 => 2023-07-01 20:14:56.009273
[0m20:14:56.010058 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:14:56.018334 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"
[0m20:14:56.019967 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:56.024273 [debug] [Thread-4 (]: On test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select sales_person_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where sales_person_fk is not null
),

parent as (
    select worker_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:14:56.084609 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7ea5782a-ae41-410d-8445-5b431396e323&page=queryresults
[0m20:14:56.085839 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de (execute): 2023-07-01 20:14:53.515436 => 2023-07-01 20:14:56.085708
[0m20:14:56.087335 [info ] [Thread-1 (]: 6 of 15 PASS relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.60s]
[0m20:14:56.088185 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_bill_to_address_fk__address_sk__ref_dim_address_.a62dc426de
[0m20:14:56.089080 [debug] [Thread-1 (]: Began running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m20:14:56.090323 [info ] [Thread-1 (]: 10 of 15 START test relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [RUN]
[0m20:14:56.093255 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310'
[0m20:14:56.094494 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m20:14:56.112736 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m20:14:56.113538 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (compile): 2023-07-01 20:14:56.095186 => 2023-07-01 20:14:56.113429
[0m20:14:56.114054 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m20:14:56.120658 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"
[0m20:14:56.121616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:56.140313 [debug] [Thread-1 (]: On test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ship_to_address_fk as from_field
    from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    where ship_to_address_fk is not null
),

parent as (
    select address_sk as to_field
    from `desafiothaina`.`dev_thaina_gold`.`dim_address`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:14:56.521149 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:04740bc8-fb3c-41ed-b1e7-3ae58dce797e&page=queryresults
[0m20:14:56.522633 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390 (execute): 2023-07-01 20:14:53.618368 => 2023-07-01 20:14:56.522492
[0m20:14:56.524353 [info ] [Thread-3 (]: 7 of 15 PASS relationships_fact_sales_order_date__metric_date__ref_dim_dates_ .. [[32mPASS[0m in 2.98s]
[0m20:14:56.526107 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.relationships_fact_sales_order_date__metric_date__ref_dim_dates_.e5ad051390
[0m20:14:56.527091 [debug] [Thread-3 (]: Began running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m20:14:56.528987 [info ] [Thread-3 (]: 11 of 15 START test unique_dim_address_address_sk .............................. [RUN]
[0m20:14:56.530517 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728'
[0m20:14:56.531075 [debug] [Thread-3 (]: Began compiling node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m20:14:56.548570 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ec8a8f91-38f2-4031-b31b-417b74bc44e7&page=queryresults
[0m20:14:56.552014 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207 (execute): 2023-07-01 20:14:53.624456 => 2023-07-01 20:14:56.551514
[0m20:14:56.574024 [debug] [Thread-3 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m20:14:56.556436 [info ] [Thread-2 (]: 8 of 15 PASS relationships_fact_sales_product_fk__product_sk__ref_dim_products_  [[32mPASS[0m in 2.97s]
[0m20:14:56.575230 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.relationships_fact_sales_product_fk__product_sk__ref_dim_products_.dc3cec8207
[0m20:14:56.577341 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:14:56.578587 [info ] [Thread-2 (]: 12 of 15 START test unique_dim_dates_metric_date ............................... [RUN]
[0m20:14:56.576061 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (compile): 2023-07-01 20:14:56.531481 => 2023-07-01 20:14:56.575913
[0m20:14:56.584326 [debug] [Thread-3 (]: Began executing node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m20:14:56.582280 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed'
[0m20:14:56.592301 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:14:56.602528 [debug] [Thread-3 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"
[0m20:14:56.613066 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m20:14:56.615176 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (compile): 2023-07-01 20:14:56.593090 => 2023-07-01 20:14:56.615039
[0m20:14:56.615731 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:14:56.616200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:14:56.622721 [debug] [Thread-3 (]: On test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select address_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_address`
  where address_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:56.619695 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"
[0m20:14:56.675326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:56.678091 [debug] [Thread-2 (]: On test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select metric_date as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_dates`
  where metric_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:58.549829 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:3f959a4f-b379-48fa-bf3b-9d434f92707f&page=queryresults
[0m20:14:58.551078 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269 (execute): 2023-07-01 20:14:56.010722 => 2023-07-01 20:14:58.550952
[0m20:14:58.552476 [info ] [Thread-4 (]: 9 of 15 PASS relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_  [[32mPASS[0m in 2.57s]
[0m20:14:58.553683 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.relationships_fact_sales_sales_person_fk__worker_sk__ref_dim_workers_.9033523269
[0m20:14:58.554581 [debug] [Thread-4 (]: Began running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:14:58.555311 [info ] [Thread-4 (]: 13 of 15 START test unique_dim_products_product_sk ............................. [RUN]
[0m20:14:58.556802 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b'
[0m20:14:58.557553 [debug] [Thread-4 (]: Began compiling node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:14:58.570082 [debug] [Thread-4 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m20:14:58.571010 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (compile): 2023-07-01 20:14:58.558066 => 2023-07-01 20:14:58.570880
[0m20:14:58.571642 [debug] [Thread-4 (]: Began executing node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:14:58.586826 [debug] [Thread-4 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"
[0m20:14:58.587922 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:58.591432 [debug] [Thread-4 (]: On test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:59.060792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:90e5bce7-34b6-4be5-bb73-a7f499cbbca4&page=queryresults
[0m20:14:59.062658 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310 (execute): 2023-07-01 20:14:56.114400 => 2023-07-01 20:14:59.062535
[0m20:14:59.064036 [info ] [Thread-1 (]: 10 of 15 PASS relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_  [[32mPASS[0m in 2.97s]
[0m20:14:59.065005 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.relationships_fact_sales_ship_to_address_fk__address_sk__ref_dim_address_.7fc1c84310
[0m20:14:59.065854 [debug] [Thread-1 (]: Began running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:14:59.066618 [info ] [Thread-1 (]: 14 of 15 START test unique_dim_workers_worker_sk ............................... [RUN]
[0m20:14:59.068191 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000'
[0m20:14:59.068854 [debug] [Thread-1 (]: Began compiling node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:14:59.084117 [debug] [Thread-1 (]: Writing injected SQL for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m20:14:59.085419 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (compile): 2023-07-01 20:14:59.069310 => 2023-07-01 20:14:59.085198
[0m20:14:59.086707 [debug] [Thread-1 (]: Began executing node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:14:59.098390 [debug] [Thread-1 (]: Writing runtime sql for node "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"
[0m20:14:59.099445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:59.103041 [debug] [Thread-1 (]: On test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select worker_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`dim_workers`
  where worker_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:59.272046 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:f3374540-e2da-46bb-9f3e-92677309d52e&page=queryresults
[0m20:14:59.273101 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed (execute): 2023-07-01 20:14:56.616428 => 2023-07-01 20:14:59.272989
[0m20:14:59.274398 [info ] [Thread-2 (]: 12 of 15 PASS unique_dim_dates_metric_date ..................................... [[32mPASS[0m in 2.69s]
[0m20:14:59.275285 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_dim_dates_metric_date.aa112511ed
[0m20:14:59.275984 [debug] [Thread-2 (]: Began running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:14:59.278080 [info ] [Thread-2 (]: 15 of 15 START test unique_fact_sales_sale_identifier_sk ....................... [RUN]
[0m20:14:59.279441 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06'
[0m20:14:59.280058 [debug] [Thread-2 (]: Began compiling node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:14:59.289809 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:ca185466-5bd3-4ba3-b016-9bb1ef2f5ba4&page=queryresults
[0m20:14:59.291506 [debug] [Thread-3 (]: Timing info for test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728 (execute): 2023-07-01 20:14:56.585298 => 2023-07-01 20:14:59.291226
[0m20:14:59.293534 [info ] [Thread-3 (]: 11 of 15 PASS unique_dim_address_address_sk .................................... [[32mPASS[0m in 2.76s]
[0m20:14:59.298004 [debug] [Thread-3 (]: Finished running node test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728
[0m20:14:59.304642 [debug] [Thread-2 (]: Writing injected SQL for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m20:14:59.306934 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (compile): 2023-07-01 20:14:59.281167 => 2023-07-01 20:14:59.306775
[0m20:14:59.307623 [debug] [Thread-2 (]: Began executing node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:14:59.316147 [debug] [Thread-2 (]: Writing runtime sql for node "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"
[0m20:14:59.317170 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:59.319877 [debug] [Thread-2 (]: On test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select sale_identifier_sk as unique_field
  from `desafiothaina`.`dev_thaina_gold`.`fact_sales`
  where sale_identifier_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:15:01.114065 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:1c93ba3c-6e3c-404e-9453-c92b672e63a4&page=queryresults
[0m20:15:01.115316 [debug] [Thread-4 (]: Timing info for test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b (execute): 2023-07-01 20:14:58.572221 => 2023-07-01 20:15:01.115163
[0m20:15:01.116575 [info ] [Thread-4 (]: 13 of 15 PASS unique_dim_products_product_sk ................................... [[32mPASS[0m in 2.56s]
[0m20:15:01.117506 [debug] [Thread-4 (]: Finished running node test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b
[0m20:15:01.319980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:bf0b4d78-ebaf-4a01-8df2-eba953f1f9c7&page=queryresults
[0m20:15:01.321499 [debug] [Thread-1 (]: Timing info for test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000 (execute): 2023-07-01 20:14:59.088394 => 2023-07-01 20:15:01.321329
[0m20:15:01.323455 [info ] [Thread-1 (]: 14 of 15 PASS unique_dim_workers_worker_sk ..................................... [[32mPASS[0m in 2.26s]
[0m20:15:01.324262 [debug] [Thread-1 (]: Finished running node test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000
[0m20:15:01.555016 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:d149f740-9858-4d2d-b3b6-fb9e29118e76&page=queryresults
[0m20:15:01.556227 [debug] [Thread-2 (]: Timing info for test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06 (execute): 2023-07-01 20:14:59.308148 => 2023-07-01 20:15:01.556102
[0m20:15:01.560025 [info ] [Thread-2 (]: 15 of 15 PASS unique_fact_sales_sale_identifier_sk ............................. [[32mPASS[0m in 2.28s]
[0m20:15:01.561163 [debug] [Thread-2 (]: Finished running node test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06
[0m20:15:01.565055 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:15:01.567752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:01.569040 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_fact_sales_sale_identifier_sk.28d5892d06' was properly closed.
[0m20:15:01.570439 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_workers_worker_sk.dae4f79000' was properly closed.
[0m20:15:01.571021 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m20:15:01.571659 [debug] [MainThread]: Connection 'test.desafioaethaina.unique_dim_address_address_sk.d3ee9ce728' was properly closed.
[0m20:15:01.572312 [info ] [MainThread]: 
[0m20:15:01.573186 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 12.07 seconds (12.07s).
[0m20:15:01.580003 [debug] [MainThread]: Command end result
[0m20:15:01.645247 [info ] [MainThread]: 
[0m20:15:01.646161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:01.647028 [info ] [MainThread]: 
[0m20:15:01.647890 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m20:15:01.649148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7cfa17160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7cfbe0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d33acac0>]}
[0m20:15:01.650175 [debug] [MainThread]: Flushing usage events


============================== 2023-07-01 20:16:11.350229 | 66b0d3d6-a36f-40bb-a423-9f870f9b8e24 ==============================
[0m20:16:11.350229 [info ] [MainThread]: Running with dbt=1.4.6
[0m20:16:11.353629 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/thaina/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:16:11.354083 [debug] [MainThread]: Tracking: tracking
[0m20:16:11.356325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b22187af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b22184e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b221854b0>]}
[0m20:16:11.407660 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m20:16:11.546195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:11.546528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:11.560852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21f480d0>]}
[0m20:16:11.592435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21f0c520>]}
[0m20:16:11.592966 [info ] [MainThread]: Found 46 models, 15 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 64 seed files, 35 sources, 0 exposures, 0 metrics
[0m20:16:11.593462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21f0c580>]}
[0m20:16:11.602295 [info ] [MainThread]: 
[0m20:16:11.606368 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:16:11.608571 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina'
[0m20:16:11.609260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:12.641015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina'
[0m20:16:12.642183 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_desafiothaina_dev_thaina_gold'
[0m20:16:12.642706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:12.643253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:13.665679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21f0c400>]}
[0m20:16:13.666637 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:16:13.667133 [info ] [MainThread]: 
[0m20:16:13.672284 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_dates
[0m20:16:13.673001 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_address
[0m20:16:13.673504 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_address_type
[0m20:16:13.674123 [info ] [Thread-1 (]: 1 of 8 START sql table model dev_thaina_gold.dim_dates ......................... [RUN]
[0m20:16:13.675270 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_business_entity_address
[0m20:16:13.676551 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address'
[0m20:16:13.680886 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_address
[0m20:16:13.679034 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_dates'
[0m20:16:13.680094 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_address'
[0m20:16:13.678188 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_address_type'
[0m20:16:13.691446 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address"
[0m20:16:13.693511 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_dates
[0m20:16:13.694514 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_address
[0m20:16:13.695049 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_address_type
[0m20:16:13.714318 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_address (compile): 2023-07-01 20:16:13.681432 => 2023-07-01 20:16:13.714148
[0m20:16:13.760033 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_address
[0m20:16:13.761782 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_address_type"
[0m20:16:13.785326 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_address_type (compile): 2023-07-01 20:16:13.724672 => 2023-07-01 20:16:13.785194
[0m20:16:13.786681 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_address_type
[0m20:16:13.779310 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_business_entity_contact
[0m20:16:13.799620 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_business_entity_contact'
[0m20:16:13.801926 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_business_entity_contact
[0m20:16:13.787463 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_contact_type
[0m20:16:13.808908 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_contact_type'
[0m20:16:13.793800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:13.809688 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_contact_type
[0m20:16:13.820498 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_contact_type"
[0m20:16:13.821465 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_contact_type (compile): 2023-07-01 20:16:13.815521 => 2023-07-01 20:16:13.821304
[0m20:16:13.814937 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */


        select 

    datetime_diff(
        cast(cast('2014-07-31' as date) as datetime),
        cast(cast('2011-05-01' as date) as datetime),
        day
    )

  
[0m20:16:13.823036 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_contact_type
[0m20:16:13.798480 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_address"
[0m20:16:13.871821 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_business_entity_address (compile): 2023-07-01 20:16:13.711830 => 2023-07-01 20:16:13.871666
[0m20:16:13.873273 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_business_entity_address
[0m20:16:13.811181 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_business_entity_contact"
[0m20:16:13.870687 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_person_country_region
[0m20:16:13.873998 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_person_person
[0m20:16:13.881511 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_country_region'
[0m20:16:13.882239 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_business_entity_contact (compile): 2023-07-01 20:16:13.802393 => 2023-07-01 20:16:13.882086
[0m20:16:13.885712 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_business_entity_contact
[0m20:16:13.884095 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_person_country_region
[0m20:16:13.886523 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_person_state_province
[0m20:16:13.883440 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_person'
[0m20:16:13.895674 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_person_person
[0m20:16:13.901758 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_person"
[0m20:16:13.902679 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_person_person (compile): 2023-07-01 20:16:13.896109 => 2023-07-01 20:16:13.902526
[0m20:16:13.894977 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_country_region"
[0m20:16:13.893301 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_person_state_province'
[0m20:16:13.904160 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_person_person
[0m20:16:13.906325 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product
[0m20:16:13.905601 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_person_country_region (compile): 2023-07-01 20:16:13.887010 => 2023-07-01 20:16:13.905495
[0m20:16:13.909718 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_person_country_region
[0m20:16:13.910497 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_category
[0m20:16:13.911697 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_category'
[0m20:16:13.912549 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_category
[0m20:16:13.907936 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product'
[0m20:16:13.905005 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_person_state_province
[0m20:16:13.919287 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_category"
[0m20:16:13.933631 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_category (compile): 2023-07-01 20:16:13.912967 => 2023-07-01 20:16:13.933463
[0m20:16:13.935075 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_category
[0m20:16:13.935906 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_description
[0m20:16:13.923963 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product
[0m20:16:13.937315 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_description'
[0m20:16:13.944775 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_description
[0m20:16:13.938328 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_person_state_province"
[0m20:16:13.951061 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_person_state_province (compile): 2023-07-01 20:16:13.927824 => 2023-07-01 20:16:13.950928
[0m20:16:13.952558 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_person_state_province
[0m20:16:13.953418 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_inventory
[0m20:16:13.954700 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_inventory'
[0m20:16:13.950226 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_description"
[0m20:16:13.956029 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_description (compile): 2023-07-01 20:16:13.945174 => 2023-07-01 20:16:13.955874
[0m20:16:13.957590 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_description
[0m20:16:13.958374 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_product_location
[0m20:16:13.962428 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_location'
[0m20:16:13.963001 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_product_location
[0m20:16:13.955244 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_inventory
[0m20:16:13.961233 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product"
[0m20:16:13.977421 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product (compile): 2023-07-01 20:16:13.939023 => 2023-07-01 20:16:13.977289
[0m20:16:13.978655 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product
[0m20:16:13.979393 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_product_model
[0m20:16:13.980589 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_model'
[0m20:16:13.981138 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_product_model
[0m20:16:13.976575 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_inventory"
[0m20:16:13.987855 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_inventory (compile): 2023-07-01 20:16:13.971579 => 2023-07-01 20:16:13.987657
[0m20:16:13.989229 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_inventory
[0m20:16:13.971065 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_location"
[0m20:16:13.990929 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_product_location (compile): 2023-07-01 20:16:13.963391 => 2023-07-01 20:16:13.990773
[0m20:16:13.989988 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_product_subcategory
[0m20:16:13.993980 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_product_subcategory'
[0m20:16:13.994543 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_product_subcategory
[0m20:16:13.992328 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_product_location
[0m20:16:14.000991 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchase_order_detail
[0m20:16:14.002215 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_detail'
[0m20:16:14.002745 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchase_order_detail
[0m20:16:13.986955 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_model"
[0m20:16:14.009048 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_product_model (compile): 2023-07-01 20:16:13.981687 => 2023-07-01 20:16:14.008915
[0m20:16:14.010280 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_product_model
[0m20:16:14.010960 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchase_order_header
[0m20:16:14.012113 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchase_order_header'
[0m20:16:14.012644 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchase_order_header
[0m20:16:14.000177 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_product_subcategory"
[0m20:16:14.020582 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_product_subcategory (compile): 2023-07-01 20:16:13.994892 => 2023-07-01 20:16:14.020430
[0m20:16:14.008185 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_detail"
[0m20:16:14.022916 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchase_order_detail (compile): 2023-07-01 20:16:14.003083 => 2023-07-01 20:16:14.022798
[0m20:16:14.022147 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_product_subcategory
[0m20:16:14.025102 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_purchasing_product_vendor
[0m20:16:14.024307 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchase_order_detail
[0m20:16:14.028458 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_purchasing_ship_method
[0m20:16:14.029612 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_ship_method'
[0m20:16:14.030162 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_purchasing_ship_method
[0m20:16:14.026464 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchase_order_header"
[0m20:16:14.036724 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchase_order_header (compile): 2023-07-01 20:16:14.012991 => 2023-07-01 20:16:14.036582
[0m20:16:14.037932 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchase_order_header
[0m20:16:14.038583 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_purchasing_vendor
[0m20:16:14.027693 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_product_vendor'
[0m20:16:14.040321 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_purchasing_product_vendor
[0m20:16:14.045757 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_product_vendor"
[0m20:16:14.046567 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_purchasing_product_vendor (compile): 2023-07-01 20:16:14.040706 => 2023-07-01 20:16:14.046433
[0m20:16:14.039636 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_purchasing_vendor'
[0m20:16:14.048787 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_purchasing_vendor
[0m20:16:14.048062 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_purchasing_product_vendor
[0m20:16:14.035862 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_ship_method"
[0m20:16:14.057361 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_purchasing_ship_method (compile): 2023-07-01 20:16:14.030526 => 2023-07-01 20:16:14.057230
[0m20:16:14.058744 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_purchasing_ship_method
[0m20:16:14.054231 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_purchasing_vendor"
[0m20:16:14.060358 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_purchasing_vendor (compile): 2023-07-01 20:16:14.049215 => 2023-07-01 20:16:14.060242
[0m20:16:14.061726 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_purchasing_vendor
[0m20:16:14.062457 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_currency
[0m20:16:14.063920 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency'
[0m20:16:14.064529 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_currency
[0m20:16:14.055819 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_country_region_currency
[0m20:16:14.059579 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_creditcard
[0m20:16:14.070810 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency"
[0m20:16:14.071864 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_country_region_currency'
[0m20:16:14.072777 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_creditcard'
[0m20:16:14.074135 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_creditcard
[0m20:16:14.073676 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_country_region_currency
[0m20:16:14.085533 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_country_region_currency"
[0m20:16:14.086464 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_country_region_currency (compile): 2023-07-01 20:16:14.079751 => 2023-07-01 20:16:14.086340
[0m20:16:14.088065 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_country_region_currency
[0m20:16:14.088948 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_currency_rate
[0m20:16:14.089706 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_creditcard"
[0m20:16:14.092296 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_creditcard (compile): 2023-07-01 20:16:14.074480 => 2023-07-01 20:16:14.092171
[0m20:16:14.093670 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_creditcard
[0m20:16:14.090200 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_currency (compile): 2023-07-01 20:16:14.065016 => 2023-07-01 20:16:14.090095
[0m20:16:14.096528 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_currency
[0m20:16:14.097479 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_order_detail
[0m20:16:14.094554 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_customer
[0m20:16:14.100104 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_customer'
[0m20:16:14.100764 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_customer
[0m20:16:14.098908 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_detail'
[0m20:16:14.091425 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_currency_rate'
[0m20:16:14.107581 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_customer"
[0m20:16:14.108210 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_order_detail
[0m20:16:14.108679 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_currency_rate
[0m20:16:14.120740 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_currency_rate"
[0m20:16:14.126169 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_detail"
[0m20:16:14.127628 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_customer (compile): 2023-07-01 20:16:14.101208 => 2023-07-01 20:16:14.127339
[0m20:16:14.128471 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_currency_rate (compile): 2023-07-01 20:16:14.114504 => 2023-07-01 20:16:14.128331
[0m20:16:14.130428 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_customer
[0m20:16:14.132094 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_currency_rate
[0m20:16:14.134513 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_order_header_reason
[0m20:16:14.133722 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_order_detail (compile): 2023-07-01 20:16:14.109221 => 2023-07-01 20:16:14.133604
[0m20:16:14.132945 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_order_header
[0m20:16:14.137490 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_order_detail
[0m20:16:14.139716 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_person
[0m20:16:14.138747 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header'
[0m20:16:14.141824 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_order_header
[0m20:16:14.141159 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person'
[0m20:16:14.135998 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_order_header_reason'
[0m20:16:14.150539 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_order_header_reason
[0m20:16:14.157283 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header_reason"
[0m20:16:14.158164 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_order_header_reason (compile): 2023-07-01 20:16:14.151044 => 2023-07-01 20:16:14.158041
[0m20:16:14.149811 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_person
[0m20:16:14.168081 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person"
[0m20:16:14.168961 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person (compile): 2023-07-01 20:16:14.161834 => 2023-07-01 20:16:14.168841
[0m20:16:14.170365 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_person
[0m20:16:14.161224 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_order_header"
[0m20:16:14.172066 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_order_header (compile): 2023-07-01 20:16:14.142312 => 2023-07-01 20:16:14.171955
[0m20:16:14.173429 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_order_header
[0m20:16:14.174252 [debug] [Thread-3 (]: Began running node model.desafioaethaina.stg_sales_reason
[0m20:16:14.175536 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_reason'
[0m20:16:14.176238 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.stg_sales_reason
[0m20:16:14.159626 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_order_header_reason
[0m20:16:14.171172 [debug] [Thread-4 (]: Began running node model.desafioaethaina.stg_sales_person_quota_history
[0m20:16:14.182953 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_reason"
[0m20:16:14.185644 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_tax_rate
[0m20:16:14.187136 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_person_quota_history'
[0m20:16:14.189259 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_tax_rate'
[0m20:16:14.190900 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_tax_rate
[0m20:16:14.190092 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.stg_sales_person_quota_history
[0m20:16:14.198329 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_tax_rate"
[0m20:16:14.205080 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_tax_rate (compile): 2023-07-01 20:16:14.191439 => 2023-07-01 20:16:14.204954
[0m20:16:14.206483 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_tax_rate
[0m20:16:14.204205 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.stg_sales_reason (compile): 2023-07-01 20:16:14.176715 => 2023-07-01 20:16:14.204066
[0m20:16:14.210734 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.stg_sales_reason
[0m20:16:14.207886 [debug] [Thread-2 (]: Began running node model.desafioaethaina.stg_sales_territory
[0m20:16:14.212042 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_person_quota_history"
[0m20:16:14.212972 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_address
[0m20:16:14.217332 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.stg_sales_territory'
[0m20:16:14.219023 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_address'
[0m20:16:14.219771 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.stg_sales_person_quota_history (compile): 2023-07-01 20:16:14.198959 => 2023-07-01 20:16:14.219618
[0m20:16:14.220504 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.stg_sales_territory
[0m20:16:14.221438 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_address
[0m20:16:14.223457 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.stg_sales_person_quota_history
[0m20:16:14.229801 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.stg_sales_territory"
[0m20:16:14.246279 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_product
[0m20:16:14.256537 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_address"
[0m20:16:14.258996 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_product'
[0m20:16:14.262020 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.stg_sales_territory (compile): 2023-07-01 20:16:14.224081 => 2023-07-01 20:16:14.261882
[0m20:16:14.263327 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_address (compile): 2023-07-01 20:16:14.230193 => 2023-07-01 20:16:14.263200
[0m20:16:14.263840 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_product
[0m20:16:14.264966 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.stg_sales_territory
[0m20:16:14.265822 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_address
[0m20:16:14.292393 [debug] [Thread-2 (]: Began running node model.desafioaethaina.int_sales
[0m20:16:14.296035 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_sales'
[0m20:16:14.294504 [debug] [Thread-3 (]: Began running node model.desafioaethaina.int_reason
[0m20:16:14.296638 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.int_sales
[0m20:16:14.293396 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_product"
[0m20:16:14.297827 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_reason'
[0m20:16:14.316143 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.int_reason
[0m20:16:14.326448 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.int_sales"
[0m20:16:14.329803 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.int_reason"
[0m20:16:14.330484 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_product (compile): 2023-07-01 20:16:14.266239 => 2023-07-01 20:16:14.330348
[0m20:16:14.332423 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_product
[0m20:16:14.333104 [debug] [Thread-4 (]: Began running node model.desafioaethaina.int_person
[0m20:16:14.334992 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.int_person'
[0m20:16:14.333912 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.int_reason (compile): 2023-07-01 20:16:14.316694 => 2023-07-01 20:16:14.333787
[0m20:16:14.335524 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.int_person
[0m20:16:14.336733 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.int_reason
[0m20:16:14.337215 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.int_sales (compile): 2023-07-01 20:16:14.298358 => 2023-07-01 20:16:14.337121
[0m20:16:14.361326 [debug] [Thread-3 (]: Began running node model.desafioaethaina.dim_address
[0m20:16:14.373664 [info ] [Thread-3 (]: 2 of 8 START sql table model dev_thaina_gold.dim_address ....................... [RUN]
[0m20:16:14.375781 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_address'
[0m20:16:14.376889 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.dim_address
[0m20:16:14.372734 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.int_sales
[0m20:16:14.403287 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_products
[0m20:16:14.405052 [info ] [Thread-2 (]: 3 of 8 START sql table model dev_thaina_gold.dim_products ...................... [RUN]
[0m20:16:14.407479 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_products'
[0m20:16:14.417003 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.dim_products
[0m20:16:14.429471 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.dim_address"
[0m20:16:14.435551 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_address (compile): 2023-07-01 20:16:14.377555 => 2023-07-01 20:16:14.435356
[0m20:16:14.436259 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.dim_address
[0m20:16:14.416356 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.int_person"
[0m20:16:14.471327 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.int_person (compile): 2023-07-01 20:16:14.337538 => 2023-07-01 20:16:14.471014
[0m20:16:14.473446 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.int_person
[0m20:16:14.474294 [debug] [Thread-4 (]: Began running node model.desafioaethaina.dim_reasons
[0m20:16:14.475032 [info ] [Thread-4 (]: 4 of 8 START sql table model dev_thaina_gold.dim_reasons ....................... [RUN]
[0m20:16:14.476859 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_reasons'
[0m20:16:14.477457 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.dim_reasons
[0m20:16:14.456725 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.dim_products"
[0m20:16:14.485219 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_products (compile): 2023-07-01 20:16:14.417645 => 2023-07-01 20:16:14.485000
[0m20:16:14.486008 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.dim_products
[0m20:16:14.519120 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.dim_reasons"
[0m20:16:14.515287 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:16:14.535188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:14.578754 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_reasons (compile): 2023-07-01 20:16:14.477854 => 2023-07-01 20:16:14.578600
[0m20:16:14.616636 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.dim_reasons
[0m20:16:14.622120 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:16:15.964722 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.dim_reasons"
[0m20:16:15.966109 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.dim_address"
[0m20:16:15.970143 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.dim_products"
[0m20:16:15.971420 [debug] [Thread-4 (]: On model.desafioaethaina.dim_reasons: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_reasons"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_reasons`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with  __dbt__cte__stg_sales_order_header_reason as (
with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
),  __dbt__cte__stg_sales_reason as (
with
  source_data as (
    select
      salesreasonid as sales_reason_id
      , name as name_reason
      , reasontype as reason_type
    from `desafiothaina`.`dev_thaina`.`salesreason`
  )

select  *
from source_data
),  __dbt__cte__int_reason as (
with order_header_reason as (
	select * 
	from __dbt__cte__stg_sales_order_header_reason	
)

, sales_reason as (
	select * 
	from __dbt__cte__stg_sales_reason	
)

, union_reason as ( 
	select
		sales_order_id
		, sales_reason.*
		from order_header_reason
		left join sales_reason
			on sales_reason.sales_reason_id = order_header_reason.sales_reason_id
)

select *
from union_reason
),int_sales as (
    select *
    from __dbt__cte__int_reason
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_reason_id order by sales_reason_id) as dedup_index
    from int_sales
)

, reason_with_sk  as (
    select
        MD5(cast(sales_reason_id as string)) as sales_reason_fk
        , sales_order_id
        , name_reason
        , reason_type
      from deduplication_data
    where dedup_index = 1
)

select *
from reason_with_sk
    );
  
[0m20:16:15.972107 [debug] [Thread-3 (]: On model.desafioaethaina.dim_address: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_address"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_address`
    
    
    OPTIONS(
      description="""This table contains information about address of workers and clients of Adventure Works"""
    )
    as (
      with  __dbt__cte__stg_person_address as (
with source_data as (
  select 
    addressid as address_id
    , addressline1 as address_line1
    , addressline2 as address_line2
    , city
    , stateprovinceid as state_province_id
    , postalcode as postal_code
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`address`
)

select *
from source_data
),  __dbt__cte__stg_person_address_type as (
with source_data as (
  select 
    addresstypeid as address_type_id
    , name as address_type_name 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`addresstype`
)

select *
from source_data
),  __dbt__cte__stg_person_business_entity_address as (
with source_data as (
  select 
    businessentityid as business_entity_id
    , addressid as address_id
    , addresstypeid as address_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentityaddress`
)

select *
from source_data
),  __dbt__cte__stg_person_business_entity_contact as (
with source_data as (
  select 
    businessentityid as business_entity_id
    , personid as person_id
    , contacttypeid as contact_type_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`businessentitycontact`
)

select *
from source_data
),  __dbt__cte__stg_person_contact_type as (
with source_data as (
  select 
    contacttypeid as contact_type_id
    , name as contact_type_name 
  from  `desafiothaina`.`dev_thaina`.`contacttype`
)

select *
from source_data
),  __dbt__cte__int_address as (
with address as (
	select * 
    from __dbt__cte__stg_person_address
)

, address_type as (
	select * 
    from __dbt__cte__stg_person_address_type
)

, business_entity_address as (
	select * 
    from __dbt__cte__stg_person_business_entity_address
)

, business_entity_contact as (
	select * 
    from __dbt__cte__stg_person_business_entity_contact
)

, contact_type_worker as (
	select  * 
    from  __dbt__cte__stg_person_contact_type 
)

, union_person_addres as (
    select
        business_entity_address.address_id
        , business_entity_id
        , business_entity_address.address_type_id
        , concat(address_line1, ' ', ifnull('',address_line2), ' ', postal_code) as address
        , city
        , state_province_id
        , address_type_name
    from business_entity_address
    left join address
    on address.address_id = business_entity_address.address_id
   	left join address_type
   	on address_type.address_type_id = business_entity_address.address_type_id
)

, union_contact_type as (
	select 
		union_person_addres.*
		, person_id as worker_id
		, contact_type_worker.contact_type_id 
		, contact_type_name as contact_type_name_worker
	from union_person_addres
	left join business_entity_contact
	on business_entity_contact.business_entity_id = union_person_addres.business_entity_id 
	left join contact_type_worker
	on contact_type_worker.contact_type_id = business_entity_contact.contact_type_id
)

select * 
from union_contact_type
),int_address as (
    select *
    from __dbt__cte__int_address
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by address_id order by address_id) as dedup_index
    from int_address
)

, address_with_sk  as (
    select
        MD5(cast(address_id as string)) address_sk
        , business_entity_id
        , address_type_id
        , address_type_name
        , worker_id
        , contact_type_id
        , contact_type_name_worker
        , address
        , city
        , state_province_id
      from deduplication_data
    where dedup_index = 1
)

select *
from address_with_sk
    );
  
[0m20:16:15.975638 [debug] [Thread-2 (]: On model.desafioaethaina.dim_products: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_products"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_products`
    
    
    OPTIONS(
      description="""This table contains information about products of Adventure Works"""
    )
    as (
      with  __dbt__cte__stg_product as (
with source_data as (
  select 
    productid as product_id
    , productmodelid as product_model_id
    , productsubcategoryid as product_subcategory_id
    , name as product_name
    , productnumber as product_number
    , makeflag
    , finishedgoodsflag as finished_goods_flag
    , color
    , safetystocklevel as safety_stock_level
    , standardcost as stand_cost
    , listprice as list_price
    , size as size_product
    , style as style_product
    , weight as weight_product 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`product`
)

select * from source_data
),  __dbt__cte__stg_product_subcategory as (
with source_data as (
  select 
    productsubcategoryid as subcategory_id
    , productcategoryid as category_id
    , name as subcategory_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productsubcategory`
)

select *
from source_data
),  __dbt__cte__stg_product_category as (
with source_data as (
  select 
    productcategoryid as category_id
    , name as category_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productcategory`
)

select *
from source_data
),  __dbt__cte__stg_product_inventory as (
with source_data as (
  select 
    productid as product_id
    , locationid as location_id
    , shelf
    , bin
    , quantity as quantity_inventory
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productinventory`
)

select *
from source_data
),  __dbt__cte__stg_product_location as (
with source_data as (
  select 
    locationid as location_id
    , name as location_name
    -- Standard hourly cost of the manufacturing location.
    , costrate as cost_rate
    -- Work capacity (in hours) of the manufacturing location.
    , availability 
  from  `desafiothaina`.`dev_thaina`.`location`
)

select *
from source_data
),  __dbt__cte__stg_product_model as (
with source_data as (
  select 
    productmodelid as model_id
    , name as model_name
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`productmodel`
)

select *
from source_data
),  __dbt__cte__int_product as (
with product as (
    select * 
    from __dbt__cte__stg_product 
)

, subcategory as (
    select * 
    from __dbt__cte__stg_product_subcategory
)

, category as (
    select * 
    from __dbt__cte__stg_product_category
)

, inventory as (
    select * 
    from __dbt__cte__stg_product_inventory
)

, location as (
    select * 
    from __dbt__cte__stg_product_location
)

, model as (
    select * 
    from __dbt__cte__stg_product_model
)

, union_product_subcategory as (
    select 
       product.*
       , category_id
       , subcategory_name
    from product
    left join subcategory
    on product.product_subcategory_id = subcategory.subcategory_id
)

, union_product_category as (
	select 
		union_product_subcategory.*
		, category_name
	from union_product_subcategory
	left join category
    on union_product_subcategory.category_id = category.category_id
)

, union_product_model as (
	select 
		union_product_category.*
		, model_name
	from union_product_category
	left join model
    on union_product_category.product_model_id = model.model_id
)

, union_product_inventory as (
    select 
        union_product_model.*
        , quantity_inventory
        , shelf
        , bin
    from union_product_model
    left join inventory
    on union_product_model.product_id = inventory.product_id
)

select * 
from union_product_inventory
),int_product as (
    select *
    from __dbt__cte__int_product
    where product_id is not null
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by product_id order by product_id) as dedup_index
    from int_product
 
)

, prodcut_with_sk  as (
    select
        MD5(cast(product_id as string)) as product_sk
        , category_name
        , subcategory_name
        , product_name
        , product_number
        , makeflag
        , finished_goods_flag
        , color
        , safety_stock_level
        , stand_cost
        , size_product
        , style_product
        , weight_product
        , shelf
        , bin
        , quantity_inventory
        , model_name
      from deduplication_data
    where dedup_index = 1  
)

-- , select_not_null as (
--     select *
--     from prodcut_with_sk
--     where product_sk is not null
-- )

select *
from prodcut_with_sk
    );
  
[0m20:16:16.199190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:aff03faf-7a12-4579-b301-040dcbb6d2e5&page=queryresults
[0m20:16:16.222953 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_dates"
[0m20:16:16.223807 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (compile): 2023-07-01 20:16:13.695754 => 2023-07-01 20:16:16.223689
[0m20:16:16.224330 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_dates
[0m20:16:16.495942 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_dates"
[0m20:16:16.496990 [debug] [Thread-1 (]: On model.desafioaethaina.dim_dates: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_dates"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_dates`
    
    
    OPTIONS(
      description="""This table contains information about the dates that events occur for all source."""
    )
    as (
      /* Using dbt_utils to create a sequence of days. */
with date_series as (
           





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1187
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2011-05-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2014-07-31' as date)

)

select * from filtered


    )

/* Creating necessary columns to use in PowerBI. */
, date_columns as (
    select distinct
        date(date_day) as metric_date
	    , extract(day from date_day) as day
        , extract(month from date_day) as month
        , extract(year from date_day) as year
        , extract(quarter from date_day) as quarter
    from date_series
)

, month_columns as (
    select
    	*
		, case
            when month = 1 then 'Jan'
            when month = 2 then 'Fev'
            when month = 3 then 'Mar'
            when month = 4 then 'Abr'
            when month = 5 then 'Mai'
            when month = 6 then 'Jun'
            when month = 7 then 'Jul'
            when month = 8 then 'Ago'
            when month = 9 then 'Set'
            when month = 10 then 'Out'
            when month = 11 then 'Nov'
            when month = 12 then 'Dez'
        end as fullmonth
    from date_columns
)

select *
from month_columns
    );
  
[0m20:16:18.990548 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:a4ecb3f3-08d3-43a5-9b8f-a6ab0ed50197&page=queryresults
[0m20:16:19.016993 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_reasons (execute): 2023-07-01 20:16:14.617675 => 2023-07-01 20:16:19.016847
[0m20:16:19.018034 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21e32bf0>]}
[0m20:16:19.018796 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dev_thaina_gold.dim_reasons .................. [[32mCREATE TABLE (7.0 rows, 432.3 KB processed)[0m in 4.54s]
[0m20:16:19.019812 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.dim_reasons
[0m20:16:19.020841 [debug] [Thread-4 (]: Began running node model.desafioaethaina.dim_cards_type
[0m20:16:19.021933 [info ] [Thread-4 (]: 5 of 8 START sql table model dev_thaina_gold.dim_cards_type .................... [RUN]
[0m20:16:19.023326 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_cards_type'
[0m20:16:19.023975 [debug] [Thread-4 (]: Began compiling node model.desafioaethaina.dim_cards_type
[0m20:16:19.042857 [debug] [Thread-4 (]: Writing injected SQL for node "model.desafioaethaina.dim_cards_type"
[0m20:16:19.044642 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_cards_type (compile): 2023-07-01 20:16:19.024417 => 2023-07-01 20:16:19.044212
[0m20:16:19.045759 [debug] [Thread-4 (]: Began executing node model.desafioaethaina.dim_cards_type
[0m20:16:19.061610 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:16:19.234721 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:6d9d5830-8f49-4c07-9db1-555833baa25b&page=queryresults
[0m20:16:19.242939 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7d7e4e2c-cc1a-4010-842a-95008d896fab&page=queryresults
[0m20:16:19.989616 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.dim_address (execute): 2023-07-01 20:16:14.436686 => 2023-07-01 20:16:19.989541
[0m20:16:19.991692 [debug] [Thread-4 (]: Writing runtime sql for node "model.desafioaethaina.dim_cards_type"
[0m20:16:19.992874 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21ca62c0>]}
[0m20:16:19.993866 [info ] [Thread-3 (]: 2 of 8 OK created sql table model dev_thaina_gold.dim_address .................. [[32mCREATE TABLE (19.6k rows, 1.5 MB processed)[0m in 5.62s]
[0m20:16:19.994721 [debug] [Thread-4 (]: On model.desafioaethaina.dim_cards_type: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_cards_type"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_cards_type`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with  __dbt__cte__stg_sales_order_header as (
with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(cast(orderdate as timestamp) as date) as order_date
    , cast(cast(duedate as timestamp) as date) as due_date
    , cast(cast(shipdate as timestamp) as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
),  __dbt__cte__stg_sales_order_header_reason as (
with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
),  __dbt__cte__stg_sales_order_detail as (
with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
),  __dbt__cte__stg_sales_creditcard as (
with source_data as (
  select 
    creditcardid as credit_card_id
    , cardtype as card_type
  from  `desafiothaina`.`dev_thaina`.`creditcard`
)
select *
from source_data
),  __dbt__cte__stg_purchasing_ship_method as (
with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
),  __dbt__cte__int_sales as (
with order_header as (
	select * 
	from __dbt__cte__stg_sales_order_header	
)

, order_header_reason as (
	select * 
	from __dbt__cte__stg_sales_order_header_reason	
)

, order_detail as (
	select * 
	from __dbt__cte__stg_sales_order_detail	
)

, credit_card as (
	select * 
	from __dbt__cte__stg_sales_creditcard	
)

, ship_method as (
	select * 
	from __dbt__cte__stg_purchasing_ship_method
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
),int_sales as (
	select * 
    from __dbt__cte__int_sales
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by 
            credit_card_id
            , credit_card_approval_code 
        order by credit_card_id) as dedup_index
    from int_sales
)

, credit_card_with_sk  as (
    select
        MD5(cast(credit_card_id as string)) credit_card_sk
        , card_type
        , credit_card_approval_code
      from deduplication_data
    where dedup_index = 1
)

select *
from credit_card_with_sk
    );
  
[0m20:16:19.995249 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.dim_address
[0m20:16:19.998343 [debug] [Thread-3 (]: Began running node model.desafioaethaina.fact_sales
[0m20:16:19.999105 [info ] [Thread-3 (]: 6 of 8 START sql table model dev_thaina_gold.fact_sales ........................ [RUN]
[0m20:16:20.000323 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.desafioaethaina.fact_sales'
[0m20:16:20.000931 [debug] [Thread-3 (]: Began compiling node model.desafioaethaina.fact_sales
[0m20:16:20.029031 [debug] [Thread-3 (]: Writing injected SQL for node "model.desafioaethaina.fact_sales"
[0m20:16:20.039127 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.fact_sales (compile): 2023-07-01 20:16:20.001321 => 2023-07-01 20:16:20.038945
[0m20:16:20.039927 [debug] [Thread-3 (]: Began executing node model.desafioaethaina.fact_sales
[0m20:16:20.045146 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:16:20.107784 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_products (execute): 2023-07-01 20:16:14.520538 => 2023-07-01 20:16:20.107705
[0m20:16:20.108732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21c895a0>]}
[0m20:16:20.109280 [info ] [Thread-2 (]: 3 of 8 OK created sql table model dev_thaina_gold.dim_products ................. [[32mCREATE TABLE (504.0 rows, 70.5 KB processed)[0m in 5.70s]
[0m20:16:20.109935 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_products
[0m20:16:20.110777 [debug] [Thread-2 (]: Began running node model.desafioaethaina.dim_customers
[0m20:16:20.111458 [info ] [Thread-2 (]: 7 of 8 START sql table model dev_thaina_gold.dim_customers ..................... [RUN]
[0m20:16:20.112630 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_customers'
[0m20:16:20.113051 [debug] [Thread-2 (]: Began compiling node model.desafioaethaina.dim_customers
[0m20:16:20.128295 [debug] [Thread-2 (]: Writing injected SQL for node "model.desafioaethaina.dim_customers"
[0m20:16:20.129118 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_customers (compile): 2023-07-01 20:16:20.113318 => 2023-07-01 20:16:20.129010
[0m20:16:20.129553 [debug] [Thread-2 (]: Began executing node model.desafioaethaina.dim_customers
[0m20:16:20.136485 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:16:20.316997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:e86f4240-7177-4f1d-bb35-ab6d94b3d503&page=queryresults
[0m20:16:21.014206 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_dates (execute): 2023-07-01 20:16:16.224642 => 2023-07-01 20:16:21.014083
[0m20:16:21.014744 [debug] [Thread-3 (]: Writing runtime sql for node "model.desafioaethaina.fact_sales"
[0m20:16:21.016416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21c5b580>]}
[0m20:16:21.017489 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dev_thaina_gold.dim_dates .................... [[32mCREATE TABLE (1.2k rows, 0 processed)[0m in 7.34s]
[0m20:16:21.018199 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_dates
[0m20:16:21.018874 [debug] [Thread-3 (]: On model.desafioaethaina.fact_sales: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.fact_sales"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`fact_sales`
    
    
    OPTIONS(
      description="""Fact table containing Letts information about PepsiCo sales."""
    )
    as (
      with  __dbt__cte__stg_sales_order_header as (
with source_data as (
  select
    salesorderid as sales_order_id
    , customerid as customer_id
    , cast(cast(orderdate as timestamp) as date) as order_date
    , cast(cast(duedate as timestamp) as date) as due_date
    , cast(cast(shipdate as timestamp) as date) as ship_date
    , status
    , onlineorderflag as online_oder_flag
    , purchaseordernumber as purchse_order_number
    , accountnumber as account_number
    , salespersonid as sales_person_id
    , territoryid as territory_id
    , billtoaddressid as bill_to_address_id
    , shiptoaddressid as ship_to_address_id
    , shipmethodid as ship_method_id
    , creditcardid as credit_card_id
    , creditcardapprovalcode as credit_card_approval_code 
    , currencyrateid as currency_rate_id
    , subtotal as sub_total
    , taxamt as tax_amount
    , freight
    /*Total due from customer. Computed as Subtotal + TaxAmt + Freight.
      Computed: isnull(([SubTotal]+[TaxAmt])+[Freight],(0)) */
    , totaldue as total_due
    , rowguid
  from
    `desafiothaina`.`dev_thaina`.`salesorderheader`
)

select * 
  from source_data
),  __dbt__cte__stg_sales_order_header_reason as (
with source_data as (
  select
    salesorderid as sales_order_id
    , salesreasonid as sales_reason_id
  from
    `desafiothaina`.`dev_thaina`.`salesorderheadersalesreason`
)
select  *
from  source_data
),  __dbt__cte__stg_sales_order_detail as (
with source_data as (
  select 
    salesorderid as sales_order_id
    , salesorderdetailid as sales_order_detail_id
    -- Shipment tracking number supplied by the shipper.
    , carriertrackingnumber as carrier_tracking_number
    , orderqty as order_qty
    , productid as product_id
    -- Promotional code. Foreign key to SpecialOffer.SpecialOfferID.
    -- , specialofferid as special_offer_id
    , unitprice as unit_price
    , unitpricediscount as unit_price_discount
    /* Per product subtotal. Computed as UnitPrice * (1 - UnitPriceDiscount) * OrderQty.
      Computed: isnull(([UnitPrice]*((1.0)-[UnitPriceDiscount]))*[OrderQty],(0.0))* era o linetotal*/ 
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`salesorderdetail`
)

select *
from source_data
),  __dbt__cte__stg_sales_creditcard as (
with source_data as (
  select 
    creditcardid as credit_card_id
    , cardtype as card_type
  from  `desafiothaina`.`dev_thaina`.`creditcard`
)
select *
from source_data
),  __dbt__cte__stg_purchasing_ship_method as (
with source_data as (
  select 
    shipmethodid as ship_method_id
    , name as shipping_company_name
    , shipbase as ship_base
    , shiprate as ship_rate
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`shipmethod`
)

select *
from source_data
),  __dbt__cte__int_sales as (
with order_header as (
	select * 
	from __dbt__cte__stg_sales_order_header	
)

, order_header_reason as (
	select * 
	from __dbt__cte__stg_sales_order_header_reason	
)

, order_detail as (
	select * 
	from __dbt__cte__stg_sales_order_detail	
)

, credit_card as (
	select * 
	from __dbt__cte__stg_sales_creditcard	
)

, ship_method as (
	select * 
	from __dbt__cte__stg_purchasing_ship_method
)

, union_header_reason as (
	select 
		order_header.*
		, card_type
	from order_header 
	left join credit_card
		on credit_card.credit_card_id = order_header.credit_card_id
)

, union_header_detail as (
	select 
		union_header_reason.*
		, shipping_company_name
		, sales_order_detail_id
		, carrier_tracking_number
		, product_id
		, order_qty
		, unit_price
		, unit_price_discount
	from order_detail 
	left join union_header_reason
		on union_header_reason.sales_order_id =  order_detail.sales_order_id
	left join ship_method
		on ship_method.ship_method_id = union_header_reason.ship_method_id
)

select * 
from union_header_detail
),int_sales as (
    select * 
    from __dbt__cte__int_sales
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by sales_order_id, sales_order_detail_id order by sales_order_id) as dedup_index
    from int_sales
)

, sales_with_sk  as (
    select
        row_number() over (order by sales_order_id, sales_order_detail_id) as sale_identifier_sk
        , sales_order_id 
        , sales_order_detail_id
        , order_date
        , MD5(cast(customer_id as string)) as customer_fk
        , MD5(cast(sales_person_id as string)) as sales_person_fk
        , MD5(cast(bill_to_address_id as string)) as bill_to_address_fk
        , MD5(cast(ship_to_address_id as string)) as ship_to_address_fk
        , MD5(cast(ship_method_id as string)) as ship_method_fk
        , MD5(cast(product_id as string)) as product_fk
        , sub_total
        , tax_amount
        , freight
        , total_due
        , order_qty
        , unit_price
        , unit_price_discount
    from deduplication_data
    where dedup_index = 1
)

select *
from sales_with_sk
    );
  
[0m20:16:21.019698 [debug] [Thread-1 (]: Began running node model.desafioaethaina.dim_workers
[0m20:16:21.024781 [info ] [Thread-1 (]: 8 of 8 START sql table model dev_thaina_gold.dim_workers ....................... [RUN]
[0m20:16:21.026596 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.desafioaethaina.dim_workers'
[0m20:16:21.030134 [debug] [Thread-2 (]: Writing runtime sql for node "model.desafioaethaina.dim_customers"
[0m20:16:21.030982 [debug] [Thread-1 (]: Began compiling node model.desafioaethaina.dim_workers
[0m20:16:21.053610 [debug] [Thread-1 (]: Writing injected SQL for node "model.desafioaethaina.dim_workers"
[0m20:16:21.054159 [debug] [Thread-2 (]: On model.desafioaethaina.dim_customers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_customers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_customers`
    
    
    OPTIONS(
      description=""""""
    )
    as (
      with  __dbt__cte__stg_sales_customer as (
with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
),  __dbt__cte__stg_sales_territory as (
with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
),  __dbt__cte__stg_person_person as (
with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
),  __dbt__cte__stg_person_country_region as (
with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
),  __dbt__cte__stg_person_state_province as (
with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
),  __dbt__cte__int_person as (
with customer as (
	select * 
    from __dbt__cte__stg_sales_customer
)

, sales_territory as (
	select * 
    from __dbt__cte__stg_sales_territory
)

, person_person as (
	select * 
    from __dbt__cte__stg_person_person
)

, person_country as (
	select * 
    from __dbt__cte__stg_person_country_region
)

, state_province as (
	select * 
    from __dbt__cte__stg_person_state_province
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , sales_territory_year
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixed_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, sales_territory_year
		, country_region_name
		, state_province_id
		, state_province_code
		, state_province_name
	from union_customer_state_province
	where customer_id is not null

)

select * 
from change_columns_name
),int_person as (
    select * 
    from __dbt__cte__int_person
    where person_type = 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_customer_id order by fixed_customer_id) as dedup_index
    from int_person
)

, customer_with_sk  as (
    select
        MD5(cast(fixed_customer_id as string)) as customer_sk
        , full_name 
		, territory_id 
        , person_type
		, courtesy_title
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from customer_with_sk
    );
  
[0m20:16:21.058204 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (compile): 2023-07-01 20:16:21.031952 => 2023-07-01 20:16:21.057925
[0m20:16:21.059105 [debug] [Thread-1 (]: Began executing node model.desafioaethaina.dim_workers
[0m20:16:21.065906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:21.939473 [debug] [Thread-1 (]: Writing runtime sql for node "model.desafioaethaina.dim_workers"
[0m20:16:21.940210 [debug] [Thread-1 (]: On model.desafioaethaina.dim_workers: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "desafioaethaina", "target_name": "dev", "node_id": "model.desafioaethaina.dim_workers"} */

  
    

    create or replace table `desafiothaina`.`dev_thaina_gold`.`dim_workers`
    
    
    OPTIONS(
      description="""This table contains information about workers of Adventure Works"""
    )
    as (
      with  __dbt__cte__stg_sales_customer as (
with source_data as (
  select 
    customerid as customer_id
    , personid as person_id
    , storeid as store_id
    , territoryid as territory_id
    , rowguid
  from  `desafiothaina`.`dev_thaina`.`customer`
)

select *
from source_data
),  __dbt__cte__stg_sales_territory as (
with source_data as (
    select
        territoryid as territory_id
        , name as name_territory_description
        , countryregioncode as country_region_code
        , 'group' as group_geo
        , salesytd as sales_territory_year
        , saleslastyear as sales_last_year
        , costytd as bussiness_cost_in_territory
        , costlastyear as bussiness_cost_in_territory_last_year
        , rowguid  rowguid_sales_territory
    from `desafiothaina`.`dev_thaina`.`salesterritory`
  )

select  *
from source_data
),  __dbt__cte__stg_person_person as (
with source_data as (
  select 
    businessentityid as business_entity_id
    , persontype as person_type
    , namestyle as name_style
    , title as courtesy_title
    , firstname as first_name
    , middlename as middle_name
    , lastname as last_name
    , suffix
    , emailpromotion as email_promotion 
    , rowguid as rowguide_person
  from  `desafiothaina`.`dev_thaina`.`person`
)

select *
from source_data
),  __dbt__cte__stg_person_country_region as (
with source_data as (
  select 
    countryregioncode as country_region_code
    , name as country_region_name 
  from  `desafiothaina`.`dev_thaina`.`countryregion`
)
select *
from source_data
),  __dbt__cte__stg_person_state_province as (
with source_data as (
  select 
    stateprovinceid as state_province_id
    , stateprovincecode as state_province_code
    , countryregioncode as country_region_code
    , name as name_province_description
    , isonlystateprovinceflag as only_state_province_flag
    , name as state_province_name
    , territoryid as territory_id
    , rowguid as rowguide_province
  from  `desafiothaina`.`dev_thaina`.`stateprovince`
)

select *
from source_data
),  __dbt__cte__int_person as (
with customer as (
	select * 
    from __dbt__cte__stg_sales_customer
)

, sales_territory as (
	select * 
    from __dbt__cte__stg_sales_territory
)

, person_person as (
	select * 
    from __dbt__cte__stg_person_person
)

, person_country as (
	select * 
    from __dbt__cte__stg_person_country_region
)

, state_province as (
	select * 
    from __dbt__cte__stg_person_state_province
)

, union_customer_person as (
	select
		customer.*
		, person_person.*
	from person_person
	left join customer
	on customer.customer_id = person_person.business_entity_id 
)

, transformed as (
	select
		customer_id
		, case
			when person_type = 'SC' 
				then 'Store Contact'
			when person_type = 'IN' 
				then 'Individual Customer'
			when person_type = 'SP' 
				then 'Sales person'
			when person_type = 'EM' 
				then 'Employee'  
			when person_type = 'VC' 
				then 'Vendor'
			when person_type = 'GC'
				then 'General contact'
		end as person_type
		, name_style
		, courtesy_title
		, case 
			when middle_name is not null
				then concat(first_name, ' ', middle_name, ' ',last_name)
			else concat(first_name, ' ',last_name)
		end as full_name
		, suffix
		, email_promotion
		, person_id
		, store_id
		, territory_id 
	from union_customer_person

)

, union_customer_territory as (
	select
		transformed.*
		, name_territory_description
        , country_region_code
        , sales_territory_year
		from sales_territory
		left join transformed
		on transformed.territory_id =  sales_territory.territory_id
)

, union_customer_country as (
 select 
 	union_customer_territory.*
 	, country_region_name
 	from union_customer_territory
 	left join person_country
	on union_customer_territory.country_region_code = person_country.country_region_code
)

, union_customer_state_province as (
	select	
		union_customer_country.*
		, state_province_id
		, state_province_code
		, state_province_name
		from state_province
		left join union_customer_country
		on state_province.country_region_code =  union_customer_country.country_region_code 
)

, change_columns_name as (
	select
		customer_id as fixed_person_id
		, person_id as fixed_customer_id
		, person_type
		, full_name
		, suffix
		, courtesy_title	
		, email_promotion
		, store_id
		, territory_id 
		, name_territory_description
		, country_region_code
		, sales_territory_year
		, country_region_name
		, state_province_id
		, state_province_code
		, state_province_name
	from union_customer_state_province
	where customer_id is not null

)

select * 
from change_columns_name
),int_person as (
    select * 
    from __dbt__cte__int_person
    where person_type != 'Individual Customer'
)

, deduplication_data as (
    select
        *
        , row_number() over (partition by fixed_person_id order by fixed_person_id) as dedup_index
    from int_person
)

, worker_with_sk  as (
    select
        MD5(cast(fixed_person_id as string)) as worker_sk
        , courtesy_title
        , full_name
		, territory_id 
        , person_type
        , suffix
        , store_id
        , email_promotion
        , name_territory_description
        , country_region_code
        , country_region_name
        , state_province_id
        , state_province_code
        , state_province_name
    from deduplication_data
    where dedup_index = 1
)

select *
from worker_with_sk
    );
  
[0m20:16:24.694205 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:7af1f641-db8d-4b76-a125-997f1dabf53b&page=queryresults
[0m20:16:24.698454 [debug] [Thread-2 (]: Timing info for model.desafioaethaina.dim_customers (execute): 2023-07-01 20:16:20.129993 => 2023-07-01 20:16:24.698390
[0m20:16:24.699381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21ca5930>]}
[0m20:16:24.699903 [info ] [Thread-2 (]: 7 of 8 OK created sql table model dev_thaina_gold.dim_customers ................ [[32mCREATE TABLE (9.8k rows, 1.2 MB processed)[0m in 4.59s]
[0m20:16:24.700396 [debug] [Thread-2 (]: Finished running node model.desafioaethaina.dim_customers
[0m20:16:25.227438 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:87bea680-becc-456e-bcf7-2db8d9fcf8e1&page=queryresults
[0m20:16:25.231235 [debug] [Thread-4 (]: Timing info for model.desafioaethaina.dim_cards_type (execute): 2023-07-01 20:16:19.046240 => 2023-07-01 20:16:25.231131
[0m20:16:25.232664 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21deb250>]}
[0m20:16:25.233656 [info ] [Thread-4 (]: 5 of 8 OK created sql table model dev_thaina_gold.dim_cards_type ............... [[32mCREATE TABLE (30.3k rows, 2.4 MB processed)[0m in 6.21s]
[0m20:16:25.234769 [debug] [Thread-4 (]: Finished running node model.desafioaethaina.dim_cards_type
[0m20:16:25.358865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:eebd72fa-702e-4788-b602-6b1628edf06f&page=queryresults
[0m20:16:25.610684 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=desafiothaina&j=bq:US:8422693d-b8cd-4f4b-8e37-05a88b859f63&page=queryresults
[0m20:16:26.132939 [debug] [Thread-1 (]: Timing info for model.desafioaethaina.dim_workers (execute): 2023-07-01 20:16:21.059701 => 2023-07-01 20:16:26.132852
[0m20:16:26.133911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21c23af0>]}
[0m20:16:26.134533 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dev_thaina_gold.dim_workers .................. [[32mCREATE TABLE (496.0 rows, 1.0 MB processed)[0m in 5.11s]
[0m20:16:26.135382 [debug] [Thread-1 (]: Finished running node model.desafioaethaina.dim_workers
[0m20:16:26.332650 [debug] [Thread-3 (]: Timing info for model.desafioaethaina.fact_sales (execute): 2023-07-01 20:16:20.040433 => 2023-07-01 20:16:26.332577
[0m20:16:26.333891 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b0d3d6-a36f-40bb-a423-9f870f9b8e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21d7b250>]}
[0m20:16:26.334853 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dev_thaina_gold.fact_sales ................... [[32mCREATE TABLE (121.3k rows, 8.9 MB processed)[0m in 6.33s]
[0m20:16:26.335697 [debug] [Thread-3 (]: Finished running node model.desafioaethaina.fact_sales
[0m20:16:26.338014 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:16:26.339199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:26.339712 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_workers' was properly closed.
[0m20:16:26.340163 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_customers' was properly closed.
[0m20:16:26.340603 [debug] [MainThread]: Connection 'model.desafioaethaina.fact_sales' was properly closed.
[0m20:16:26.341047 [debug] [MainThread]: Connection 'model.desafioaethaina.dim_cards_type' was properly closed.
[0m20:16:26.341639 [info ] [MainThread]: 
[0m20:16:26.342418 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 14.74 seconds (14.74s).
[0m20:16:26.344539 [debug] [MainThread]: Command end result
[0m20:16:26.377645 [info ] [MainThread]: 
[0m20:16:26.378255 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:26.379003 [info ] [MainThread]: 
[0m20:16:26.380386 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:16:26.381746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21ef9120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21e43e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b21e40e50>]}
[0m20:16:26.382411 [debug] [MainThread]: Flushing usage events
